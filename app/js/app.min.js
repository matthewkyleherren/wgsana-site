/*! For license information please see app.min.js.LICENSE.txt */
(()=>{"use strict";var __webpack_modules__={815:(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{eval("\n;// CONCATENATED MODULE: ./app/src/js/app/appStore.js\n/* harmony default export */ const appStore = ({\n  main: null,\n  rootUrl: null,\n  isDesktop: null,\n  firstNavigation: null,\n  currentSection: null,\n  client: {\n    browser: '',\n    device: '',\n    lang: 'es',\n    os: '',\n    orientation: null,\n    sizes: {\n      width: window.innerWidth,\n      height: window.innerHeight\n    },\n    mousePosition: {\n      x: window.innerWidth / 2,\n      y: window.innerHeight / 2\n    }\n  }\n});\n;// CONCATENATED MODULE: ./app/src/js/utils/string.js\n//Copyright 2018 Vicente Lucendo - vicen@vlucendo.com\nvar string = {\n  //converts a string number '#FFFFFF' to hex 0xffffff - it gets used on pixi\n  toHex: function toHex(str) {\n    return parseInt(str.substring(1), 16);\n  },\n  //true or false if text is on the string\n  contains: function contains(str, text) {\n    return str.indexOf(text) > -1;\n  }\n};\n;// CONCATENATED MODULE: ./app/src/js/utils/is.js\n//Copyright 2018 Vicente Lucendo - vicen@vlucendo.com\n\nvar is = {\n  array: function array(a) {\n    return Array.isArray(a);\n  },\n  object: function object(a) {\n    return string.contains(Object.prototype.toString.call(a), 'Object');\n  },\n  path: function path(a) {\n    return is.obj(a) && a.hasOwnProperty('totalLength');\n  },\n  //eslint-disable-line\n  svg: function svg(a) {\n    return a instanceof SVGElement;\n  },\n  node: function node(a) {\n    return a.nodeType || is.svg(a);\n  },\n  nodeList: function nodeList(a) {\n    return a instanceof NodeList || a instanceof HTMLCollection;\n  },\n  string: function string(a) {\n    return typeof a === 'string';\n  },\n  number: function number(a) {\n    return !isNaN(parseFloat(a)) && isFinite(a);\n  },\n  \"function\": function _function(a) {\n    return typeof a === 'function';\n  },\n  undefined: function undefined(a) {\n    return typeof a === 'undefined';\n  },\n  hex: function hex(a) {\n    return /(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(a);\n  },\n  rgb: function rgb(a) {\n    return /^rgb/.test(a);\n  },\n  hsl: function hsl(a) {\n    return /^hsl/.test(a);\n  },\n  color: function color(a) {\n    return is.hex(a) || is.rgb(a) || is.hsl(a);\n  }\n};\n;// CONCATENATED MODULE: ./app/src/js/classes/domEvents.js\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n//Copyright 2018 Vicente Lucendo - vicen@vlucendo.com\n\n\nvar domEvents_default = /*#__PURE__*/function () {\n  function _default() {\n    _classCallCheck(this, _default);\n\n    this._eventCache = [];\n  }\n\n  _createClass(_default, [{\n    key: \"_removeEvent\",\n    value: function _removeEvent(index) {\n      //remove event listener\n      this._eventCache[index].node.removeEventListener(this._eventCache[index].action, this._eventCache[index].cb); //remove element from eventcache\n\n\n      this._eventCache.splice(index, 1);\n    }\n  }, {\n    key: \"add\",\n    value: function add(node, eventName, _func) {\n      var _this = this;\n\n      var context = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n      var arg = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n      var rLink = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : false;\n\n      //nodelist or single node?\n      var _nodes = is.nodeList(node) || is.array(node) ? node : [node]; //loop though the nodes\n\n\n      var _loop = function _loop(i) {\n        //create callback passing the event, argument and source node\n        var _cb = context !== false ? function (e) {\n          _func.call(context, e, arg, _nodes[i]);\n        } : function (e) {\n          _func(e, arg, _nodes[i]);\n        }; //add the event to the node event cache\n\n\n        _this._eventCache.push({\n          node: _nodes[i],\n          action: eventName,\n          func: _func,\n          cb: _cb,\n          routerLink: rLink\n        }); //add the event to the node\n\n\n        _nodes[i].addEventListener(eventName, _cb);\n      };\n\n      for (var i = 0; i < _nodes.length; i++) {\n        _loop(i);\n      }\n    } //this function removes non router events meeting the criteria\n\n  }, {\n    key: \"remove\",\n    value: function remove(node, eventName, func) {\n      //nodelist or single node?\n      var _nodes = is.nodeList(node) || is.array(node) ? node : [node]; //loop though the nodes\n\n\n      for (var k = 0; k < _nodes.length; k++) {\n        var i = 0;\n\n        while (i < this._eventCache.length) {\n          //check if it is the same node and is not a router link\n          if (this._eventCache[i].node === _nodes[k] && !this._eventCache[i].routerLink) {\n            if (eventName && func) {\n              if (this._eventCache[i].action === eventName && this._eventCache[i].func === func) this._removeEvent(i);else i++;\n            } else if (eventName) {\n              if (this._eventCache[i].action === eventName) this._removeEvent(i);else i++;\n            } else if (func) {\n              if (this._eventCache[i].func === func) this._removeEvent(i);else i++;\n            } else {\n              this._removeEvent(i);\n            }\n          } else {\n            i++;\n          }\n        }\n      }\n    } //this function removes all non router links\n\n  }, {\n    key: \"removeAll\",\n    value: function removeAll() {\n      var i = 0;\n\n      while (i < this._eventCache.length) {\n        if (!this._eventCache[i].routerLink) this._removeEvent(i);else i++;\n      }\n    } //this function removes everything, it must only be used by component classes after elements are removed\n    //from the dom so there are not problems with unbound router links clicked by the user refreshing the page\n\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      while (this._eventCache.length > 0) {\n        this._removeEvent(0);\n      }\n    }\n  }]);\n\n  return _default;\n}();\n\n\n// EXTERNAL MODULE: ./node_modules/gsap/index.js + 2 modules\nvar gsap = __webpack_require__(358);\n;// CONCATENATED MODULE: ./app/src/js/app/appUi.js\nfunction appUi_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction appUi_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction appUi_createClass(Constructor, protoProps, staticProps) { if (protoProps) appUi_defineProperties(Constructor.prototype, protoProps); if (staticProps) appUi_defineProperties(Constructor, staticProps); return Constructor; }\n\n// app\n\n // classes\n\n // gsap\n\n\nvar _singleton = null;\n\nvar appUi = /*#__PURE__*/function () {\n  function appUi(data) {\n    appUi_classCallCheck(this, appUi);\n\n    if (!_singleton) {\n      this.data = data;\n      _singleton = this;\n    } else {\n      return _singleton;\n    } // store\n\n\n    this.appStore = appStore; // app references\n\n    this.appCore = new app_appCore(); // Events\n\n    this.domEvents = new domEvents_default(); // Cursor vars\n\n    this.cursor = {\n      position: {\n        x: 0,\n        y: 0\n      },\n      livePosition: {\n        x: 0,\n        y: 0\n      },\n      lock: false\n    };\n    this.cursorDrag = {\n      isOpen: false,\n      isPlayed: false,\n      isReduced: false,\n      openTimeline: null,\n      closeTimeline: null\n    }; // Info vars\n\n    this.info = {\n      isOpen: false\n    };\n    this.header = null;\n    this.guides = null;\n    this.background = null;\n    this.loaderDuration = 1;\n  }\n\n  appUi_createClass(appUi, [{\n    key: \"init\",\n    value: function init() {\n      this.header = {\n        isOpen: false,\n        isAnimating: false,\n        isLocked: false\n      };\n      this.initLoader();\n      this.initMenu();\n      this.initSubmenu();\n    }\n  }, {\n    key: \"selectors\",\n    value: function selectors() {\n      // Deafult\n      this.$app = document.getElementById('app');\n      this.$logo = document.getElementById('logo'); // Cursor\n\n      this.$cursor = document.getElementById('cursor');\n      this.$cursorDot = this.$cursor.querySelector('.cursor__dot');\n      this.$cursorMinus = this.$cursor.querySelector('.cursor__minus');\n      this.$cursorPlus = this.$cursor.querySelector('.cursor__plus');\n      this.$cursorDrag = this.$cursor.querySelector('.cursor__drag'); // Mask\n\n      this.$mask = document.getElementById('mask'); // Loader\n\n      this.$loader = document.getElementById('loader');\n\n      if (this.$loader) {\n        this.$loaderMask = this.$loader.querySelector('.mask');\n        this.$loaderInner = this.$loader.querySelector('.inner');\n        this.$loaderLogo = this.$loader.querySelector('.inner .letterlogo');\n        this.$loaderLogoLetters = this.$loaderLogo.querySelectorAll('.inner .letterlogo .letter');\n        this.$loaderProgress = this.$loader.querySelector('.inner .progress');\n      } // Header\n\n\n      this.$header = document.getElementById('header');\n\n      if (this.$header) {\n        this.$headerLogo = this.$header.querySelector('.logo');\n        this.$headerMenu = this.$header.querySelector('nav.menu');\n        this.$headerMenuItems = this.$headerMenu.querySelectorAll('li');\n        this.$headerSubmenu = this.$header.querySelector('nav.submenu');\n        this.$headerSubmenuItems = this.$headerSubmenu.querySelectorAll('li');\n        this.$headerTrigger = this.$header.querySelector('.trigger');\n        this.$headerTriggerText = this.$headerTrigger.querySelector('.text');\n        this.$headerTriggerIcon = this.$headerTrigger.querySelector('.icon');\n      } // Info\n\n\n      this.$info = document.getElementById('info');\n\n      if (this.$info) {\n        this.$infoCloser = this.$info.querySelector('.closer');\n        this.$infoMask = this.$info.querySelector('.mask');\n        this.$infoContent = this.$info.querySelector('.content');\n      } // Guides\n\n\n      this.$guides = document.getElementById('guides');\n\n      if (this.$guides) {\n        this.$guidesSwitcher = this.$guides.querySelector('.guides__switcher');\n        this.$guidesSwitcher2 = this.$guides.querySelector('.guides__switcher2');\n        this.$guidesHr = this.$guides.querySelector('.guides__horizontal');\n        this.$guidesVr = this.$guides.querySelector('.guides__vertical');\n        this.$guidesHr2 = this.$guides.querySelector('.guides__horizontal2');\n        this.$guidesVr2 = this.$guides.querySelector('.guides__vertical2');\n      } // Cookies\n\n\n      this.$cookies = document.getElementById('cookie-law-info-bar');\n\n      if (this.$cookies) {\n        this.$cookiesConfigureButton = document.querySelector('a.cli_settings_button');\n        this.$cookiesModal = document.querySelector('.cli-modal');\n        this.$cookiesCategory = this.$cookiesModal.querySelectorAll('a.cli-nav-link');\n      }\n    }\n  }, {\n    key: \"events\",\n    value: function events() {\n      var _this = this;\n\n      // Header\n      if (this.$header) this.domEvents.add(this.$headerTrigger, 'click', function () {\n        _this.triggerMenu();\n      }); // Info\n\n      if (this.$info) {\n        this.domEvents.add(this.$infoMask, 'click', function (e, a, el) {\n          _this.closeInfo();\n        });\n        this.domEvents.add(this.$infoCloser, 'click', function (e, a, el) {\n          _this.closeInfo();\n        });\n      } // Guides\n\n\n      if (this.$guides) {\n        this.domEvents.add(this.$guidesSwitcher, 'click', function () {\n          _this.guidesSwitcher();\n        });\n        this.domEvents.add(this.$guidesSwitcher2, 'click', function () {\n          _this.guidesSwitcher2();\n        });\n      }\n\n      if (this.$cursor && this.appStore.isDesktop) this.domEvents.add(document, 'mousemove', function (e) {\n        _this.moveCursor(e);\n      }); // this.domEvents.add(document, 'mousemove', (e, a, el) => { this.cursorOver(e, a, el); });\n\n      if (!this.appStore.isDesktop) {\n        this.previousScroll = 0;\n        this.menuOpened = true;\n        gsap/* default.to */.ZP.to(this.$header, {\n          y: '0%',\n          duration: 0.8,\n          ease: 'expo.out'\n        });\n        this.domEvents.add(window, 'scroll', function () {\n          if (_this.header.isOpen || _this.header.isLocked) return;\n          var scroll = document.documentElement.scrollTop;\n\n          if (scroll < _this.previousScroll || scroll <= 0) {\n            if (!_this.menuOpened) {\n              _this.menuOpened = true;\n              gsap/* default.to */.ZP.to(_this.$header, {\n                y: '0%',\n                duration: 0.8,\n                ease: 'expo.out'\n              });\n            }\n          } else {\n            if (_this.menuOpened) {\n              _this.menuOpened = false;\n              gsap/* default.to */.ZP.to(_this.$header, {\n                y: '-100%',\n                duration: 0.8,\n                ease: 'expo.out'\n              });\n            }\n          }\n\n          _this.previousScroll = scroll;\n        });\n      } // Cookies\n\n\n      if (this.$cookiesConfigureButton) {\n        // eslint-disable-next-line no-script-url\n        var disabled = 'javascript: void(0)';\n        this.$cookiesConfigureButton.setAttribute('href', disabled);\n      }\n\n      if (this.$cookiesModal) {\n        // eslint-disable-next-line no-script-url\n        var _disabled = 'javascript: void(0)';\n\n        for (var i = 0; i < this.$cookiesCategory.length; i++) {\n          this.$cookiesCategory[i].setAttribute('href', _disabled);\n        }\n      }\n    }\n  }, {\n    key: \"initLoader\",\n    value: function initLoader() {\n      // Animate in next slide\n      gsap/* default.to */.ZP.to(this.$loaderLogo, {\n        opacity: 1,\n        duration: 0.4,\n        ease: 'powe2.out'\n      });\n      if (this.appStore.isDesktop) gsap/* default.to */.ZP.to(this.$loaderProgress, {\n        opacity: 1,\n        duration: 0.4,\n        ease: 'powe2.out'\n      });\n\n      for (var i = 0; i < this.$loaderLogoLetters.length; i++) {\n        if (this.appStore.isDesktop) gsap/* default.set */.ZP.set(this.$loaderLogoLetters[i], {\n          y: -(window.innerHeight / 2 + window.innerWidth * 0.05)\n        });else gsap/* default.set */.ZP.set(this.$loaderLogoLetters[i], {\n          opacity: 0.0001\n        });\n        gsap/* default.to */.ZP.to(this.$loaderLogoLetters[i], {\n          y: 0,\n          ease: 'expo.inOut',\n          opacity: 1,\n          duration: 1.2,\n          delay: 0 + i * 0.02\n        });\n      }\n    }\n  }, {\n    key: \"hideLoader\",\n    value: function hideLoader() {\n      var _this2 = this;\n\n      if (this.appStore.isDesktop) gsap/* default.to */.ZP.to(this.$loaderProgress, {\n        opacity: 0.0001,\n        duration: 0.6,\n        ease: 'powe2.out'\n      });\n\n      for (var i = 0; i < this.$loaderLogoLetters.length; i++) {\n        if (this.appStore.isDesktop) gsap/* default.to */.ZP.to(this.$loaderLogoLetters[i], {\n          y: window.innerHeight / 2 + window.innerWidth * 0.1,\n          ease: 'expo.inOut',\n          duration: 1.2,\n          delay: 0 + i * 0.05\n        });else gsap/* default.to */.ZP.to(this.$loaderLogoLetters[i], {\n          opacity: 0.0001,\n          ease: 'expo.inOut',\n          duration: 1.2,\n          delay: 0 + i * 0.02\n        });\n      }\n\n      gsap/* default.to */.ZP.to([this.$loaderMask, this.$loaderInner], {\n        y: '100%',\n        duration: 1.8,\n        ease: 'expo.inOut',\n        delay: this.appStore.isDesktop ? 0 : 0.8,\n        onComplete: function onComplete() {\n          gsap/* default.set */.ZP.set(_this2.$loader, {\n            display: 'none',\n            onComplete: function onComplete() {\n              _this2.$loader.remove();\n            }\n          });\n        }\n      });\n    } // hideLoader()\n    // {\n    //     // gsap.to(this.$loaderProgress, { opacity: 0.0001, duration: 0.6, ease: 'powe2.out' });\n    //     gsap.to(this.$loaderProgress, { opacity: 0.0001,\n    //         duration: 0.6,\n    //         ease: 'powe2.out',\n    //         onComplete: () =>\n    //         {\n    //             gsap.to(this.$loaderInner, {\n    //                 y: '-100%',\n    //                 duration: this.loaderDuration,\n    //                 ease: 'power4.out',\n    //                 onComplete: () =>\n    //                 {\n    //                     gsap.set(this.$loader, { display: 'none' });\n    //                 }\n    //             });\n    //         } });\n    // }\n\n  }, {\n    key: \"initMenu\",\n    value: function initMenu() {\n      gsap/* default.set */.ZP.set(this.$headerTriggerText.children[1], {\n        y: '-100%'\n      });\n\n      for (var i = 0; i < this.$headerMenuItems.length; i++) {\n        gsap/* default.set */.ZP.set(this.$headerMenuItems[i].children[0], {\n          y: '-100%'\n        });\n      }\n    }\n  }, {\n    key: \"triggerMenu\",\n    value: function triggerMenu() {\n      var _this3 = this;\n\n      if (this.header.isAnimating) return;\n      this.header.isAnimating = true;\n\n      if (!this.header.isOpen) {\n        // Set overlay\n        gsap/* default.to */.ZP.to(this.appStore.currentSection.$overlay, {\n          opacity: 0.1,\n          duration: 0.8,\n          ease: 'power2.out'\n        }); // Reposition menu on promotionsingle\n\n        if (this.appStore.current === 'promotionssingle' && this.appStore.isDesktop) gsap/* default.to */.ZP.to(this.$header, {\n          y: '0vw',\n          duration: 0.8,\n          ease: 'expo.inOut'\n        }); // Hide logo\n\n        if (this.appStore.current !== 'home' && this.appStore.isDesktop) gsap/* default.to */.ZP.to(this.$headerLogo, {\n          opacity: 0.0001,\n          pointerEvents: 'none',\n          duration: 0.2,\n          ease: 'power2.out'\n        });\n\n        if (this.appStore.isDesktop) {\n          gsap/* default.to */.ZP.to(this.$app, {\n            willChange: 'transform',\n            scale: 0.9,\n            y: '5vw',\n            duration: 0.8,\n            ease: 'expo.inOut'\n          });\n          this.$headerMenu.style.pointerEvents = 'all';\n        } else {\n          gsap/* default.to */.ZP.to(this.$app, {\n            willChange: 'transform',\n            y: '10vw',\n            duration: 0.8,\n            ease: 'expo.inOut'\n          });\n          this.$headerMenu.style.display = 'block';\n          gsap/* default.to */.ZP.to(this.$headerMenu, {\n            y: '0%',\n            duration: 0.8,\n            ease: 'expo.inOut'\n          });\n          document.documentElement.style.overflow = 'hidden';\n        } // Animate menu items\n\n\n        for (var i = 0; i < this.$headerMenuItems.length; i++) {\n          gsap/* default.to */.ZP.to(this.$headerMenuItems[i].children[0], {\n            y: '0%',\n            duration: this.appStore.isDesktop ? 0.8 : 0.3,\n            ease: 'expo.inOut',\n            delay: this.appStore.isDesktop ? 0.1 + i * 0.05 : 0.5 + i * 0.02\n          });\n        }\n\n        if (this.appStore.isDesktop) {\n          // gsap.to(this.$headerTrigger, { y: '2.5vw', duration: 0.8, ease: 'expo.inOut' });\n          gsap/* default.to */.ZP.to(this.$headerTriggerText.children[1], {\n            y: '0%',\n            duration: 0.8,\n            ease: 'expo.inOut',\n            delay: 0.1\n          });\n          gsap/* default.to */.ZP.to(this.$headerTriggerText.children[0], {\n            y: '100%',\n            duration: 0.8,\n            ease: 'expo.inOut',\n            delay: 0.1\n          });\n          gsap/* default.to */.ZP.to(this.$headerTriggerIcon.children[0], {\n            rotation: '45deg',\n            backgroundColor: '#ffffff',\n            y: '5px',\n            duration: 0.8,\n            ease: 'expo.inOut',\n            delay: 0.1\n          });\n          gsap/* default.to */.ZP.to(this.$headerTriggerIcon.children[1], {\n            rotation: '-45deg',\n            backgroundColor: '#ffffff',\n            y: '-5px',\n            duration: 0.8,\n            ease: 'expo.inOut',\n            delay: 0.1\n          });\n        } else {\n          gsap/* default.to */.ZP.to(this.$headerTriggerIcon.children[0], {\n            rotation: '45deg',\n            y: '5px',\n            duration: 0.8,\n            ease: 'expo.inOut',\n            delay: 0.1\n          });\n          gsap/* default.to */.ZP.to(this.$headerTriggerIcon.children[1], {\n            rotation: '-45deg',\n            y: '-5px',\n            duration: 0.8,\n            ease: 'expo.inOut',\n            delay: 0.1\n          });\n        }\n\n        gsap/* default.delayedCall */.ZP.delayedCall(0.8, function () {\n          _this3.header.isAnimating = false;\n          _this3.header.isOpen = true;\n        });\n      } else {\n        // Unset overlay\n        gsap/* default.to */.ZP.to(this.appStore.currentSection.$overlay, {\n          opacity: 0.0001,\n          duration: 0.8,\n          ease: 'power2.out'\n        }); // Reposition menu on promotionsingle\n\n        if (this.appStore.current === 'promotionssingle' && this.appStore.isDesktop) gsap/* default.to */.ZP.to(this.$header, {\n          y: '-2.5vw',\n          duration: 0.8,\n          ease: 'expo.inOut'\n        }); // Hide logo\n\n        if (this.appStore.current !== 'home' && this.appStore.isDesktop) gsap/* default.to */.ZP.to(this.$headerLogo, {\n          opacity: 1,\n          duration: 0.2,\n          pointerEvents: 'initial',\n          ease: 'power2.out',\n          delay: 0.6\n        });\n\n        if (this.appStore.isDesktop) {\n          gsap/* default.to */.ZP.to(this.$app, {\n            willChange: '',\n            scale: 1,\n            y: 0,\n            duration: 0.8,\n            ease: 'expo.inOut',\n            clearProps: 'all'\n          });\n          this.$headerMenu.style.pointerEvents = 'none';\n        } else {\n          gsap/* default.to */.ZP.to(this.$app, {\n            willChange: 'transform',\n            y: 0,\n            duration: 0.8,\n            ease: 'expo.inOut',\n            clearProps: 'all'\n          });\n          gsap/* default.to */.ZP.to(this.$headerMenu, {\n            y: '-100%',\n            duration: 0.8,\n            ease: 'expo.inOut',\n            onComplete: function onComplete() {\n              _this3.$headerMenu.style.display = 'block';\n            }\n          });\n          document.documentElement.style.overflow = 'initial';\n        } // Animate menu items\n\n\n        for (var _i = 0; _i < this.$headerMenuItems.length; _i++) {\n          gsap/* default.to */.ZP.to(this.$headerMenuItems[_i].children[0], {\n            y: '-100%',\n            duration: this.appStore.isDesktop ? 0.8 : 0.4,\n            ease: 'expo.inOut',\n            delay: 0\n          });\n        }\n\n        if (this.appStore.isDesktop) {\n          gsap/* default.to */.ZP.to(this.$headerTriggerText.children[1], {\n            y: '-100%',\n            duration: 0.8,\n            ease: 'expo.inOut',\n            delay: 0\n          });\n          gsap/* default.to */.ZP.to(this.$headerTriggerText.children[0], {\n            y: '0%',\n            duration: 0.8,\n            ease: 'expo.inOut',\n            delay: 0\n          });\n          gsap/* default.to */.ZP.to(this.$headerTriggerIcon.children[0], {\n            rotation: '0deg',\n            backgroundColor: '#EC1C24',\n            y: '0',\n            duration: 0.8,\n            ease: 'expo.inOut',\n            delay: 0\n          });\n          gsap/* default.to */.ZP.to(this.$headerTriggerIcon.children[1], {\n            rotation: '0deg',\n            backgroundColor: '#EC1C24',\n            y: '0',\n            duration: 0.8,\n            ease: 'expo.inOut',\n            delay: 0\n          });\n        } else {\n          gsap/* default.to */.ZP.to(this.$headerTriggerIcon.children[0], {\n            rotation: '0deg',\n            y: '0',\n            duration: 0.8,\n            ease: 'expo.inOut',\n            delay: 0\n          });\n          gsap/* default.to */.ZP.to(this.$headerTriggerIcon.children[1], {\n            rotation: '0deg',\n            y: '0',\n            duration: 0.8,\n            ease: 'expo.inOut',\n            delay: 0\n          });\n        }\n\n        gsap/* default.delayedCall */.ZP.delayedCall(0.8, function () {\n          _this3.header.isAnimating = false;\n          _this3.header.isOpen = false;\n        });\n      }\n    }\n  }, {\n    key: \"initSubmenu\",\n    value: function initSubmenu() {\n      var _this4 = this;\n\n      for (var i = 0; i < this.$headerSubmenuItems.length; i++) {\n        gsap/* default.set */.ZP.set(this.$headerSubmenuItems[i].children[0], {\n          y: '-100%'\n        });\n        this.domEvents.add(this.$headerSubmenuItems[i], 'mouseenter', function (e, a, el) {\n          _this4.enterSubmenu(e, a, el);\n        });\n        this.domEvents.add(this.$headerSubmenuItems[i], 'mouseleave', function (e, a, el) {\n          _this4.leaveSubmenu(e, a, el);\n        });\n      }\n    }\n  }, {\n    key: \"enterSubmenu\",\n    value: function enterSubmenu(e, a, el) {\n      gsap/* default.to */.ZP.to(el.children[0].children[0], {\n        x: '0px',\n        scaleX: 1,\n        duration: 0.4,\n        ease: 'expo.out'\n      });\n      gsap/* default.to */.ZP.to(el.children[0].children[1], {\n        x: '12px',\n        opacity: 0.4,\n        duration: 0.4,\n        ease: 'expo.out'\n      });\n    }\n  }, {\n    key: \"leaveSubmenu\",\n    value: function leaveSubmenu(e, a, el) {\n      gsap/* default.to */.ZP.to(el.children[0].children[0], {\n        x: '-4px',\n        scaleX: 0,\n        duration: 0.4,\n        ease: 'expo.out'\n      });\n      gsap/* default.to */.ZP.to(el.children[0].children[1], {\n        x: '0px',\n        opacity: 1,\n        duration: 0.4,\n        ease: 'expo.out'\n      });\n    }\n  }, {\n    key: \"triggerSubmenu\",\n    value: function triggerSubmenu(_show) {\n      if (_show) {\n        gsap/* default.to */.ZP.to([this.$headerLogo, this.$headerTrigger], {\n          opacity: 0.0001,\n          pointerEvents: 'none',\n          duration: 0.2,\n          ease: 'power2.out'\n        });\n\n        for (var i = 0; i < this.$headerSubmenuItems.length; i++) {\n          gsap/* default.set */.ZP.set(this.$headerSubmenuItems[i].children[0], {\n            y: '-100%'\n          });\n          gsap/* default.to */.ZP.to(this.$headerSubmenuItems[i].children[0], {\n            y: '0%',\n            duration: 0.8,\n            ease: 'expo.inOut',\n            delay: 0 + i * 0.05\n          });\n        }\n\n        this.$headerSubmenu.style.pointerEvents = 'all';\n      } else {\n        gsap/* default.to */.ZP.to([this.$headerLogo, this.$headerTrigger], {\n          opacity: 1,\n          pointerEvents: 'initial',\n          duration: 0.2,\n          ease: 'power2.out',\n          delay: 0.8\n        });\n\n        for (var _i2 = 0; _i2 < this.$headerSubmenuItems.length; _i2++) {\n          gsap/* default.to */.ZP.to(this.$headerSubmenuItems[_i2].children[0], {\n            y: '-100%',\n            duration: 0.8,\n            ease: 'expo.inOut',\n            delay: 0 + (this.$headerSubmenuItems.length - _i2) * 0.05\n          });\n        }\n\n        this.$headerSubmenu.style.pointerEvents = 'none';\n      }\n    }\n  }, {\n    key: \"moveCursor\",\n    value: function moveCursor(e) {\n      if (this.cursor.lock) return; // Check velocity\n\n      this.cursor.livePosition.x = e.clientX;\n      this.cursor.livePosition.y = e.clientY;\n      var movementX = this.cursor.livePosition.x - this.cursor.position.x;\n      var movementY = this.cursor.livePosition.y - this.cursor.position.y;\n      var movement = Math.sqrt(movementX * movementX + movementY * movementY);\n      var velocity = movement / 10; // this._drag.velocity = lerp(this._drag.velocity, velocity, this._drag.ease * 2);\n\n      gsap/* default.to */.ZP.to(this.$cursorDot, {\n        x: this.cursor.livePosition.x,\n        y: this.cursor.livePosition.y,\n        duration: 1,\n        ease: 'expo.out'\n      });\n      gsap/* default.to */.ZP.to(this.$cursorMinus, {\n        x: this.cursor.livePosition.x,\n        y: this.cursor.livePosition.y,\n        duration: 1,\n        ease: 'expo.out'\n      });\n      gsap/* default.to */.ZP.to(this.$cursorPlus, {\n        x: this.cursor.livePosition.x,\n        y: this.cursor.livePosition.y,\n        duration: 1,\n        ease: 'expo.out'\n      });\n      gsap/* default.to */.ZP.to(this.$cursorDrag, {\n        x: this.cursor.livePosition.x,\n        y: this.cursor.livePosition.y,\n        duration: 1,\n        ease: 'expo.out'\n      });\n      this.cursor.position.x = this.cursor.livePosition.x;\n      this.cursor.position.y = this.cursor.livePosition.y;\n    }\n  }, {\n    key: \"openInfo\",\n    value: function openInfo(e) {\n      if (this.info.isOpen) return;\n      this.info.isOpen = true;\n      if (this.appStore.isDesktop) this.appStore.currentSection.superScroller._scroll.enable = false; // const textContent = this.$form.textContent;\n      // // const shortcode = '<?php echo do_shortcode(' + textContent + ')';\n      // const yourHTML = '<div class=\"mydiv\"><?php do_shortcode(\"' + textContent + '\");?></div>';\n      // // document.getElementsByClassName('services-right')[0].innerHTML = yourHTML;\n      // this.$infoContent.children[1].insertAdjacentHTML('afterbegin', yourHTML);\n\n      gsap/* default.set */.ZP.set(this.$info, {\n        display: 'block'\n      });\n      gsap/* default.set */.ZP.set(this.$infoCloser, {\n        display: 'block'\n      });\n      gsap/* default.to */.ZP.to(this.$infoMask, {\n        opacity: 1,\n        duration: 0.2,\n        ease: 'power2.out'\n      });\n      gsap/* default.to */.ZP.to(this.$infoContent, {\n        x: '0%',\n        duration: 1,\n        ease: 'expo.inOut'\n      });\n      gsap/* default.to */.ZP.to(this.$infoCloser, {\n        opacity: 1,\n        duration: 0.2,\n        ease: 'power2.out',\n        delay: 1\n      });\n      e.preventDefault();\n      return false;\n    }\n  }, {\n    key: \"closeInfo\",\n    value: function closeInfo() {\n      var _this5 = this;\n\n      gsap/* default.to */.ZP.to(this.$infoCloser, {\n        opacity: 0.0001,\n        duration: 0.2,\n        ease: 'power2.out'\n      });\n      gsap/* default.to */.ZP.to(this.$infoContent, {\n        x: '100%',\n        duration: 1,\n        ease: 'expo.inOut'\n      });\n      gsap/* default.to */.ZP.to(this.$infoMask, {\n        opacity: 0.0001,\n        duration: 0.2,\n        ease: 'power2.out',\n        delay: 1,\n        onComplete: function onComplete() {\n          gsap/* default.set */.ZP.set(_this5.$infoCloser, {\n            display: 'none'\n          });\n          gsap/* default.set */.ZP.set(_this5.$info, {\n            display: 'none'\n          });\n          _this5.info.isOpen = false;\n          if (_this5.appStore.isDesktop) _this5.appStore.currentSection.superScroller._scroll.enable = true;\n        }\n      });\n    }\n  }, {\n    key: \"enterDragCursor\",\n    value: function enterDragCursor() {\n      gsap/* default.killTweensOf */.ZP.killTweensOf([this.$cursorDrag, this.$cursorDrag.children[0], this.$cursorDot, this.$cursorPlus]);\n      this.$cursorMinus.style.display = 'block';\n      this.$cursorPlus.style.display = 'block';\n      this.$cursorDrag.style.display = 'block';\n      gsap/* default.to */.ZP.to(this.$cursorDot, {\n        scale: 1,\n        opacity: 0.0001,\n        duration: 0.3,\n        ease: 'expo.out'\n      });\n      gsap/* default.to */.ZP.to(this.$cursorMinus, {\n        scale: 1,\n        opacity: 0.0001,\n        duration: 0.3,\n        ease: 'expo.out'\n      });\n      gsap/* default.to */.ZP.to(this.$cursorPlus, {\n        scale: 1,\n        opacity: 0.0001,\n        duration: 0.3,\n        ease: 'expo.out'\n      }); //gsap.to(this.$cursorPlus.children[0], { opacity: 0.0001, duration: 0.3, ease: 'expo.out', delay: 0.1 });\n\n      gsap/* default.to */.ZP.to(this.$cursorDrag, {\n        scale: 1,\n        opacity: 1,\n        duration: 0.3,\n        ease: 'expo.out'\n      });\n      gsap/* default.to */.ZP.to(this.$cursorDrag.children[0], {\n        opacity: 1,\n        duration: 0.3,\n        ease: 'expo.out',\n        delay: 0.1\n      });\n    }\n  }, {\n    key: \"leaveDragCursor\",\n    value: function leaveDragCursor() {\n      var _this6 = this;\n\n      gsap/* default.killTweensOf */.ZP.killTweensOf([this.$cursorDrag, this.$cursorDrag.children[0], this.$cursorDot, this.$cursorPlus]);\n      gsap/* default.to */.ZP.to(this.$cursorDot, {\n        scale: 0.35,\n        opacity: 1,\n        duration: 0.3,\n        ease: 'expo.out'\n      });\n      gsap/* default.to */.ZP.to([this.$cursorDrag, this.$cursorPlus], {\n        scale: 0.35,\n        opacity: 0.0001,\n        duration: 0.3,\n        ease: 'expo.out'\n      });\n      gsap/* default.to */.ZP.to([this.$cursorDrag.children[0], this.$cursorPlus.children[0]], {\n        opacity: 0.0001,\n        duration: 0.3,\n        ease: 'expo.out',\n        onComplete: function onComplete() {\n          _this6.$cursorDrag.style.display = 'none';\n          _this6.$cursorMinus.style.display = 'none';\n          _this6.$cursorPlus.style.display = 'none';\n        }\n      });\n    } // overCursor(e, a, el)\n    // {\n    //     if(e.target.closest('a') !== null || e.target.closest('div').classList.contains('trigger'))\n    //     {\n    //         if(!this.isCursorViewing)\n    //         {\n    //             this.isCursorViewing = true;\n    //             gsap.to(this.$cursor.children[0], { scale: 0, duration: 0.8, ease: 'expo.out' });\n    //         }\n    //     }\n    //     else if(e.target.closest('div').classList.contains('drag') || e.target.closest('div').classList.contains('dot'))\n    //     {\n    //         if(!this.isCursorViewing)\n    //         {\n    //             this.isCursorViewing = true;\n    //             gsap.to(this.$cursor.children[0], { scale: 0, duration: 0.8, ease: 'expo.out' });\n    //             gsap.to(this.$cursor.children[1], { scale: 0, duration: 0.8, ease: 'expo.out' });\n    //         }\n    //     }\n    //     else if(e.target.closest('div').classList.contains('slider__bullets__item'))\n    //     {\n    //         if(!this.isCursorViewing)\n    //         {\n    //             this.isCursorViewing = true;\n    //             gsap.to(this.$cursor.children[0], { scale: 0.7, opacity: 0.2, duration: 0.8, ease: 'expo.out' });\n    //             gsap.to(this.$cursor.children[1], { scale: 0, duration: 0.8, ease: 'expo.out' });\n    //         }\n    //     }\n    //     else\n    //     {\n    //         if(this.isCursorViewing)\n    //         {\n    //             this.isCursorViewing = false;\n    //             gsap.to(this.$cursor.children[0], { scale: 1, opacity: 0.5, duration: 0.8, ease: 'expo.out' });\n    //             gsap.to(this.$cursor.children[1], { scale: 1, duration: 0.8, ease: 'expo.out' });\n    //         }\n    //     }\n    // }\n\n  }, {\n    key: \"guidesSwitcher\",\n    value: function guidesSwitcher() {\n      if (this.$guidesHr.style.display === 'block') {\n        gsap/* default.set */.ZP.set(this.$guidesHr, {\n          display: 'none'\n        });\n        gsap/* default.set */.ZP.set(this.$guidesVr, {\n          display: 'none'\n        });\n      } else {\n        gsap/* default.set */.ZP.set(this.$guidesHr, {\n          display: 'block'\n        });\n        gsap/* default.set */.ZP.set(this.$guidesVr, {\n          display: 'block'\n        });\n      }\n    }\n  }, {\n    key: \"guidesSwitcher2\",\n    value: function guidesSwitcher2() {\n      if (this.$guidesHr2.style.display === 'block') {\n        gsap/* default.set */.ZP.set(this.$guidesHr2, {\n          display: 'none'\n        });\n        gsap/* default.set */.ZP.set(this.$guidesVr2, {\n          display: 'none'\n        });\n      } else {\n        gsap/* default.set */.ZP.set(this.$guidesHr2, {\n          display: 'block'\n        });\n        gsap/* default.set */.ZP.set(this.$guidesVr2, {\n          display: 'block'\n        });\n      }\n    }\n  }, {\n    key: \"resize\",\n    value: function resize(width, height) {// this.$notice = document.getElementById('notice');\n      // if(!this.appStore.isDesktop)\n      // {\n      //     if(width > height)\n      //     {\n      //         gsap.set(this.$notice, { display: 'block' });\n      //         this.$notice.addEventListener('touchmove', (e) => { e.preventDefault(); });\n      //     }\n      //     else\n      //     {\n      //         gsap.set(this.$notice, { display: 'none' });\n      //     }\n      // }\n    }\n  }, {\n    key: \"resizeOrientation\",\n    value: function resizeOrientation() {} // eslint-disable-line\n\n  }, {\n    key: \"split\",\n    value: function split(x, n) {\n      if (x < n) {\n        document.write('-1 ');\n      } else if (x % n === 0) {\n        for (var i = 0; i < n; i++) {\n          document.write(x / n + ' ');\n        }\n      } else {\n        var zp = n - x % n;\n        var pp = Math.floor(x / n);\n\n        for (var _i3 = 0; _i3 < n; _i3++) {\n          if (_i3 >= zp) document.write(pp + 1 + ' ');else document.write(pp + ' ');\n        }\n      }\n    }\n  }, {\n    key: \"splitInParts\",\n    value: function splitInParts(num, parts) {\n      var sumParts = 0;\n      var totalParts = [];\n\n      for (var i = 0; i < parts - 1; i++) {\n        var pn = Math.random() * (num - sumParts);\n        sumParts += Math.min(pn, num * 0.5);\n        totalParts.push(sumParts);\n      }\n\n      sumParts += num - sumParts;\n      totalParts.push(sumParts);\n      return totalParts;\n    }\n  }]);\n\n  return appUi;\n}();\n\n/* harmony default export */ const app_appUi = (appUi);\n// EXTERNAL MODULE: ./node_modules/@dogstudio/highway/build/highway.module.js\nvar highway_module = __webpack_require__(219);\n// EXTERNAL MODULE: ./node_modules/gsap/ScrollTrigger.js\nvar ScrollTrigger = __webpack_require__(82);\n// EXTERNAL MODULE: ./node_modules/preload-it/dist/preload-it.js\nvar preload_it = __webpack_require__(130);\nvar preload_it_default = /*#__PURE__*/__webpack_require__.n(preload_it);\n// EXTERNAL MODULE: ./node_modules/lazyload/lazyload.js\nvar lazyload = __webpack_require__(261);\nvar lazyload_default = /*#__PURE__*/__webpack_require__.n(lazyload);\n// EXTERNAL MODULE: ./node_modules/virtual-scroll/lib/virtualscroll.js\nvar virtualscroll = __webpack_require__(389);\nvar virtualscroll_default = /*#__PURE__*/__webpack_require__.n(virtualscroll);\n;// CONCATENATED MODULE: ./app/src/js/classes/superScroller.js\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction superScroller_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction superScroller_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction superScroller_createClass(Constructor, protoProps, staticProps) { if (protoProps) superScroller_defineProperties(Constructor.prototype, protoProps); if (staticProps) superScroller_defineProperties(Constructor, staticProps); return Constructor; }\n\n// utilities\n\n\n // empty function\n\nvar noop = function noop() {}; // eslint-disable-line\n\n\nvar _default = /*#__PURE__*/function () {\n  function _default(options) {\n    var _this = this;\n\n    superScroller_classCallCheck(this, _default);\n\n    // store\n    this.appStore = appStore; // hook functions\n\n    this._onRaf = options.onRaf || noop;\n    this._onScroll = options.onScroll || noop;\n    this._currentSection = options.currentSection ? options.currentSection : null;\n    this._global = {\n      percent: {\n        x: 0,\n        y: 0\n      },\n      mode: options.mode || 'vertical'\n    };\n\n    var lerp = function lerp(value1, value2, amount) {\n      amount = amount < 0 ? 0 : amount;\n      amount = amount > 1 ? 1 : amount;\n      return value1 + (value2 - value1) * amount;\n    }; // scroll properties\n\n\n    if (options.scroll) {\n      // default virtualScroll options\n      this._virtualScroll = null;\n      this._virtualScrollOptions = {\n        el: typeof options.el !== 'undefined' ? _typeof(options.el) : window,\n        mouseMultiplier: typeof options.mouseMultiplier !== 'undefined' ? options.mouseMultiplier : this.appStore.client.os === 'windows' ? 1 : 0.4,\n        touchMultiplier: typeof options.touchMultiplier !== 'undefined' ? options.touchMultiplier : 2,\n        firefoxMultiplier: typeof options.firefoxMultiplier !== 'undefined' ? options.firefoxMultiplier : 50,\n        limitInertia: typeof options.limitInertia !== 'undefined' ? _typeof(options.limitInertia) : false,\n        passive: typeof options.passive !== 'undefined' ? options.pasive : false,\n        useKeyboard: false\n      };\n      this._scroll = {\n        enable: typeof options.enable !== 'undefined' ? options.enable : true,\n        target: options.scrollTarget,\n        width: 0,\n        height: 0,\n        timeout: false,\n        dragging: false,\n        ratio: {\n          x: 0,\n          y: 0\n        },\n        clickedPoint: {\n          x: 0,\n          y: 0\n        },\n        position: {\n          x: 0,\n          y: 0\n        },\n        lastPosition: {\n          x: 0,\n          y: 0\n        },\n        livePosition: {\n          x: 0,\n          y: 0\n        },\n        maxScroll: {\n          x: 0,\n          y: 0\n        }\n      };\n\n      this._scrollDown = function (e) {\n        gsap/* gsap.delayedCall */.p8.delayedCall(0.2, function () {\n          _this._scroll.target.parentNode.style.pointerEvents = 'none';\n        }); // set flag\n\n        _this._scroll.dragging = true;\n\n        _this._scroll.target.classList.add('dragging'); // get the point the user clicked on the bar\n\n\n        _this._scroll.clickedPoint.x = e.clientX - _this._scroll.livePosition.x;\n        _this._scroll.clickedPoint.y = e.clientY - _this._scroll.livePosition.y; // track the mouse events\n\n        document.addEventListener('mousemove', _this._scrollDrag);\n        document.addEventListener('mouseup', _this._scrollUp);\n      };\n\n      this._scrollDrag = function (e) {\n        if (_this._global.mode === 'horizontal') {\n          // calculate the amount the user moved from the clicked point on the scrollbar, checking limits\n          _this._scroll.position.x = Math.min(0, Math.max(_this._scroll.maxScroll.x, e.clientX - _this._scroll.clickedPoint.x)); // update global percentage\n\n          _this._global.percent.x = _this._scroll.position.x / _this._scroll.maxScroll.x;\n        } else {\n          // calculate the amount the user moved from the clicked point on the scrollbar, checking limits\n          _this._scroll.position.y = Math.min(0, Math.max(_this._scroll.maxScroll.y, e.clientY - _this._scroll.clickedPoint.y)); // update global percentage\n\n          _this._global.percent.y = _this._scroll.position.y / _this._scroll.maxScroll.y;\n        }\n      };\n\n      this._scrollUp = function () {\n        gsap/* gsap.delayedCall */.p8.delayedCall(0.2, function () {\n          _this._scroll.target.parentNode.style.pointerEvents = 'all';\n        }); // stop tracking the two mouse events\n\n        document.removeEventListener('mousemove', _this._scrollDrag);\n        document.removeEventListener('mouseup', _this._scrollUp); // set flag\n\n        _this._scroll.dragging = false;\n\n        _this._scroll.target.classList.remove('dragging');\n      }; // bind mousedown event\n\n\n      if (this._global.mode === 'horizontal') this._scroll.target.addEventListener('mousedown', this._scrollDown);\n\n      this._scrollMove = function (e) {\n        _this._onScroll(); // Prevent pointerevents on scroll\n\n\n        _this._scroll.target.parentNode.style.pointerEvents = 'none';\n        clearTimeout(_this._scroll.timeout);\n        _this._scroll.timeout = setTimeout(function () {\n          _this._scroll.target.parentNode.style.pointerEvents = 'all';\n        }, 200); // check if scroll is allowed\n\n        if (!_this._scroll.enable) return; // update scroll\n\n        if (_this._global.mode === 'horizontal') {\n          // get scroll values\n          _this._scroll.position.x = Math.min(0, Math.max(_this._scroll.maxScroll.x, _this._scroll.position.x += e.deltaY));\n          _this._scroll.position.x = Math.min(0, Math.max(_this._scroll.maxScroll.x, _this._scroll.position.x += e.deltaX));\n          _this._global.percent.x = _this._scroll.position.x / _this._scroll.maxScroll.x;\n          _this._scroll.lastPosition.x = _this._scroll.position.x;\n        } else {\n          // get scroll values\n          _this._scroll.position.y = Math.min(0, Math.max(_this._scroll.maxScroll.y, _this._scroll.position.y += e.deltaY));\n          _this._global.percent.y = _this._scroll.position.y / _this._scroll.maxScroll.y;\n          _this._scroll.lastPosition.y = _this._scroll.position.y;\n        }\n\n        e.originalEvent.preventDefault();\n      };\n\n      this._scrollRaf = function () {\n        if (_this._global.mode === 'horizontal') _this._scroll.livePosition.x = lerp(_this._scroll.livePosition.x, _this._scroll.maxScroll.x * _this._global.percent.x, 0.1);else _this._scroll.livePosition.y = lerp(_this._scroll.livePosition.y, _this._scroll.maxScroll.y * _this._global.percent.y, 0.1);\n        _this._scroll.target.style.transform = 'translate3d(' + _this._scroll.livePosition.x + 'px,' + _this._scroll.livePosition.y + 'px, 0px)';\n      };\n\n      this._onKeyDown = function (e) {\n        // Return if input is focused\n        var $inputs = document.querySelectorAll('input');\n\n        for (var i = 0; i < $inputs.length; i++) {\n          if (document.activeElement.name === $inputs[i].name) return false;\n        } // init scroll values\n\n\n        var scrollX = 0;\n        var scrollY = 0; // get window height and width\n\n        var windowHeight = window.innerHeight - 40;\n        var windowWidth = window.innerWidth - 40; // check pressed key\n\n        switch (e.keyCode) {\n          case 37:\n            scrollX = -120;\n            break;\n\n          case 38:\n            scrollY = -120;\n            break;\n\n          case 39:\n            scrollX = 120;\n            break;\n\n          case 40:\n            scrollY = 120;\n            break;\n\n          case  true && e.shiftKey:\n            scrollX = -windowWidth;\n            scrollY = -windowHeight;\n            break;\n\n          case 32:\n            scrollX = windowWidth;\n            scrollY = windowHeight;\n            break;\n\n          default:\n            return;\n        } // update scroll\n\n\n        _this.scrollUpdate(scrollX, scrollY);\n      };\n    } // bar properties\n\n\n    if (options.bar) {\n      this._bar = {\n        enable: true,\n        target: options.barTarget,\n        width: 0,\n        height: 0,\n        dragging: false,\n        ratio: {\n          x: 0,\n          y: 0\n        },\n        position: {\n          x: 0,\n          y: 0\n        },\n        livePosition: {\n          x: 0,\n          y: 0\n        },\n        maxScroll: {\n          x: 0,\n          y: 0\n        },\n        clickedPoint: {\n          x: 0,\n          y: 0\n        }\n      };\n\n      this._barDown = function (e) {\n        // set flag\n        _this._bar.dragging = true;\n\n        _this._bar.target.classList.add('dragging'); // get the point the user clicked on the bar\n\n\n        _this._bar.clickedPoint.x = e.clientX - _this._bar.livePosition.x;\n        _this._bar.clickedPoint.y = e.clientY - _this._bar.livePosition.y; // track the mouse events\n\n        document.addEventListener('mousemove', _this._barMove);\n        document.addEventListener('mouseup', _this._barUp);\n      };\n\n      this._barMove = function (e) {\n        if (_this._global.mode === 'horizontal') {\n          // calculate the amount the user moved from the clicked point on the scrollbar, checking limits\n          _this._bar.position.x = Math.min(Math.max(e.clientX - _this._bar.clickedPoint.x, 0), _this._bar.maxScroll.x); // update global percentage\n\n          _this._global.percent.x = _this._bar.position.x / _this._bar.maxScroll.x;\n          _this._scroll.position.x = _this._global.percent.x * _this._scroll.maxScroll.x;\n        } else {\n          // calculate the amount the user moved from the clicked point on the scrollbar, checking limits\n          _this._bar.position.y = Math.min(Math.max(e.clientY - _this._bar.clickedPoint.y, 0), _this._bar.maxScroll.y); // update global percentage\n\n          _this._global.percent.y = _this._bar.position.y / _this._bar.maxScroll.y;\n          _this._scroll.position.y = _this._global.percent.y * _this._scroll.maxScroll.y;\n        }\n      };\n\n      this._barUp = function () {\n        // stop tracking the two mouse events\n        document.removeEventListener('mousemove', _this._barMove);\n        document.removeEventListener('mouseup', _this._barUp); // set flag\n\n        _this._bar.dragging = false;\n\n        _this._bar.target.classList.remove('dragging');\n      };\n\n      this._barRaf = function () {\n        if (_this._global.mode === 'horizontal') _this._bar.livePosition.x = lerp(_this._bar.livePosition.x, _this._bar.maxScroll.x * _this._global.percent.x, 0.1);else _this._bar.livePosition.y = lerp(_this._bar.livePosition.y, _this._bar.maxScroll.y * _this._global.percent.y, 0.1);\n        _this._bar.target.style.transform = 'translate3d(' + _this._bar.livePosition.x + 'px,' + _this._bar.livePosition.y + 'px, 0px)';\n      }; // bind mousedown event\n\n\n      this._bar.target.addEventListener('mousedown', this._barDown);\n    }\n\n    this._raf = function () {\n      if (!_this._scroll.enable) return;\n      if (_this._scroll) _this._scrollRaf();\n      if (_this._bar) _this._barRaf();\n\n      _this._onRaf(_this._scroll.livePosition, _this._global.percent);\n    }; // bind to gsap ticker\n\n\n    gsap/* gsap.ticker.add */.p8.ticker.add(this._raf); // bind\n\n    this.init();\n  }\n\n  superScroller_createClass(_default, [{\n    key: \"init\",\n    value: function init() {\n      var _this2 = this;\n\n      // virtualscroll properties\n      if (this._virtualScroll !== 'undefined') {\n        this._virtualScroll = new (virtualscroll_default())(this._virtualScrollOptions);\n\n        this._virtualScroll.on(function (e) {\n          _this2._scrollMove(e);\n        }); // bind keydown event\n\n\n        document.addEventListener('keydown', this._onKeyDown);\n      }\n    }\n  }, {\n    key: \"scrollUpdate\",\n    value: function scrollUpdate(scrollX, scrollY) {\n      // Update scroll values\n      this._scroll.position.x = Math.min(0, Math.max(this._scroll.position.x -= scrollX, this._scroll.maxScroll.y));\n      this._scroll.position.y = Math.min(0, Math.max(this._scroll.position.y -= scrollY, this._scroll.maxScroll.y));\n      gsap/* gsap.to */.p8.to(this._global.percent, {\n        x: this._scroll.position.x / this._scroll.maxScroll.x,\n        y: this._scroll.position.y / this._scroll.maxScroll.y,\n        ease: 'power4.out',\n        duration: 0.4\n      });\n    }\n  }, {\n    key: \"scrollAnimate\",\n    value: function scrollAnimate(_position) {\n      var _duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 2;\n\n      var _ease = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'power4.inOut';\n\n      var _force = arguments.length > 3 ? arguments[3] : undefined;\n\n      _duration = this.appStore.client.browser === 'firefox' ? _duration / 2 : _duration;\n      if (!_force && !this._scroll.enable) return;\n      this._scroll.position.y = Math.max(-_position, this._scroll.maxScroll.y);\n      gsap/* gsap.to */.p8.to(this._global.percent, {\n        y: this._scroll.position.y / this._scroll.maxScroll.y,\n        ease: _ease,\n        duration: _duration\n      });\n    }\n  }, {\n    key: \"scrollResize\",\n    value: function scrollResize() {\n      //\n      this._scroll.width = this._scroll.target.getBoundingClientRect().width;\n      this._scroll.height = this._scroll.target.getBoundingClientRect().height;\n      this._scroll.maxScroll.x = -(this._scroll.width - window.innerWidth);\n      this._scroll.maxScroll.y = -(this._scroll.height - window.innerHeight);\n    }\n  }, {\n    key: \"barResize\",\n    value: function barResize() {\n      // get container el sizes\n      this._bar.parentWidth = this._bar.target.parentNode.getBoundingClientRect().width;\n      this._bar.parentHeight = this._bar.target.parentNode.getBoundingClientRect().height; // get bar size\n\n      if (this._global.mode === 'horizontal') {\n        this._bar.width = this._bar.parentWidth * this._bar.parentWidth / this._scroll.width;\n        this._bar.height = this._bar.target.getBoundingClientRect().height;\n        this._bar.target.style.width = this._bar.width + 'px';\n      } else {\n        this._bar.width = this._bar.target.getBoundingClientRect().width;\n        this._bar.height = this._bar.parentHeight * this._bar.parentHeight / this._scroll.height;\n        this._bar.target.style.height = this._bar.height + 'px';\n      } // calculate maximum scroll\n\n\n      this._bar.maxScroll.x = this._bar.parentWidth - this._bar.width;\n      this._bar.maxScroll.y = this._bar.parentHeight - this._bar.height;\n      this._bar.ratio.x = this._bar.width / this._bar.parentWidth;\n      this._bar.ratio.y = this._bar.height / this._bar.parentHeight;\n    }\n  }, {\n    key: \"resize\",\n    value: function resize() {\n      if (this._scroll) this.scrollResize();\n      if (this._bar) this.barResize();\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      gsap/* gsap.ticker.remove */.p8.ticker.remove(this._raf);\n    }\n  }]);\n\n  return _default;\n}();\n\n\n;// CONCATENATED MODULE: ./app/src/js/utils/strings.js\n/*!\n * strings: 3.2.6\n * https://greensock.com\n *\n * Copyright 2008-2020, GreenSock. All rights reserved.\n * Subject to the terms at https://greensock.com/standard-license or for\n * Club GreenSock members, the agreement issued with that membership.\n * @author: Jack Doyle, jack@greensock.com\n*/\n\n/* eslint-disable */\nvar _trimExp = /(^\\s+|\\s+$)/g;\nvar emojiExp = /([\\uD800-\\uDBFF][\\uDC00-\\uDFFF](?:[\\u200D\\uFE0F][\\uD800-\\uDBFF][\\uDC00-\\uDFFF]){2,}|\\uD83D\\uDC69(?:\\u200D(?:(?:\\uD83D\\uDC69\\u200D)?\\uD83D\\uDC67|(?:\\uD83D\\uDC69\\u200D)?\\uD83D\\uDC66)|\\uD83C[\\uDFFB-\\uDFFF])|\\uD83D\\uDC69\\u200D(?:\\uD83D\\uDC69\\u200D)?\\uD83D\\uDC66\\u200D\\uD83D\\uDC66|\\uD83D\\uDC69\\u200D(?:\\uD83D\\uDC69\\u200D)?\\uD83D\\uDC67\\u200D(?:\\uD83D[\\uDC66\\uDC67])|\\uD83C\\uDFF3\\uFE0F\\u200D\\uD83C\\uDF08|(?:\\uD83C[\\uDFC3\\uDFC4\\uDFCA]|\\uD83D[\\uDC6E\\uDC71\\uDC73\\uDC77\\uDC81\\uDC82\\uDC86\\uDC87\\uDE45-\\uDE47\\uDE4B\\uDE4D\\uDE4E\\uDEA3\\uDEB4-\\uDEB6]|\\uD83E[\\uDD26\\uDD37-\\uDD39\\uDD3D\\uDD3E\\uDDD6-\\uDDDD])(?:\\uD83C[\\uDFFB-\\uDFFF])\\u200D[\\u2640\\u2642]\\uFE0F|\\uD83D\\uDC69(?:\\uD83C[\\uDFFB-\\uDFFF])\\u200D(?:\\uD83C[\\uDF3E\\uDF73\\uDF93\\uDFA4\\uDFA8\\uDFEB\\uDFED]|\\uD83D[\\uDCBB\\uDCBC\\uDD27\\uDD2C\\uDE80\\uDE92])|(?:\\uD83C[\\uDFC3\\uDFC4\\uDFCA]|\\uD83D[\\uDC6E\\uDC6F\\uDC71\\uDC73\\uDC77\\uDC81\\uDC82\\uDC86\\uDC87\\uDE45-\\uDE47\\uDE4B\\uDE4D\\uDE4E\\uDEA3\\uDEB4-\\uDEB6]|\\uD83E[\\uDD26\\uDD37-\\uDD39\\uDD3C-\\uDD3E\\uDDD6-\\uDDDF])\\u200D[\\u2640\\u2642]\\uFE0F|\\uD83C\\uDDFD\\uD83C\\uDDF0|\\uD83C\\uDDF6\\uD83C\\uDDE6|\\uD83C\\uDDF4\\uD83C\\uDDF2|\\uD83C\\uDDE9(?:\\uD83C[\\uDDEA\\uDDEC\\uDDEF\\uDDF0\\uDDF2\\uDDF4\\uDDFF])|\\uD83C\\uDDF7(?:\\uD83C[\\uDDEA\\uDDF4\\uDDF8\\uDDFA\\uDDFC])|\\uD83C\\uDDE8(?:\\uD83C[\\uDDE6\\uDDE8\\uDDE9\\uDDEB-\\uDDEE\\uDDF0-\\uDDF5\\uDDF7\\uDDFA-\\uDDFF])|(?:\\u26F9|\\uD83C[\\uDFCB\\uDFCC]|\\uD83D\\uDD75)(?:\\uFE0F\\u200D[\\u2640\\u2642]|(?:\\uD83C[\\uDFFB-\\uDFFF])\\u200D[\\u2640\\u2642])\\uFE0F|(?:\\uD83D\\uDC41\\uFE0F\\u200D\\uD83D\\uDDE8|\\uD83D\\uDC69(?:\\uD83C[\\uDFFB-\\uDFFF])\\u200D[\\u2695\\u2696\\u2708]|\\uD83D\\uDC69\\u200D[\\u2695\\u2696\\u2708]|\\uD83D\\uDC68(?:(?:\\uD83C[\\uDFFB-\\uDFFF])\\u200D[\\u2695\\u2696\\u2708]|\\u200D[\\u2695\\u2696\\u2708]))\\uFE0F|\\uD83C\\uDDF2(?:\\uD83C[\\uDDE6\\uDDE8-\\uDDED\\uDDF0-\\uDDFF])|\\uD83D\\uDC69\\u200D(?:\\uD83C[\\uDF3E\\uDF73\\uDF93\\uDFA4\\uDFA8\\uDFEB\\uDFED]|\\uD83D[\\uDCBB\\uDCBC\\uDD27\\uDD2C\\uDE80\\uDE92]|\\u2764\\uFE0F\\u200D(?:\\uD83D\\uDC8B\\u200D(?:\\uD83D[\\uDC68\\uDC69])|\\uD83D[\\uDC68\\uDC69]))|\\uD83C\\uDDF1(?:\\uD83C[\\uDDE6-\\uDDE8\\uDDEE\\uDDF0\\uDDF7-\\uDDFB\\uDDFE])|\\uD83C\\uDDEF(?:\\uD83C[\\uDDEA\\uDDF2\\uDDF4\\uDDF5])|\\uD83C\\uDDED(?:\\uD83C[\\uDDF0\\uDDF2\\uDDF3\\uDDF7\\uDDF9\\uDDFA])|\\uD83C\\uDDEB(?:\\uD83C[\\uDDEE-\\uDDF0\\uDDF2\\uDDF4\\uDDF7])|[#\\*0-9]\\uFE0F\\u20E3|\\uD83C\\uDDE7(?:\\uD83C[\\uDDE6\\uDDE7\\uDDE9-\\uDDEF\\uDDF1-\\uDDF4\\uDDF6-\\uDDF9\\uDDFB\\uDDFC\\uDDFE\\uDDFF])|\\uD83C\\uDDE6(?:\\uD83C[\\uDDE8-\\uDDEC\\uDDEE\\uDDF1\\uDDF2\\uDDF4\\uDDF6-\\uDDFA\\uDDFC\\uDDFD\\uDDFF])|\\uD83C\\uDDFF(?:\\uD83C[\\uDDE6\\uDDF2\\uDDFC])|\\uD83C\\uDDF5(?:\\uD83C[\\uDDE6\\uDDEA-\\uDDED\\uDDF0-\\uDDF3\\uDDF7-\\uDDF9\\uDDFC\\uDDFE])|\\uD83C\\uDDFB(?:\\uD83C[\\uDDE6\\uDDE8\\uDDEA\\uDDEC\\uDDEE\\uDDF3\\uDDFA])|\\uD83C\\uDDF3(?:\\uD83C[\\uDDE6\\uDDE8\\uDDEA-\\uDDEC\\uDDEE\\uDDF1\\uDDF4\\uDDF5\\uDDF7\\uDDFA\\uDDFF])|\\uD83C\\uDFF4\\uDB40\\uDC67\\uDB40\\uDC62(?:\\uDB40\\uDC77\\uDB40\\uDC6C\\uDB40\\uDC73|\\uDB40\\uDC73\\uDB40\\uDC63\\uDB40\\uDC74|\\uDB40\\uDC65\\uDB40\\uDC6E\\uDB40\\uDC67)\\uDB40\\uDC7F|\\uD83D\\uDC68(?:\\u200D(?:\\u2764\\uFE0F\\u200D(?:\\uD83D\\uDC8B\\u200D)?\\uD83D\\uDC68|(?:(?:\\uD83D[\\uDC68\\uDC69])\\u200D)?\\uD83D\\uDC66\\u200D\\uD83D\\uDC66|(?:(?:\\uD83D[\\uDC68\\uDC69])\\u200D)?\\uD83D\\uDC67\\u200D(?:\\uD83D[\\uDC66\\uDC67])|\\uD83C[\\uDF3E\\uDF73\\uDF93\\uDFA4\\uDFA8\\uDFEB\\uDFED]|\\uD83D[\\uDCBB\\uDCBC\\uDD27\\uDD2C\\uDE80\\uDE92])|(?:\\uD83C[\\uDFFB-\\uDFFF])\\u200D(?:\\uD83C[\\uDF3E\\uDF73\\uDF93\\uDFA4\\uDFA8\\uDFEB\\uDFED]|\\uD83D[\\uDCBB\\uDCBC\\uDD27\\uDD2C\\uDE80\\uDE92]))|\\uD83C\\uDDF8(?:\\uD83C[\\uDDE6-\\uDDEA\\uDDEC-\\uDDF4\\uDDF7-\\uDDF9\\uDDFB\\uDDFD-\\uDDFF])|\\uD83C\\uDDF0(?:\\uD83C[\\uDDEA\\uDDEC-\\uDDEE\\uDDF2\\uDDF3\\uDDF5\\uDDF7\\uDDFC\\uDDFE\\uDDFF])|\\uD83C\\uDDFE(?:\\uD83C[\\uDDEA\\uDDF9])|\\uD83C\\uDDEE(?:\\uD83C[\\uDDE8-\\uDDEA\\uDDF1-\\uDDF4\\uDDF6-\\uDDF9])|\\uD83C\\uDDF9(?:\\uD83C[\\uDDE6\\uDDE8\\uDDE9\\uDDEB-\\uDDED\\uDDEF-\\uDDF4\\uDDF7\\uDDF9\\uDDFB\\uDDFC\\uDDFF])|\\uD83C\\uDDEC(?:\\uD83C[\\uDDE6\\uDDE7\\uDDE9-\\uDDEE\\uDDF1-\\uDDF3\\uDDF5-\\uDDFA\\uDDFC\\uDDFE])|\\uD83C\\uDDFA(?:\\uD83C[\\uDDE6\\uDDEC\\uDDF2\\uDDF3\\uDDF8\\uDDFE\\uDDFF])|\\uD83C\\uDDEA(?:\\uD83C[\\uDDE6\\uDDE8\\uDDEA\\uDDEC\\uDDED\\uDDF7-\\uDDFA])|\\uD83C\\uDDFC(?:\\uD83C[\\uDDEB\\uDDF8])|(?:\\u26F9|\\uD83C[\\uDFCB\\uDFCC]|\\uD83D\\uDD75)(?:\\uD83C[\\uDFFB-\\uDFFF])|(?:\\uD83C[\\uDFC3\\uDFC4\\uDFCA]|\\uD83D[\\uDC6E\\uDC71\\uDC73\\uDC77\\uDC81\\uDC82\\uDC86\\uDC87\\uDE45-\\uDE47\\uDE4B\\uDE4D\\uDE4E\\uDEA3\\uDEB4-\\uDEB6]|\\uD83E[\\uDD26\\uDD37-\\uDD39\\uDD3D\\uDD3E\\uDDD6-\\uDDDD])(?:\\uD83C[\\uDFFB-\\uDFFF])|(?:[\\u261D\\u270A-\\u270D]|\\uD83C[\\uDF85\\uDFC2\\uDFC7]|\\uD83D[\\uDC42\\uDC43\\uDC46-\\uDC50\\uDC66\\uDC67\\uDC70\\uDC72\\uDC74-\\uDC76\\uDC78\\uDC7C\\uDC83\\uDC85\\uDCAA\\uDD74\\uDD7A\\uDD90\\uDD95\\uDD96\\uDE4C\\uDE4F\\uDEC0\\uDECC]|\\uD83E[\\uDD18-\\uDD1C\\uDD1E\\uDD1F\\uDD30-\\uDD36\\uDDD1-\\uDDD5])(?:\\uD83C[\\uDFFB-\\uDFFF])|\\uD83D\\uDC68(?:\\u200D(?:(?:(?:\\uD83D[\\uDC68\\uDC69])\\u200D)?\\uD83D\\uDC67|(?:(?:\\uD83D[\\uDC68\\uDC69])\\u200D)?\\uD83D\\uDC66)|\\uD83C[\\uDFFB-\\uDFFF])|(?:[\\u261D\\u26F9\\u270A-\\u270D]|\\uD83C[\\uDF85\\uDFC2-\\uDFC4\\uDFC7\\uDFCA-\\uDFCC]|\\uD83D[\\uDC42\\uDC43\\uDC46-\\uDC50\\uDC66-\\uDC69\\uDC6E\\uDC70-\\uDC78\\uDC7C\\uDC81-\\uDC83\\uDC85-\\uDC87\\uDCAA\\uDD74\\uDD75\\uDD7A\\uDD90\\uDD95\\uDD96\\uDE45-\\uDE47\\uDE4B-\\uDE4F\\uDEA3\\uDEB4-\\uDEB6\\uDEC0\\uDECC]|\\uD83E[\\uDD18-\\uDD1C\\uDD1E\\uDD1F\\uDD26\\uDD30-\\uDD39\\uDD3D\\uDD3E\\uDDD1-\\uDDDD])(?:\\uD83C[\\uDFFB-\\uDFFF])?|(?:[\\u231A\\u231B\\u23E9-\\u23EC\\u23F0\\u23F3\\u25FD\\u25FE\\u2614\\u2615\\u2648-\\u2653\\u267F\\u2693\\u26A1\\u26AA\\u26AB\\u26BD\\u26BE\\u26C4\\u26C5\\u26CE\\u26D4\\u26EA\\u26F2\\u26F3\\u26F5\\u26FA\\u26FD\\u2705\\u270A\\u270B\\u2728\\u274C\\u274E\\u2753-\\u2755\\u2757\\u2795-\\u2797\\u27B0\\u27BF\\u2B1B\\u2B1C\\u2B50\\u2B55]|\\uD83C[\\uDC04\\uDCCF\\uDD8E\\uDD91-\\uDD9A\\uDDE6-\\uDDFF\\uDE01\\uDE1A\\uDE2F\\uDE32-\\uDE36\\uDE38-\\uDE3A\\uDE50\\uDE51\\uDF00-\\uDF20\\uDF2D-\\uDF35\\uDF37-\\uDF7C\\uDF7E-\\uDF93\\uDFA0-\\uDFCA\\uDFCF-\\uDFD3\\uDFE0-\\uDFF0\\uDFF4\\uDFF8-\\uDFFF]|\\uD83D[\\uDC00-\\uDC3E\\uDC40\\uDC42-\\uDCFC\\uDCFF-\\uDD3D\\uDD4B-\\uDD4E\\uDD50-\\uDD67\\uDD7A\\uDD95\\uDD96\\uDDA4\\uDDFB-\\uDE4F\\uDE80-\\uDEC5\\uDECC\\uDED0-\\uDED2\\uDEEB\\uDEEC\\uDEF4-\\uDEF8]|\\uD83E[\\uDD10-\\uDD3A\\uDD3C-\\uDD3E\\uDD40-\\uDD45\\uDD47-\\uDD4C\\uDD50-\\uDD6B\\uDD80-\\uDD97\\uDDC0\\uDDD0-\\uDDE6])|(?:[#\\*0-9\\xA9\\xAE\\u203C\\u2049\\u2122\\u2139\\u2194-\\u2199\\u21A9\\u21AA\\u231A\\u231B\\u2328\\u23CF\\u23E9-\\u23F3\\u23F8-\\u23FA\\u24C2\\u25AA\\u25AB\\u25B6\\u25C0\\u25FB-\\u25FE\\u2600-\\u2604\\u260E\\u2611\\u2614\\u2615\\u2618\\u261D\\u2620\\u2622\\u2623\\u2626\\u262A\\u262E\\u262F\\u2638-\\u263A\\u2640\\u2642\\u2648-\\u2653\\u2660\\u2663\\u2665\\u2666\\u2668\\u267B\\u267F\\u2692-\\u2697\\u2699\\u269B\\u269C\\u26A0\\u26A1\\u26AA\\u26AB\\u26B0\\u26B1\\u26BD\\u26BE\\u26C4\\u26C5\\u26C8\\u26CE\\u26CF\\u26D1\\u26D3\\u26D4\\u26E9\\u26EA\\u26F0-\\u26F5\\u26F7-\\u26FA\\u26FD\\u2702\\u2705\\u2708-\\u270D\\u270F\\u2712\\u2714\\u2716\\u271D\\u2721\\u2728\\u2733\\u2734\\u2744\\u2747\\u274C\\u274E\\u2753-\\u2755\\u2757\\u2763\\u2764\\u2795-\\u2797\\u27A1\\u27B0\\u27BF\\u2934\\u2935\\u2B05-\\u2B07\\u2B1B\\u2B1C\\u2B50\\u2B55\\u3030\\u303D\\u3297\\u3299]|\\uD83C[\\uDC04\\uDCCF\\uDD70\\uDD71\\uDD7E\\uDD7F\\uDD8E\\uDD91-\\uDD9A\\uDDE6-\\uDDFF\\uDE01\\uDE02\\uDE1A\\uDE2F\\uDE32-\\uDE3A\\uDE50\\uDE51\\uDF00-\\uDF21\\uDF24-\\uDF93\\uDF96\\uDF97\\uDF99-\\uDF9B\\uDF9E-\\uDFF0\\uDFF3-\\uDFF5\\uDFF7-\\uDFFF]|\\uD83D[\\uDC00-\\uDCFD\\uDCFF-\\uDD3D\\uDD49-\\uDD4E\\uDD50-\\uDD67\\uDD6F\\uDD70\\uDD73-\\uDD7A\\uDD87\\uDD8A-\\uDD8D\\uDD90\\uDD95\\uDD96\\uDDA4\\uDDA5\\uDDA8\\uDDB1\\uDDB2\\uDDBC\\uDDC2-\\uDDC4\\uDDD1-\\uDDD3\\uDDDC-\\uDDDE\\uDDE1\\uDDE3\\uDDE8\\uDDEF\\uDDF3\\uDDFA-\\uDE4F\\uDE80-\\uDEC5\\uDECB-\\uDED2\\uDEE0-\\uDEE5\\uDEE9\\uDEEB\\uDEEC\\uDEF0\\uDEF3-\\uDEF8]|\\uD83E[\\uDD10-\\uDD3A\\uDD3C-\\uDD3E\\uDD40-\\uDD45\\uDD47-\\uDD4C\\uDD50-\\uDD6B\\uDD80-\\uDD97\\uDDC0\\uDDD0-\\uDDE6])\\uFE0F)/;\nfunction getText(e) {\n  var type = e.nodeType,\n      result = \"\";\n\n  if (type === 1 || type === 9 || type === 11) {\n    if (typeof e.textContent === \"string\") {\n      return e.textContent;\n    } else {\n      for (e = e.firstChild; e; e = e.nextSibling) {\n        result += getText(e);\n      }\n    }\n  } else if (type === 3 || type === 4) {\n    return e.nodeValue;\n  }\n\n  return result;\n}\nfunction splitInnerHTML(element, delimiter, trim) {\n  var node = element.firstChild,\n      result = [];\n\n  while (node) {\n    if (node.nodeType === 3) {\n      result.push.apply(result, emojiSafeSplit((node.nodeValue + \"\").replace(/^\\n+/g, \"\").replace(/\\s+/g, \" \"), delimiter, trim));\n    } else if ((node.nodeName + \"\").toLowerCase() === \"br\") {\n      result[result.length - 1] += \"<br>\";\n    } else {\n      result.push(node.outerHTML);\n    }\n\n    node = node.nextSibling;\n  }\n\n  return result;\n}\n/*\n//smaller kb version that only handles the simpler emoji's, which is often perfectly adequate.\n\nlet _emoji = \"[\\uE000-\\uF8FF]|\\uD83C[\\uDC00-\\uDFFF]|\\uD83D[\\uDC00-\\uDFFF]|[\\u2694-\\u2697]|\\uD83E[\\uDD10-\\uDD5D]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]\",\n\t_emojiExp = new RegExp(_emoji),\n\t_emojiAndCharsExp = new RegExp(_emoji + \"|.\", \"g\"),\n\t_emojiSafeSplit = (text, delimiter, trim) => {\n\t\tif (trim) {\n\t\t\ttext = text.replace(_trimExp, \"\");\n\t\t}\n\t\treturn ((delimiter === \"\" || !delimiter) && _emojiExp.test(text)) ? text.match(_emojiAndCharsExp) : text.split(delimiter || \"\");\n\t};\n */\n\nfunction emojiSafeSplit(text, delimiter, trim) {\n  text += \"\"; // make sure it's cast as a string. Someone may pass in a number.\n\n  if (trim) {\n    text = text.replace(_trimExp, \"\");\n  }\n\n  if (delimiter && delimiter !== \"\") {\n    return text.replace(/>/g, \"&gt;\").replace(/</g, \"&lt;\").split(delimiter);\n  }\n\n  var result = [],\n      l = text.length,\n      i = 0,\n      j,\n      character;\n\n  for (; i < l; i++) {\n    character = text.charAt(i);\n\n    if (character.charCodeAt(0) >= 0xD800 && character.charCodeAt(0) <= 0xDBFF || text.charCodeAt(i + 1) >= 0xFE00 && text.charCodeAt(i + 1) <= 0xFE0F) {\n      //special emoji characters use 2 or 4 unicode characters that we must keep together.\n      j = ((text.substr(i, 12).split(emojiExp) || [])[1] || \"\").length || 2;\n      character = text.substr(i, j);\n      result.emoji = 1;\n      i += j - 1;\n    }\n\n    result.push(character === \">\" ? \"&gt;\" : character === \"<\" ? \"&lt;\" : character);\n  }\n\n  return result;\n}\n;// CONCATENATED MODULE: ./app/src/js/classes/splitText.js\nfunction splitText_typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { splitText_typeof = function _typeof(obj) { return typeof obj; }; } else { splitText_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return splitText_typeof(obj); }\n\n/*!\n * SplitText: 3.2.6\n * https://greensock.com\n *\n * @license Copyright 2008-2020, GreenSock. All rights reserved.\n * Subject to the terms at https://greensock.com/standard-license or for\n * Club GreenSock members, the agreement issued with that membership.\n * @author: Jack Doyle, jack@greensock.com\n*/\n\n/* eslint-disable */\n\n\nvar _doc,\n    _win,\n    _coreInitted,\n    _stripExp = /(?:\\r|\\n|\\t\\t)/g,\n    //find carriage returns, new line feeds and double-tabs.\n_multipleSpacesExp = /(?:\\s\\s+)/g,\n    _initCore = function _initCore() {\n  _doc = document;\n  _win = window;\n  _coreInitted = 1;\n},\n    _bonusValidated = 1,\n    //<name>SplitText</name>\n_getComputedStyle = function _getComputedStyle(element) {\n  return _win.getComputedStyle(element);\n},\n    _isArray = Array.isArray,\n    _slice = [].slice,\n    _toArray = function _toArray(value, leaveStrings) {\n  //takes any value and returns an array. If it's a string (and leaveStrings isn't true), it'll use document.querySelectorAll() and convert that to an array. It'll also accept iterables like jQuery objects.\n  var type;\n  return _isArray(value) ? value : (type = splitText_typeof(value)) === \"string\" && !leaveStrings && value ? _slice.call(_doc.querySelectorAll(value), 0) : value && type === \"object\" && \"length\" in value ? _slice.call(value, 0) : value ? [value] : [];\n},\n    _isAbsolute = function _isAbsolute(vars) {\n  return vars.position === \"absolute\" || vars.absolute === true;\n},\n    //some characters are combining marks (think diacritics/accents in European languages) which involve 2 or 4 characters that combine in the browser to form a single character. Pass in the remaining text and an array of the special characters to search for and if the text starts with one of those special characters, it'll spit back the number of characters to retain (often 2 or 4). Used in the specialChars features that was introduced in 0.6.0.\n_findSpecialChars = function _findSpecialChars(text, chars) {\n  var i = chars.length,\n      s;\n\n  while (--i > -1) {\n    s = chars[i];\n\n    if (text.substr(0, s.length) === s) {\n      return s.length;\n    }\n  }\n},\n    _divStart = \" style='position:relative;display:inline-block;'\",\n    _cssClassFunc = function _cssClassFunc(cssClass, tag) {\n  if (cssClass === void 0) {\n    cssClass = \"\";\n  }\n\n  var iterate = ~cssClass.indexOf(\"++\"),\n      num = 1;\n\n  if (iterate) {\n    cssClass = cssClass.split(\"++\").join(\"\");\n  }\n\n  return function () {\n    return \"<\" + tag + _divStart + (cssClass ? \" class='\" + cssClass + (iterate ? num++ : \"\") + \"'>\" : \">\");\n  };\n},\n    _swapText = function _swapText(element, oldText, newText) {\n  var type = element.nodeType;\n\n  if (type === 1 || type === 9 || type === 11) {\n    for (element = element.firstChild; element; element = element.nextSibling) {\n      _swapText(element, oldText, newText);\n    }\n  } else if (type === 3 || type === 4) {\n    element.nodeValue = element.nodeValue.split(oldText).join(newText);\n  }\n},\n    _pushReversed = function _pushReversed(a, merge) {\n  var i = merge.length;\n\n  while (--i > -1) {\n    a.push(merge[i]);\n  }\n},\n    _isBeforeWordDelimiter = function _isBeforeWordDelimiter(e, root, wordDelimiter) {\n  var next;\n\n  while (e && e !== root) {\n    next = e._next || e.nextSibling;\n\n    if (next) {\n      return next.textContent.charAt(0) === wordDelimiter;\n    }\n\n    e = e.parentNode || e._parent;\n  }\n},\n    _deWordify = function _deWordify(e) {\n  var children = _toArray(e.childNodes),\n      l = children.length,\n      i,\n      child;\n\n  for (i = 0; i < l; i++) {\n    child = children[i];\n\n    if (child._isSplit) {\n      _deWordify(child);\n    } else {\n      if (i && child.previousSibling.nodeType === 3) {\n        child.previousSibling.nodeValue += child.nodeType === 3 ? child.nodeValue : child.firstChild.nodeValue;\n      } else if (child.nodeType !== 3) {\n        e.insertBefore(child.firstChild, child);\n      }\n\n      e.removeChild(child);\n    }\n  }\n},\n    _getStyleAsNumber = function _getStyleAsNumber(name, computedStyle) {\n  return parseFloat(computedStyle[name]) || 0;\n},\n    _setPositionsAfterSplit = function _setPositionsAfterSplit(element, vars, allChars, allWords, allLines, origWidth, origHeight) {\n  var cs = _getComputedStyle(element),\n      paddingLeft = _getStyleAsNumber(\"paddingLeft\", cs),\n      lineOffsetY = -999,\n      borderTopAndBottom = _getStyleAsNumber(\"borderBottomWidth\", cs) + _getStyleAsNumber(\"borderTopWidth\", cs),\n      borderLeftAndRight = _getStyleAsNumber(\"borderLeftWidth\", cs) + _getStyleAsNumber(\"borderRightWidth\", cs),\n      padTopAndBottom = _getStyleAsNumber(\"paddingTop\", cs) + _getStyleAsNumber(\"paddingBottom\", cs),\n      padLeftAndRight = _getStyleAsNumber(\"paddingLeft\", cs) + _getStyleAsNumber(\"paddingRight\", cs),\n      lineThreshold = _getStyleAsNumber(\"fontSize\", cs) * 0.2,\n      textAlign = cs.textAlign,\n      charArray = [],\n      wordArray = [],\n      lineArray = [],\n      wordDelimiter = vars.wordDelimiter || \" \",\n      tag = vars.tag ? vars.tag : vars.span ? \"span\" : \"div\",\n      types = vars.type || vars.split || \"chars,words,lines\",\n      lines = allLines && ~types.indexOf(\"lines\") ? [] : null,\n      words = ~types.indexOf(\"words\"),\n      chars = ~types.indexOf(\"chars\"),\n      absolute = _isAbsolute(vars),\n      linesClass = vars.linesClass,\n      iterateLine = ~(linesClass || \"\").indexOf(\"++\"),\n      spaceNodesToRemove = [],\n      i,\n      j,\n      l,\n      node,\n      nodes,\n      isChild,\n      curLine,\n      addWordSpaces,\n      style,\n      lineNode,\n      lineWidth,\n      offset;\n\n  if (iterateLine) {\n    linesClass = linesClass.split(\"++\").join(\"\");\n  } //copy all the descendant nodes into an array (we can't use a regular nodeList because it's live and we may need to renest things)\n\n\n  j = element.getElementsByTagName(\"*\");\n  l = j.length;\n  nodes = [];\n\n  for (i = 0; i < l; i++) {\n    nodes[i] = j[i];\n  } //for absolute positioning, we need to record the x/y offsets and width/height for every <div>. And even if we're not positioning things absolutely, in order to accommodate lines, we must figure out where the y offset changes so that we can sense where the lines break, and we populate the lines array.\n\n\n  if (lines || absolute) {\n    for (i = 0; i < l; i++) {\n      node = nodes[i];\n      isChild = node.parentNode === element;\n\n      if (isChild || absolute || chars && !words) {\n        offset = node.offsetTop;\n\n        if (lines && isChild && Math.abs(offset - lineOffsetY) > lineThreshold && (node.nodeName !== \"BR\" || i === 0)) {\n          //we found some rare occasions where a certain character like &#8209; could cause the offsetTop to be off by 1 pixel, so we build in a threshold.\n          curLine = [];\n          lines.push(curLine);\n          lineOffsetY = offset;\n        }\n\n        if (absolute) {\n          //record offset x and y, as well as width and height so that we can access them later for positioning. Grabbing them at once ensures we don't trigger a browser paint & we maximize performance.\n          node._x = node.offsetLeft;\n          node._y = offset;\n          node._w = node.offsetWidth;\n          node._h = node.offsetHeight;\n        }\n\n        if (lines) {\n          if (node._isSplit && isChild || !chars && isChild || words && isChild || !words && node.parentNode.parentNode === element && !node.parentNode._isSplit) {\n            curLine.push(node);\n            node._x -= paddingLeft;\n\n            if (_isBeforeWordDelimiter(node, element, wordDelimiter)) {\n              node._wordEnd = true;\n            }\n          }\n\n          if (node.nodeName === \"BR\" && (node.nextSibling && node.nextSibling.nodeName === \"BR\" || i === 0)) {\n            //two consecutive <br> tags signify a new [empty] line. Also, if the entire block of content STARTS with a <br>, add a line.\n            lines.push([]);\n          }\n        }\n      }\n    }\n  }\n\n  for (i = 0; i < l; i++) {\n    node = nodes[i];\n    isChild = node.parentNode === element;\n\n    if (node.nodeName === \"BR\") {\n      if (lines || absolute) {\n        if (node.parentNode) {\n          node.parentNode.removeChild(node);\n        }\n\n        nodes.splice(i--, 1);\n        l--;\n      } else if (!words) {\n        element.appendChild(node);\n      }\n\n      continue;\n    }\n\n    if (absolute) {\n      style = node.style;\n\n      if (!words && !isChild) {\n        node._x += node.parentNode._x;\n        node._y += node.parentNode._y;\n      }\n\n      style.left = node._x + \"px\";\n      style.top = node._y + \"px\";\n      style.position = \"absolute\";\n      style.display = \"block\"; //if we don't set the width/height, things collapse in older versions of IE and the origin for transforms is thrown off in all browsers.\n\n      style.width = node._w + 1 + \"px\"; //IE is 1px short sometimes. Avoid wrapping\n\n      style.height = node._h + \"px\";\n    }\n\n    if (!words && chars) {\n      //we always start out wrapping words in their own <div> so that line breaks happen correctly, but here we'll remove those <div> tags if necessary and renest the characters directly into the element rather than inside the word <div>\n      if (node._isSplit) {\n        node._next = node.nextSibling;\n        node.parentNode.appendChild(node); //put it at the end to keep the order correct.\n      } else if (node.parentNode._isSplit) {\n        node._parent = node.parentNode;\n\n        if (!node.previousSibling && node.firstChild) {\n          node.firstChild._isFirst = true;\n        }\n\n        if (node.nextSibling && node.nextSibling.textContent === \" \" && !node.nextSibling.nextSibling) {\n          //if the last node inside a nested element is just a space (like T<span>nested </span>), remove it otherwise it'll get placed in the wrong order. Don't remove it right away, though, because we need to sense when words/characters are before a space like _isBeforeWordDelimiter(). Removing it now would make that a false negative.\n          spaceNodesToRemove.push(node.nextSibling);\n        }\n\n        node._next = node.nextSibling && node.nextSibling._isFirst ? null : node.nextSibling;\n        node.parentNode.removeChild(node);\n        nodes.splice(i--, 1);\n        l--;\n      } else if (!isChild) {\n        offset = !node.nextSibling && _isBeforeWordDelimiter(node.parentNode, element, wordDelimiter); //if this is the last letter in the word (and we're not breaking by lines and not positioning things absolutely), we need to add a space afterwards so that the characters don't just mash together\n\n        if (node.parentNode._parent) {\n          node.parentNode._parent.appendChild(node);\n        }\n\n        if (offset) {\n          node.parentNode.appendChild(_doc.createTextNode(\" \"));\n        }\n\n        if (tag === \"span\") {\n          node.style.display = \"inline\"; //so that word breaks are honored properly.\n        }\n\n        charArray.push(node);\n      }\n    } else if (node.parentNode._isSplit && !node._isSplit && node.innerHTML !== \"\") {\n      wordArray.push(node);\n    } else if (chars && !node._isSplit) {\n      if (tag === \"span\") {\n        node.style.display = \"inline\";\n      }\n\n      charArray.push(node);\n    }\n  }\n\n  i = spaceNodesToRemove.length;\n\n  while (--i > -1) {\n    spaceNodesToRemove[i].parentNode.removeChild(spaceNodesToRemove[i]);\n  }\n\n  if (lines) {\n    //the next 7 lines just give us the line width in the most reliable way and figure out the left offset (if position isn't relative or absolute). We must set the width along with text-align to ensure everything works properly for various alignments.\n    if (absolute) {\n      lineNode = _doc.createElement(tag);\n      element.appendChild(lineNode);\n      lineWidth = lineNode.offsetWidth + \"px\";\n      offset = lineNode.offsetParent === element ? 0 : element.offsetLeft;\n      element.removeChild(lineNode);\n    }\n\n    style = element.style.cssText;\n    element.style.cssText = \"display:none;\"; //to improve performance, set display:none on the element so that the browser doesn't have to worry about reflowing or rendering while we're renesting things. We'll revert the cssText later.\n    //we can't use element.innerHTML = \"\" because that causes IE to literally delete all the nodes and their content even though we've stored them in an array! So we must loop through the children and remove them.\n\n    while (element.firstChild) {\n      element.removeChild(element.firstChild);\n    }\n\n    addWordSpaces = wordDelimiter === \" \" && (!absolute || !words && !chars);\n\n    for (i = 0; i < lines.length; i++) {\n      curLine = lines[i];\n      lineNode = _doc.createElement(tag);\n      lineNode.style.cssText = \"display:block;text-align:\" + textAlign + \";position:\" + (absolute ? \"absolute;\" : \"relative;\");\n\n      if (linesClass) {\n        lineNode.className = linesClass + (iterateLine ? i + 1 : \"\");\n      }\n\n      lineArray.push(lineNode);\n      l = curLine.length;\n\n      for (j = 0; j < l; j++) {\n        if (curLine[j].nodeName !== \"BR\") {\n          node = curLine[j];\n          lineNode.appendChild(node);\n\n          if (addWordSpaces && node._wordEnd) {\n            lineNode.appendChild(_doc.createTextNode(\" \"));\n          }\n\n          if (absolute) {\n            if (j === 0) {\n              lineNode.style.top = node._y + \"px\";\n              lineNode.style.left = paddingLeft + offset + \"px\";\n            }\n\n            node.style.top = \"0px\";\n\n            if (offset) {\n              node.style.left = node._x - offset + \"px\";\n            }\n          }\n        }\n      }\n\n      if (l === 0) {\n        //if there are no nodes in the line (typically meaning there were two consecutive <br> tags, just add a non-breaking space so that things display properly.\n        lineNode.innerHTML = \"&nbsp;\";\n      } else if (!words && !chars) {\n        _deWordify(lineNode);\n\n        _swapText(lineNode, String.fromCharCode(160), \" \");\n      }\n\n      if (absolute) {\n        lineNode.style.width = lineWidth;\n        lineNode.style.height = node._h + \"px\";\n      }\n\n      element.appendChild(lineNode);\n    }\n\n    element.style.cssText = style;\n  } //if everything shifts to being position:absolute, the container can collapse in terms of height or width, so fix that here.\n\n\n  if (absolute) {\n    if (origHeight > element.clientHeight) {\n      element.style.height = origHeight - padTopAndBottom + \"px\";\n\n      if (element.clientHeight < origHeight) {\n        //IE8 and earlier use a different box model - we must include padding and borders\n        element.style.height = origHeight + borderTopAndBottom + \"px\";\n      }\n    }\n\n    if (origWidth > element.clientWidth) {\n      element.style.width = origWidth - padLeftAndRight + \"px\";\n\n      if (element.clientWidth < origWidth) {\n        //IE8 and earlier use a different box model - we must include padding and borders\n        element.style.width = origWidth + borderLeftAndRight + \"px\";\n      }\n    }\n  }\n\n  _pushReversed(allChars, charArray);\n\n  if (words) {\n    _pushReversed(allWords, wordArray);\n  }\n\n  _pushReversed(allLines, lineArray);\n},\n    _splitRawText = function _splitRawText(element, vars, wordStart, charStart) {\n  var tag = vars.tag ? vars.tag : vars.span ? \"span\" : \"div\",\n      types = vars.type || vars.split || \"chars,words,lines\",\n      //words = (types.indexOf(\"words\") !== -1),\n  chars = ~types.indexOf(\"chars\"),\n      absolute = _isAbsolute(vars),\n      wordDelimiter = vars.wordDelimiter || \" \",\n      space = wordDelimiter !== \" \" ? \"\" : absolute ? \"&#173; \" : \" \",\n      wordEnd = \"</\" + tag + \">\",\n      wordIsOpen = 1,\n      specialChars = vars.specialChars ? typeof vars.specialChars === \"function\" ? vars.specialChars : _findSpecialChars : null,\n      //specialChars can be an array or a function. For performance reasons, we always set this local \"specialChars\" to a function to which we pass the remaining text and whatever the original vars.specialChars was so that if it's an array, it works with the _findSpecialChars() function.\n  text,\n      splitText,\n      i,\n      j,\n      l,\n      character,\n      hasTagStart,\n      testResult,\n      container = _doc.createElement(\"div\"),\n      parent = element.parentNode;\n\n  parent.insertBefore(container, element);\n  container.textContent = element.nodeValue;\n  parent.removeChild(element);\n  element = container;\n  text = getText(element);\n  hasTagStart = text.indexOf(\"<\") !== -1;\n\n  if (vars.reduceWhiteSpace !== false) {\n    text = text.replace(_multipleSpacesExp, \" \").replace(_stripExp, \"\");\n  }\n\n  if (hasTagStart) {\n    text = text.split(\"<\").join(\"{{LT}}\"); //we can't leave \"<\" in the string, or when we set the innerHTML, it can be interpreted as a node\n  }\n\n  l = text.length;\n  splitText = (text.charAt(0) === \" \" ? space : \"\") + wordStart();\n\n  for (i = 0; i < l; i++) {\n    character = text.charAt(i);\n\n    if (specialChars && (testResult = specialChars(text.substr(i), vars.specialChars))) {\n      // look for any specialChars that were declared. Remember, they can be passed in like {specialChars:[\"मी\", \"पा\", \"है\"]} or a function could be defined instead. Either way, the function should return the number of characters that should be grouped together for this \"character\".\n      character = text.substr(i, testResult || 1);\n      splitText += chars && character !== \" \" ? charStart() + character + \"</\" + tag + \">\" : character;\n      i += testResult - 1;\n    } else if (character === wordDelimiter && text.charAt(i - 1) !== wordDelimiter && i) {\n      splitText += wordIsOpen ? wordEnd : \"\";\n      wordIsOpen = 0;\n\n      while (text.charAt(i + 1) === wordDelimiter) {\n        //skip over empty spaces (to avoid making them words)\n        splitText += space;\n        i++;\n      }\n\n      if (i === l - 1) {\n        splitText += space;\n      } else if (text.charAt(i + 1) !== \")\") {\n        splitText += space + wordStart();\n        wordIsOpen = 1;\n      }\n    } else if (character === \"{\" && text.substr(i, 6) === \"{{LT}}\") {\n      splitText += chars ? charStart() + \"{{LT}}\" + \"</\" + tag + \">\" : \"{{LT}}\";\n      i += 5;\n    } else if (character.charCodeAt(0) >= 0xD800 && character.charCodeAt(0) <= 0xDBFF || text.charCodeAt(i + 1) >= 0xFE00 && text.charCodeAt(i + 1) <= 0xFE0F) {\n      //special emoji characters use 2 or 4 unicode characters that we must keep together.\n      j = ((text.substr(i, 12).split(emojiExp) || [])[1] || \"\").length || 2;\n      splitText += chars && character !== \" \" ? charStart() + text.substr(i, j) + \"</\" + tag + \">\" : text.substr(i, j);\n      i += j - 1;\n    } else {\n      splitText += chars && character !== \" \" ? charStart() + character + \"</\" + tag + \">\" : character;\n    }\n  }\n\n  element.outerHTML = splitText + (wordIsOpen ? wordEnd : \"\");\n\n  if (hasTagStart) {\n    _swapText(parent, \"{{LT}}\", \"<\"); //note: don't perform this on \"element\" because that gets replaced with all new elements when we set element.outerHTML.\n\n  }\n},\n    _split = function _split(element, vars, wordStart, charStart) {\n  var children = _toArray(element.childNodes),\n      l = children.length,\n      absolute = _isAbsolute(vars),\n      i,\n      child;\n\n  if (element.nodeType !== 3 || l > 1) {\n    vars.absolute = false;\n\n    for (i = 0; i < l; i++) {\n      child = children[i];\n\n      if (child.nodeType !== 3 || /\\S+/.test(child.nodeValue)) {\n        if (absolute && child.nodeType !== 3 && _getComputedStyle(child).display === \"inline\") {\n          //if there's a child node that's display:inline, switch it to inline-block so that absolute positioning works properly (most browsers don't report offsetTop/offsetLeft properly inside a <span> for example)\n          child.style.display = \"inline-block\";\n          child.style.position = \"relative\";\n        }\n\n        child._isSplit = true;\n\n        _split(child, vars, wordStart, charStart); //don't split lines on child elements\n\n      }\n    }\n\n    vars.absolute = absolute;\n    element._isSplit = true;\n    return;\n  }\n\n  _splitRawText(element, vars, wordStart, charStart);\n};\n\nvar SplitText = /*#__PURE__*/function () {\n  function SplitText(element, vars) {\n    if (!_coreInitted) {\n      _initCore();\n    }\n\n    this.elements = _toArray(element);\n    this.chars = [];\n    this.words = [];\n    this.lines = [];\n    this._originals = [];\n    this.vars = vars || {};\n\n    if (_bonusValidated) {\n      this.split(vars);\n    }\n  }\n\n  var _proto = SplitText.prototype;\n\n  _proto.split = function split(vars) {\n    if (this.isSplit) {\n      this.revert();\n    }\n\n    this.vars = vars = vars || this.vars;\n    this._originals.length = this.chars.length = this.words.length = this.lines.length = 0;\n\n    var i = this.elements.length,\n        tag = vars.tag ? vars.tag : vars.span ? \"span\" : \"div\",\n        wordStart = _cssClassFunc(vars.wordsClass, tag),\n        charStart = _cssClassFunc(vars.charsClass, tag),\n        origHeight,\n        origWidth,\n        e; //we split in reversed order so that if/when we position:absolute elements, they don't affect the position of the ones after them in the document flow (shifting them up as they're taken out of the document flow).\n\n\n    while (--i > -1) {\n      e = this.elements[i];\n      this._originals[i] = e.innerHTML;\n      origHeight = e.clientHeight;\n      origWidth = e.clientWidth;\n\n      _split(e, vars, wordStart, charStart);\n\n      _setPositionsAfterSplit(e, vars, this.chars, this.words, this.lines, origWidth, origHeight);\n    }\n\n    this.chars.reverse();\n    this.words.reverse();\n    this.lines.reverse();\n    this.isSplit = true;\n    return this;\n  };\n\n  _proto.revert = function revert() {\n    var originals = this._originals;\n\n    if (!originals) {\n      throw \"revert() call wasn't scoped properly.\";\n    }\n\n    this.elements.forEach(function (e, i) {\n      return e.innerHTML = originals[i];\n    });\n    this.chars = [];\n    this.words = [];\n    this.lines = [];\n    this.isSplit = false;\n    return this;\n  };\n\n  SplitText.create = function create(element, vars) {\n    return new SplitText(element, vars);\n  };\n\n  return SplitText;\n}();\nSplitText.version = \"3.2.6\";\n\n;// CONCATENATED MODULE: ./app/src/js/renderers/renderer.js\nfunction renderer_typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { renderer_typeof = function _typeof(obj) { return typeof obj; }; } else { renderer_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return renderer_typeof(obj); }\n\nfunction renderer_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction renderer_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction renderer_createClass(Constructor, protoProps, staticProps) { if (protoProps) renderer_defineProperties(Constructor.prototype, protoProps); if (staticProps) renderer_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (renderer_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\n// app\n\n\n // classes\n\n // Highway\n\n // Preload\n\n\n // Utilities\n\n\n // import SuperObserver from '../classes/superObserver';\n// Gsap\n\n\n\ngsap/* default.registerPlugin */.ZP.registerPlugin(ScrollTrigger/* default */.Z);\n\nvar Renderer = /*#__PURE__*/function (_Highway$Renderer) {\n  _inherits(Renderer, _Highway$Renderer);\n\n  var _super = _createSuper(Renderer);\n\n  function Renderer(properties) {\n    var _this;\n\n    renderer_classCallCheck(this, Renderer);\n\n    _this = _super.call(this, properties); // store\n\n    _this.appStore = appStore; // app references\n\n    _this.appCore = new app_appCore();\n    _this.appUi = new app_appUi(); // Events\n\n    _this.domEvents = new domEvents_default(); // Save slug\n    // if(this.appStore.from === 'home')\n    //     this.appUi.navigation.isLocked = true;\n\n    _this.hash = window.location.hash !== '' ? window.location.hash : null;\n    _this.params = new URLSearchParams(window.location.search);\n    _this.appStore.firstNavigation = _this.appStore.currentSection === null;\n    _this.appStore.current = _this.properties.slug;\n    _this.appStore.currentSub = _this.appStore.current === 'project' ? location.pathname.split('/')[location.pathname.split('/').length - 2] : null;\n    _this.appStore.currentSection = _assertThisInitialized(_this); // if(this.appStore.firstNavigation)\n    //     this.appStore.firstNavigation();\n    // Preloader\n\n    _this.preloadMain = null;\n    _this.preloadSecondary = null;\n    _this.preloadDelay = _this.appStore.isDesktop ? 3 : 1.2; //this.preloadDelay = 0;\n\n    _this.preloadItems = {\n      main: [],\n      // Mandatory items\n      secondary: [] // Secondary items\n\n    }; // Scroll\n\n    _this.superScroller = null;\n    _this.superTrigger = null;\n    if (history.scrollRestoration) history.scrollRestoration = 'manual';\n    return _this;\n  }\n\n  renderer_createClass(Renderer, [{\n    key: \"onEnter\",\n    value: function onEnter() {\n      this.checkElements();\n      this.preselectors();\n      this.selectors();\n      this.events();\n      this.preload();\n      this.splitTexts = [];\n\n      if (!this.params.has('trp-edit-translation')) {\n        // Set animations\n        this.setLabels();\n        this.setTitles();\n        this.setDescriptions();\n        this.setImages();\n        this.setLinks();\n        this.setMinilines();\n      }\n\n      this.beforeEnter();\n    }\n  }, {\n    key: \"checkElements\",\n    value: function checkElements() {\n      if (this.appStore.isDesktop) {\n        this.$elementsMobile = document.querySelectorAll('[data-mobile]');\n\n        for (var i = 0; i < this.$elementsMobile.length; i++) {\n          this.$elementsMobile[i].remove();\n        }\n      } else {\n        this.$elementsDesktop = document.querySelectorAll('[data-desktop]');\n\n        for (var _i = 0; _i < this.$elementsDesktop.length; _i++) {\n          this.$elementsDesktop[_i].remove();\n        }\n      }\n    }\n  }, {\n    key: \"preselectors\",\n    value: function preselectors() {\n      // Set reference to current section\n      this.$el = this.wrap.lastElementChild;\n      this.$inner = this.$el.querySelector('[data-scroll-wrapper] .inner');\n      this.$scrollbar = this.$el.querySelector('[data-scroll-wrapper] .scrollbar');\n      this.$overlay = this.$el.querySelector('.overlay');\n    }\n  }, {\n    key: \"selectors\",\n    value: function selectors() {} // eslint-disable-line\n\n  }, {\n    key: \"events\",\n    value: function events() {} // eslint-disable-line\n\n  }, {\n    key: \"preload\",\n    value: function preload() {} // eslint-disable-line\n\n  }, {\n    key: \"beforeEnter\",\n    value: function beforeEnter() {} // eslint-disable-line\n\n  }, {\n    key: \"onEnterCompleted\",\n    value: function onEnterCompleted() {\n      var _this2 = this;\n\n      // Lazy load\n      this.lazyLoad = new (lazyload_default())(this.lazyLoad, {\n        root: null,\n        rootMargin: window.innerHeight * 0.25 + 'px',\n        threshold: 0\n      }); // this.lazyLoad.loadImages();\n      // If first navigation and need preload\n\n      if (this.preloadItems.main.length > 0 && this.appStore.firstNavigation) {\n        var _index = 0;\n\n        var _preloadOn = new Date().getTime();\n\n        this.preloadMain = preload_it_default()();\n        this.preloadMain.fetch(this.preloadItems.main); // this.preloadMain.onprogress = (event) => { this.appUi.$loaderProgress.innerHTML = event.progress + '%'; };\n\n        this.preloadMain.onprogress = function (event) {\n          var _amount = event.progress / 100;\n\n          console.log(_amount);\n          gsap/* default.to */.ZP.to(_this2.appUi.$loaderProgress.children[0], {\n            scaleX: Math.min(_amount, 0.95),\n            ease: 'expo.inOut',\n            duration: _this2.preloadDelay / (_this2.preloadItems.main.length + 1),\n            delay: _this2.preloadDelay / (_this2.preloadItems.main.length + 1) * _index\n          });\n          _index++;\n        };\n\n        this.preloadMain.oncomplete = function (items) {\n          var _preloadOff = new Date().getTime();\n\n          var _preloadDifference = (_preloadOff - _preloadOn) / 1000;\n\n          var _preloadDelay = Math.max(0, _this2.preloadDelay - _preloadDifference);\n\n          gsap/* default.delayedCall */.ZP.delayedCall(_preloadDelay, function () {\n            gsap/* default.to */.ZP.to(_this2.appUi.$loaderProgress.children[0], {\n              scaleX: 1,\n              ease: 'expo.out',\n              duration: 0.2,\n              onComplete: function onComplete() {\n                _this2.start();\n              }\n            });\n          });\n        };\n      } // if first navigation but dont need preloads\n      else if (this.preloadItems.main.length === 0 && this.appStore.firstNavigation) {\n        // Fake progress\n        var splitProgress = this.appUi.splitInParts(1, 5);\n\n        for (var i = 0; i < splitProgress.length; i++) {\n          var _duration = i === 0 ? this.preloadDelay * splitProgress[0] : this.preloadDelay * splitProgress[i] - this.preloadDelay * splitProgress[i - 1];\n\n          var _delay = i === 0 ? 0 : this.preloadDelay * splitProgress[i - 1];\n\n          gsap/* default.to */.ZP.to(this.appUi.$loaderProgress.children[0], {\n            scaleX: splitProgress[i],\n            ease: 'expo.inOut',\n            duration: _duration,\n            delay: _delay\n          });\n        }\n\n        gsap/* default.delayedCall */.ZP.delayedCall(this.preloadDelay, function () {\n          _this2.start();\n        });\n      } else {\n        this.start();\n      }\n    }\n  }, {\n    key: \"start\",\n    value: function start() {\n      var _this3 = this;\n\n      if (this.appStore.firstNavigation) {\n        // Remove loader\n        this.appUi.hideLoader();\n      }\n\n      this.scroll();\n\n      if (this.appStore.isDesktop) {\n        if (this.appStore.firstNavigation) gsap/* default.fromTo */.ZP.fromTo(this.appStore.currentSection.$el, {\n          y: '-5vw'\n        }, {\n          y: '0vw',\n          duration: 1.8,\n          ease: 'expo.inOut'\n        });else gsap/* default.fromTo */.ZP.fromTo(this.appStore.currentSection.$el, {\n          y: '-5vw'\n        }, {\n          y: '0vw',\n          duration: 1,\n          ease: 'expo.out'\n        });\n      } else {\n        if (this.appStore.firstNavigation) gsap/* default.to */.ZP.to(this.appStore.currentSection.$el, {\n          opacity: 1,\n          duration: 1,\n          ease: 'expo.out',\n          delay: 1.8\n        });\n      }\n\n      if (this.appStore.firstNavigation) this.appCore.navigateStart();\n\n      if (!this.params.has('trp-edit-translation')) {\n        // Init animations\n        this.initLabels();\n        this.initTitles();\n        this.initDescriptions();\n        this.initImages();\n        this.initLinks();\n        this.initMinilines();\n      }\n\n      this.initInfo();\n      this.preenter();\n      gsap/* default.delayedCall */.ZP.delayedCall(this.appStore.firstNavigation ? 1.8 : 1, function () {\n        _this3.enter();\n\n        if (_this3.superScroller) _this3.superScroller._scroll.enable = true;\n        if (_this3.hash) _this3.scrollTo(_this3.hash);\n\n        _this3.beforeResize(window.innerWidth, window.innerHeight);\n      });\n\n      if (this.preloadItems.secondary.length > 0) {\n        this.preloadSecondary = preload_it_default()();\n        this.preloadSecondary.fetch(this.preloadItems.secondary);\n      }\n    }\n  }, {\n    key: \"scroll\",\n    value: function scroll() {\n      var _this4 = this;\n\n      if (this.$inner) {\n        if (this.appStore.isDesktop) {\n          // Superscroller\n          this.superScroller = new _default({\n            enable: false,\n            scroll: true,\n            scrollTarget: this.$inner,\n            bar: true,\n            barTarget: this.$scrollbar.children[0],\n            onRaf: function onRaf(scroll, percent) {\n              _this4.requestAnimationFrame();\n\n              if (_this4.appStore.current === 'home') {\n                if (_this4.appUi.$headerSubmenu) gsap/* default.to */.ZP.to(_this4.appUi.$headerSubmenu, {\n                  y: scroll.y * 2,\n                  ease: 'expo.out'\n                });\n              } else {\n                if (_this4.appUi.$logo) gsap/* default.to */.ZP.to(_this4.appUi.$logo, {\n                  y: scroll.y * 2,\n                  ease: 'expo.out'\n                });\n              }\n\n              if (_this4.appUi.$headerTrigger && _this4.appStore.current === 'home') {\n                if (scroll.y <= -window.innerHeight) gsap/* default.to */.ZP.to(_this4.appUi.$headerTrigger, {\n                  opacity: 1,\n                  ease: 'expo.out'\n                });else gsap/* default.to */.ZP.to(_this4.appUi.$headerTrigger, {\n                  opacity: 0.0001,\n                  pointerEvents: 'initial',\n                  ease: 'expo.out'\n                });\n              }\n\n              if (_this4.superTrigger) _this4.superTrigger.update();\n            }\n          }); // Scroll Trigger\n\n          this.superTrigger = ScrollTrigger/* default */.Z;\n          this.superTrigger.defaults({\n            scroller: this.$inner\n          });\n          this.superTrigger.scrollerProxy(this.$inner, {\n            scrollTop: function scrollTop(value) {\n              return -_this4.superScroller._scroll.livePosition.y;\n            },\n            getBoundingClientRect: function getBoundingClientRect() {\n              return {\n                top: 0,\n                left: 0,\n                width: window.innerWidth,\n                height: window.innerHeight\n              };\n            }\n          });\n          this.superTrigger.refresh();\n        } else {\n          this.superTrigger = ScrollTrigger/* default */.Z;\n          this.superTrigger.config({\n            autoRefreshEvents: 'DOMContentLoaded,load',\n            syncInterval: 999999999\n          });\n          this.superTrigger.refresh();\n          gsap/* default.ticker.add */.ZP.ticker.add(function () {\n            _this4.requestAnimationFrame();\n          });\n          this.superTriggerTl = gsap/* default.timeline */.ZP.timeline({\n            defaults: {\n              ease: 'none'\n            },\n            scrollTrigger: {\n              trigger: this.$app,\n              scrub: true,\n              start: 'top top',\n              end: 'bottom bottom',\n              onUpdate: function onUpdate(self) {\n                _this4.superScrollerMobile = self.progress * self.end; // if(this.appUi.$header)\n                //     gsap.to(this.appUi.$header, { y: -(self.progress * this.$inner.getBoundingClientRect().height) });\n                // if(this.appUi.$logo)\n                //     gsap.to(this.appUi.$logo, { y: -(self.progress * this.$inner.getBoundingClientRect().height) / 2 });\n                // if(this.appUi.$headerTriggerText && !this.appStore.isDesktop)\n                //     gsap.to(this.appUi.$headerTriggerText, { y: -(self.progress * this.$inner.getBoundingClientRect().height) / 2 });\n              }\n            }\n          });\n        }\n      }\n    }\n  }, {\n    key: \"preenter\",\n    value: function preenter() {}\n  }, {\n    key: \"scrollTo\",\n    value: function scrollTo(hash) {\n      var $target = this.$el.querySelector(hash);\n\n      if ($target) {\n        if (this.appStore.isDesktop) {\n          var offset = $target.getBoundingClientRect().y + this.superScroller._scroll.livePosition.y;\n\n          this.superScroller.scrollAnimate(offset, 2, 'power4.inOut');\n        } else {\n          var _offset = $target.getBoundingClientRect().y + document.documentElement.scrollTop;\n\n          gsap/* default.to */.ZP.to(document.documentElement, {\n            scrollTop: _offset,\n            duration: 2,\n            ease: 'power4.inOut'\n          });\n        }\n      }\n    }\n  }, {\n    key: \"requestAnimationFrame\",\n    value: function requestAnimationFrame() {\n      if (this.superTrigger) this.superTrigger.update();\n    }\n  }, {\n    key: \"setLabels\",\n    value: function setLabels() {\n      if (this.appStore.isDesktop) this.$labels = this.$el.querySelectorAll('.label:not(.promotion .label)');else this.$labels = this.$el.querySelectorAll('.label');\n\n      if (this.$labels) {\n        for (var i = 0; i < this.$labels.length; i++) {\n          var split = new SplitText(this.$labels[i], {\n            type: 'lines, words',\n            linesClass: 'line line--++',\n            wordsClass: 'word word--++',\n            charsClass: 'char char--++'\n          }); // eslint-disable-line\n\n          this.splitTexts.push(split);\n          this.$labels[i].classList.add('split');\n          var lines = this.$labels[i].querySelectorAll('.line');\n\n          for (var j = 0; j < lines.length; j++) {\n            var words = lines[j].querySelectorAll(':scope > .word,:scope > strong');\n\n            for (var k = 0; k < words.length; k++) {\n              gsap/* default.set */.ZP.set(words[k], {\n                y: '100%'\n              });\n            }\n          }\n        }\n      }\n    }\n  }, {\n    key: \"setTitles\",\n    value: function setTitles() {\n      this.$titles = this.$el.querySelectorAll('.title:not(.post .title)');\n\n      if (this.$titles) {\n        for (var i = 0; i < this.$titles.length; i++) {\n          var split = new SplitText(this.$titles[i], {\n            type: 'lines, words',\n            linesClass: 'line line--++',\n            wordsClass: 'word word--++',\n            charsClass: 'char char--++'\n          }); // eslint-disable-line\n\n          this.splitTexts.push(split);\n          this.$titles[i].classList.add('split');\n          var lines = this.$titles[i].querySelectorAll('.line');\n\n          for (var j = 0; j < lines.length; j++) {\n            var words = lines[j].querySelectorAll(':scope > .word,:scope > strong');\n\n            for (var k = 0; k < words.length; k++) {\n              // if(words[k].tagName === 'DIV')\n              //     //gsap.set(words[k], { opacity: 0.0001 });\n              // else\n              if (words[k].tagName === 'STRONG') words[k].insertAdjacentHTML('beforeend', '<span class=\"mask\"></span>');\n            }\n          }\n        }\n      }\n\n      this.$titlesInfo = this.$el.querySelectorAll('.info .title');\n\n      if (this.$titlesInfo) {\n        for (var _i2 = 0; _i2 < this.$titlesInfo.length; _i2++) {\n          var _split = new SplitText(this.$titlesInfo[_i2], {\n            type: 'lines, words',\n            linesClass: 'line line--++',\n            wordsClass: 'word word--++',\n            charsClass: 'char char--++'\n          }); // eslint-disable-line\n\n\n          this.splitTexts.push(_split);\n\n          this.$titlesInfo[_i2].classList.add('split');\n\n          var _lines = this.$titlesInfo[_i2].querySelectorAll('.line');\n\n          for (var _j = 0; _j < _lines.length; _j++) {\n            var _words = _lines[_j].querySelectorAll(':scope > .word,:scope > strong');\n\n            for (var _k = 0; _k < _words.length; _k++) {\n              gsap/* default.set */.ZP.set(_words[_k], {\n                y: '100%'\n              });\n            }\n          }\n        }\n      }\n    }\n  }, {\n    key: \"setDescriptions\",\n    value: function setDescriptions() {\n      this.$descriptions = this.$el.querySelectorAll('.wysiwyg:not(.principles .principles__item .info .wysiwyg, .features .features__item .info .wysiwyg)');\n\n      if (this.$descriptions) {\n        for (var i = 0; i < this.$descriptions.length; i++) {\n          gsap/* default.set */.ZP.set(this.$descriptions[i], {\n            y: this.appStore.isDesktop ? '5vw' : '20px',\n            scaleY: 1.1,\n            opacity: 0.0001,\n            willChange: 'transition, opacity'\n          });\n        }\n      }\n    }\n  }, {\n    key: \"setImages\",\n    value: function setImages() {\n      this.$imagesMask = this.$el.querySelectorAll('.image--mask');\n\n      for (var i = 0; i < this.$imagesMask.length; i++) {\n        gsap/* default.set */.ZP.set(this.$imagesMask[i], {\n          y: '-102%'\n        });\n        gsap/* default.set */.ZP.set(this.$imagesMask[i].children[0], {\n          y: '102%'\n        });\n      }\n\n      this.$imagesAppear = this.$el.querySelectorAll('.image--appear');\n\n      for (var _i3 = 0; _i3 < this.$imagesAppear.length; _i3++) {\n        gsap/* default.set */.ZP.set(this.$imagesAppear[_i3], {\n          y: '5vw'\n        });\n        gsap/* default.set */.ZP.set(this.$imagesAppear[_i3].children[0], {\n          scale: 1.2,\n          opacity: 0.0001\n        });\n      }\n    }\n  }, {\n    key: \"setLinks\",\n    value: function setLinks() {\n      var _this5 = this;\n\n      this.$links = this.$el.querySelectorAll('.link:not(.post .link)');\n\n      if (this.$links) {\n        for (var i = 0; i < this.$links.length; i++) {\n          gsap/* default.set */.ZP.set(this.$links[i], {\n            y: this.appStore.isDesktop ? '10vw' : '40px',\n            opacity: 0.0001\n          });\n          gsap/* default.set */.ZP.set(this.$links[i].children[0], {\n            opacity: 0.0001\n          });\n          gsap/* default.set */.ZP.set(this.$links[i].querySelector('svg'), {\n            opacity: 0.0001,\n            rotation: '450deg'\n          });\n          gsap/* default.set */.ZP.set(this.$links[i].querySelector('svg circle'), {\n            strokeDashoffset: '1181.24px'\n          });\n          this.domEvents.add(this.$links[i], 'mouseenter', function (e, a, el) {\n            _this5.enterLink(e, a, el);\n          });\n          this.domEvents.add(this.$links[i], 'mouseleave', function (e, a, el) {\n            _this5.leaveLink(e, a, el);\n          });\n        }\n      }\n    }\n  }, {\n    key: \"setMinilines\",\n    value: function setMinilines() {\n      this.$minilines = this.$el.querySelectorAll('.miniline');\n\n      if (this.$minilines) {\n        for (var i = 0; i < this.$minilines.length; i++) {\n          gsap/* default.set */.ZP.set(this.$minilines[i], {\n            scaleX: 0\n          });\n        }\n      }\n    }\n  }, {\n    key: \"enterLink\",\n    value: function enterLink(e, a, el) {\n      // gsap.to(el.children[1], { x: '-1rem', ease: 'expo.out', duration: 0.8 });\n      gsap/* default.killTweensOf */.ZP.killTweensOf([el.querySelector('svg'), el.querySelector('svg circle')]);\n      gsap/* default.to */.ZP.to(el.querySelector('svg'), {\n        rotation: '450deg',\n        ease: 'expo.out',\n        duration: 0.8\n      });\n      gsap/* default.to */.ZP.to(el.querySelector('svg circle'), {\n        strokeDashoffset: '1181.24px',\n        ease: 'expo.out',\n        duration: 0.8\n      });\n    }\n  }, {\n    key: \"leaveLink\",\n    value: function leaveLink(e, a, el) {\n      // gsap.to(el.children[1], { x: '0', ease: 'expo.out', duration: 0.8 });\n      gsap/* default.killTweensOf */.ZP.killTweensOf([el.querySelector('svg'), el.querySelector('svg circle')]);\n      gsap/* default.to */.ZP.to(el.querySelector('svg'), {\n        rotation: '0deg',\n        ease: 'expo.out',\n        duration: 0.8\n      });\n      gsap/* default.to */.ZP.to(el.querySelector('svg circle'), {\n        strokeDashoffset: '0px',\n        ease: 'expo.out',\n        duration: 0.8\n      });\n    }\n  }, {\n    key: \"initLabels\",\n    value: function initLabels() {\n      var _this6 = this;\n\n      if (this.$labels) {\n        var _loop = function _loop(i) {\n          ScrollTrigger/* default.create */.Z.create({\n            trigger: _this6.$labels[i],\n            // start: 'top 80%',\n            onEnter: function onEnter() {\n              var lines = _this6.$labels[i].querySelectorAll('.line');\n\n              for (var j = 0; j < lines.length; j++) {\n                var words = lines[j].querySelectorAll(':scope > .word, :scope > strong');\n\n                for (var k = 0; k < words.length; k++) {\n                  gsap/* default.to */.ZP.to(words[k], {\n                    y: 0,\n                    ease: 'expo.out',\n                    duration: 1.4,\n                    delay: 0.1 + k * 0.05\n                  });\n                }\n              }\n            }\n          });\n        };\n\n        for (var i = 0; i < this.$labels.length; i++) {\n          _loop(i);\n        }\n      }\n    }\n  }, {\n    key: \"initTitles\",\n    value: function initTitles() {\n      var _this7 = this;\n\n      if (this.$titles) {\n        var _loop2 = function _loop2(i) {\n          ScrollTrigger/* default.create */.Z.create({\n            trigger: _this7.$titles[i],\n            // start: 'top 80%',\n            onEnter: function onEnter() {\n              var lines = _this7.$titles[i].querySelectorAll('.line');\n\n              for (var j = 0; j < lines.length; j++) {\n                var words = lines[j].querySelectorAll(':scope > .word, :scope > strong');\n\n                for (var k = 0; k < words.length; k++) {\n                  // if(words[k].tagName === 'DIV')\n                  //     gsap.to(words[k], { opacity: 1, ease: 'power2.out', delay: (j * 0.1) + (k * 0.05) });\n                  // else\n                  if (words[k].tagName === 'STRONG' && words[k].querySelector('.mask')) gsap/* default.to */.ZP.to(words[k].querySelector('.mask'), {\n                    scaleX: 0,\n                    ease: 'expo.inOut',\n                    duration: 1.2,\n                    delay: j * 0.1 + k * 0.05\n                  });\n                }\n              }\n            }\n          });\n        };\n\n        for (var i = 0; i < this.$titles.length; i++) {\n          _loop2(i);\n        }\n      }\n\n      if (this.$titlesInfo) {\n        var _loop3 = function _loop3(_i4) {\n          ScrollTrigger/* default.create */.Z.create({\n            trigger: _this7.$titlesInfo[_i4],\n            // start: 'top 80%',\n            onEnter: function onEnter() {\n              var lines = _this7.$titlesInfo[_i4].querySelectorAll('.line');\n\n              for (var j = 0; j < lines.length; j++) {\n                var words = lines[j].querySelectorAll(':scope > .word, :scope > strong');\n\n                for (var k = 0; k < words.length; k++) {\n                  gsap/* default.to */.ZP.to(words[k], {\n                    y: 0,\n                    ease: 'expo.out',\n                    duration: 1.4,\n                    delay: j * 0.1 + k * 0.05\n                  });\n                }\n              }\n            }\n          });\n        };\n\n        for (var _i4 = 0; _i4 < this.$titlesInfo.length; _i4++) {\n          _loop3(_i4);\n        }\n      }\n    }\n  }, {\n    key: \"initDescriptions\",\n    value: function initDescriptions() {\n      var _this8 = this;\n\n      if (this.$descriptions) {\n        var _loop4 = function _loop4(i) {\n          ScrollTrigger/* default.create */.Z.create({\n            trigger: _this8.$descriptions[i],\n            start: _this8.appStore.isDesktop ? 'top bottom' : 'top 80%',\n            once: true,\n            onEnter: function onEnter() {\n              gsap/* default.to */.ZP.to(_this8.$descriptions[i], {\n                y: '0',\n                scaleY: 1,\n                opacity: 1,\n                duration: 2,\n                ease: 'expo.out',\n                clearProps: 'all'\n              });\n            }\n          });\n        };\n\n        for (var i = 0; i < this.$descriptions.length; i++) {\n          _loop4(i);\n        }\n      }\n    }\n  }, {\n    key: \"initImages\",\n    value: function initImages() {\n      var _this9 = this;\n\n      var _loop5 = function _loop5(i) {\n        ScrollTrigger/* default.create */.Z.create({\n          trigger: _this9.$imagesMask[i],\n          start: 'top 80%',\n          once: true,\n          onEnter: function onEnter() {\n            gsap/* default.to */.ZP.to(_this9.$imagesMask[i], {\n              y: '0%',\n              duration: 1.8,\n              ease: 'expo.inOut',\n              delay: 0\n            });\n            gsap/* default.to */.ZP.to(_this9.$imagesMask[i].children[0], {\n              y: '0%',\n              scale: 1,\n              duration: 1.8,\n              ease: 'expo.inOut',\n              delay: 0\n            });\n          }\n        });\n      };\n\n      for (var i = 0; i < this.$imagesMask.length; i++) {\n        _loop5(i);\n      }\n\n      var _loop6 = function _loop6(_i5) {\n        ScrollTrigger/* default.create */.Z.create({\n          trigger: _this9.$imagesAppear[_i5],\n          start: 'top bottom',\n          once: true,\n          onEnter: function onEnter() {\n            gsap/* default.to */.ZP.to(_this9.$imagesAppear[_i5], {\n              y: '0%',\n              duration: 2,\n              ease: 'expo.out',\n              delay: 0\n            });\n            gsap/* default.to */.ZP.to(_this9.$imagesAppear[_i5].children[0], {\n              scale: 1,\n              opacity: 1,\n              duration: 1.2,\n              ease: 'expo.out',\n              delay: 0\n            });\n          }\n        });\n      };\n\n      for (var _i5 = 0; _i5 < this.$imagesAppear.length; _i5++) {\n        _loop6(_i5);\n      }\n    }\n  }, {\n    key: \"initLinks\",\n    value: function initLinks() {\n      var _this10 = this;\n\n      if (this.$links) {\n        var _loop7 = function _loop7(i) {\n          ScrollTrigger/* default.create */.Z.create({\n            trigger: _this10.$links[i],\n            start: 'top bottom',\n            once: true,\n            onEnter: function onEnter() {\n              gsap/* default.to */.ZP.to(_this10.$links[i], {\n                y: 0,\n                opacity: 1,\n                duration: 2,\n                ease: 'expo.out'\n              });\n              gsap/* default.to */.ZP.to(_this10.$links[i].children[0], {\n                opacity: 1,\n                duration: 2,\n                ease: 'expo.out'\n              });\n              gsap/* default.to */.ZP.to(_this10.$links[i].querySelector('svg'), {\n                opacity: 1,\n                rotation: '0',\n                duration: 2,\n                ease: 'expo.out'\n              });\n              gsap/* default.to */.ZP.to(_this10.$links[i].querySelector('svg circle'), {\n                strokeDashoffset: '0px',\n                duration: 2,\n                ease: 'expo.out'\n              });\n            }\n          });\n        };\n\n        for (var i = 0; i < this.$links.length; i++) {\n          _loop7(i);\n        }\n      }\n    }\n  }, {\n    key: \"initMinilines\",\n    value: function initMinilines() {\n      var _this11 = this;\n\n      if (this.$minilines) {\n        var _loop8 = function _loop8(i) {\n          ScrollTrigger/* default.create */.Z.create({\n            trigger: _this11.$minilines[i],\n            start: 'top 80%',\n            once: true,\n            onEnter: function onEnter() {\n              gsap/* default.to */.ZP.to(_this11.$minilines[i], {\n                scaleX: 1,\n                duration: 1,\n                ease: 'expo.out'\n              });\n            }\n          });\n        };\n\n        for (var i = 0; i < this.$minilines.length; i++) {\n          _loop8(i);\n        }\n      }\n    }\n  }, {\n    key: \"initInfo\",\n    value: function initInfo() {\n      var _this12 = this;\n\n      // Check infotrigger sidebar element\n      this.$infotrigger = this.$el.querySelector('.infotrigger');\n\n      if (this.$infotrigger) {\n        gsap/* default.to */.ZP.to(this.$infotrigger, {\n          opacity: 1,\n          ease: 'power2.out',\n          duration: 0.8,\n          delay: 1\n        });\n        this.domEvents.add(this.$infotrigger, 'click', function (e, a, el) {\n          _this12.appUi.openInfo(e);\n        });\n      } // Check infotrigger button elements\n\n\n      this.$buttontriggers = this.$el.querySelectorAll('.button--infotrigger');\n\n      for (var i = 0; i < this.$buttontriggers.length; i++) {\n        this.domEvents.add(this.$buttontriggers[i], 'click', function (e, a, el) {\n          _this12.appUi.openInfo(e);\n        });\n      }\n\n      this.appUi.info.isOpen = false;\n    }\n  }, {\n    key: \"beforeResize\",\n    value: function beforeResize(width, height) {\n      if (this.superScroller) this.superScroller.resize();\n      this.resize(width, height);\n    }\n  }, {\n    key: \"resize\",\n    value: function resize(width, height) {} // eslint-disable-line\n\n  }, {\n    key: \"resizeOrientation\",\n    value: function resizeOrientation(width, height, orientation) {\n      for (var i = 0; i < this.splitTexts.length; i++) {\n        this.splitTexts[i].revert();\n      } //this.setImages();\n\n    }\n  }, {\n    key: \"enter\",\n    value: function enter() {} // eslint-disable-line\n\n  }, {\n    key: \"onLeave\",\n    value: function onLeave() {\n      this.leave();\n    }\n  }, {\n    key: \"leave\",\n    value: function leave() {\n      if (this.domEvents) this.domEvents.destroy();\n      if (this.superScroller) this.superScroller.destroy();\n      if (this.superDragger) this.superDragger.destroy();\n    }\n  }, {\n    key: \"onLeaveCompleted\",\n    value: function onLeaveCompleted() {\n      this.afterLeave();\n    }\n  }, {\n    key: \"afterLeave\",\n    value: function afterLeave() {} // eslint-disable-line\n\n  }]);\n\n  return Renderer;\n}(highway_module/* default.Renderer */.Z.Renderer); // Don`t forget to export your renderer\n\n\n/* harmony default export */ const renderer = (Renderer);\n;// CONCATENATED MODULE: ./app/src/js/renderers/rendererDefault.js\nfunction rendererDefault_typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { rendererDefault_typeof = function _typeof(obj) { return typeof obj; }; } else { rendererDefault_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return rendererDefault_typeof(obj); }\n\nfunction rendererDefault_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction rendererDefault_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction rendererDefault_createClass(Constructor, protoProps, staticProps) { if (protoProps) rendererDefault_defineProperties(Constructor.prototype, protoProps); if (staticProps) rendererDefault_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction rendererDefault_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) rendererDefault_setPrototypeOf(subClass, superClass); }\n\nfunction rendererDefault_setPrototypeOf(o, p) { rendererDefault_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return rendererDefault_setPrototypeOf(o, p); }\n\nfunction rendererDefault_createSuper(Derived) { var hasNativeReflectConstruct = rendererDefault_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = rendererDefault_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = rendererDefault_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return rendererDefault_possibleConstructorReturn(this, result); }; }\n\nfunction rendererDefault_possibleConstructorReturn(self, call) { if (call && (rendererDefault_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return rendererDefault_assertThisInitialized(self); }\n\nfunction rendererDefault_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction rendererDefault_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction rendererDefault_getPrototypeOf(o) { rendererDefault_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return rendererDefault_getPrototypeOf(o); }\n\n// Gsap\n\n\ngsap/* default.registerPlugin */.ZP.registerPlugin(ScrollTrigger/* default */.Z); // Import Renderer\n\n // import stylesDefault from './stylesDefault.css'; //eslint-disable-line\n// Utilities\n\n\n // Other\n// import Slider from '../classes/slider';\n// import SplitText from '../classes/splitText';\n\nvar RendererDefault = /*#__PURE__*/function (_Renderer) {\n  rendererDefault_inherits(RendererDefault, _Renderer);\n\n  var _super = rendererDefault_createSuper(RendererDefault);\n\n  function RendererDefault() {\n    rendererDefault_classCallCheck(this, RendererDefault);\n\n    return _super.apply(this, arguments);\n  }\n\n  rendererDefault_createClass(RendererDefault, [{\n    key: \"selectors\",\n    value: function selectors() {} // eslint-disable-line\n\n  }, {\n    key: \"events\",\n    value: function events() {} // eslint-disable-line\n\n  }, {\n    key: \"beforeEnter\",\n    value: function beforeEnter() {} // eslint-disable-line\n\n  }, {\n    key: \"enter\",\n    value: function enter() {} // eslint-disable-line\n\n  }, {\n    key: \"raf\",\n    value: function raf() {} // eslint-disable-line\n\n  }]);\n\n  return RendererDefault;\n}(renderer); // Don`t forget to export your renderer\n\n\n/* harmony default export */ const rendererDefault = (RendererDefault);\n;// CONCATENATED MODULE: ./app/src/js/classes/superDragger.js\nfunction superDragger_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction superDragger_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction superDragger_createClass(Constructor, protoProps, staticProps) { if (protoProps) superDragger_defineProperties(Constructor.prototype, protoProps); if (staticProps) superDragger_defineProperties(Constructor, staticProps); return Constructor; }\n\n //empty function\n\nvar superDragger_noop = function noop() {}; //eslint-disable-line\n\n\nvar lerp = function lerp(a, b, n) {\n  return (1 - n) * a + n * b;\n};\n\nvar superDragger_default = /*#__PURE__*/function () {\n  function _default(options) {\n    var _this = this;\n\n    superDragger_classCallCheck(this, _default);\n\n    //hook functions\n    this._onRaf = options.onRaf || superDragger_noop;\n    this._onMouseEnter = options.onMouseEnter || superDragger_noop;\n    this._onMouseLeave = options.onMouseLeave || superDragger_noop;\n    this._onDragStart = options.onDragStart || superDragger_noop;\n    this._onDragMove = options.onDragMove || superDragger_noop;\n    this._onDragEnd = options.onDragEnd || superDragger_noop;\n    this._onSnap = options.onSnap || superDragger_noop;\n    this._onSnapLimits = options._onSnapLimits || superDragger_noop;\n    this.rAF = undefined;\n    this._drag = {\n      enable: typeof options.enable !== 'undefined' ? options.enable : true,\n      el: options.el,\n      elClickables: options.elClickables || [],\n      inner: options.inner || options.el.children[0],\n      ease: options.ease || 0.1,\n      speed: options.speed || 2,\n      dragging: false,\n      width: 0,\n      height: 0,\n      velocity: 0,\n      direction: 0,\n      on: {\n        x: 0,\n        y: 0\n      },\n      off: {\n        x: 0,\n        y: 0\n      },\n      offset: {\n        x: 0,\n        y: 0\n      },\n      movement: {\n        x: 0,\n        y: 0\n      },\n      position: {\n        x: 0,\n        y: 0\n      },\n      lastPosition: {\n        x: 0,\n        y: 0\n      },\n      livePosition: {\n        x: 0,\n        y: 0\n      },\n      min: {\n        x: 0,\n        y: 0\n      },\n      max: {\n        x: 0,\n        y: 0\n      },\n      total: 0,\n      snap: typeof options.snap !== 'undefined' ? options.snap : false,\n      snapPositions: [],\n      snapLimits: [],\n      snapAnimating: false,\n      inertia: typeof options.inertia !== 'undefined' ? options.inertia : 0.4,\n      elasticity: typeof options.elasticity !== 'undefined' ? options.elasticity : false,\n      elasticityType: typeof options.elasticityType !== 'undefined' ? options.elasticityType : 1\n    };\n    if (this._drag.snap && this._drag.inertia === 0) throw Error('If snap is true, inertia should be great than 0');\n\n    this.raf = function () {\n      _this._onRaf(_this._drag); //Move inner\n\n\n      _this._drag.livePosition.x = lerp(_this._drag.livePosition.x, _this._drag.position.x, _this._drag.ease);\n      _this.$dragInner.style.transform = \"translate3d(\".concat(_this._drag.livePosition.x, \"px, 0, 0)\");\n\n      if (_this._drag.elasticity) {\n        //Check velocity\n        var movementX = Math.abs(_this._drag.livePosition.x - _this._drag.position.x);\n        var movement = Math.sqrt(movementX * movementX + movementX * movementX);\n        var velocity = movement / 10;\n        _this._drag.velocity = lerp(_this._drag.velocity, velocity, _this._drag.ease * 2); //Do elasticity\n\n        var elasticity = _this._drag.velocity * -_this._drag.direction;\n\n        for (var i = 0; i < _this.$dragItems.length; i++) {\n          if (_this._drag.elasticityType === 1 ? _this._drag.direction < 0 : _this._drag.direction > 0) _this.$dragItems[i].style.transform = \"translate3d(\".concat(i * elasticity, \"px, 0, 0)\");else _this.$dragItems[i].style.transform = \"translate3d(\".concat((_this.$dragItems.length - i) * elasticity, \"px, 0, 0)\");\n        }\n      }\n    };\n\n    this.selectors();\n    this.init();\n  }\n\n  superDragger_createClass(_default, [{\n    key: \"selectors\",\n    value: function selectors() {\n      this.$drag = this._drag.el;\n      this.$dragInner = this._drag.inner;\n      this.$dragItems = this._drag.inner.children;\n      this.$dragClickables = this._drag.elClickables;\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      var _this2 = this;\n\n      this.setBounds(); //add requestAnimationFrame\n\n      gsap/* gsap.ticker.add */.p8.ticker.add(this.raf); //add events\n      //this.$dragInner.addEventListener('click', (e) => { this.click(e); });\n\n      for (var i = 0; i < this.$dragClickables.length; i++) {\n        this.$dragClickables[i].addEventListener('click', function (e) {\n          _this2.click(e);\n        }, true);\n      }\n\n      this.$dragInner.addEventListener('mousedown', function (e) {\n        _this2.on(e);\n      });\n      this.$drag.addEventListener('mouseenter', function (e) {\n        _this2.enter(e);\n      });\n      this.$drag.addEventListener('mouseleave', function (e) {\n        _this2.leave(e);\n      });\n      document.addEventListener('mousemove', function (e) {\n        _this2.move(e);\n      });\n      document.addEventListener('mouseup', function (e) {\n        _this2.off(e);\n      });\n      document.addEventListener('resize', function (e) {\n        _this2.resize(e);\n      });\n    }\n  }, {\n    key: \"setBounds\",\n    value: function setBounds() {\n      var dragBounding = this.$drag.getBoundingClientRect();\n      var dragInnerBounding = this.$dragInner.getBoundingClientRect();\n      this._drag.width = dragBounding.width;\n      this._drag.height = dragBounding.height;\n      this._drag.min.x = dragBounding.width - dragInnerBounding.width;\n      this._drag.max.x = 0;\n      this._drag.offset.x = dragBounding.x; //Check limits for inertia\n\n      this._drag.snapLimits.push(0);\n\n      this._drag.snapLimits.push(dragBounding.width - dragInnerBounding.width);\n\n      if (this._drag.snap) {\n        for (var i = 0; i < this.$dragItems.length; i++) {\n          var bounds = this.$dragItems[i].getBoundingClientRect();\n          var snap = bounds.x - this._drag.offset.x;\n\n          this._drag.snapPositions.push(-snap);\n        }\n      }\n    }\n  }, {\n    key: \"click\",\n    value: function click(e) {\n      if (Math.abs(this._drag.on.x - this._drag.off.x) > 10) {\n        e.stopPropagation();\n        e.preventDefault();\n      }\n    }\n  }, {\n    key: \"enter\",\n    value: function enter() {\n      this._onMouseEnter();\n    }\n  }, {\n    key: \"on\",\n    value: function on(e) {\n      var _this3 = this;\n\n      this._drag.dragging = true;\n      this._drag.on.x = e.clientX;\n      this.onTimeout = setTimeout(function () {\n        _this3._onDragStart();\n\n        _this3.$drag.classList.add('is--dragging');\n      }, 120);\n    }\n  }, {\n    key: \"move\",\n    value: function move(e) {\n      e.preventDefault();\n      if (!this._drag.dragging || !this._drag.enable) return;\n\n      this._onDragMove();\n\n      this._drag.movement = e.clientX - this._drag.on.x;\n      this._drag.direction = Math.sign(e.clientX - this._drag.on.x);\n      this._drag.position.x = this._drag.lastPosition.x + e.clientX - this._drag.on.x;\n      this._drag.position.x = Math.min(this._drag.max.x + this._drag.width / 4 * this._drag.inertia, Math.max(this._drag.position.x, this._drag.min.x - this._drag.width / 4 * this._drag.inertia));\n    }\n  }, {\n    key: \"off\",\n    value: function off(e) {\n      clearTimeout(this.onTimeout);\n      if (!this._drag.dragging) return;\n      this._drag.dragging = false;\n      this._drag.off.x = e.clientX;\n      this._drag.lastPosition.x = this._drag.position.x;\n\n      this._onDragEnd();\n\n      this.$drag.classList.remove('is--dragging');\n\n      if (this._drag.position.x > 0 || this._drag.position.x < this._drag.min.x) {\n        this.snapLimits();\n      } else {\n        if (this._drag.snap) this.snap();\n      }\n    }\n  }, {\n    key: \"leave\",\n    value: function leave() {\n      this._onMouseLeave();\n    }\n  }, {\n    key: \"snap\",\n    value: function snap() {\n      //this._drag.snapAnimating = true;\n      var goal = this._drag.position.x;\n\n      var closest = this._drag.snapPositions.reduce(function (prev, curr) {\n        return Math.abs(curr - goal) < Math.abs(prev - goal) ? curr : prev;\n      });\n\n      this._drag.position.x = closest;\n      this._drag.lastPosition.x = closest;\n\n      this._onSnap();\n    }\n  }, {\n    key: \"snapLimits\",\n    value: function snapLimits() {\n      //this._drag.snapAnimating = true;\n      var goal = this._drag.position.x;\n\n      var closest = this._drag.snapLimits.reduce(function (prev, curr) {\n        return Math.abs(curr - goal) < Math.abs(prev - goal) ? curr : prev;\n      });\n\n      this._drag.position.x = closest;\n      this._drag.lastPosition.x = closest;\n\n      this._onSnapLimits();\n    }\n  }, {\n    key: \"lerp\",\n    value: function lerp(value1, value2, amount) {\n      amount = amount < 0 ? 0 : amount;\n      amount = amount > 1 ? 1 : amount;\n      return value1 + (value2 - value1) * amount;\n    }\n  }, {\n    key: \"resize\",\n    value: function resize() {\n      this.setBounds();\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      //empty options\n      this._drag = {}; //remove requestAnimationFrame\n\n      gsap/* gsap.ticker.remove */.p8.ticker.remove(this.raf); //Remove events\n\n      document.removeEventListener('mousedown', this.on);\n      document.removeEventListener('resize', this.resize);\n    }\n  }]);\n\n  return _default;\n}();\n\n\n// EXTERNAL MODULE: ./node_modules/gsap/Draggable.js + 1 modules\nvar Draggable = __webpack_require__(354);\n;// CONCATENATED MODULE: ./app/src/js/utils/VelocityTracker.js\nfunction VelocityTracker_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction VelocityTracker_createClass(Constructor, protoProps, staticProps) { if (protoProps) VelocityTracker_defineProperties(Constructor.prototype, protoProps); if (staticProps) VelocityTracker_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction VelocityTracker_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*!\n * VelocityTracker: 3.6.1\n * https://greensock.com\n *\n * Copyright 2008-2021, GreenSock. All rights reserved.\n * Subject to the terms at https://greensock.com/standard-license or for\n * Club GreenSock members, the agreement issued with that membership.\n * @author: Jack Doyle, jack@greensock.com\n*/\n\n/* eslint-disable */\nvar VelocityTracker_gsap,\n    VelocityTracker_coreInitted,\n    VelocityTracker_toArray,\n    _getUnit,\n    _first,\n    _ticker,\n    _time1,\n    _time2,\n    _getCache,\n    _getGSAP = function _getGSAP() {\n  return VelocityTracker_gsap || typeof window !== \"undefined\" && (VelocityTracker_gsap = window.gsap);\n},\n    _lookup = {},\n    _round = function _round(value) {\n  return Math.round(value * 10000) / 10000;\n},\n    _getID = function _getID(target) {\n  return _getCache(target).id;\n},\n    _getByTarget = function _getByTarget(target) {\n  return _lookup[_getID(typeof target === \"string\" ? VelocityTracker_toArray(target)[0] : target)];\n},\n    _onTick = function _onTick(time) {\n  var pt = _first,\n      val; //if the frame rate is too high, we won't be able to track the velocity as well, so only update the values about 20 times per second\n\n  if (time - _time1 >= 0.05) {\n    _time2 = _time1;\n    _time1 = time;\n\n    while (pt) {\n      val = pt.g(pt.t, pt.p);\n\n      if (val !== pt.v1 || time - pt.t1 > 0.2) {\n        //use a threshold of 0.2 seconds for zeroing-out velocity. If we only use 0.05 and things update slightly slower, like some Android devices dispatch \"touchmove\" events sluggishly so 2 or 3 ticks of the gsap.ticker may elapse inbetween, thus it may appear like the object is not moving but it actually is but it's not updating as frequently. A threshold of 0.2 seconds seems to be a good balance. We want to update things frequently (0.05 seconds) when they're moving so that we can respond to fast motions accurately, but we want to be more resistant to go back to a zero velocity.\n        pt.v2 = pt.v1;\n        pt.v1 = val;\n        pt.t2 = pt.t1;\n        pt.t1 = time;\n      }\n\n      pt = pt._next;\n    }\n  }\n},\n    _types = {\n  deg: 360,\n  rad: Math.PI * 2\n},\n    VelocityTracker_initCore = function _initCore() {\n  VelocityTracker_gsap = _getGSAP();\n\n  if (VelocityTracker_gsap) {\n    VelocityTracker_toArray = VelocityTracker_gsap.utils.toArray;\n    _getUnit = VelocityTracker_gsap.utils.getUnit;\n    _getCache = VelocityTracker_gsap.core.getCache;\n    _ticker = VelocityTracker_gsap.ticker;\n    VelocityTracker_coreInitted = 1;\n  }\n};\n\nvar PropTracker = function PropTracker(target, property, type, next) {\n  VelocityTracker_classCallCheck(this, PropTracker);\n\n  this.t = target;\n  this.p = property;\n  this.g = target._gsap.get;\n  this.rCap = _types[type || _getUnit(this.g(target, property))]; //rotational cap (for degrees, \"deg\", it's 360 and for radians, \"rad\", it's Math.PI * 2)\n\n  this.v1 = this.v2 = 0;\n  this.t1 = this.t2 = _ticker.time;\n\n  if (next) {\n    this._next = next;\n    next._prev = this;\n  }\n};\n\nvar VelocityTracker = /*#__PURE__*/function () {\n  function VelocityTracker(target, property) {\n    VelocityTracker_classCallCheck(this, VelocityTracker);\n\n    if (!VelocityTracker_coreInitted) {\n      VelocityTracker_initCore();\n    }\n\n    this.target = VelocityTracker_toArray(target)[0];\n    _lookup[_getID(this.target)] = this;\n    this._props = {};\n    property && this.add(property);\n  }\n\n  VelocityTracker_createClass(VelocityTracker, [{\n    key: \"get\",\n    value: function get(property, skipRecentTick) {\n      var pt = this._props[property] || console.warn(\"Not tracking \" + property + \" velocity.\"),\n          val,\n          dif,\n          rotationCap;\n      val = parseFloat(skipRecentTick ? pt.v1 : pt.g(pt.t, pt.p));\n      dif = val - parseFloat(pt.v2);\n      rotationCap = pt.rCap;\n\n      if (rotationCap) {\n        //rotational values need special interpretation so that if, for example, they go from 179 to -178 degrees it is interpreted as a change of 3 instead of -357.\n        dif = dif % rotationCap;\n\n        if (dif !== dif % (rotationCap / 2)) {\n          dif = dif < 0 ? dif + rotationCap : dif - rotationCap;\n        }\n      }\n\n      return _round(dif / ((skipRecentTick ? pt.t1 : _ticker.time) - pt.t2));\n    }\n  }, {\n    key: \"getAll\",\n    value: function getAll() {\n      var result = {},\n          props = this._props,\n          p;\n\n      for (p in props) {\n        result[p] = this.get(p);\n      }\n\n      return result;\n    }\n  }, {\n    key: \"isTracking\",\n    value: function isTracking(property) {\n      return property in this._props;\n    }\n  }, {\n    key: \"add\",\n    value: function add(property, type) {\n      if (!(property in this._props)) {\n        if (!_first) {\n          _ticker.add(_onTick);\n\n          _time1 = _time2 = _ticker.time;\n        }\n\n        _first = this._props[property] = new PropTracker(this.target, property, type, _first);\n      }\n    }\n  }, {\n    key: \"remove\",\n    value: function remove(property) {\n      var pt = this._props[property],\n          prev,\n          next;\n\n      if (pt) {\n        prev = pt._prev;\n        next = pt._next;\n\n        if (prev) {\n          prev._next = next;\n        }\n\n        if (next) {\n          next._prev = prev;\n        } else if (_first === pt) {\n          _ticker.remove(_onTick);\n\n          _first = 0;\n        }\n\n        delete this._props[property];\n      }\n    }\n  }, {\n    key: \"kill\",\n    value: function kill(shallow) {\n      for (var p in this._props) {\n        this.remove(p);\n      }\n\n      if (!shallow) {\n        delete _lookup[_getID(this.target)];\n      }\n    }\n  }], [{\n    key: \"register\",\n    value: function register(core) {\n      VelocityTracker_gsap = core;\n\n      VelocityTracker_initCore();\n    }\n  }, {\n    key: \"track\",\n    value: function track(targets, properties, types) {\n      if (!VelocityTracker_coreInitted) {\n        VelocityTracker_initCore();\n      }\n\n      var result = [],\n          targs = VelocityTracker_toArray(targets),\n          a = properties.split(\",\"),\n          t = (types || \"\").split(\",\"),\n          i = targs.length,\n          tracker,\n          j;\n\n      while (i--) {\n        tracker = _getByTarget(targs[i]) || new VelocityTracker(targs[i]);\n        j = a.length;\n\n        while (j--) {\n          tracker.add(a[j], t[j] || t[0]);\n        }\n\n        result.push(tracker);\n      }\n\n      return result;\n    }\n  }, {\n    key: \"untrack\",\n    value: function untrack(targets, properties) {\n      var props = (properties || \"\").split(\",\");\n\n      VelocityTracker_toArray(targets).forEach(function (target) {\n        var tracker = _getByTarget(target);\n\n        if (tracker) {\n          if (!props.length) {\n            tracker.kill(1);\n          } else {\n            props.forEach(function (p) {\n              return tracker.remove(p);\n            });\n          }\n        }\n      });\n    }\n  }, {\n    key: \"isTracking\",\n    value: function isTracking(target, property) {\n      var tracker = _getByTarget(target);\n\n      return tracker && tracker.isTracking(property);\n    }\n  }, {\n    key: \"getVelocity\",\n    value: function getVelocity(target, property) {\n      var tracker = _getByTarget(target);\n\n      return !tracker || !tracker.isTracking(property) ? console.warn(\"Not tracking velocity of \" + property) : tracker.get(property);\n    }\n  }]);\n\n  return VelocityTracker;\n}();\nVelocityTracker.getByTarget = _getByTarget;\n_getGSAP() && VelocityTracker_gsap.registerPlugin(VelocityTracker);\n\n;// CONCATENATED MODULE: ./app/src/js/classes/InertiaPlugin.js\nfunction InertiaPlugin_typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { InertiaPlugin_typeof = function _typeof(obj) { return typeof obj; }; } else { InertiaPlugin_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return InertiaPlugin_typeof(obj); }\n\n/*!\n * InertiaPlugin 3.6.1\n * https://greensock.com\n *\n * @license Copyright 2008-2021, GreenSock. All rights reserved.\n * Subject to the terms at https://greensock.com/standard-license or for\n * Club GreenSock members, the agreement issued with that membership.\n * @author: Jack Doyle, jack@greensock.com\n*/\n\n/* eslint-disable */\n\n\nvar InertiaPlugin_gsap,\n    InertiaPlugin_coreInitted,\n    _parseEase,\n    InertiaPlugin_toArray,\n    _power3,\n    _config,\n    InertiaPlugin_getUnit,\n    PropTween,\n    InertiaPlugin_getCache,\n    _checkPointRatio,\n    _clamp,\n    _processingVars,\n    _getTracker = VelocityTracker.getByTarget,\n    InertiaPlugin_getGSAP = function _getGSAP() {\n  return InertiaPlugin_gsap || typeof window !== \"undefined\" && (InertiaPlugin_gsap = window.gsap) && InertiaPlugin_gsap.registerPlugin && InertiaPlugin_gsap;\n},\n    _isString = function _isString(value) {\n  return typeof value === \"string\";\n},\n    _isNumber = function _isNumber(value) {\n  return typeof value === \"number\";\n},\n    _isObject = function _isObject(value) {\n  return InertiaPlugin_typeof(value) === \"object\";\n},\n    _isFunction = function _isFunction(value) {\n  return typeof value === \"function\";\n},\n    InertiaPlugin_bonusValidated = 1,\n    //<name>InertiaPlugin</name>\nInertiaPlugin_isArray = Array.isArray,\n    _emptyFunc = function _emptyFunc(p) {\n  return p;\n},\n    _bigNum = 1e10,\n    _tinyNum = 1 / _bigNum,\n    _checkPoint = 0.05,\n    InertiaPlugin_round = function _round(value) {\n  return Math.round(value * 10000) / 10000;\n},\n    _extend = function _extend(obj, defaults, exclude) {\n  for (var p in defaults) {\n    if (!(p in obj) && p !== exclude) {\n      obj[p] = defaults[p];\n    }\n  }\n\n  return obj;\n},\n    _deepClone = function _deepClone(obj) {\n  var copy = {},\n      p,\n      v;\n\n  for (p in obj) {\n    copy[p] = _isObject(v = obj[p]) ? _deepClone(v) : v;\n  }\n\n  return copy;\n},\n    _getClosest = function _getClosest(n, values, max, min, radius) {\n  var i = values.length,\n      closest = 0,\n      absDif = _bigNum,\n      val,\n      dif,\n      p,\n      dist;\n\n  if (_isObject(n)) {\n    while (i--) {\n      val = values[i];\n      dif = 0;\n\n      for (p in n) {\n        dist = val[p] - n[p];\n        dif += dist * dist;\n      }\n\n      if (dif < absDif) {\n        closest = i;\n        absDif = dif;\n      }\n    }\n\n    if ((radius || _bigNum) < _bigNum && radius < Math.sqrt(absDif)) {\n      return n;\n    }\n  } else {\n    while (i--) {\n      val = values[i];\n      dif = val - n;\n\n      if (dif < 0) {\n        dif = -dif;\n      }\n\n      if (dif < absDif && val >= min && val <= max) {\n        closest = i;\n        absDif = dif;\n      }\n    }\n  }\n\n  return values[closest];\n},\n    _parseEnd = function _parseEnd(curProp, end, max, min, name, radius) {\n  if (curProp.end === \"auto\") {\n    return curProp;\n  }\n\n  var endVar = curProp.end,\n      adjustedEnd,\n      p;\n  max = isNaN(max) ? _bigNum : max;\n  min = isNaN(min) ? -_bigNum : min;\n\n  if (_isObject(end)) {\n    //for objects, like {x, y} where they're linked and we must pass an object to the function or find the closest value in an array.\n    adjustedEnd = end.calculated ? end : (_isFunction(endVar) ? endVar(end) : _getClosest(end, endVar, max, min, radius)) || end;\n\n    if (!end.calculated) {\n      for (p in adjustedEnd) {\n        end[p] = adjustedEnd[p];\n      }\n\n      end.calculated = true;\n    }\n\n    adjustedEnd = adjustedEnd[name];\n  } else {\n    adjustedEnd = _isFunction(endVar) ? endVar(end) : InertiaPlugin_isArray(endVar) ? _getClosest(end, endVar, max, min, radius) : parseFloat(endVar);\n  }\n\n  if (adjustedEnd > max) {\n    adjustedEnd = max;\n  } else if (adjustedEnd < min) {\n    adjustedEnd = min;\n  }\n\n  return {\n    max: adjustedEnd,\n    min: adjustedEnd,\n    unitFactor: curProp.unitFactor\n  };\n},\n    _getNumOrDefault = function _getNumOrDefault(vars, property, defaultValue) {\n  return isNaN(vars[property]) ? defaultValue : +vars[property];\n},\n    _calculateChange = function _calculateChange(velocity, duration) {\n  return duration * _checkPoint * velocity / _checkPointRatio;\n},\n    _calculateDuration = function _calculateDuration(start, end, velocity) {\n  return Math.abs((end - start) * _checkPointRatio / velocity / _checkPoint);\n},\n    _reservedProps = {\n  resistance: 1,\n  checkpoint: 1,\n  preventOvershoot: 1,\n  linkedProps: 1,\n  radius: 1,\n  duration: 1\n},\n    _processLinkedProps = function _processLinkedProps(target, vars, getVal, resistance) {\n  if (vars.linkedProps) {\n    //when there are linkedProps (typically \"x,y\" where snapping has to factor in multiple properties, we must first populate an object with all of those end values, then feed it to the function that make any necessary alterations. So the point of this first loop is to simply build an object (like {x:100, y:204.5}) for feeding into that function which we'll do later in the \"real\" loop.\n    var linkedPropNames = vars.linkedProps.split(\",\"),\n        linkedProps = {},\n        i,\n        p,\n        curProp,\n        curVelocity,\n        tracker,\n        curDuration;\n\n    for (i = 0; i < linkedPropNames.length; i++) {\n      p = linkedPropNames[i];\n      curProp = vars[p];\n\n      if (curProp) {\n        if (_isNumber(curProp.velocity)) {\n          curVelocity = curProp.velocity;\n        } else {\n          tracker = tracker || _getTracker(target);\n          curVelocity = tracker && tracker.isTracking(p) ? tracker.get(p) : 0;\n        }\n\n        curDuration = Math.abs(curVelocity / _getNumOrDefault(curProp, \"resistance\", resistance));\n        linkedProps[p] = parseFloat(getVal(target, p)) + _calculateChange(curVelocity, curDuration);\n      }\n    }\n\n    return linkedProps;\n  }\n},\n    _calculateTweenDuration = function _calculateTweenDuration(target, vars) {\n  var maxDuration = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 10;\n  var minDuration = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0.2;\n  var overshootTolerance = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1;\n  var recordEnd = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 0;\n  _isString(target) && (target = InertiaPlugin_toArray(target)[0]);\n\n  if (!target) {\n    return 0;\n  }\n\n  var duration = 0,\n      clippedDuration = _bigNum,\n      inertiaVars = vars.inertia || vars,\n      getVal = InertiaPlugin_getCache(target).get,\n      resistance = _getNumOrDefault(inertiaVars, \"resistance\", _config.resistance),\n      p,\n      curProp,\n      curDuration,\n      curVelocity,\n      curVal,\n      end,\n      curClippedDuration,\n      tracker,\n      unitFactor,\n      linkedProps; //when there are linkedProps (typically \"x,y\" where snapping has to factor in multiple properties, we must first populate an object with all of those end values, then feed it to the function that make any necessary alterations. So the point of this first loop is to simply build an object (like {x:100, y:204.5}) for feeding into that function which we'll do later in the \"real\" loop.\n\n\n  linkedProps = _processLinkedProps(target, inertiaVars, getVal, resistance);\n\n  for (p in inertiaVars) {\n    if (!_reservedProps[p]) {\n      curProp = inertiaVars[p];\n\n      if (!_isObject(curProp)) {\n        tracker = tracker || _getTracker(target);\n\n        if (tracker && tracker.isTracking(p)) {\n          curProp = _isNumber(curProp) ? {\n            velocity: curProp\n          } : {\n            velocity: tracker.get(p)\n          }; //if we're tracking this property, we should use the tracking velocity and then use the numeric value that was passed in as the min and max so that it tweens exactly there.\n        } else {\n          curVelocity = +curProp || 0;\n          curDuration = Math.abs(curVelocity / resistance);\n        }\n      }\n\n      if (_isObject(curProp)) {\n        if (_isNumber(curProp.velocity)) {\n          curVelocity = curProp.velocity;\n        } else {\n          tracker = tracker || _getTracker(target);\n          curVelocity = tracker && tracker.isTracking(p) ? tracker.get(p) : 0;\n        }\n\n        curDuration = _clamp(minDuration, maxDuration, Math.abs(curVelocity / _getNumOrDefault(curProp, \"resistance\", resistance)));\n        curVal = parseFloat(getVal(target, p)) || 0;\n        end = curVal + _calculateChange(curVelocity, curDuration);\n\n        if (\"end\" in curProp) {\n          curProp = _parseEnd(curProp, linkedProps && p in linkedProps ? linkedProps : end, curProp.max, curProp.min, p, inertiaVars.radius);\n\n          if (recordEnd) {\n            _processingVars === vars && (_processingVars = inertiaVars = _deepClone(vars));\n            inertiaVars[p] = _extend(curProp, inertiaVars[p], \"end\");\n          }\n        }\n\n        if (\"max\" in curProp && end > +curProp.max + _tinyNum) {\n          unitFactor = curProp.unitFactor || _config.unitFactors[p] || 1; //some values are measured in special units like radians in which case our thresholds need to be adjusted accordingly.\n          //if the value is already exceeding the max or the velocity is too low, the duration can end up being uncomfortably long but in most situations, users want the snapping to occur relatively quickly (0.75 seconds), so we implement a cap here to make things more intuitive. If the max and min match, it means we're animating to a particular value and we don't want to shorten the time unless the velocity is really slow. Example: a rotation where the start and natural end value are less than the snapping spot, but the natural end is pretty close to the snap.\n\n          curClippedDuration = curVal > curProp.max && curProp.min !== curProp.max || curVelocity * unitFactor > -15 && curVelocity * unitFactor < 45 ? minDuration + (maxDuration - minDuration) * 0.1 : _calculateDuration(curVal, curProp.max, curVelocity);\n\n          if (curClippedDuration + overshootTolerance < clippedDuration) {\n            clippedDuration = curClippedDuration + overshootTolerance;\n          }\n        } else if (\"min\" in curProp && end < +curProp.min - _tinyNum) {\n          unitFactor = curProp.unitFactor || _config.unitFactors[p] || 1; //some values are measured in special units like radians in which case our thresholds need to be adjusted accordingly.\n          //if the value is already exceeding the min or if the velocity is too low, the duration can end up being uncomfortably long but in most situations, users want the snapping to occur relatively quickly (0.75 seconds), so we implement a cap here to make things more intuitive.\n\n          curClippedDuration = curVal < curProp.min && curProp.min !== curProp.max || curVelocity * unitFactor > -45 && curVelocity * unitFactor < 15 ? minDuration + (maxDuration - minDuration) * 0.1 : _calculateDuration(curVal, curProp.min, curVelocity);\n\n          if (curClippedDuration + overshootTolerance < clippedDuration) {\n            clippedDuration = curClippedDuration + overshootTolerance;\n          }\n        }\n\n        curClippedDuration > duration && (duration = curClippedDuration);\n      }\n\n      curDuration > duration && (duration = curDuration);\n    }\n  }\n\n  duration > clippedDuration && (duration = clippedDuration);\n  return duration > maxDuration ? maxDuration : duration < minDuration ? minDuration : duration;\n},\n    InertiaPlugin_initCore = function _initCore() {\n  InertiaPlugin_gsap = InertiaPlugin_getGSAP();\n\n  if (InertiaPlugin_gsap) {\n    _parseEase = InertiaPlugin_gsap.parseEase;\n    InertiaPlugin_toArray = InertiaPlugin_gsap.utils.toArray;\n    InertiaPlugin_getUnit = InertiaPlugin_gsap.utils.getUnit;\n    InertiaPlugin_getCache = InertiaPlugin_gsap.core.getCache;\n    _clamp = InertiaPlugin_gsap.utils.clamp;\n    _power3 = _parseEase(\"power3\");\n    _checkPointRatio = _power3(0.05);\n    PropTween = InertiaPlugin_gsap.core.PropTween;\n    InertiaPlugin_gsap.config({\n      resistance: 100,\n      unitFactors: {\n        time: 1000,\n        totalTime: 1000,\n        progress: 1000,\n        totalProgress: 1000\n      }\n    });\n    _config = InertiaPlugin_gsap.config();\n    InertiaPlugin_gsap.registerPlugin(VelocityTracker);\n    InertiaPlugin_coreInitted = 1;\n  }\n};\n\nvar InertiaPlugin = {\n  version: \"3.6.1\",\n  name: \"inertia\",\n  register: function register(core) {\n    InertiaPlugin_gsap = core;\n\n    InertiaPlugin_initCore();\n  },\n  init: function init(target, vars, tween, index, targets) {\n    InertiaPlugin_coreInitted || InertiaPlugin_initCore();\n\n    var tracker = _getTracker(target);\n\n    if (vars === \"auto\") {\n      if (!tracker) {\n        console.warn(\"No inertia tracking on \" + target + \". InertiaPlugin.track(target) first.\");\n        return;\n      }\n\n      vars = tracker.getAll();\n    }\n\n    this.target = target;\n    this.tween = tween;\n    _processingVars = vars; // gets swapped inside _calculateTweenDuration() if there's a function-based value encountered (to avoid double-calling it)\n\n    var cache = target._gsap,\n        getVal = cache.get,\n        dur = vars.duration,\n        durIsObj = _isObject(dur),\n        preventOvershoot = vars.preventOvershoot || durIsObj && dur.overshoot === 0,\n        resistance = _getNumOrDefault(vars, \"resistance\", _config.resistance),\n        duration = _isNumber(dur) ? dur : _calculateTweenDuration(target, vars, durIsObj && dur.max || 10, durIsObj && dur.min || 0.2, durIsObj && \"overshoot\" in dur ? +dur.overshoot : preventOvershoot ? 0 : 1, true),\n        p,\n        curProp,\n        curVal,\n        unit,\n        velocity,\n        change1,\n        end,\n        change2,\n        linkedProps;\n\n    vars = _processingVars;\n    _processingVars = 0; //when there are linkedProps (typically \"x,y\" where snapping has to factor in multiple properties, we must first populate an object with all of those end values, then feed it to the function that make any necessary alterations. So the point of this first loop is to simply build an object (like {x:100, y:204.5}) for feeding into that function which we'll do later in the \"real\" loop.\n\n    linkedProps = _processLinkedProps(target, vars, getVal, resistance);\n\n    for (p in vars) {\n      if (!_reservedProps[p]) {\n        curProp = vars[p];\n        _isFunction(curProp) && (curProp = curProp(index, target, targets));\n\n        if (_isNumber(curProp)) {\n          velocity = curProp;\n        } else if (_isObject(curProp) && !isNaN(curProp.velocity)) {\n          velocity = +curProp.velocity;\n        } else {\n          if (tracker && tracker.isTracking(p)) {\n            velocity = tracker.get(p);\n          } else {\n            console.warn(\"ERROR: No velocity was defined for \" + target + \" property: \" + p);\n          }\n        }\n\n        change1 = _calculateChange(velocity, duration);\n        change2 = 0;\n        curVal = getVal(target, p);\n        unit = InertiaPlugin_getUnit(curVal);\n        curVal = parseFloat(curVal);\n\n        if (_isObject(curProp)) {\n          end = curVal + change1;\n\n          if (\"end\" in curProp) {\n            curProp = _parseEnd(curProp, linkedProps && p in linkedProps ? linkedProps : end, curProp.max, curProp.min, p, vars.radius);\n          }\n\n          if (\"max\" in curProp && +curProp.max < end) {\n            if (preventOvershoot || curProp.preventOvershoot) {\n              change1 = curProp.max - curVal;\n            } else {\n              change2 = curProp.max - curVal - change1;\n            }\n          } else if (\"min\" in curProp && +curProp.min > end) {\n            if (preventOvershoot || curProp.preventOvershoot) {\n              change1 = curProp.min - curVal;\n            } else {\n              change2 = curProp.min - curVal - change1;\n            }\n          }\n        }\n\n        this._props.push(p);\n\n        this._pt = new PropTween(this._pt, target, p, curVal, 0, _emptyFunc, 0, cache.set(target, p, this));\n        this._pt.u = unit || 0;\n        this._pt.c1 = change1;\n        this._pt.c2 = change2;\n      }\n    }\n\n    tween.duration(duration);\n    return InertiaPlugin_bonusValidated;\n  },\n  render: function render(ratio, data) {\n    var pt = data._pt;\n    ratio = _power3(data.tween._time / data.tween._dur);\n\n    while (pt) {\n      pt.set(pt.t, pt.p, InertiaPlugin_round(pt.s + pt.c1 * ratio + pt.c2 * ratio * ratio) + pt.u, pt.d, ratio);\n      pt = pt._next;\n    }\n  }\n};\n\"track,untrack,isTracking,getVelocity,getByTarget\".split(\",\").forEach(function (name) {\n  return InertiaPlugin[name] = VelocityTracker[name];\n});\nInertiaPlugin_getGSAP() && InertiaPlugin_gsap.registerPlugin(InertiaPlugin);\n\n;// CONCATENATED MODULE: ./app/src/js/classes/Draggable.js\nfunction Draggable_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction Draggable_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction Draggable_createClass(Constructor, protoProps, staticProps) { if (protoProps) Draggable_defineProperties(Constructor.prototype, protoProps); if (staticProps) Draggable_defineProperties(Constructor, staticProps); return Constructor; }\n\n// Gsap\n\n\n\ngsap/* gsap.registerPlugin */.p8.registerPlugin(Draggable/* Draggable */._);\ngsap/* gsap.registerPlugin */.p8.registerPlugin(InertiaPlugin); //empty function\n\nvar Draggable_noop = function noop() {}; //eslint-disable-line\n\n\nvar Draggable_lerp = function lerp(a, b, n) {\n  return (1 - n) * a + n * b;\n}; // Utilities\n\n\n\n\nvar Draggable_default = /*#__PURE__*/function () {\n  function _default(options) {\n    Draggable_classCallCheck(this, _default);\n\n    //hook functions\n    this._onDragStart = options.onDragStart || Draggable_noop;\n    this._onDrag = options.onDrag || Draggable_noop;\n    this._onDragEnd = options.onDragEnd || Draggable_noop;\n    this._onProgress = options.onProgress || Draggable_noop;\n    this._onPress = options.onPress || Draggable_noop;\n    this._onRelease = options.onRelease || Draggable_noop; // this._onSnap = options.onSnap || noop;\n    // this._onSnapLimits = options._onSnapLimits || noop;\n\n    this.slider = options.target;\n    this.sliderContent = options.targetInner;\n    this.snap = typeof options.snap !== 'undefined' ? options.snap : false;\n    this.item = this.sliderContent.querySelector('.slider__item');\n    this.draggable = null;\n    this.divNode = null;\n    this.current = 0;\n    this.last = 0; // this.BoundItemWidth = this.item.getBoundingClientRect().width;\n    // this.styleRightItem = window.getComputedStyle(this.sliderContent.querySelector('a'), null);\n    // this.SnapItem = this.BoundItemWidth + (parseInt(this.styleRightItem.marginRight, 10));\n\n    this.init();\n  } // eslint-disable-next-line no-empty-function\n\n\n  Draggable_createClass(_default, [{\n    key: \"events\",\n    value: function events() {}\n  }, {\n    key: \"createDraggable\",\n    value: function createDraggable() {\n      var _this = this;\n\n      this.draggable = Draggable/* Draggable.create */._.create(this.sliderContent, {\n        type: 'x',\n        lockAxis: true,\n        autoScroll: true,\n        dragResistance: 0.1,\n        edgeResistance: 0.8,\n        bounds: this.slider,\n        inertia: true,\n        throwProps: true,\n        snap: function snap(value) {\n          return _this.snap ? Math.round(value / -_this.item.offsetWidth) * -_this.item.offsetWidth : value;\n        },\n        onDrag: function onDrag() {\n          _this._onDrag(_this);\n        },\n        onThrowUpdate: function onThrowUpdate() {\n          _this._onDrag();\n        },\n        onDragStart: function onDragStart() {\n          _this._onDragStart();\n        },\n        onDragEnd: function onDragEnd() {\n          _this._onDragEnd();\n        },\n        onProgress: function onProgress(e) {\n          _this._onProgress(e);\n        },\n        onPress: function onPress(e) {\n          _this._onPress(e);\n        },\n        onRelease: function onRelease(e) {\n          _this._onRelease(e);\n        } // snap: {\n        //     x: (endValue) => {\n        //         return Math.round(endValue / this.SnapItem) * this.SnapItem;\n        //     },\n        // },\n        // onPress: (e) =>\n        // {\n        //     gsap.to(this.sliderContent, { scale: 0.9, ease: 'power1.out', duration: 1 });\n        //     // gsap.to(this.$circle, { scale: .8, ease: 'power1.out', duration: .5 });\n        //     // this.$circle.querySelector('.label').innerHTML = \"\";\n        //     // this.$circle.querySelector('.label').appendChild(\n        //     //     this.$circle.querySelector('.label').ownerDocument.importNode(this.doc.documentElement, true));\n        // },\n        // onRelease: () =>\n        // {\n        //     gsap.to(this.sliderContent, { scale: 1, ease: 'power1.out', duration: 1 });\n        //     // gsap.to(this.$circle, { scale: 1, ease: 'power1.out', duration: .5 });\n        //     // this.$circle.querySelector('.label').innerHTML = \"DRAG\";\n        // }\n\n      });\n    } // set up dots\n\n  }, {\n    key: \"setupDots\",\n    value: function setupDots() {\n      for (var i = 0; i < this.slides.length; i++) {\n        this.divNode = document.createElement('div');\n        this.divNode.classList.add('nav_dot');\n        this.divNode.id = 'dot_' + i + '';\n        this.$navDots.appendChild(this.divNode); // this.divNode = ;\n        // this.$navDots.prepend('<div class=\"nav_dot\" id=\"dot_' + i + '\"></div>');\n      }\n    }\n  }, {\n    key: \"resize\",\n    value: function resize() {// this.BoundItemWidth = this.item.getBoundingClientRect().width;\n      // this.styleRightItem = window.getComputedStyle(this.sliderContent.querySelector('a'), null);\n      // this.SnapItem = this.BoundItemWidth + (parseInt(this.styleRightItem.marginRight, 10));\n      //gsap.to(this.slider, { x: 0, ease: 'power4.inOut', duration: 1 });\n      // this.BoundItemWidth = this.item.getBoundingClientRect().width;\n      // this.styleRightItem = window.getComputedStyle(this.sliderContent.querySelector('a'), null);\n      // this.SnapItem = this.BoundItemWidth + (parseInt(this.styleRightItem.marginRight, 10));\n      // if (window.innerWidth >= 1025) {\n      //     this.draggable[0].disable();\n      //     gsap.to(this.slider, { x: 0, ease: 'power4.inOut', duration: 1 });\n      // }\n      // else\n      //     this.draggable[0].enable();\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.draggable.kill();\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      this.createDraggable(); // this.setupDots();\n    }\n  }]);\n\n  return _default;\n}();\n\n\n;// CONCATENATED MODULE: ./app/src/js/renderers/rendererHome.js\nfunction rendererHome_typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { rendererHome_typeof = function _typeof(obj) { return typeof obj; }; } else { rendererHome_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return rendererHome_typeof(obj); }\n\nfunction rendererHome_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction rendererHome_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction rendererHome_createClass(Constructor, protoProps, staticProps) { if (protoProps) rendererHome_defineProperties(Constructor.prototype, protoProps); if (staticProps) rendererHome_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction rendererHome_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) rendererHome_setPrototypeOf(subClass, superClass); }\n\nfunction rendererHome_setPrototypeOf(o, p) { rendererHome_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return rendererHome_setPrototypeOf(o, p); }\n\nfunction rendererHome_createSuper(Derived) { var hasNativeReflectConstruct = rendererHome_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = rendererHome_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = rendererHome_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return rendererHome_possibleConstructorReturn(this, result); }; }\n\nfunction rendererHome_possibleConstructorReturn(self, call) { if (call && (rendererHome_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return rendererHome_assertThisInitialized(self); }\n\nfunction rendererHome_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction rendererHome_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction rendererHome_getPrototypeOf(o) { rendererHome_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return rendererHome_getPrototypeOf(o); }\n\n// Gsap\n\n\ngsap/* default.registerPlugin */.ZP.registerPlugin(ScrollTrigger/* default */.Z); // Import Renderer\n\n // import stylesDefault from './stylesDefault.css'; //eslint-disable-line\n// Utilities\n\n\n // Other\n// import Slider from '../classes/slider';\n// import SplitText from '../classes/splitText';\n\nvar RendererHome = /*#__PURE__*/function (_Renderer) {\n  rendererHome_inherits(RendererHome, _Renderer);\n\n  var _super = rendererHome_createSuper(RendererHome);\n\n  function RendererHome() {\n    rendererHome_classCallCheck(this, RendererHome);\n\n    return _super.apply(this, arguments);\n  }\n\n  rendererHome_createClass(RendererHome, [{\n    key: \"selectors\",\n    value: function selectors() {\n      this.$hero = this.$el.querySelector('.home__hero');\n      this.$poster = this.$el.querySelector('.home__poster');\n      this.$masterworks = this.$el.querySelector('.home__masterworks');\n      this.$related = this.$el.querySelector('.home__related'); // Video\n\n      this.$video = this.$hero.querySelector('.video');\n\n      if (this.$video) {\n        this.$videoLoop = this.$video.querySelector('.video__loop');\n        this.$videoLoopItem = this.$video.querySelector('.video__loop video');\n        this.$videoPoster = this.$video.querySelector('.video__poster');\n        this.$videoTrigger = this.$video.querySelector('.video__trigger');\n        this.$videoModal = this.$el.querySelector('.video--modal');\n        this.$videoMask = this.$videoModal.querySelector('.video__mask');\n        this.$videoPlayer = this.$videoModal.querySelector('.video__player');\n        this.$videoPlayerItem = this.$videoModal.querySelector('.video__player video');\n        this.$videoCloser = this.$videoModal.querySelector('.video__closer');\n      }\n    }\n  }, {\n    key: \"beforeEnter\",\n    value: function beforeEnter() {// if(this.appStore.isDesktop)\n      //     gsap.set(this.$hero.querySelector('.logo'), { opacity: 0.0001 });\n      // gsap.set(this.$hero.querySelector('.title'), { opacity: 0.0001 });\n    }\n  }, {\n    key: \"events\",\n    value: function events() {\n      var _this = this;\n\n      if (this.$videoPlayer && this.$videoTrigger) {\n        this.domEvents.add(this.$videoTrigger, 'click', function (e, a, el) {\n          if (_this.appStore.isDesktop) {\n            _this.lastScroll = _this.superScroller._scroll.livePosition.y;\n\n            var _offset = _this.$videoLoop.getBoundingClientRect().top - window.innerWidth * 0.05;\n\n            _this.superScroller.scrollAnimate(_offset - _this.lastScroll, 1, 'expo.inOut', true);\n\n            gsap/* default.delayedCall */.ZP.delayedCall(1, function () {\n              _this.videoOpen(e, a, el);\n            });\n          } else {\n            _this.videoOpen(e, a, el);\n          }\n        });\n        this.domEvents.add(this.$videoCloser, 'click', function (e, a, el) {\n          _this.videoClose(e, a, el);\n        });\n        this.domEvents.add(this.$videoMask, 'click', function (e, a, el) {\n          _this.videoClose(e, a, el);\n        });\n        this.domEvents.add(this.$videoPlayerItem, 'ended', function (e, a, el) {\n          _this.videoClose(e, a, el);\n        });\n\n        if (this.appStore.isDesktop) {\n          this.domEvents.add(this.$videoTrigger, 'mouseenter', function (e, a, el) {\n            _this.enterIcon(e, a, el);\n          });\n          this.domEvents.add(this.$videoTrigger, 'mouseleave', function (e, a, el) {\n            _this.leaveIcon(e, a, el);\n          });\n          this.domEvents.add(this.$videoCloser, 'mouseenter', function (e, a, el) {\n            _this.enterIcon(e, a, el);\n          });\n          this.domEvents.add(this.$videoCloser, 'mouseleave', function (e, a, el) {\n            _this.leaveIcon(e, a, el);\n          });\n        }\n      }\n    }\n  }, {\n    key: \"enter\",\n    value: function enter() {\n      // if(this.appStore.isDesktop)\n      //     gsap.to(this.$hero.querySelector('.logo'), { opacity: 1, duration: 1, ease: 'power2.out' });\n      // gsap.to(this.$hero.querySelector('.title'), { opacity: 1, duration: 1, ease: 'power2.out' });\n      if (this.appStore.isDesktop) gsap/* default.to */.ZP.to(this.appUi.$headerSubmenu, {\n        opacity: 1,\n        duration: 1,\n        ease: 'power2.out'\n      });\n      if (this.appStore.isDesktop) this.initHero();\n      this.initScrolltitle();\n      this.initParallaxPoster();\n      this.initMasterworks();\n      this.initRelated();\n    }\n  }, {\n    key: \"initHero\",\n    value: function initHero() {\n      if (this.$hero) {\n        this.$heroOuters = this.$hero.querySelectorAll('.outer');\n        var heroTimeline = gsap/* default.timeline */.ZP.timeline({\n          defaults: {\n            ease: 'none'\n          },\n          scrollTrigger: {\n            trigger: this.$hero,\n            scrub: true,\n            start: 'top top',\n            end: window.innerHeight * 2 + 'px top'\n          }\n        });\n\n        for (var i = 0; i < this.$heroOuters.length; i++) {\n          heroTimeline.to(this.$heroOuters[i], {\n            y: i * 15 + 'vw'\n          }, 0);\n        }\n      }\n    }\n  }, {\n    key: \"videoOpen\",\n    value: function videoOpen() {\n      this.$videoLoopItem.pause();\n      gsap/* default.set */.ZP.set(this.$videoModal, {\n        display: 'block',\n        zIndex: 1000\n      });\n      if (this.appStore.isDesktop) this.superScroller._scroll.enable = false;else this.$videoModal.addEventListener('touchmove', function (e) {\n        e.preventDefault();\n      });\n      this.opened = true;\n      this.$videoPlayerItem.play();\n      this.$videoPlayerItem.style.visibility = 'visible';\n      gsap/* default.to */.ZP.to(this.$videoMask, {\n        opacity: 0.8,\n        ease: 'expo.out',\n        duration: 0.5\n      });\n      gsap/* default.to */.ZP.to(this.$videoPlayer, {\n        y: '-50%',\n        ease: 'expo.out',\n        duration: 0.8,\n        delay: 0.5\n      });\n      gsap/* default.to */.ZP.to(this.$videoCloser, {\n        opacity: 1,\n        ease: 'expo.out',\n        duration: 0.8,\n        delay: 1.3\n      });\n    }\n  }, {\n    key: \"videoClose\",\n    value: function videoClose() {\n      var _this2 = this;\n\n      this.opened = false;\n      gsap/* default.to */.ZP.to(this.$videoCloser, {\n        opacity: 0.0001,\n        ease: 'expo.out',\n        duration: 0.8\n      });\n      gsap/* default.to */.ZP.to(this.$videoPlayer, {\n        y: this.appStore.isDesktop ? '-200%' : '-300%',\n        ease: 'expo.out',\n        duration: 0.8,\n        delay: 0.5\n      });\n      gsap/* default.to */.ZP.to(this.$videoMask, {\n        opacity: 0.0001,\n        ease: 'expo.out',\n        duration: 0.5,\n        delay: 1.3,\n        onComplete: function onComplete() {\n          _this2.$videoLoopItem.play();\n\n          _this2.$videoPlayerItem.style.visibility = 'hidden';\n\n          _this2.$videoPlayerItem.pause();\n\n          _this2.$videoPlayerItem.currentTime = 0;\n          gsap/* default.set */.ZP.set(_this2.$videoModal, {\n            display: 'none',\n            zIndex: 'initial'\n          });\n          if (_this2.appStore.isDesktop) _this2.superScroller._scroll.enable = true;\n        }\n      });\n    }\n  }, {\n    key: \"enterIcon\",\n    value: function enterIcon(e, a, el) {\n      gsap/* default.to */.ZP.to(el, {\n        scale: 0.9,\n        duration: 1.5,\n        ease: 'expo.out'\n      });\n    }\n  }, {\n    key: \"leaveIcon\",\n    value: function leaveIcon(e, a, el) {\n      gsap/* default.to */.ZP.to(el, {\n        scale: 1,\n        duration: 1.5,\n        ease: 'expo.out'\n      });\n    }\n  }, {\n    key: \"initScrolltitle\",\n    value: function initScrolltitle() {\n      var _this3 = this;\n\n      this.scrolltitles = [];\n      this.$scrolltitles = this.$el.querySelectorAll('.scrolltitle');\n\n      var _loop = function _loop(i) {\n        var speed = _this3.$scrolltitles[i].dataset.speed;\n        var scrolltitle = {};\n        scrolltitle.$scrolltitlesItems = _this3.$scrolltitles[i].children;\n        _this3.$scrolltitles[i].style.width = scrolltitle.$scrolltitlesItems[0].offsetWidth + 'px';\n        scrolltitle.scrollTitleInnerLeft = gsap/* default.timeline */.ZP.timeline({\n          paused: false,\n          defaults: {\n            ease: 'none',\n            duration: _this3.appStore.isDesktop ? scrolltitle.$scrolltitlesItems[0].offsetWidth / 300 : scrolltitle.$scrolltitlesItems[0].offsetWidth / 100,\n            repeat: '-1',\n            onReverseComplete: function onReverseComplete() {\n              scrolltitle.scrollTitleInnerLeft.pause();\n              scrolltitle.scrollTitleInnerRight.play();\n            }\n          }\n        });\n\n        for (var j = 0; j < scrolltitle.$scrolltitlesItems.length; j++) {\n          scrolltitle.scrollTitleInnerLeft.to(scrolltitle.$scrolltitlesItems[j], {\n            x: -100 * speed + '%'\n          }, 0);\n        }\n\n        scrolltitle.scrollTitleInnerRight = gsap/* default.timeline */.ZP.timeline({\n          paused: true,\n          defaults: {\n            ease: 'none',\n            duration: _this3.appStore.isDesktop ? scrolltitle.$scrolltitlesItems[0].offsetWidth / 300 : scrolltitle.$scrolltitlesItems[0].offsetWidth / 100,\n            repeat: '-1',\n            onReverseComplete: function onReverseComplete() {\n              scrolltitle.scrollTitleInnerRight.pause();\n              scrolltitle.scrollTitleInnerLeft.play();\n            }\n          }\n        });\n\n        for (var _j = 0; _j < scrolltitle.$scrolltitlesItems.length; _j++) {\n          scrolltitle.scrollTitleInnerRight.to(scrolltitle.$scrolltitlesItems[_j], {\n            x: 100 * speed + '%'\n          }, 0);\n        }\n\n        if (_this3.appStore.isDesktop) {\n          scrolltitle.scrollTitleOuter = gsap/* default.timeline */.ZP.timeline({\n            defaults: {\n              ease: 'none'\n            },\n            scrollTrigger: {\n              trigger: _this3.$scrolltitles[i],\n              scrub: true,\n              start: 'top bottom',\n              end: 'bottom top',\n              onUpdate: function onUpdate(self) {\n                // this.scrollTitleInner.timeScale(self.direction);\n                if (!scrolltitle.scrollTitleInnerLeft.paused()) scrolltitle.scrollTitleInnerLeft.reversed(self.direction !== 1);\n                if (!scrolltitle.scrollTitleInnerRight.paused()) scrolltitle.scrollTitleInnerRight.reversed(self.direction === 1);\n              }\n            }\n          });\n          scrolltitle.scrollTitleOuter.fromTo(_this3.$scrolltitles[i], {\n            x: window.innerWidth * 0.2 * speed\n          }, {\n            x: -window.innerWidth * 0.2 * speed\n          }, 0);\n        }\n\n        _this3.scrolltitles.push(scrolltitle);\n      };\n\n      for (var i = 0; i < this.$scrolltitles.length; i++) {\n        _loop(i);\n      }\n    }\n  }, {\n    key: \"resizeScrolltitles\",\n    value: function resizeScrolltitles() {\n      for (var i = 0; i < this.$scrolltitles.length; i++) {\n        this.$scrolltitles[i].style.width = '';\n      }\n\n      for (var _i = 0; _i < this.scrolltitles.length; _i++) {\n        if (this.scrolltitles[_i].scrollTitleInnerLeft) this.scrolltitles[_i].scrollTitleInnerLeft.pause(0).kill(true);\n        if (this.scrolltitles[_i].scrollTitleInnerRight) this.scrolltitles[_i].scrollTitleInnerRight.pause(0).kill(true);\n        if (this.scrolltitles[_i].scrollTitleOuter) this.scrolltitles[_i].scrollTitleOuter.pause(0).kill(true);\n      }\n\n      this.initScrolltitle();\n    }\n  }, {\n    key: \"initParallaxPoster\",\n    value: function initParallaxPoster() {\n      if (this.$poster) {\n        this.$posterImage = this.$poster.querySelector('.image');\n        this.$posterTitle = this.$poster.querySelector('.supertitle');\n        this.timelineParallaxPoster = gsap/* default.timeline */.ZP.timeline({\n          defaults: {\n            ease: 'none'\n          },\n          scrollTrigger: {\n            trigger: this.$posterImage,\n            scrub: true,\n            start: '-=' + window.innerWidth * 0.05 + ' bottom',\n            end: this.$posterImage.getBoundingClientRect().height - window.innerWidth * 0.05 + ' top'\n          }\n        });\n        var top = this.$posterImage.getBoundingClientRect().height / 2 - this.$posterTitle.getBoundingClientRect().height / 2;\n        var offset = this.$posterImage.getBoundingClientRect().height / 2 - this.$posterTitle.getBoundingClientRect().height / 2 - window.innerWidth * 0.05;\n        this.$posterTitle.style.top = top + 'px';\n        this.timelineParallaxPoster.set(this.$posterTitle, {\n          y: -offset\n        }, 0);\n        this.timelineParallaxPoster.to(this.$posterTitle, {\n          y: offset\n        }, 0);\n      }\n    }\n  }, {\n    key: \"initMasterworks\",\n    value: function initMasterworks() {\n      if (this.$masterworks) {\n        gsap/* default.set */.ZP.set(this.$masterworks.querySelector('.background__bg'), {\n          y: '-10vw',\n          scale: 1.2\n        });\n        var backgroundTimeline = gsap/* default.timeline */.ZP.timeline({\n          scrollTrigger: {\n            trigger: this.$masterworks.querySelector('.background'),\n            start: 'top bottom',\n            end: 'bottom top',\n            scrub: true // onToggle: (isActive) =>\n            // {\n            //     isActive ? this.$videoCover.querySelector('.video__player video').play() : this.$videoCover.querySelector('.video__player video').pause();\n            // }\n\n          },\n          defaults: {\n            duration: 1,\n            ease: 'none'\n          }\n        });\n        backgroundTimeline.to(this.$masterworks.querySelector('.background__bg'), {\n          y: '10vw',\n          scale: 1,\n          duration: 1\n        }, 0);\n      }\n    }\n  }, {\n    key: \"initRelated\",\n    value: function initRelated() {\n      var _this4 = this;\n\n      // Selectors\n      this.$relatedSlider = this.$related.querySelector('.slider');\n      this.$relatedSliderInner = this.$related.querySelector('.slider__inner');\n      this.$relatedSliderItems = this.$related.querySelectorAll('.slider__item');\n      this.$relatedPromotions = this.$related.querySelectorAll('.promotion');\n\n      if (this.appStore.isDesktop) {\n        for (var i = 0; i < this.$relatedPromotions.length; i++) {\n          this.domEvents.add(this.$relatedPromotions[i], 'mouseenter', function (e, a, el) {\n            _this4.promotionEnter(el);\n          });\n          this.domEvents.add(this.$relatedPromotions[i], 'mouseleave', function (e, a, el) {\n            _this4.promotionLeave(el);\n          });\n        }\n\n        if (this.$relatedSliderItems.length > 4) {\n          this.$relatedSliderInner.style.justifyContent = 'flex-start';\n          this.$relatedSliderInner.style.minWidth = 'auto';\n          this.domEvents.add(this.$relatedSliderInner, 'mouseenter', function (e, a, el) {\n            _this4.appUi.enterDragCursor();\n          });\n          this.domEvents.add(this.$relatedSliderInner, 'mouseleave', function (e, a, el) {\n            _this4.appUi.leaveDragCursor();\n          });\n          this.relatedDraggable = new superDragger_default({\n            el: this.$relatedSlider,\n            elClickables: this.$relatedPromotions,\n            inner: this.$relatedSliderInner,\n            onDragStart: function onDragStart() {\n              _this4.superScroller._scroll.enable = false;\n\n              for (var _i2 = 0; _i2 < _this4.$relatedPromotions.length; _i2++) {\n                gsap/* default.to */.ZP.to(_this4.$relatedPromotions[_i2], {\n                  scale: 0.94,\n                  opacity: 1,\n                  ease: 'expo.out',\n                  duration: 0.6\n                });\n                gsap/* default.to */.ZP.to(_this4.$relatedPromotions[_i2].querySelector('.inner .background__bg'), {\n                  scale: 1,\n                  opacity: 1,\n                  ease: 'expo.out',\n                  duration: 0.6\n                });\n              }\n            },\n            onDragEnd: function onDragEnd() {\n              _this4.superScroller._scroll.enable = true;\n\n              for (var _i3 = 0; _i3 < _this4.$relatedPromotions.length; _i3++) {\n                gsap/* default.to */.ZP.to(_this4.$relatedPromotions[_i3], {\n                  scale: 1,\n                  opacity: 1,\n                  ease: 'expo.out',\n                  duration: 0.6\n                });\n                gsap/* default.to */.ZP.to(_this4.$relatedPromotions[_i3].querySelector('.inner .background__bg'), {\n                  scale: 1.1,\n                  ease: 'expo.out',\n                  duration: 0.6\n                });\n              }\n            }\n          });\n        }\n      } else {\n        this.$relatedSliderInner.style.justifyContent = 'flex-start';\n        this.$relatedSliderInner.style.minWidth = 'auto';\n        this.relatedDraggable = new Draggable_default({\n          target: this.$relatedSlider,\n          targetInner: this.$relatedSliderInner,\n          snap: true\n        });\n      }\n    }\n  }, {\n    key: \"promotionEnter\",\n    value: function promotionEnter(el) {\n      gsap/* default.to */.ZP.to(el.querySelector('.inner .background__bg'), {\n        scale: 1,\n        opacity: 1,\n        ease: 'expo.out',\n        duration: 0.6\n      });\n    }\n  }, {\n    key: \"promotionLeave\",\n    value: function promotionLeave(el) {\n      if (this.relatedDraggable && this.relatedDraggable._drag.dragging) return;\n      gsap/* default.to */.ZP.to(el.querySelector('.inner .background__bg'), {\n        scale: 1.1,\n        ease: 'expo.out',\n        duration: 0.6\n      });\n    }\n  }, {\n    key: \"raf\",\n    value: function raf() {} // eslint-disable-line\n\n  }, {\n    key: \"resizeOrientation\",\n    value: function resizeOrientation() {\n      for (var i = 0; i < this.splitTexts.length; i++) {\n        this.splitTexts[i].revert();\n      }\n\n      this.resizeScrolltitles();\n    }\n  }]);\n\n  return RendererHome;\n}(renderer); // Don`t forget to export your renderer\n\n\n/* harmony default export */ const rendererHome = (RendererHome);\n;// CONCATENATED MODULE: ./app/src/js/renderers/rendererAbout.js\nfunction rendererAbout_typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { rendererAbout_typeof = function _typeof(obj) { return typeof obj; }; } else { rendererAbout_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return rendererAbout_typeof(obj); }\n\nfunction rendererAbout_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction rendererAbout_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction rendererAbout_createClass(Constructor, protoProps, staticProps) { if (protoProps) rendererAbout_defineProperties(Constructor.prototype, protoProps); if (staticProps) rendererAbout_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction rendererAbout_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) rendererAbout_setPrototypeOf(subClass, superClass); }\n\nfunction rendererAbout_setPrototypeOf(o, p) { rendererAbout_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return rendererAbout_setPrototypeOf(o, p); }\n\nfunction rendererAbout_createSuper(Derived) { var hasNativeReflectConstruct = rendererAbout_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = rendererAbout_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = rendererAbout_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return rendererAbout_possibleConstructorReturn(this, result); }; }\n\nfunction rendererAbout_possibleConstructorReturn(self, call) { if (call && (rendererAbout_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return rendererAbout_assertThisInitialized(self); }\n\nfunction rendererAbout_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction rendererAbout_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction rendererAbout_getPrototypeOf(o) { rendererAbout_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return rendererAbout_getPrototypeOf(o); }\n\n// Gsap\n\n\ngsap/* default.registerPlugin */.ZP.registerPlugin(ScrollTrigger/* default */.Z); // Import Renderer\n\n // import stylesDefault from './stylesDefault.css'; //eslint-disable-line\n// Utilities\n\n\n\n // Other\n// import Slider from '../classes/slider';\n\n\n\nvar RendererAbout = /*#__PURE__*/function (_Renderer) {\n  rendererAbout_inherits(RendererAbout, _Renderer);\n\n  var _super = rendererAbout_createSuper(RendererAbout);\n\n  function RendererAbout() {\n    rendererAbout_classCallCheck(this, RendererAbout);\n\n    return _super.apply(this, arguments);\n  }\n\n  rendererAbout_createClass(RendererAbout, [{\n    key: \"selectors\",\n    value: function selectors() {\n      this.$hero = this.$el.querySelector('.about__hero');\n      if (this.$hero) this.$heroImages = this.$hero.querySelectorAll('.image');\n    }\n  }, {\n    key: \"events\",\n    value: function events() {} // eslint-disable-line\n\n  }, {\n    key: \"beforeEnter\",\n    value: function beforeEnter() {\n      if (this.appStore.isDesktop) this.setCta();\n    }\n  }, {\n    key: \"enter\",\n    value: function enter() {\n      if (this.appStore.isDesktop) this.initCta();\n    }\n  }, {\n    key: \"setCta\",\n    value: function setCta() {\n      this.$cta = this.$el.querySelector('.cta');\n\n      if (this.$cta) {\n        gsap/* default.set */.ZP.set(this.$cta.querySelector('.mask'), {\n          scaleY: 0\n        });\n        gsap/* default.set */.ZP.set(this.$cta.querySelector('.button'), {\n          y: '5vw'\n        });\n      }\n    }\n  }, {\n    key: \"initCta\",\n    value: function initCta() {\n      var _this = this;\n\n      if (this.$cta) {\n        ScrollTrigger/* default.create */.Z.create({\n          trigger: this.$cta,\n          start: 'top bottom',\n          once: true,\n          onEnter: function onEnter() {\n            gsap/* default.to */.ZP.to(_this.$cta.querySelector('.mask'), {\n              scaleY: 1,\n              duration: 2,\n              ease: 'expo.inOut'\n            });\n            gsap/* default.to */.ZP.to(_this.$cta.querySelector('.button'), {\n              y: 0,\n              duration: 2,\n              ease: 'expo.inOut'\n            });\n          }\n        });\n      }\n    }\n  }, {\n    key: \"raf\",\n    value: function raf() {} // eslint-disable-line\n\n  }]);\n\n  return RendererAbout;\n}(renderer); // Don`t forget to export your renderer\n\n\n/* harmony default export */ const rendererAbout = (RendererAbout);\n;// CONCATENATED MODULE: ./app/src/js/renderers/rendererPhilosophy.js\nfunction rendererPhilosophy_typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { rendererPhilosophy_typeof = function _typeof(obj) { return typeof obj; }; } else { rendererPhilosophy_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return rendererPhilosophy_typeof(obj); }\n\nfunction rendererPhilosophy_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction rendererPhilosophy_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction rendererPhilosophy_createClass(Constructor, protoProps, staticProps) { if (protoProps) rendererPhilosophy_defineProperties(Constructor.prototype, protoProps); if (staticProps) rendererPhilosophy_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction rendererPhilosophy_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) rendererPhilosophy_setPrototypeOf(subClass, superClass); }\n\nfunction rendererPhilosophy_setPrototypeOf(o, p) { rendererPhilosophy_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return rendererPhilosophy_setPrototypeOf(o, p); }\n\nfunction rendererPhilosophy_createSuper(Derived) { var hasNativeReflectConstruct = rendererPhilosophy_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = rendererPhilosophy_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = rendererPhilosophy_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return rendererPhilosophy_possibleConstructorReturn(this, result); }; }\n\nfunction rendererPhilosophy_possibleConstructorReturn(self, call) { if (call && (rendererPhilosophy_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return rendererPhilosophy_assertThisInitialized(self); }\n\nfunction rendererPhilosophy_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction rendererPhilosophy_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction rendererPhilosophy_getPrototypeOf(o) { rendererPhilosophy_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return rendererPhilosophy_getPrototypeOf(o); }\n\n// Gsap\n\n\ngsap/* default.registerPlugin */.ZP.registerPlugin(ScrollTrigger/* default */.Z); // Import Renderer\n\n // import stylesDefault from './stylesDefault.css'; //eslint-disable-line\n// Utilities\n\n\n\n // Other\n// import Slider from '../classes/slider';\n\n\n\nvar RendererPhilosophy = /*#__PURE__*/function (_Renderer) {\n  rendererPhilosophy_inherits(RendererPhilosophy, _Renderer);\n\n  var _super = rendererPhilosophy_createSuper(RendererPhilosophy);\n\n  function RendererPhilosophy() {\n    rendererPhilosophy_classCallCheck(this, RendererPhilosophy);\n\n    return _super.apply(this, arguments);\n  }\n\n  rendererPhilosophy_createClass(RendererPhilosophy, [{\n    key: \"selectors\",\n    value: function selectors() {\n      this.$mision = this.$el.querySelector('.philosophy__mision');\n\n      if (this.$mision) {\n        this.$misionTitles = this.$mision.querySelectorAll('.supertitle');\n        this.$misionImage = this.$mision.querySelector('.image');\n      }\n\n      this.$vision = this.$el.querySelector('.philosophy__vision');\n\n      if (this.$vision) {\n        this.$visionTitles = this.$vision.querySelectorAll('.supertitle');\n        this.$visionImage = this.$vision.querySelector('.image');\n      }\n\n      this.$quote = this.$el.querySelector('.philosophy__quote');\n\n      if (this.$quote) {\n        this.$quoteIcon = this.$quote.querySelector('.quote__icon');\n        this.$quoteText = this.$quote.querySelector('quote__text');\n      }\n\n      this.$assets = this.$el.querySelector('.philosophy__assets');\n\n      if (this.$assets) {\n        if (this.appStore.isDesktop) this.$assetsTitles = this.$assets.querySelectorAll('.supertitle');else this.$assetsTitle = this.$assets.querySelector('.supertitle');\n        this.$assetsImages = this.$assets.querySelectorAll('.image');\n      }\n\n      this.$principles = this.$el.querySelector('.philosophy__principles');\n\n      if (this.$principles) {\n        this.$principlesTitle = this.$principles.querySelector('.supertitle');\n        this.$principlesItems = this.$principles.querySelectorAll('.principles__item');\n      }\n    }\n  }, {\n    key: \"events\",\n    value: function events() {} // eslint-disable-line\n\n  }, {\n    key: \"beforeEnter\",\n    value: function beforeEnter() {\n      if (this.appStore.isDesktop) this.setSupertitles();else this.setSupertitlesMobile();\n    }\n  }, {\n    key: \"enter\",\n    value: function enter() {\n      if (this.appStore.isDesktop) this.initSupertitles();else this.initSupertitlesMobile();\n      this.initQuote();\n      this.initPrinciples();\n    }\n  }, {\n    key: \"setSupertitles\",\n    value: function setSupertitles() {\n      gsap/* default.set */.ZP.set(this.$misionImage.children[0], {\n        scale: 1.2\n      }, 0);\n      this.$supertitles = this.$el.querySelectorAll('.supertitle');\n\n      if (this.$supertitles) {\n        for (var $i = 0; $i < this.$supertitles.length; $i++) {\n          new SplitText(this.$supertitles[$i], {\n            type: 'chars',\n            linesClass: 'line line--++',\n            wordsClass: 'word word--++',\n            charsClass: 'char char--++'\n          }); // eslint-disable-line\n\n          this.$supertitles[$i].classList.add('split', 'split--chars'); // for(let j = 0; j < this.$supertitles[$i].querySelectorAll('.supertitle .line').length; j++)\n          // {\n          //     this.$supertitles[$i].querySelectorAll('.supertitle .line')[j].insertAdjacentHTML('beforeend', '<span class=\"underline\"></span>');\n          //     this.$supertitles[$i].querySelectorAll('.supertitle .line')[j].insertAdjacentHTML('afterend', '<span class=\"break\"></span>');\n          // }\n        }\n      }\n\n      this.$mision.style.paddingTop = window.innerHeight / 2 - this.$misionTitles[0].getBoundingClientRect().height / 2 + 'px';\n      this.$assets.querySelector('.columns--inner-2').style.paddingTop = this.$assetsImages[0].getBoundingClientRect().height + 'px';\n    }\n  }, {\n    key: \"initQuote\",\n    value: function initQuote() {\n      if (this.$quote) {\n        gsap/* default.set */.ZP.set(this.$quoteIcon, {\n          y: '2.5vw'\n        }, 0);\n        var quoteTimeline = gsap/* default.timeline */.ZP.timeline({\n          defaults: {\n            ease: 'none'\n          },\n          scrollTrigger: {\n            trigger: this.$quote,\n            scrub: true,\n            start: 'top bottom',\n            end: 'bottom top'\n          }\n        });\n        quoteTimeline.to(this.$quoteIcon, {\n          y: '-2.5vw'\n        }, 0);\n      }\n    }\n  }, {\n    key: \"initSupertitles\",\n    value: function initSupertitles() {\n      // Mision\n      var misionStart = window.innerHeight / 2 - this.$misionTitles[0].getBoundingClientRect().height / 2;\n      var misionEnd = window.innerHeight / 2 + this.$misionTitles[0].getBoundingClientRect().height / 2;\n      var misionOffset = this.$misionImage.getBoundingClientRect().y + this.$misionImage.getBoundingClientRect().height - this.$misionTitles[0].getBoundingClientRect().top;\n      var misionTimeline = gsap/* default.timeline */.ZP.timeline({\n        defaults: {\n          ease: 'none'\n        },\n        scrollTrigger: {\n          trigger: this.$misionTitles[0],\n          scrub: true,\n          start: 'top ' + misionStart + 'px',\n          end: misionOffset + 'px ' + misionEnd + 'px'\n        }\n      });\n      misionTimeline.to(this.$misionTitles[0], {\n        y: (misionOffset - this.$misionTitles[0].getBoundingClientRect().height) / 2,\n        duration: 0.5\n      }, 0);\n      misionTimeline.to(this.$misionTitles[1], {\n        y: misionOffset - this.$misionTitles[0].getBoundingClientRect().height,\n        duration: 1\n      }, 0);\n      misionTimeline.to(this.$misionImage.children[0], {\n        scale: 1,\n        duration: 1\n      }, 0); // Vision\n\n      var visionStart = window.innerHeight / 2 - this.$visionTitles[0].getBoundingClientRect().height / 2;\n      var visionEnd = window.innerHeight / 2 + this.$visionTitles[0].getBoundingClientRect().height / 2;\n      var visionOffset = this.$visionImage.getBoundingClientRect().top + this.$visionImage.getBoundingClientRect().height - this.$visionTitles[0].getBoundingClientRect().top;\n      gsap/* default.set */.ZP.set(this.$visionImage.children[0], {\n        scale: 1.2\n      }, 0);\n      var visionTimeline = gsap/* default.timeline */.ZP.timeline({\n        defaults: {\n          ease: 'none'\n        },\n        scrollTrigger: {\n          trigger: this.$visionTitles[0],\n          scrub: true,\n          start: 'top ' + visionStart + 'px',\n          end: visionOffset + 'px ' + visionEnd + 'px'\n        }\n      });\n      visionTimeline.to(this.$visionTitles[0], {\n        y: (visionOffset - this.$visionTitles[0].getBoundingClientRect().height) / 2,\n        duration: 0.5\n      }, 0);\n      visionTimeline.to(this.$visionTitles[1], {\n        y: visionOffset - this.$visionTitles[0].getBoundingClientRect().height,\n        duration: 1\n      }, 0);\n      visionTimeline.to(this.$visionImage.children[0], {\n        scale: 1,\n        duration: 1\n      }, 0); // gsap.set(this.$visionImage.children[0], { scale: 1.2 }, 0);\n      // const visionTimeline2 = gsap.timeline({\n      //     defaults: { ease: 'none' },\n      //     scrollTrigger: {\n      //         trigger: this.$visionTitles[0],\n      //         scrub: true,\n      //         start: 'top bottom',\n      //         end: visionOffset + 'px ' + visionEnd + 'px',\n      //     }\n      // });\n      // visionTimeline2.to(this.$visionImage.children[0], { scale: 1, duration: 1 }, 0);\n      // Assets\n\n      var assetsStart = window.innerHeight / 2 - this.$assetsTitles[0].getBoundingClientRect().height / 2;\n      var assetsEnd = window.innerHeight / 2 + this.$assetsTitles[0].getBoundingClientRect().height / 2;\n      var assetsActiOffset = this.$assetsTitles[0].getBoundingClientRect().height + window.innerWidth * 0.125;\n      var assetsVosOffset = this.$assetsTitles[1].getBoundingClientRect().height + this.$assetsImages[0].getBoundingClientRect().height + window.innerWidth * 0.125;\n      var assetsActiTimeline = gsap/* default.timeline */.ZP.timeline({\n        defaults: {\n          ease: 'none'\n        },\n        scrollTrigger: {\n          trigger: this.$assetsTitles[0],\n          scrub: true,\n          start: 'top ' + assetsStart + 'px',\n          end: assetsActiOffset + 'px ' + assetsEnd + 'px'\n        }\n      });\n      assetsActiTimeline.to(this.$assetsTitles[0], {\n        y: assetsActiOffset - this.$assetsTitles[0].getBoundingClientRect().height,\n        duration: 0.5\n      }, 0);\n      var assetsVosTimeline = gsap/* default.timeline */.ZP.timeline({\n        defaults: {\n          ease: 'none'\n        },\n        scrollTrigger: {\n          trigger: this.$assetsTitles[1],\n          scrub: true,\n          start: 'top ' + assetsStart + 'px',\n          end: assetsVosOffset + 'px ' + assetsEnd + 'px'\n        }\n      });\n      assetsVosTimeline.to(this.$assetsTitles[1], {\n        y: assetsVosOffset - this.$assetsTitles[1].getBoundingClientRect().height,\n        duration: 0.5\n      }, 0);\n    }\n  }, {\n    key: \"setSupertitlesMobile\",\n    value: function setSupertitlesMobile() {\n      this.$fixedTitles = this.$el.querySelectorAll('.fixed .supertitle');\n      new SplitText(this.$fixedTitles[0], {\n        type: 'words',\n        wordsClass: 'word word--++'\n      });\n      gsap/* default.set */.ZP.set(this.$fixedTitles[0].children[0], {\n        opacity: 0.0001\n      });\n      new SplitText(this.$fixedTitles[1], {\n        type: 'words',\n        wordsClass: 'word word--++'\n      });\n      gsap/* default.set */.ZP.set(this.$fixedTitles[1].children[0], {\n        opacity: 0.0001\n      });\n      new SplitText(this.$fixedTitles[2], {\n        type: 'words',\n        wordsClass: 'word word--++'\n      });\n      gsap/* default.set */.ZP.set(this.$fixedTitles[2].children[0], {\n        opacity: 0.0001\n      });\n      new SplitText(this.$fixedTitles[3], {\n        type: 'words',\n        wordsClass: 'word word--++'\n      });\n      gsap/* default.set */.ZP.set(this.$fixedTitles[3].children[0], {\n        opacity: 0.0001\n      });\n      gsap/* default.to */.ZP.to(this.$fixedTitles[0].children[0], {\n        opacity: 1,\n        ease: 'power2.out',\n        duration: 0.1\n      });\n    }\n  }, {\n    key: \"initSupertitlesMobile\",\n    value: function initSupertitlesMobile() {\n      var _this = this;\n\n      // Mision\n      this.superTrigger.create({\n        trigger: this.$mision,\n        scrub: true,\n        start: 'top top+=100',\n        end: 'bottom 110%',\n        onEnter: function onEnter() {\n          gsap/* default.to */.ZP.to(_this.$fixedTitles[0].children[0], {\n            opacity: 1,\n            ease: 'power2.out',\n            duration: 0.2\n          });\n        },\n        onLeave: function onLeave() {\n          gsap/* default.to */.ZP.to(_this.$fixedTitles[0].children[0], {\n            opacity: 0.0001,\n            ease: 'power2.out',\n            duration: 0.2\n          });\n        },\n        onEnterBack: function onEnterBack() {\n          gsap/* default.to */.ZP.to(_this.$fixedTitles[0].children[0], {\n            opacity: 1,\n            ease: 'power2.out',\n            duration: 0.2\n          });\n        },\n        onLeaveBack: function onLeaveBack() {\n          gsap/* default.to */.ZP.to(_this.$fixedTitles[0].children[0], {\n            opacity: 0.0001,\n            ease: 'power2.out',\n            duration: 0.2\n          });\n        }\n      }); // Vision\n\n      this.superTrigger.create({\n        trigger: this.$vision,\n        scrub: true,\n        start: 'top 50%',\n        end: 'bottom 110%',\n        onEnter: function onEnter() {\n          gsap/* default.to */.ZP.to(_this.$fixedTitles[1].children[0], {\n            opacity: 1,\n            ease: 'power2.out',\n            duration: 0.2\n          });\n        },\n        onLeave: function onLeave() {\n          gsap/* default.to */.ZP.to(_this.$fixedTitles[1].children[0], {\n            opacity: 0.0001,\n            ease: 'power2.out',\n            duration: 0.2\n          });\n        },\n        onEnterBack: function onEnterBack() {\n          gsap/* default.to */.ZP.to(_this.$fixedTitles[1].children[0], {\n            opacity: 1,\n            ease: 'power2.out',\n            duration: 0.2\n          });\n        },\n        onLeaveBack: function onLeaveBack() {\n          gsap/* default.to */.ZP.to(_this.$fixedTitles[1].children[0], {\n            opacity: 0.0001,\n            ease: 'power2.out',\n            duration: 0.2\n          });\n        }\n      }); // Assets\n\n      this.superTrigger.create({\n        trigger: this.$assets,\n        scrub: true,\n        start: 'top 50%',\n        end: 'bottom 110%',\n        onEnter: function onEnter() {\n          gsap/* default.to */.ZP.to(_this.$fixedTitles[2].children[0], {\n            opacity: 1,\n            ease: 'power2.out',\n            duration: 0.2\n          });\n        },\n        onLeave: function onLeave() {\n          gsap/* default.to */.ZP.to(_this.$fixedTitles[2].children[0], {\n            opacity: 0.0001,\n            ease: 'power2.out',\n            duration: 0.2\n          });\n        },\n        onEnterBack: function onEnterBack() {\n          gsap/* default.to */.ZP.to(_this.$fixedTitles[2].children[0], {\n            opacity: 1,\n            ease: 'power2.out',\n            duration: 0.2\n          });\n        },\n        onLeaveBack: function onLeaveBack() {\n          gsap/* default.to */.ZP.to(_this.$fixedTitles[2].children[0], {\n            opacity: 0.0001,\n            ease: 'power2.out',\n            duration: 0.2\n          });\n        }\n      }); // Principles\n\n      this.superTrigger.create({\n        trigger: this.$principles,\n        scrub: true,\n        start: 'top 35%',\n        end: 'bottom 110%',\n        onEnter: function onEnter() {\n          gsap/* default.to */.ZP.to(_this.$fixedTitles[3].children[0], {\n            opacity: 1,\n            ease: 'power2.out',\n            duration: 0.2\n          });\n        },\n        onLeave: function onLeave() {\n          gsap/* default.to */.ZP.to(_this.$fixedTitles[3].children[0], {\n            opacity: 0.0001,\n            ease: 'power2.out',\n            duration: 0.2\n          });\n        },\n        onEnterBack: function onEnterBack() {\n          gsap/* default.to */.ZP.to(_this.$fixedTitles[3].children[0], {\n            opacity: 1,\n            ease: 'power2.out',\n            duration: 0.2\n          });\n        },\n        onLeaveBack: function onLeaveBack() {\n          gsap/* default.to */.ZP.to(_this.$fixedTitles[3].children[0], {\n            opacity: 0.0001,\n            ease: 'power2.out',\n            duration: 0.2\n          });\n        }\n      });\n    }\n  }, {\n    key: \"initPrinciples\",\n    value: function initPrinciples() {\n      this.principlesTimelines = [];\n\n      for (var i = 0; i < this.$principlesItems.length; i++) {\n        gsap/* default.set */.ZP.set(this.$principlesItems[i].querySelector('.background__bg'), {\n          y: this.appStore.isDesktop ? -window.innerHeight + 200 : -(window.innerHeight * 0.5) + 200,\n          scale: 1.2\n        }, 0);\n        gsap/* default.set */.ZP.set(this.$principlesItems[i].querySelector('.background__mask'), {\n          opacity: 1\n        }, 0);\n        var principleTimeline = gsap/* default.timeline */.ZP.timeline({\n          defaults: {\n            ease: 'none'\n          },\n          scrollTrigger: {\n            trigger: this.$principlesItems[i].querySelector('.background'),\n            scrub: true,\n            start: 'top bottom',\n            end: 'bottom bottom' //end: 'top+=' + window.innerHeight + ' bottom'\n\n          }\n        });\n        principleTimeline.to(this.$principlesItems[i].querySelector('.background__bg'), {\n          y: 0,\n          scale: 1\n        }, 0);\n        principleTimeline.to(this.$principlesItems[i].querySelector('.background__mask'), {\n          opacity: 0.0001,\n          duration: 0.5\n        }, 0);\n        this.principlesTimelines.push(principleTimeline);\n      }\n    }\n  }, {\n    key: \"raf\",\n    value: function raf() {} // eslint-disable-line\n\n  }]);\n\n  return RendererPhilosophy;\n}(renderer); // Don`t forget to export your renderer\n\n\n/* harmony default export */ const rendererPhilosophy = (RendererPhilosophy);\n;// CONCATENATED MODULE: ./app/src/js/renderers/rendererPromotions.js\nfunction rendererPromotions_typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { rendererPromotions_typeof = function _typeof(obj) { return typeof obj; }; } else { rendererPromotions_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return rendererPromotions_typeof(obj); }\n\nfunction rendererPromotions_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction rendererPromotions_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction rendererPromotions_createClass(Constructor, protoProps, staticProps) { if (protoProps) rendererPromotions_defineProperties(Constructor.prototype, protoProps); if (staticProps) rendererPromotions_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction rendererPromotions_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) rendererPromotions_setPrototypeOf(subClass, superClass); }\n\nfunction rendererPromotions_setPrototypeOf(o, p) { rendererPromotions_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return rendererPromotions_setPrototypeOf(o, p); }\n\nfunction rendererPromotions_createSuper(Derived) { var hasNativeReflectConstruct = rendererPromotions_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = rendererPromotions_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = rendererPromotions_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return rendererPromotions_possibleConstructorReturn(this, result); }; }\n\nfunction rendererPromotions_possibleConstructorReturn(self, call) { if (call && (rendererPromotions_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return rendererPromotions_assertThisInitialized(self); }\n\nfunction rendererPromotions_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction rendererPromotions_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction rendererPromotions_getPrototypeOf(o) { rendererPromotions_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return rendererPromotions_getPrototypeOf(o); }\n\n// Gsap\n\n\ngsap/* default.registerPlugin */.ZP.registerPlugin(ScrollTrigger/* default */.Z); // Import Renderer\n\n // import stylesDefault from './stylesDefault.css'; //eslint-disable-line\n// Utilities\n\n\n\n\n // Other\n// import Slider from '../classes/slider';\n\n\n\nvar RendererPromotions = /*#__PURE__*/function (_Renderer) {\n  rendererPromotions_inherits(RendererPromotions, _Renderer);\n\n  var _super = rendererPromotions_createSuper(RendererPromotions);\n\n  function RendererPromotions() {\n    rendererPromotions_classCallCheck(this, RendererPromotions);\n\n    return _super.apply(this, arguments);\n  }\n\n  rendererPromotions_createClass(RendererPromotions, [{\n    key: \"selectors\",\n    value: function selectors() {\n      this.$promotions = this.$el.querySelectorAll('.promotion');\n      this.$slider = this.$el.querySelector('.slider');\n      this.$sliderInner = this.$slider.querySelector('.slider__inner');\n      this.$sliderScrollbar = this.$slider.querySelector('.slider__scrollbar');\n    }\n  }, {\n    key: \"events\",\n    value: function events() {\n      this.splitTexts = [];\n      this.scrollTriggers = [];\n\n      for (var i = 0; i < this.$promotions.length; i++) {\n        this.promotionInit(this.$promotions[i]);\n      }\n    }\n  }, {\n    key: \"scroll\",\n    value: function scroll() {\n      var _this = this;\n\n      if (this.$sliderInner) {\n        if (this.appStore.isDesktop) {\n          // Superscroller\n          this.sliderScroller = new _default({\n            mode: 'horizontal',\n            scroll: true,\n            scrollTarget: this.$sliderInner,\n            bar: false\n          });\n          if (this.appUi.$headerLogo) gsap/* default.to */.ZP.to(this.appUi.$headerLogo, {\n            y: 0,\n            ease: 'expo.out'\n          });\n        } else {\n          // this.superTrigger = ScrollTrigger;\n          this.superTrigger = ScrollTrigger/* default */.Z;\n          this.superTrigger.refresh();\n          gsap/* default.ticker.add */.ZP.ticker.add(function () {\n            _this.requestAnimationFrame();\n          });\n          this.superTriggerTl = gsap/* default.timeline */.ZP.timeline({\n            defaults: {\n              ease: 'none'\n            },\n            scrollTrigger: {\n              trigger: this.$app,\n              scrub: true,\n              start: 'top top',\n              end: 'bottom bottom',\n              onUpdate: function onUpdate(self) {\n                _this.superScrollerMobile = self.progress * self.end; // if(this.appUi.$header)\n                //     gsap.to(this.appUi.$header, { y: -(self.progress * this.$el.getBoundingClientRect().height) });\n                // if(this.appUi.$logo)\n                //     gsap.to(this.appUi.$logo, { y: -(self.progress * this.$el.getBoundingClientRect().height) / 2 });\n                // if(this.appUi.$headerTriggerText && !this.appStore.isDesktop)\n                //     gsap.to(this.appUi.$headerTriggerText, { y: -(self.progress * this.$el.getBoundingClientRect().height) / 2 });\n              }\n            }\n          });\n        }\n      }\n    } // beforeEnter()\n    // {\n    //     if(this.appStore.isDesktop)\n    //     {\n    //         for(let i = 0; i < this.$promotions.length; i++)\n    //             gsap.set(this.$promotions[i], { x: '20vw', opacity: 0.0001 });\n    //     }\n    // }\n    // enter()\n    // {\n    //     if(this.appStore.isDesktop)\n    //     {\n    //         for(let i = 0; i < this.$promotions.length; i++)\n    //             gsap.to(this.$promotions[i], { x: '0vw', opacity: 1, duration: 2, ease: 'expo.out', delay: i * 0.2 });\n    //     }\n    //     else\n    //     {\n    //         // Animate first promotion numbers in mobile\n    //         const pending = this.$promotions[0].querySelector('.pending').dataset.value;\n    //         const pendingSplit = pending.split('');\n    //         for(let i = 0; i < pendingSplit.length; i++)\n    //             gsap.to(this.$promotions[0].querySelector('.pending').querySelectorAll('.number')[i], { y: -((pendingSplit[i] * 100)) + '%', opacity: 1, ease: 'expo.out', duration: 2, delay: 1 + (i * 0.01) });\n    //     }\n    //     if(!this.appStore.isDesktop)\n    //         this.initPromotionMobile();\n    // }\n\n  }, {\n    key: \"beforeEnter\",\n    value: function beforeEnter() {\n      if (this.appStore.isDesktop) {\n        // Set promotions\n        for (var i = 0; i < this.$promotions.length; i++) {\n          gsap/* default.set */.ZP.set(this.$promotions[i], {\n            y: '-2.5vw',\n            willChange: 'transform'\n          });\n        }\n      }\n    }\n  }, {\n    key: \"preenter\",\n    value: function preenter() {\n      if (this.appStore.isDesktop) {\n        // Init promotions\n        for (var i = 0; i < this.$promotions.length; i++) {\n          gsap/* default.to */.ZP.to(this.$promotions[i], {\n            y: '0vw',\n            duration: 1,\n            delay: i * 0.05,\n            ease: 'expo.out',\n            clearProps: 'willChange'\n          });\n        }\n      }\n    }\n  }, {\n    key: \"enter\",\n    value: function enter() {\n      var _this2 = this;\n\n      if (!this.appStore.isDesktop) {\n        gsap/* default.to */.ZP.to(this.$promotions[0].querySelector('.pending'), {\n          opacity: 1,\n          ease: 'expo.out',\n          duration: 2\n        });\n        var pending = this.$promotions[0].querySelector('.pending').dataset.value;\n        var pendingSplit = pending.split('');\n\n        for (var j = 0; j < pendingSplit.length; j++) {\n          gsap/* default.to */.ZP.to(this.$promotions[0].querySelector('.pending').querySelectorAll('.number')[j], {\n            y: (9 - pendingSplit[j]) * 100 + 100 + '%',\n            opacity: 1,\n            ease: 'expo.out',\n            duration: 2,\n            delay: j * 0.1\n          });\n        }\n      }\n\n      if (this.appStore.isDesktop) {\n        for (var i = 0; i < this.$promotions.length; i++) {\n          this.domEvents.add(this.$promotions[i], 'mouseenter', function (e, a, el) {\n            _this2.promotionEnter(el);\n          });\n          this.domEvents.add(this.$promotions[i], 'mouseleave', function (e, a, el) {\n            _this2.promotionLeave(el);\n          });\n        }\n      }\n    }\n  }, {\n    key: \"promotionInit\",\n    value: function promotionInit(el) {\n      if (this.appStore.isDesktop) {\n        var firstLabel = el.querySelector('.label--1');\n        var firstLabelSplit = new SplitText(firstLabel, {\n          type: 'lines, words',\n          linesClass: 'line line--++',\n          wordsClass: 'word word--++',\n          charsClass: 'char char--++'\n        }); // eslint-disable-line\n\n        this.splitTexts.push(firstLabelSplit);\n        firstLabel.classList.add('split');\n        var firstLabelWords = el.querySelectorAll('.label--1 .word');\n\n        for (var j = 0; j < firstLabelWords.length; j++) {\n          gsap/* default.set */.ZP.set(firstLabelWords[j], {\n            y: '0%'\n          });\n        }\n\n        var secondLabel = el.querySelector('.label--2');\n        var secondLabelSplit = new SplitText(secondLabel, {\n          type: 'lines, words',\n          linesClass: 'line line--++',\n          wordsClass: 'word word--++',\n          charsClass: 'char char--++'\n        }); // eslint-disable-line\n\n        this.splitTexts.push(secondLabelSplit);\n        secondLabel.classList.add('split');\n        var secondLabelWords = el.querySelectorAll('.label--2 .word');\n\n        for (var _j = 0; _j < secondLabelWords.length; _j++) {\n          gsap/* default.set */.ZP.set(secondLabelWords[_j], {\n            y: '100%'\n          });\n        }\n      } else {\n        var promotionTrigger = ScrollTrigger/* default.create */.Z.create({\n          defaults: {\n            ease: 'none'\n          },\n          trigger: el.querySelector('.pending'),\n          start: 'top bottom',\n          once: true,\n          onEnter: function onEnter() {\n            gsap/* default.set */.ZP.set(el.querySelector('.pending'), {\n              display: 'flex'\n            });\n            var pending = el.querySelector('.pending').dataset.value;\n            var pendingSplit = pending.split('');\n            gsap/* default.to */.ZP.to(el.querySelector('.pending'), {\n              opacity: 1,\n              ease: 'expo.out',\n              duration: 2\n            });\n\n            for (var i = 0; i < pendingSplit.length; i++) {\n              gsap/* default.to */.ZP.to(el.querySelector('.pending').querySelectorAll('.number')[i], {\n                y: (9 - pendingSplit[i]) * 100 + 100 + '%',\n                opacity: 1,\n                ease: 'expo.out',\n                duration: 2,\n                delay: i * 0.1\n              });\n            } // gsap.to(el.querySelector('.pending'), { opacity: 1, ease: 'expo.out', duration: 2 });\n            // const pending = el.querySelector('.pending').dataset.value;\n            // const pendingSplit = pending.split('');\n            // for(let j = 0; j < pendingSplit.length; j++)\n            //     gsap.to(el.querySelector('.pending').querySelectorAll('.number')[j], { y: (((9 - pendingSplit[j]) * 100) + 100) + '%', opacity: 1, ease: 'expo.out', duration: 2, delay: j * 0.1 });\n\n          }\n        });\n        this.scrollTriggers.push(promotionTrigger);\n      }\n    }\n  }, {\n    key: \"promotionEnter\",\n    value: function promotionEnter(el) {\n      gsap/* default.killTweensOf */.ZP.killTweensOf([el.querySelector('.outer'), el.querySelector('.pending')]);\n      gsap/* default.set */.ZP.set(el.querySelector('.pending'), {\n        display: 'flex'\n      });\n      gsap/* default.set */.ZP.set(el.querySelector('.outer'), {\n        display: 'block'\n      });\n      var pending = el.querySelector('.pending').dataset.value;\n      var pendingSplit = pending.split('');\n      gsap/* default.to */.ZP.to(el.querySelector('.pending'), {\n        opacity: 1,\n        ease: 'expo.out',\n        duration: 2\n      });\n\n      for (var i = 0; i < pendingSplit.length; i++) {\n        gsap/* default.to */.ZP.to(el.querySelector('.pending').querySelectorAll('.number')[i], {\n          y: (9 - pendingSplit[i]) * 100 + 100 + '%',\n          opacity: 1,\n          ease: 'expo.out',\n          duration: 2,\n          delay: i * 0.1\n        });\n      }\n\n      gsap/* default.to */.ZP.to(el.querySelector('.outer .background__bg'), {\n        scale: 1,\n        opacity: 1,\n        ease: 'expo.out',\n        duration: 0.6\n      });\n      gsap/* default.to */.ZP.to(el.querySelector('.outer .background__overlay'), {\n        opacity: 0.5,\n        ease: 'expo.out',\n        duration: 0.6\n      });\n      gsap/* default.to */.ZP.to(el.querySelector('.inner .background__bg'), {\n        scale: 1,\n        ease: 'expo.out',\n        duration: 0.6\n      });\n      gsap/* default.to */.ZP.to(el.querySelector('.inner .mask'), {\n        opacity: 1,\n        ease: 'expo.out',\n        duration: 0.6\n      });\n      gsap/* default.to */.ZP.to(el.querySelector('.inner .info'), {\n        color: '#fff',\n        ease: 'expo.out',\n        duration: 0.6\n      });\n\n      if (this.appStore.isDesktop) {\n        var firstLabelWords = el.querySelectorAll('.label--1 .word');\n\n        for (var _i = 0; _i < firstLabelWords.length; _i++) {\n          gsap/* default.to */.ZP.to(firstLabelWords[_i], {\n            y: '-100%',\n            ease: 'expo.out',\n            duration: 0.6\n          });\n        }\n\n        var secondLabelWords = el.querySelectorAll('.label--2 .word');\n\n        for (var _i2 = 0; _i2 < secondLabelWords.length; _i2++) {\n          gsap/* default.to */.ZP.to(secondLabelWords[_i2], {\n            y: '0%',\n            ease: 'expo.out',\n            duration: 0.6\n          });\n        }\n      }\n    }\n  }, {\n    key: \"promotionLeave\",\n    value: function promotionLeave(el) {\n      var pending = el.querySelector('.pending').dataset.value;\n      var pendingSplit = pending.split('');\n      gsap/* default.to */.ZP.to(el.querySelector('.pending'), {\n        opacity: 0.0001,\n        ease: 'expo.out',\n        duration: 0.4,\n        onComplete: function onComplete() {\n          for (var i = 0; i < pendingSplit.length; i++) {\n            gsap/* default.killTweensOf */.ZP.killTweensOf(el.querySelector('.pending').querySelectorAll('.number')[i]);\n            gsap/* default.set */.ZP.set(el.querySelector('.pending').querySelectorAll('.number')[i], {\n              y: '0%'\n            });\n          }\n        }\n      });\n      gsap/* default.to */.ZP.to(el.querySelector('.outer .background__bg'), {\n        scale: 1.1,\n        opacity: 0.0001,\n        ease: 'expo.out',\n        duration: 0.6\n      });\n      gsap/* default.to */.ZP.to(el.querySelector('.outer .background__overlay'), {\n        opacity: 0.0001,\n        ease: 'expo.out',\n        duration: 0.6\n      });\n      gsap/* default.to */.ZP.to(el.querySelector('.inner .background__bg'), {\n        scale: 1.1,\n        ease: 'expo.out',\n        duration: 0.6\n      });\n      gsap/* default.to */.ZP.to(el.querySelector('.inner .mask'), {\n        opacity: 0.0001,\n        ease: 'expo.out',\n        duration: 0.6\n      });\n      gsap/* default.to */.ZP.to(el.querySelector('.inner .info'), {\n        color: '#000',\n        ease: 'expo.out',\n        duration: 0.6\n      });\n      gsap/* default.set */.ZP.set(el.querySelector('.outer'), {\n        display: 'block',\n        delay: 0.6\n      });\n      gsap/* default.set */.ZP.set(el.querySelector('.pending'), {\n        display: 'none',\n        delay: 0.6\n      });\n\n      if (this.appStore.isDesktop) {\n        var firstLabelWords = el.querySelectorAll('.label--1 .word');\n\n        for (var i = 0; i < firstLabelWords.length; i++) {\n          gsap/* default.to */.ZP.to(firstLabelWords[i], {\n            y: '0%',\n            ease: 'expo.out',\n            duration: 0.6\n          });\n        }\n\n        var secondLabelWords = el.querySelectorAll('.label--2 .word');\n\n        for (var _i3 = 0; _i3 < secondLabelWords.length; _i3++) {\n          gsap/* default.to */.ZP.to(secondLabelWords[_i3], {\n            y: '100%',\n            ease: 'expo.out',\n            duration: 0.6\n          });\n        }\n      }\n    } // promotionClick(e, el, clicked)\n    // {\n    //     if(e.shiftKey || e.ctrlKey || e.metaKey)\n    //         return;\n    //     this.clickedDone = true;\n    //     this.clicked = clicked;\n    //     for(let i = 0; i < this.$promotions.length; i++)\n    //     {\n    //         // if(i !== clicked)\n    //         // {\n    //             gsap.to(this.$promotions[i].querySelector('.inner .mask'), { opacity: 0.0001, duration: 0.2 });\n    //             gsap.to(this.$promotions[i].querySelector('.inner .info'), { opacity: 0.0001, ease: 'expo.out', duration: 1 });\n    //             gsap.to(this.$promotions[i].querySelector('.outer .background'), { y: '100%', ease: 'expo.inOut', duration: 1 });\n    //             gsap.to(this.$promotions[i].querySelector('.outer .background .background__bg'), { y: '-100%', scale: 1, ease: 'expo.inOut', duration: 1 });\n    //             gsap.to(this.$promotions[i].querySelector('.inner .background'), { y: '100%', ease: 'expo.inOut', duration: 1 });\n    //             gsap.to(this.$promotions[i].querySelector('.inner .background .background__bg'), { y: '-100%', scale: 1, ease: 'expo.inOut', duration: 1 });\n    //             gsap.delayedCall(1, () =>\n    //             {\n    //                 gsap.to(this.$promotions[i], { opacity: 0.0001 });\n    //             });\n    //         // }\n    //     }\n    // }\n\n  }, {\n    key: \"resize\",\n    value: function resize() {\n      if (this.sliderScroller) this.sliderScroller.resize();\n    }\n  }]);\n\n  return RendererPromotions;\n}(renderer); // Don`t forget to export your renderer\n\n\n/* harmony default export */ const rendererPromotions = (RendererPromotions);\n;// CONCATENATED MODULE: ./app/src/js/components/slider.js\nfunction slider_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction slider_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction slider_createClass(Constructor, protoProps, staticProps) { if (protoProps) slider_defineProperties(Constructor.prototype, protoProps); if (staticProps) slider_defineProperties(Constructor, staticProps); return Constructor; }\n\n//utilities\n\n //import WheelIndicator from 'wheel-indicator';\n//utilities\n\n\n\nvar slider_noop = function noop() {}; // eslint-disable-line\n\n\nvar slider_default = /*#__PURE__*/function () {\n  function _default(options) {\n    slider_classCallCheck(this, _default);\n\n    // hook functions\n    this._onSet = options.onSet || slider_noop;\n    this._onUnset = options.onUnset || slider_noop;\n    this._onChange = options.onChange || slider_noop;\n    this.domEvents = new domEvents_default();\n    this.lightbox = {\n      target: options.target,\n      current: 0,\n      total: 0,\n      direction: 'next',\n      directionValue: 100,\n      directionValue2: 70,\n      directionText: 100,\n      dir: 1,\n      progress: 0,\n      prev: 0,\n      next: 0,\n      duration: typeof options.duration !== 'undefined' ? options.duration : 1,\n      totalDuration: 1,\n      ease: 'expo.inOut',\n      animating: false,\n      tlAnimation: null\n    }; //asignamos el selector\n\n    this.$el = options.el;\n    this.$mySplitText = null;\n    this.selectors();\n    this.events();\n    this.init();\n  }\n\n  slider_createClass(_default, [{\n    key: \"selectors\",\n    value: function selectors() {\n      this.$lightbox = this.lightbox.target;\n      this.$lightboxMask = this.$lightbox.querySelector('.lightbox__mask');\n      this.$lightboxInner = this.$lightbox.querySelector('.lightbox__inner');\n      this.$lightboxInnerItems = this.$lightboxInner.querySelectorAll('.lightbox__item');\n      this.$lightboxPrev = this.$lightbox.querySelector('.lightbox__prev');\n      this.$lightboxNext = this.$lightbox.querySelector('.lightbox__next');\n      this.$lightboxClose = this.$lightbox.querySelector('.lightbox__close');\n    }\n  }, {\n    key: \"events\",\n    value: function events() {\n      var _this = this;\n\n      this.domEvents.add(this.$lightboxPrev, 'click', function () {\n        _this.change('prev');\n      });\n      this.domEvents.add(this.$lightboxNext, 'click', function () {\n        _this.change('next');\n      });\n      this.domEvents.add(this.$lightboxClose, 'click', function () {\n        _this.unset();\n      });\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      //Set total count\n      this.lightbox.total = this.$lightboxInnerItems.length;\n\n      for (var i = 0; i < this.$lightboxInnerItems.length; i++) {\n        gsap/* default.set */.ZP.set(this.$lightboxInnerItems[i], {\n          display: 'none'\n        });\n      }\n\n      gsap/* default.set */.ZP.set(this.$lightboxInnerItems[0], {\n        display: 'block'\n      });\n    }\n  }, {\n    key: \"set\",\n    value: function set(index) {\n      this._onSet(index);\n\n      gsap/* default.set */.ZP.set(this.$lightboxInnerItems[this.lightbox.prev], {\n        display: 'none'\n      });\n      gsap/* default.set */.ZP.set(this.$lightbox, {\n        display: 'block'\n      });\n      gsap/* default.to */.ZP.to(this.$lightboxMask, {\n        opacity: 1,\n        ease: 'expo.out',\n        duration: 1\n      });\n      gsap/* default.to */.ZP.to(this.$lightboxInner, {\n        opacity: 1,\n        ease: 'expo.out',\n        duration: 1,\n        delay: 0.5\n      });\n      gsap/* default.set */.ZP.set(this.$lightboxInnerItems[index], {\n        display: 'block'\n      }); // gsap.set(this.$lightboxInnerItems[index].querySelector('.background'), { x: '0%', y: '-100%' });\n      // gsap.set(this.$lightboxInnerItems[index].querySelector('.background .background__bg'), { y: '100%' });\n      // gsap.to(this.$lightboxInnerItems[index].querySelector('.background'), { y: '0%', duration: 1, ease: 'expo.out', delay: 0.5 });\n      // gsap.to(this.$lightboxInnerItems[index].querySelector('.background .background__bg'), { y: '0%', duration: 1, ease: 'expo.out', delay: 0.5 });\n\n      gsap/* default.to */.ZP.to([this.$lightboxPrev, this.$lightboxNext, this.$lightboxClose], {\n        opacity: 1,\n        duration: 1,\n        ease: 'expo.out',\n        delay: 0.5\n      });\n      this.lightbox.current = index;\n    }\n  }, {\n    key: \"unset\",\n    value: function unset() {\n      var _this2 = this;\n\n      this._onUnset(this.lightbox.current); // gsap.to(this.$lightboxInnerItems[this.lightbox.current].querySelector('.background'), { y: '100%', duration: 1, ease: 'expo.out', delay: 0 });\n      // gsap.to(this.$lightboxInnerItems[this.lightbox.current].querySelector('.background .background__bg'), { y: '-100%', duration: 1, ease: 'expo.out', delay: 0 });\n\n\n      gsap/* default.to */.ZP.to([this.$lightboxPrev, this.$lightboxNext, this.$lightboxClose], {\n        opacity: 0.0001,\n        duration: 1,\n        ease: 'expo.out',\n        delay: 0\n      });\n      gsap/* default.to */.ZP.to(this.$lightboxMask, {\n        opacity: 0.0001,\n        ease: 'expo.out',\n        duration: 1,\n        delay: 0.5\n      });\n      gsap/* default.to */.ZP.to(this.$lightboxInner, {\n        opacity: 0.0001,\n        ease: 'expo.out',\n        duration: 1\n      });\n      gsap/* default.delayedCall */.ZP.delayedCall(1.5, function () {\n        gsap/* default.set */.ZP.set(_this2.$lightbox, {\n          display: 'none'\n        });\n        gsap/* default.set */.ZP.set(_this2.$lightboxInnerItems[_this2.lightbox.current], {\n          display: 'none'\n        });\n        gsap/* default.set */.ZP.set(_this2.$lightboxInnerItems[_this2.lightbox.current].querySelector('.background'), {\n          y: '0%'\n        });\n        gsap/* default.set */.ZP.set(_this2.$lightboxInnerItems[_this2.lightbox.current].querySelector('.background .background__bg'), {\n          y: '0%'\n        });\n      });\n    }\n  }, {\n    key: \"change\",\n    value: function change(direction) {\n      var _this3 = this;\n\n      if (this.lightbox.animating) return;\n\n      this._onChange();\n\n      this.lightbox.animating = true;\n      this.lightbox.direction = direction;\n\n      if (direction === 'next') {\n        this.lightbox.next = (this.lightbox.current + 1) % this.lightbox.total;\n        this.lightbox.prev = this.lightbox.current === -1 ? this.lightbox.total - 1 : this.lightbox.current;\n        this.lightbox.dir = true;\n      } else {\n        this.lightbox.next = this.lightbox.current === 0 ? this.lightbox.total - 1 : this.lightbox.current - 1;\n        this.lightbox.prev = this.lightbox.current === -1 ? this.lightbox.total - 1 : this.lightbox.current;\n        this.lightbox.dir = false;\n      }\n\n      this.lightbox.current = this.lightbox.next; //Set next slide\n\n      gsap/* default.set */.ZP.set(this.$lightboxInnerItems[this.lightbox.next].querySelector('.background'), {\n        x: this.lightbox.dir ? '100%' : '-100%'\n      });\n      gsap/* default.set */.ZP.set(this.$lightboxInnerItems[this.lightbox.next], {\n        display: 'block'\n      }); //Animate out current slide\n\n      gsap/* default.to */.ZP.to(this.$lightboxInnerItems[this.lightbox.prev].querySelector('.background'), {\n        x: this.lightbox.dir ? '-100%' : '100%',\n        ease: 'expo.inOut',\n        duration: 1\n      });\n      gsap/* default.to */.ZP.to(this.$lightboxInnerItems[this.lightbox.next].querySelector('.background'), {\n        x: '0%',\n        ease: 'expo.inOut',\n        duration: 1\n      });\n      gsap/* default.delayedCall */.ZP.delayedCall(this.lightbox.duration, function () {\n        gsap/* default.set */.ZP.set(_this3.$lightboxInnerItems[_this3.lightbox.prev], {\n          display: 'none'\n        });\n        _this3.lightbox.animating = false;\n      });\n    }\n  }]);\n\n  return _default;\n}();\n\n\n;// CONCATENATED MODULE: ./app/src/js/renderers/rendererPromotionsSingle.js\nfunction rendererPromotionsSingle_typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { rendererPromotionsSingle_typeof = function _typeof(obj) { return typeof obj; }; } else { rendererPromotionsSingle_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return rendererPromotionsSingle_typeof(obj); }\n\nfunction rendererPromotionsSingle_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction rendererPromotionsSingle_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction rendererPromotionsSingle_createClass(Constructor, protoProps, staticProps) { if (protoProps) rendererPromotionsSingle_defineProperties(Constructor.prototype, protoProps); if (staticProps) rendererPromotionsSingle_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction rendererPromotionsSingle_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) rendererPromotionsSingle_setPrototypeOf(subClass, superClass); }\n\nfunction rendererPromotionsSingle_setPrototypeOf(o, p) { rendererPromotionsSingle_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return rendererPromotionsSingle_setPrototypeOf(o, p); }\n\nfunction rendererPromotionsSingle_createSuper(Derived) { var hasNativeReflectConstruct = rendererPromotionsSingle_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = rendererPromotionsSingle_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = rendererPromotionsSingle_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return rendererPromotionsSingle_possibleConstructorReturn(this, result); }; }\n\nfunction rendererPromotionsSingle_possibleConstructorReturn(self, call) { if (call && (rendererPromotionsSingle_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return rendererPromotionsSingle_assertThisInitialized(self); }\n\nfunction rendererPromotionsSingle_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction rendererPromotionsSingle_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction rendererPromotionsSingle_getPrototypeOf(o) { rendererPromotionsSingle_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return rendererPromotionsSingle_getPrototypeOf(o); }\n\n// Gsap\n\n // import Masonry from 'masonry-layout';\n\ngsap/* default.registerPlugin */.ZP.registerPlugin(ScrollTrigger/* default */.Z); // Import Renderer\n\n // import stylesDefault from './stylesDefault.css'; //eslint-disable-line\n// Utilities\n\n\n\n // Other\n// import Slider from '../classes/slider';\n// import SplitText from '../classes/splitText';\n\nvar RendererPromotionsSingle = /*#__PURE__*/function (_Renderer) {\n  rendererPromotionsSingle_inherits(RendererPromotionsSingle, _Renderer);\n\n  var _super = rendererPromotionsSingle_createSuper(RendererPromotionsSingle);\n\n  function RendererPromotionsSingle() {\n    rendererPromotionsSingle_classCallCheck(this, RendererPromotionsSingle);\n\n    return _super.apply(this, arguments);\n  }\n\n  rendererPromotionsSingle_createClass(RendererPromotionsSingle, [{\n    key: \"selectors\",\n    value: function selectors() {\n      this.$hero = this.$el.querySelector('.promotionssingle__hero');\n      this.$background = this.$el.querySelector('.promotionssingle__background');\n      this.$content = this.$el.querySelector('.promotionssingle__content');\n      this.$featured = this.$el.querySelector('.promotionssingle__featured');\n      this.$gallery = this.$el.querySelector('.promotionssingle__gallery');\n      this.$from = this.$el.querySelector('.promotionssingle__from');\n      this.$related = this.$el.querySelector('.promotionssingle__related');\n      this.$form = this.$el.querySelector('.promotionssingle__form');\n      this.$footer = this.$el.querySelector('.promotionssingle__footer');\n    }\n  }, {\n    key: \"preload\",\n    value: function preload() {\n      // Preloader\n      var _main = [];\n      if (this.$hero.querySelector('.image img')) _main.push(this.$hero.querySelector('.image img').src);\n      var _secondary = [];\n      if (this.$background.querySelector('.background__bg')) _main.push(this.$background.querySelector('.background__bg').style.backgroundImage.substring(5, this.$background.querySelector('.background__bg').style.backgroundImage.length - 2));\n      if (this.$featured.querySelector('.background__bg')) _main.push(this.$featured.querySelector('.background__bg').style.backgroundImage.substring(5, this.$featured.querySelector('.background__bg').style.backgroundImage.length - 2));\n      this.preloadItems = {\n        main: _main,\n        secondary: _secondary\n      };\n    }\n  }, {\n    key: \"beforeEnter\",\n    value: function beforeEnter() {\n      // Hide drag after click\n      this.appUi.leaveDragCursor();\n\n      if (this.appStore.isDesktop) {\n        gsap/* default.set */.ZP.set(this.$hero.querySelector('.image'), {\n          y: '-100%'\n        });\n        gsap/* default.set */.ZP.set(this.$hero.querySelector('.image img'), {\n          y: '100%'\n        });\n      }\n\n      gsap/* default.set */.ZP.set(this.$hero.querySelector('.mask .bg'), {\n        scaleY: this.appStore.isDesktop ? 0 : 1\n      });\n      gsap/* default.set */.ZP.set(this.$hero.querySelector('.mask .center'), {\n        opacity: 0.0001\n      });\n    }\n  }, {\n    key: \"preenter\",\n    value: function preenter() {\n      if (this.appStore.isDesktop) {\n        gsap/* default.to */.ZP.to(this.$hero.querySelector('.image'), {\n          y: '0%',\n          duration: this.appStore.firstNavigation ? 1.8 : 1.8,\n          ease: this.appStore.firstNavigation ? 'expo.inOut' : 'expo.out',\n          delay: 0\n        });\n        gsap/* default.to */.ZP.to(this.$hero.querySelector('.image img'), {\n          y: '0%',\n          duration: this.appStore.firstNavigation ? 1.8 : 1.8,\n          ease: this.appStore.firstNavigation ? 'expo.inOut' : 'expo.out',\n          delay: 0\n        });\n      }\n\n      gsap/* default.to */.ZP.to(this.$hero.querySelector('.mask .bg'), {\n        scaleY: 1,\n        duration: this.appStore.firstNavigation ? 1.6 : 1.6,\n        ease: this.appStore.firstNavigation ? 'expo.inOut' : 'expo.out',\n        delay: this.appStore.firstNavigation ? 0.2 : 0.2\n      });\n      gsap/* default.to */.ZP.to(this.$hero.querySelector('.mask .center'), {\n        opacity: 1,\n        ease: 'power2.out',\n        duration: 0.8,\n        delay: 1\n      });\n    }\n  }, {\n    key: \"enter\",\n    value: function enter() {\n      this.appUi.$infoContent.querySelector('input[name=\"info-subject\"]').value = 'Información sobre ' + this.$hero.querySelector('.mask .center .title').getAttribute('data-title');\n      if (this.appStore.isDesktop) this.initScrolltitle();else this.initScrolltitleMobile();\n      this.initBackground();\n      this.initParallax();\n      this.initLightbox();\n      this.initGallery();\n      this.initRelated();\n    }\n  }, {\n    key: \"initScrolltitle\",\n    value: function initScrolltitle() {\n      var _this = this;\n\n      this.$scrolltitle = this.$el.querySelector('.scrolltitle');\n\n      if (this.$scrolltitle) {\n        this.$scrolltitleItems = this.$scrolltitle.children;\n        this.$scrolltitle.style.width = this.$scrolltitleItems[0].offsetWidth + 'px';\n        this.scrollTitleInnerLeft = gsap/* default.timeline */.ZP.timeline({\n          paused: false,\n          defaults: {\n            ease: 'none',\n            duration: this.$scrolltitleItems[0].offsetWidth / 300,\n            repeat: '-1',\n            onReverseComplete: function onReverseComplete() {\n              _this.scrollTitleInnerLeft.pause();\n\n              _this.scrollTitleInnerRight.play();\n            }\n          }\n        });\n\n        for (var i = 0; i < this.$scrolltitleItems.length; i++) {\n          this.scrollTitleInnerLeft.to(this.$scrolltitleItems[i], {\n            x: '-100%'\n          }, 0);\n        }\n\n        this.scrollTitleInnerRight = gsap/* default.timeline */.ZP.timeline({\n          paused: true,\n          defaults: {\n            ease: 'none',\n            duration: this.$scrolltitleItems[0].offsetWidth / 300,\n            repeat: '-1',\n            onReverseComplete: function onReverseComplete() {\n              _this.scrollTitleInnerRight.pause();\n\n              _this.scrollTitleInnerLeft.play();\n            }\n          }\n        });\n\n        for (var _i = 0; _i < this.$scrolltitleItems.length; _i++) {\n          this.scrollTitleInnerRight.to(this.$scrolltitleItems[_i], {\n            x: '100%'\n          }, 0);\n        }\n\n        this.scrollTitleOuter = gsap/* default.timeline */.ZP.timeline({\n          defaults: {\n            ease: 'none'\n          },\n          scrollTrigger: {\n            trigger: this.$scrolltitle,\n            scrub: true,\n            start: 'top bottom',\n            end: 'bottom top',\n            onUpdate: function onUpdate(self) {\n              // this.scrollTitleInner.timeScale(self.direction);\n              if (!_this.scrollTitleInnerLeft.paused()) _this.scrollTitleInnerLeft.reversed(self.direction !== 1);\n              if (!_this.scrollTitleInnerRight.paused()) _this.scrollTitleInnerRight.reversed(self.direction === 1);\n            }\n          }\n        });\n        this.scrollTitleOuter.fromTo(this.$scrolltitle, {\n          x: window.innerWidth * 0.2\n        }, {\n          x: -window.innerWidth * 0.2\n        }, 0);\n      }\n    }\n  }, {\n    key: \"initScrolltitleMobile\",\n    value: function initScrolltitleMobile() {\n      this.$scrolltitles = this.$el.querySelectorAll('.scrolltitle');\n\n      if (this.$scrolltitles) {\n        for (var i = 0; i < this.$scrolltitles.length; i++) {\n          this.$scrolltitlesItems = this.$scrolltitles[i].children[0].children;\n          this.scrollTitleTimeline = gsap/* default.timeline */.ZP.timeline({\n            paused: false,\n            defaults: {\n              ease: 'none',\n              duration: this.$scrolltitlesItems.length * 8 + i * 10,\n              repeat: '-1'\n            }\n          });\n          this.scrollTitleTimeline.to(this.$scrolltitles[i].children, {\n            x: -100 + '%'\n          }, 0);\n        }\n      }\n    }\n  }, {\n    key: \"initBackground\",\n    value: function initBackground() {\n      if (this.$background) {\n        gsap/* default.set */.ZP.set(this.$background.querySelector('.background .background__overlay'), {\n          opacity: 1\n        });\n        gsap/* default.set */.ZP.set(this.$background.querySelector('.background .background__bg'), {\n          y: '-80%',\n          scale: 1.2\n        });\n        var backgroundTimeline = gsap/* default.timeline */.ZP.timeline({\n          scrollTrigger: {\n            trigger: this.$background,\n            start: 'top bottom',\n            end: 'bottom top',\n            scrub: true // onToggle: (isActive) =>\n            // {\n            //     isActive ? this.$videoCover.querySelector('.video__player video').play() : this.$videoCover.querySelector('.video__player video').pause();\n            // }\n\n          },\n          defaults: {\n            duration: 1,\n            ease: 'none'\n          }\n        });\n        backgroundTimeline.to(this.$background.querySelector('.background .background__overlay'), {\n          opacity: 0.5,\n          duration: 0.5\n        }, 0);\n        backgroundTimeline.to(this.$background.querySelector('.background .background__bg'), {\n          y: '80%',\n          scale: 1,\n          duration: 1\n        }, 0);\n      }\n    }\n  }, {\n    key: \"initParallax\",\n    value: function initParallax() {\n      if (this.$content) {\n        gsap/* default.set */.ZP.set(this.$content.querySelector('.image--2'), {\n          y: '-5vw'\n        });\n        var contentTimeline = gsap/* default.timeline */.ZP.timeline({\n          scrollTrigger: {\n            trigger: this.$content,\n            start: 'top bottom',\n            end: 'bottom top',\n            scrub: true // onToggle: (isActive) =>\n            // {\n            //     isActive ? this.$videoCover.querySelector('.video__player video').play() : this.$videoCover.querySelector('.video__player video').pause();\n            // }\n\n          },\n          defaults: {\n            duration: 1,\n            ease: 'none'\n          }\n        });\n        contentTimeline.to(this.$content.querySelector('.image--2'), {\n          y: '5vw',\n          duration: 1\n        }, 0);\n      }\n\n      if (this.$featured) {\n        gsap/* default.set */.ZP.set(this.$featured.querySelector('.image'), {\n          y: '10vw'\n        });\n        var featuredTimeline = gsap/* default.timeline */.ZP.timeline({\n          scrollTrigger: {\n            trigger: this.$featured,\n            start: 'top bottom',\n            end: 'bottom top',\n            scrub: true // onToggle: (isActive) =>\n            // {\n            //     isActive ? this.$videoCover.querySelector('.video__player video').play() : this.$videoCover.querySelector('.video__player video').pause();\n            // }\n\n          },\n          defaults: {\n            duration: 1,\n            ease: 'none'\n          }\n        });\n        featuredTimeline.to(this.$featured.querySelector('.image'), {\n          y: '-10vw',\n          duration: 1\n        }, 0);\n      }\n    }\n  }, {\n    key: \"initLightbox\",\n    value: function initLightbox() {\n      var _this2 = this;\n\n      this.$lightbox = this.$el.querySelector('.lightbox');\n      this.lightbox = new slider_default({\n        target: this.$lightbox,\n        onUnset: function onUnset(index) {\n          _this2.closeLightbox(index);\n        }\n      });\n    }\n  }, {\n    key: \"initGallery\",\n    value: function initGallery() {\n      var _this3 = this;\n\n      if (this.$gallery) {\n        // Selectors\n        this.$galleryGrid = this.$gallery.querySelector('.grid');\n        this.$galleryGridInner = this.$gallery.querySelector('.grid__inner');\n        this.$galleryGridItems = this.$gallery.querySelectorAll('.grid__item');\n        this.$galleryButton = this.$gallery.querySelector('.button');\n        gsap/* default.set */.ZP.set(this.$galleryGrid, {\n          display: 'block'\n        });\n        this.domEvents.add(this.$galleryGrid, 'mouseenter', function (e, a, el) {\n          _this3.appUi.enterDragCursor();\n        });\n        this.domEvents.add(this.$galleryGrid, 'mouseleave', function (e, a, el) {\n          _this3.appUi.leaveDragCursor();\n        });\n        this.gallery = {\n          isZoomed: false,\n          isExpanded: false,\n          isAnimating: false,\n          count: 0,\n          margin: window.innerWidth * 0.05,\n          references: {\n            0: [15, 15, 0, 5],\n            1: [20, 15, 0, 25],\n            2: [20, 15, 20, 5],\n            3: [15, 10, 25, 25],\n            4: [30, 20, 45, 5],\n            5: [10, 15, 45, 30],\n            6: [15, 10, 60, 30],\n            7: [15, 10, 80, 5],\n            8: [20, 15, 80, 20],\n            9: [25, 40, 105, 5],\n            10: [15, 15, 135, 5],\n            11: [20, 15, 135, 25],\n            12: [20, 15, 155, 5],\n            13: [15, 10, 160, 25],\n            14: [30, 20, 180, 5],\n            15: [10, 15, 180, 30],\n            16: [15, 10, 195, 30],\n            17: [15, 10, 215, 5],\n            18: [20, 15, 215, 20]\n          },\n          relativeWidth: 0,\n          relativePositions: {},\n          absoluteWidth: 0,\n          absolutePositions: {}\n        };\n        this.gallery.count = this.$galleryGridItems.length; // Get absolute positions\n\n        for (var i = 0; i < this.$galleryGridItems.length; i++) {\n          var _width = window.innerWidth * this.gallery.references[i][0] / (this.appStore.isDeskop || this.appStore.client.orientation === 'horizontal' ? 100 : 50);\n\n          var _height = window.innerWidth * this.gallery.references[i][1] / (this.appStore.isDeskop || this.appStore.client.orientation === 'horizontal' ? 100 : 50);\n\n          var _left = window.innerWidth * this.gallery.references[i][2] / (this.appStore.isDeskop || this.appStore.client.orientation === 'horizontal' ? 100 : 50);\n\n          var _top = window.innerWidth * this.gallery.references[i][3] / (this.appStore.isDeskop || this.appStore.client.orientation === 'horizontal' ? 100 : 50);\n\n          var _ratio = 1 / ((window.innerHeight - window.innerWidth * 0.1) / _height);\n\n          var _multiplier = (window.innerHeight - window.innerWidth * 0.1) / _height;\n\n          this.gallery.absolutePositions[i] = [_width, _height, _left, _top, _ratio, _multiplier];\n        }\n\n        this.gallery.absoluteWidth = this.gallery.absolutePositions[this.gallery.count - 1][0] + this.gallery.absolutePositions[this.gallery.count - 1][2]; // Get relative positions\n\n        for (var _i2 = 0; _i2 < this.$galleryGridItems.length; _i2++) {\n          var _multiplier2 = this.gallery.absolutePositions[_i2][5];\n\n          var _width2 = _multiplier2 * this.gallery.absolutePositions[_i2][0];\n\n          var _height2 = _multiplier2 * this.gallery.absolutePositions[_i2][1];\n\n          var _left2 = _i2 === 0 ? 0 : this.gallery.relativePositions[_i2 - 1][2] + this.gallery.relativePositions[_i2 - 1][0] + this.gallery.margin;\n\n          var _top2 = window.innerWidth * 0.05;\n\n          this.gallery.relativePositions[_i2] = [_width2, _height2, _left2, _top2];\n        }\n\n        this.gallery.relativeWidth = this.gallery.relativePositions[this.gallery.count - 1][0] + this.gallery.relativePositions[this.gallery.count - 1][2]; // Set initial positions\n\n        var _loop = function _loop(_i3) {\n          if (_this3.gallery.isZoomed) {\n            _this3.$galleryGridItems[_i3].style.width = _this3.gallery.relativePositions[_i3][0] + 'px';\n            _this3.$galleryGridItems[_i3].style.height = _this3.gallery.relativePositions[_i3][1] + 'px';\n            _this3.$galleryGridItems[_i3].style.transform = 'translateX(' + _this3.gallery.relativePositions[_i3][2] + 'px) translateY(' + _this3.gallery.relativePositions[_i3][3] + 'px)';\n            _this3.$galleryGridItems[_i3].children[0].children[0].style.transform = 'scale(1)';\n          } else {\n            _this3.$galleryGridItems[_i3].style.width = _this3.gallery.relativePositions[_i3][0] + 'px';\n            _this3.$galleryGridItems[_i3].style.height = _this3.gallery.relativePositions[_i3][1] + 'px';\n            _this3.$galleryGridItems[_i3].style.transform = 'translateX(' + _this3.gallery.absolutePositions[_i3][2] + 'px) translateY(' + _this3.gallery.absolutePositions[_i3][3] + 'px) scale(' + _this3.gallery.absolutePositions[_i3][4] + ')';\n            _this3.$galleryGridItems[_i3].children[0].children[0].style.transform = 'scale(1.1)';\n          }\n\n          if (_this3.appStore.isDesktop) {\n            _this3.domEvents.add(_this3.$galleryGridItems[_i3], 'mouseenter', function (e, a, el) {\n              _this3.enterImage(el);\n            });\n\n            _this3.domEvents.add(_this3.$galleryGridItems[_i3], 'mouseleave', function (e, a, el) {\n              _this3.leaveImage(el);\n            });\n\n            _this3.domEvents.add(_this3.$galleryGridItems[_i3].querySelector('.expand'), 'mouseenter', function (e, a, el) {\n              _this3.enterExpand(el);\n            });\n\n            _this3.domEvents.add(_this3.$galleryGridItems[_i3].querySelector('.expand'), 'mouseleave', function (e, a, el) {\n              _this3.leaveExpand(el);\n            });\n\n            _this3.domEvents.add(_this3.$galleryGridItems[_i3].querySelector('.expand'), 'click', function (e, a, el) {\n              _this3.clickExpand(e, a, el, _i3);\n            });\n\n            _this3.domEvents.add(_this3.$galleryGridItems[_i3], 'click', function (e, a, el) {\n              if (_this3.gallery.isZoomed) _this3.compressGallery(_i3);else _this3.expandGallery(_i3);\n            });\n          } else {\n            _this3.domEvents.add(_this3.$galleryGridItems[_i3], 'click', function (e, a, el) {\n              _this3.clickExpand(e, a, el, _i3);\n            });\n          }\n        };\n\n        for (var _i3 = 0; _i3 < this.$galleryGridItems.length; _i3++) {\n          _loop(_i3);\n        }\n\n        if (!this.appStore.isDesktop) this.domEvents.add(this.$galleryButton, 'click', function (e, a, el) {\n          _this3.openLightbox(0);\n        });\n        if (this.gallery.isZoomed) this.$galleryGridInner.style.minWidth = this.gallery.relativeWidth + 'px';else this.$galleryGridInner.style.minWidth = this.gallery.absoluteWidth + 'px';\n\n        if (this.appStore.isDesktop) {\n          this.galleryDraggable = new superDragger_default({\n            el: this.$galleryGrid,\n            elClickables: this.$galleryGridItems,\n            inner: this.$galleryGridInner,\n            onDragStart: function onDragStart() {\n              if (!_this3.gallery.isZoomed && _this3.appStore.isDesktop) {\n                for (var _i4 = 0; _i4 < _this3.$galleryGridItems.length; _i4++) {\n                  gsap/* default.to */.ZP.to(_this3.$galleryGridItems[_i4].children[0].children[0], {\n                    scale: 1,\n                    ease: 'expo.out',\n                    duration: 1\n                  });\n                }\n              }\n\n              if (_this3.appStore.isDesktop) {\n                gsap/* default.to */.ZP.to(_this3.appUi.$cursorDot, {\n                  scale: 0.6,\n                  duration: 0.3,\n                  ease: 'expo.out'\n                });\n                gsap/* default.to */.ZP.to(_this3.appUi.$cursorDrag, {\n                  scale: 0.6,\n                  duration: 0.3,\n                  ease: 'expo.out'\n                });\n                gsap/* default.to */.ZP.to(_this3.appUi.$cursorDrag.children[0], {\n                  opacity: 0.0001,\n                  duration: 0.3,\n                  ease: 'expo.out'\n                });\n              }\n\n              _this3.gallery.dragging = true;\n            },\n            onDragEnd: function onDragEnd() {\n              if (!_this3.gallery.isZoomed && _this3.appStore.isDesktop) {\n                for (var _i5 = 0; _i5 < _this3.$galleryGridItems.length; _i5++) {\n                  gsap/* default.to */.ZP.to(_this3.$galleryGridItems[_i5].children[0].children[0], {\n                    scale: 1.1,\n                    ease: 'expo.out',\n                    duration: 1\n                  });\n                }\n              }\n\n              if (_this3.appStore.isDesktop) {\n                gsap/* default.to */.ZP.to(_this3.appUi.$cursorDot, {\n                  scale: 1,\n                  duration: 0.3,\n                  ease: 'expo.out'\n                });\n                gsap/* default.to */.ZP.to(_this3.appUi.$cursorDrag, {\n                  scale: 1,\n                  duration: 0.3,\n                  ease: 'expo.out'\n                });\n                gsap/* default.to */.ZP.to(_this3.appUi.$cursorDrag.children[0], {\n                  opacity: 1,\n                  duration: 0.3,\n                  ease: 'expo.out',\n                  delay: 0.1\n                });\n              }\n\n              _this3.gallery.dragging = false;\n            }\n          });\n        } else {\n          this.galleryDraggable = new Draggable_default({\n            target: this.$galleryGrid,\n            targetInner: this.$galleryGridInner,\n            onPress: function onPress() {\n              if (_this3.appStore.isDesktop) {\n                gsap/* default.to */.ZP.to(_this3.appUi.$cursorDot, {\n                  scale: 0.6,\n                  duration: 0.3,\n                  ease: 'expo.out'\n                });\n                gsap/* default.to */.ZP.to(_this3.appUi.$cursorDrag, {\n                  scale: 0.6,\n                  duration: 0.3,\n                  ease: 'expo.out'\n                });\n                gsap/* default.to */.ZP.to(_this3.appUi.$cursorDrag.children[0], {\n                  opacity: 0.0001,\n                  duration: 0.3,\n                  ease: 'expo.out'\n                });\n              }\n\n              _this3.gallery.dragging = true;\n            },\n            onRelease: function onRelease() {\n              if (_this3.appStore.isDesktop) {\n                gsap/* default.to */.ZP.to(_this3.appUi.$cursorDot, {\n                  scale: 1,\n                  duration: 0.3,\n                  ease: 'expo.out'\n                });\n                gsap/* default.to */.ZP.to(_this3.appUi.$cursorDrag, {\n                  scale: 1,\n                  duration: 0.3,\n                  ease: 'expo.out'\n                });\n                gsap/* default.to */.ZP.to(_this3.appUi.$cursorDrag.children[0], {\n                  opacity: 1,\n                  duration: 0.3,\n                  ease: 'expo.out',\n                  delay: 0.1\n                });\n              }\n\n              _this3.gallery.dragging = false;\n            },\n            onDragStart: function onDragStart(drag) {\n              if (!_this3.gallery.isZoomed && _this3.appStore.isDesktop) {\n                for (var _i6 = 0; _i6 < _this3.$galleryGridItems.length; _i6++) {\n                  gsap/* default.to */.ZP.to(_this3.$galleryGridItems[_i6].children[0].children[0], {\n                    scale: 1,\n                    ease: 'expo.out',\n                    duration: 1\n                  });\n                }\n              }\n            },\n            onDragEnd: function onDragEnd() {\n              if (!_this3.gallery.isZoomed && _this3.appStore.isDesktop) {\n                for (var _i7 = 0; _i7 < _this3.$galleryGridItems.length; _i7++) {\n                  gsap/* default.to */.ZP.to(_this3.$galleryGridItems[_i7].children[0].children[0], {\n                    scale: 1.1,\n                    ease: 'expo.out',\n                    duration: 1\n                  });\n                }\n              }\n            }\n          });\n        }\n\n        this.galleryTimeline = gsap/* default.timeline */.ZP.timeline({\n          defaults: {\n            ease: 'none'\n          },\n          scrollTrigger: {\n            trigger: this.$gallery,\n            scrub: true,\n            start: 'top bottom',\n            end: 'bottom top'\n          }\n        });\n        this.galleryTimeline.fromTo(this.$galleryGrid, {\n          x: window.innerWidth * 0.1\n        }, {\n          x: -window.innerWidth * 0.1\n        }, 0);\n      }\n    }\n  }, {\n    key: \"compressGallery\",\n    value: function compressGallery(index) {\n      var _this4 = this;\n\n      if (this.gallery.isExpanded) return;\n      gsap/* default.to */.ZP.to(this.appUi.$cursorPlus, {\n        scale: 0.7,\n        rotation: '0deg',\n        opacity: 1,\n        duration: 0.3,\n        ease: 'expo.out'\n      });\n      gsap/* default.to */.ZP.to(this.appUi.$cursorMinus, {\n        scale: 0.7,\n        rotation: '0deg',\n        opacity: 0.0001,\n        duration: 0.3,\n        ease: 'expo.out'\n      });\n\n      for (var i = 0; i < this.$galleryGridItems.length; i++) {\n        gsap/* default.killTweensOf */.ZP.killTweensOf(this.$galleryGridItems[i], this.$galleryGridItems[i].querySelector('.background .expand'));\n        var positions = this.gallery.absolutePositions[i];\n        var relativePositions = this.gallery.relativePositions[i];\n        gsap/* default.to */.ZP.to(this.$galleryGridItems[i], {\n          x: positions[2],\n          y: positions[3],\n          scale: positions[4],\n          duration: 1.4,\n          ease: 'expo.inOut'\n        });\n        gsap/* default.to */.ZP.to(this.$galleryGridItems[i].children[0].children[0], {\n          scale: 1.1,\n          duration: 1.4,\n          ease: 'expo.inOut'\n        });\n        gsap/* default.to */.ZP.to(this.$galleryGridItems[i].querySelector('.background .expand'), {\n          opacity: 0.0001,\n          duration: 0.2,\n          ease: 'power2.out'\n        });\n      }\n\n      this.$galleryGridInner.style.minWidth = this.gallery.absoluteWidth + 'px';\n      var $el = this.gallery.absolutePositions[index];\n      var center = $el[2] - window.innerWidth / 2 + $el[0] / 2;\n      var _maxX = 0;\n\n      var _minX = -(this.gallery.absoluteWidth - window.innerWidth);\n\n      var _center = Math.min(_maxX, Math.max(_minX, -center));\n\n      if (this.appStore.isDesktop) gsap/* default.to */.ZP.to([this.galleryDraggable._drag.livePosition, this.galleryDraggable._drag.position, this.galleryDraggable._drag.lastPosition], {\n        x: _center,\n        duration: 1.4,\n        ease: 'expo.inOut'\n      });\n      gsap/* default.to */.ZP.to(this.$galleryGridInner, {\n        x: _center,\n        duration: 1.4,\n        ease: 'expo.inOut',\n        onComplete: function onComplete() {\n          if (_this4.appStore.isDesktop) _this4.galleryDraggable.resize();else _this4.galleryDraggable.draggable[0].applyBounds();\n        }\n      });\n      this.gallery.isZoomed = false;\n    }\n  }, {\n    key: \"expandGallery\",\n    value: function expandGallery(index) {\n      var _this5 = this;\n\n      gsap/* default.to */.ZP.to(this.appUi.$cursorMinus, {\n        scale: 0.7,\n        rotation: '90deg',\n        opacity: 1,\n        duration: 0.3,\n        ease: 'expo.out'\n      });\n      gsap/* default.to */.ZP.to(this.appUi.$cursorPlus, {\n        scale: 0.7,\n        rotation: '90deg',\n        opacity: 0.0001,\n        duration: 0.3,\n        ease: 'expo.out'\n      });\n\n      for (var i = 0; i < this.$galleryGridItems.length; i++) {\n        gsap/* default.killTweensOf */.ZP.killTweensOf(this.$galleryGridItems[i]);\n        var positions = this.gallery.relativePositions[i];\n        gsap/* default.to */.ZP.to(this.$galleryGridItems[i], {\n          x: positions[2],\n          y: positions[3],\n          scale: 1,\n          duration: 1.4,\n          ease: 'expo.inOut'\n        });\n        gsap/* default.to */.ZP.to(this.$galleryGridItems[i].children[0].children[0], {\n          scale: 1,\n          duration: 1.4,\n          ease: 'expo.inOut'\n        });\n        gsap/* default.to */.ZP.to(this.$galleryGridItems[i].querySelector('.background .background__overlay2'), {\n          opacity: 0.0001,\n          duration: 0.2,\n          ease: 'power2.out'\n        });\n        gsap/* default.to */.ZP.to(this.$galleryGridItems[i].querySelector('.background .expand'), {\n          opacity: 1,\n          duration: 0.2,\n          ease: 'power2.out',\n          delay: 1.4\n        });\n      }\n\n      this.$galleryGridInner.style.minWidth = this.gallery.relativeWidth + 'px';\n      var $el = this.gallery.relativePositions[index];\n      var center = $el[2] - window.innerWidth / 2 + $el[0] / 2; // Center gallery\n\n      var offset = this.$gallery.getBoundingClientRect().top;\n      if (this.superScroller) this.superScroller.scrollAnimate(-this.superScroller._scroll.livePosition.y + offset, 1.4, 'expo.inOut');\n      var _maxX = 0;\n\n      var _minX = -(this.gallery.relativeWidth - window.innerWidth);\n\n      var _center = Math.min(_maxX, Math.max(_minX, -center));\n\n      if (this.appStore.isDesktop) gsap/* default.to */.ZP.to([this.galleryDraggable._drag.livePosition, this.galleryDraggable._drag.position, this.galleryDraggable._drag.lastPosition], {\n        x: _center,\n        duration: 1.4,\n        ease: 'expo.inOut'\n      });\n      gsap/* default.to */.ZP.to(this.$galleryGridInner, {\n        x: _center,\n        duration: 1.4,\n        ease: 'expo.inOut',\n        onComplete: function onComplete() {\n          if (_this5.appStore.isDesktop) _this5.galleryDraggable.resize();else _this5.galleryDraggable.draggable[0].applyBounds();\n        }\n      });\n      this.gallery.isZoomed = true;\n    }\n  }, {\n    key: \"openLightbox\",\n    value: function openLightbox(index) {\n      var _this6 = this;\n\n      gsap/* default.to */.ZP.to(this.appUi.$headerTrigger, {\n        opacity: 0.0001,\n        pointerEvents: 'none',\n        duration: 0.8,\n        ease: 'power2.out'\n      });\n      if (this.$infoTrigger) gsap/* default.to */.ZP.to(this.$infoTrigger, {\n        opacity: 0.0001,\n        pointerEvents: 'none',\n        duration: 0.8,\n        ease: 'power2.out'\n      });\n\n      if (this.superScroller) {\n        var offset = this.$gallery.getBoundingClientRect().top;\n        this.superScroller.scrollAnimate(-this.superScroller._scroll.livePosition.y + offset, 1.4, 'expo.inOut');\n        gsap/* default.delayedCall */.ZP.delayedCall(1.4, function () {\n          _this6.superScroller._scroll.enable = false;\n        });\n      }\n\n      for (var i = 0; i < this.$galleryGridItems.length; i++) {\n        gsap/* default.to */.ZP.to(this.$galleryGridItems[i].querySelector('.expand'), {\n          opacity: 0.0001,\n          duration: 0.2,\n          ease: 'power2.out'\n        });\n      }\n\n      this.lightbox.set(index);\n    }\n  }, {\n    key: \"closeLightbox\",\n    value: function closeLightbox(index) {\n      var $el = this.gallery.relativePositions[index];\n      var center = $el[2] - window.innerWidth / 2 + $el[0] / 2; // Center gallery\n\n      if (this.superScroller) {\n        this.superScroller._scroll.enable = true;\n        var offset = this.$gallery.getBoundingClientRect().top;\n        if (this.superScroller) this.superScroller.scrollAnimate(-this.superScroller._scroll.livePosition.y + offset, 1.4, 'expo.inOut');\n      }\n\n      var _maxX = 0;\n\n      var _minX = -(this.gallery.relativeWidth - window.innerWidth);\n\n      var _center = Math.min(_maxX, Math.max(_minX, -center));\n\n      if (this.appStore.isDesktop) gsap/* default.set */.ZP.set([this.galleryDraggable._drag.livePosition, this.galleryDraggable._drag.position, this.galleryDraggable._drag.lastPosition], {\n        x: _center\n      });\n      gsap/* default.set */.ZP.set(this.$galleryGridInner, {\n        x: _center\n      });\n      if (this.appStore.isDesktop) this.galleryDraggable.resize();else this.galleryDraggable.draggable[0].applyBounds();\n      gsap/* default.to */.ZP.to(this.appUi.$headerTrigger, {\n        opacity: 1,\n        pointerEvents: 'all',\n        duration: 0.8,\n        ease: 'power2.out',\n        delay: 1\n      });\n      if (this.$infoTrigger) gsap/* default.to */.ZP.to(this.$infoTrigger, {\n        opacity: 1,\n        pointerEvents: 'all',\n        duration: 0.8,\n        ease: 'power2.out',\n        delay: 1\n      });\n\n      if (this.appStore.isDesktop) {\n        for (var i = 0; i < this.$galleryGridItems.length; i++) {\n          gsap/* default.to */.ZP.to(this.$galleryGridItems[i].querySelector('.expand'), {\n            opacity: 1,\n            duration: 0.2,\n            ease: 'power2.out',\n            delay: 0\n          });\n        }\n      }\n\n      this.gallery.isExpanded = false;\n    }\n  }, {\n    key: \"enterImage\",\n    value: function enterImage(el) {\n      if (!this.gallery.dragging) {\n        if (!this.gallery.isZoomed) {\n          gsap/* default.to */.ZP.to(el.querySelector('.background .background__overlay2'), {\n            opacity: 1,\n            duration: 0.2,\n            ease: 'power2.out'\n          });\n          gsap/* default.to */.ZP.to(el.children[0].children[0], {\n            scale: 1,\n            ease: 'expo.out',\n            duration: 1\n          });\n          gsap/* default.killTweensOf */.ZP.killTweensOf([this.appUi.$cursorDrag, this.appUi.$cursorDrag.children[0], this.appUi.$cursorPlus, this.appUi.$cursorPlus.children[0]]);\n          gsap/* default.to */.ZP.to(this.appUi.$cursorDot, {\n            scale: 0.7,\n            opacity: 0.0001,\n            duration: 0.3,\n            ease: 'expo.out'\n          });\n          gsap/* default.to */.ZP.to(this.appUi.$cursorMinus, {\n            scale: 0.7,\n            opacity: 0.0001,\n            duration: 0.3,\n            ease: 'expo.out'\n          });\n          gsap/* default.to */.ZP.to(this.appUi.$cursorPlus, {\n            scale: 0.7,\n            opacity: 1,\n            duration: 0.3,\n            ease: 'expo.out'\n          }); //gsap.to(this.appUi.$cursorPlus.children[0], { opacity: 1, duration: 0.3, ease: 'expo.out' });\n\n          gsap/* default.to */.ZP.to(this.appUi.$cursorDrag, {\n            scale: 0.7,\n            opacity: 0.0001,\n            duration: 0.3,\n            ease: 'expo.out'\n          });\n          gsap/* default.to */.ZP.to(this.appUi.$cursorDrag.children[0], {\n            opacity: 0.0001,\n            duration: 0.3,\n            ease: 'expo.out'\n          });\n        } else {\n          gsap/* default.to */.ZP.to(this.appUi.$cursorDot, {\n            scale: 0.7,\n            opacity: 0.0001,\n            duration: 0.3,\n            ease: 'expo.out'\n          });\n          gsap/* default.to */.ZP.to(this.appUi.$cursorMinus, {\n            scale: 0.7,\n            opacity: 1,\n            duration: 0.3,\n            ease: 'expo.out'\n          });\n          gsap/* default.to */.ZP.to(this.appUi.$cursorPlus, {\n            scale: 0.7,\n            opacity: 0.0001,\n            duration: 0.3,\n            ease: 'expo.out'\n          }); //gsap.to(this.appUi.$cursorMinus.children[0], { opacity: 1, duration: 0.3, ease: 'expo.out' });\n\n          gsap/* default.to */.ZP.to(this.appUi.$cursorDrag, {\n            scale: 0.7,\n            opacity: 0.0001,\n            duration: 0.3,\n            ease: 'expo.out'\n          });\n          gsap/* default.to */.ZP.to(this.appUi.$cursorDrag.children[0], {\n            opacity: 0.0001,\n            duration: 0.3,\n            ease: 'expo.out'\n          });\n        }\n      }\n    }\n  }, {\n    key: \"leaveImage\",\n    value: function leaveImage(el) {\n      if (!this.gallery.dragging) {\n        if (!this.gallery.isZoomed) {\n          gsap/* default.to */.ZP.to(el.querySelector('.background .background__overlay2'), {\n            opacity: 0.0001,\n            duration: 0.2,\n            ease: 'power2.out'\n          });\n          gsap/* default.to */.ZP.to(el.children[0].children[0], {\n            scale: 1.1,\n            ease: 'expo.out',\n            duration: 1\n          });\n          gsap/* default.to */.ZP.to(this.appUi.$cursorDot, {\n            scale: 1,\n            opacity: 0.0001,\n            duration: 0.3,\n            ease: 'expo.out'\n          });\n          gsap/* default.to */.ZP.to(this.appUi.$cursorDrag, {\n            scale: 1,\n            opacity: 1,\n            duration: 0.3,\n            ease: 'expo.out'\n          });\n          gsap/* default.to */.ZP.to(this.appUi.$cursorDrag.children[0], {\n            opacity: 1,\n            duration: 0.3,\n            ease: 'expo.out'\n          });\n          gsap/* default.to */.ZP.to(this.appUi.$cursorMinus, {\n            scale: 1,\n            opacity: 0.0001,\n            duration: 0.3,\n            ease: 'expo.out'\n          });\n          gsap/* default.to */.ZP.to(this.appUi.$cursorPlus, {\n            scale: 1,\n            opacity: 0.0001,\n            duration: 0.3,\n            ease: 'expo.out'\n          }); //gsap.to(this.appUi.$cursorPlus.children[0], { scale: 1, opacity: 0.0001, duration: 0.3, ease: 'expo.out' });\n        } else {\n          gsap/* default.to */.ZP.to(this.appUi.$cursorDot, {\n            scale: 1,\n            opacity: 0.0001,\n            duration: 0.3,\n            ease: 'expo.out'\n          });\n          gsap/* default.to */.ZP.to(this.appUi.$cursorDrag, {\n            scale: 1,\n            opacity: 1,\n            duration: 0.3,\n            ease: 'expo.out'\n          });\n          gsap/* default.to */.ZP.to(this.appUi.$cursorDrag.children[0], {\n            opacity: 1,\n            duration: 0.3,\n            ease: 'expo.out'\n          });\n          gsap/* default.to */.ZP.to(this.appUi.$cursorMinus, {\n            scale: 1,\n            opacity: 0.0001,\n            duration: 0.3,\n            ease: 'expo.out'\n          });\n          gsap/* default.to */.ZP.to(this.appUi.$cursorPlus, {\n            scale: 1,\n            opacity: 0.0001,\n            duration: 0.3,\n            ease: 'expo.out'\n          }); //gsap.to(this.appUi.$cursorMinus.children[0], { scale: 1, opacity: 0.0001, duration: 0.3, ease: 'expo.out' });\n        }\n      }\n    }\n  }, {\n    key: \"enterExpand\",\n    value: function enterExpand() {\n      gsap/* default.to */.ZP.to(this.appUi.$cursorDot, {\n        scale: 0.35,\n        opacity: 1,\n        duration: 0.3,\n        ease: 'expo.out'\n      });\n      gsap/* default.to */.ZP.to(this.appUi.$cursorMinus, {\n        scale: 0.35,\n        opacity: 0.0001,\n        duration: 0.3,\n        ease: 'expo.out'\n      }); //gsap.to(this.appUi.$cursorMinus.children[0], { scale: 1, opacity: 0.0001, duration: 0.3, ease: 'expo.out' });\n    }\n  }, {\n    key: \"leaveExpand\",\n    value: function leaveExpand() {\n      gsap/* default.to */.ZP.to(this.appUi.$cursorDot, {\n        scale: 0.7,\n        opacity: 0.0001,\n        duration: 0.3,\n        ease: 'expo.out'\n      });\n      gsap/* default.to */.ZP.to(this.appUi.$cursorMinus, {\n        scale: 0.7,\n        opacity: 1,\n        duration: 0.3,\n        ease: 'expo.out'\n      }); //gsap.to(this.appUi.$cursorMinus.children[0], { opacity: 1, duration: 0.3, ease: 'expo.out' });\n    }\n  }, {\n    key: \"clickExpand\",\n    value: function clickExpand(e, a, el, index) {\n      this.gallery.isExpanded = true;\n      this.openLightbox(index);\n    }\n  }, {\n    key: \"resizeGallery\",\n    value: function resizeGallery() {\n      // Get absolute positions\n      for (var i = 0; i < this.$galleryGridItems.length; i++) {\n        var _width = window.innerWidth * this.gallery.references[i][0] / 100;\n\n        var _height = window.innerWidth * this.gallery.references[i][1] / 100;\n\n        var _left = window.innerWidth * this.gallery.references[i][2] / 100;\n\n        var _top = window.innerWidth * this.gallery.references[i][3] / 100;\n\n        var _ratio = 1 / ((window.innerHeight - window.innerWidth * 0.1) / _height);\n\n        var _multiplier = (window.innerHeight - window.innerWidth * 0.1) / _height;\n\n        this.gallery.absolutePositions[i] = [_width, _height, _left, _top, _ratio, _multiplier];\n      }\n\n      this.gallery.absoluteWidth = this.gallery.absolutePositions[this.gallery.count - 1][0] + this.gallery.absolutePositions[this.gallery.count - 1][2]; // Get relative positions\n\n      for (var _i8 = 0; _i8 < this.$galleryGridItems.length; _i8++) {\n        var _multiplier3 = this.gallery.absolutePositions[_i8][5];\n\n        var _width3 = _multiplier3 * this.gallery.absolutePositions[_i8][0];\n\n        var _height3 = _multiplier3 * this.gallery.absolutePositions[_i8][1];\n\n        var _left3 = _i8 === 0 ? 0 : this.gallery.relativePositions[_i8 - 1][2] + this.gallery.relativePositions[_i8 - 1][0] + this.gallery.margin;\n\n        var _top3 = window.innerWidth * 0.05;\n\n        this.gallery.relativePositions[_i8] = [_width3, _height3, _left3, _top3];\n      }\n\n      this.gallery.relativeWidth = this.gallery.relativePositions[this.gallery.count - 1][0] + this.gallery.relativePositions[this.gallery.count - 1][2];\n    }\n  }, {\n    key: \"initRelated\",\n    value: function initRelated() {\n      var _this7 = this;\n\n      // Selectors\n      this.$relatedSlider = this.$related.querySelector('.slider');\n      this.$relatedSliderInner = this.$related.querySelector('.slider__inner');\n      this.$relatedSliderItems = this.$related.querySelectorAll('.slider__item');\n      this.$relatedPromotions = this.$related.querySelectorAll('.promotion');\n\n      if (this.appStore.isDesktop) {\n        for (var i = 0; i < this.$relatedPromotions.length; i++) {\n          this.domEvents.add(this.$relatedPromotions[i], 'mouseenter', function (e, a, el) {\n            _this7.promotionEnter(el);\n          });\n          this.domEvents.add(this.$relatedPromotions[i], 'mouseleave', function (e, a, el) {\n            _this7.promotionLeave(el);\n          });\n        }\n\n        this.domEvents.add(this.$relatedSliderInner, 'mouseenter', function (e, a, el) {\n          _this7.appUi.enterDragCursor();\n        });\n        this.domEvents.add(this.$relatedSliderInner, 'mouseleave', function (e, a, el) {\n          _this7.appUi.leaveDragCursor();\n        });\n        this.relatedDraggable = new superDragger_default({\n          el: this.$relatedSlider,\n          elClickables: this.$relatedPromotions,\n          inner: this.$relatedSliderInner,\n          onDragStart: function onDragStart() {\n            _this7.superScroller._scroll.enable = false;\n\n            for (var _i9 = 0; _i9 < _this7.$relatedPromotions.length; _i9++) {\n              gsap/* default.to */.ZP.to(_this7.$relatedPromotions[_i9], {\n                scale: 0.94,\n                opacity: 1,\n                ease: 'expo.out',\n                duration: 0.6\n              });\n              gsap/* default.to */.ZP.to(_this7.$relatedPromotions[_i9].querySelector('.inner .background__bg'), {\n                scale: 1,\n                opacity: 1,\n                ease: 'expo.out',\n                duration: 0.6\n              });\n            }\n          },\n          onDragEnd: function onDragEnd() {\n            _this7.superScroller._scroll.enable = true;\n\n            for (var _i10 = 0; _i10 < _this7.$relatedPromotions.length; _i10++) {\n              gsap/* default.to */.ZP.to(_this7.$relatedPromotions[_i10], {\n                scale: 1,\n                opacity: 1,\n                ease: 'expo.out',\n                duration: 0.6\n              });\n              gsap/* default.to */.ZP.to(_this7.$relatedPromotions[_i10].querySelector('.inner .background__bg'), {\n                scale: 1.1,\n                ease: 'expo.out',\n                duration: 0.6\n              });\n            }\n          }\n        });\n      } else {\n        this.relatedDraggable = new Draggable_default({\n          target: this.$relatedSlider,\n          targetInner: this.$relatedSliderInner,\n          snap: true\n        });\n      }\n    }\n  }, {\n    key: \"promotionEnter\",\n    value: function promotionEnter(el) {\n      gsap/* default.to */.ZP.to(el.querySelector('.inner .background__bg'), {\n        scale: 1,\n        opacity: 1,\n        ease: 'expo.out',\n        duration: 0.6\n      });\n    }\n  }, {\n    key: \"promotionLeave\",\n    value: function promotionLeave(el) {\n      if (this.relatedDraggable && this.relatedDraggable._drag.dragging) return;\n      gsap/* default.to */.ZP.to(el.querySelector('.inner .background__bg'), {\n        scale: 1.1,\n        ease: 'expo.out',\n        duration: 0.6\n      });\n    }\n  }, {\n    key: \"raf\",\n    value: function raf() {} // eslint-disable-line\n\n  }, {\n    key: \"resize\",\n    value: function resize() {// if(this.lightboxDraggable)\n      //     this.lightboxDraggable.resize();\n      // this.resizeGallery();\n    }\n  }]);\n\n  return RendererPromotionsSingle;\n}(renderer); // Don`t forget to export your renderer\n\n\n/* harmony default export */ const rendererPromotionsSingle = (RendererPromotionsSingle);\n;// CONCATENATED MODULE: ./app/src/js/renderers/rendererMasterworks.js\nfunction rendererMasterworks_typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { rendererMasterworks_typeof = function _typeof(obj) { return typeof obj; }; } else { rendererMasterworks_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return rendererMasterworks_typeof(obj); }\n\nfunction rendererMasterworks_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction rendererMasterworks_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction rendererMasterworks_createClass(Constructor, protoProps, staticProps) { if (protoProps) rendererMasterworks_defineProperties(Constructor.prototype, protoProps); if (staticProps) rendererMasterworks_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction rendererMasterworks_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) rendererMasterworks_setPrototypeOf(subClass, superClass); }\n\nfunction rendererMasterworks_setPrototypeOf(o, p) { rendererMasterworks_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return rendererMasterworks_setPrototypeOf(o, p); }\n\nfunction rendererMasterworks_createSuper(Derived) { var hasNativeReflectConstruct = rendererMasterworks_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = rendererMasterworks_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = rendererMasterworks_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return rendererMasterworks_possibleConstructorReturn(this, result); }; }\n\nfunction rendererMasterworks_possibleConstructorReturn(self, call) { if (call && (rendererMasterworks_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return rendererMasterworks_assertThisInitialized(self); }\n\nfunction rendererMasterworks_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction rendererMasterworks_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction rendererMasterworks_getPrototypeOf(o) { rendererMasterworks_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return rendererMasterworks_getPrototypeOf(o); }\n\n// Gsap\n\n\ngsap/* default.registerPlugin */.ZP.registerPlugin(ScrollTrigger/* default */.Z); // Import Renderer\n\n // import stylesDefault from './stylesDefault.css'; //eslint-disable-line\n// Utilities\n\n\n // Other\n// import Slider from '../classes/slider';\n// import SplitText from '../classes/splitText';\n\nvar RendererMasterworks = /*#__PURE__*/function (_Renderer) {\n  rendererMasterworks_inherits(RendererMasterworks, _Renderer);\n\n  var _super = rendererMasterworks_createSuper(RendererMasterworks);\n\n  function RendererMasterworks() {\n    rendererMasterworks_classCallCheck(this, RendererMasterworks);\n\n    return _super.apply(this, arguments);\n  }\n\n  rendererMasterworks_createClass(RendererMasterworks, [{\n    key: \"selectors\",\n    value: function selectors() {\n      this.$hero = this.$el.querySelector('.masterworks__hero');\n      this.$intro = this.$el.querySelector('.masterworks__intro');\n      this.$features = this.$el.querySelector('.masterworks__features');\n      if (this.$features) this.$featuresItems = this.$features.querySelectorAll('.features__item');\n    }\n  }, {\n    key: \"events\",\n    value: function events() {} // eslint-disable-line\n\n  }, {\n    key: \"beforeEnter\",\n    value: function beforeEnter() {\n      if (this.appStore.isDesktop) {\n        gsap/* default.set */.ZP.set(this.$hero.querySelector('.image'), {\n          y: '-100%'\n        });\n        gsap/* default.set */.ZP.set(this.$hero.querySelector('.image img'), {\n          y: '100%'\n        });\n      }\n\n      gsap/* default.set */.ZP.set(this.$hero.querySelector('.mask .bg'), {\n        scaleY: this.appStore.isDesktop ? 0 : 1\n      });\n      gsap/* default.set */.ZP.set(this.$hero.querySelector('.mask .center'), {\n        opacity: 0.0001\n      });\n    }\n  }, {\n    key: \"preenter\",\n    value: function preenter() {\n      if (this.appStore.isDesktop) {\n        gsap/* default.to */.ZP.to(this.$hero.querySelector('.image'), {\n          y: '0%',\n          duration: 1.8,\n          ease: 'expo.inOut',\n          delay: 0\n        });\n        gsap/* default.to */.ZP.to(this.$hero.querySelector('.image img'), {\n          y: '0%',\n          duration: 1.8,\n          ease: 'expo.inOut',\n          delay: 0\n        });\n      }\n\n      gsap/* default.to */.ZP.to(this.$hero.querySelector('.mask .bg'), {\n        scaleY: 1,\n        duration: 1.6,\n        ease: 'expo.inOut',\n        delay: 0.2\n      });\n      gsap/* default.to */.ZP.to(this.$hero.querySelector('.mask .center'), {\n        opacity: 1,\n        ease: 'power2.out',\n        duration: 0.8,\n        delay: 1\n      });\n    }\n  }, {\n    key: \"enter\",\n    value: function enter() {\n      this.appUi.$infoContent.querySelector('input[name=\"info-subject\"]').value = 'Información sobre Masterworks';\n      if (this.appStore.isDesktop) this.parallaxHero();\n      this.initFeatures();\n    }\n  }, {\n    key: \"parallaxHero\",\n    value: function parallaxHero() {\n      var _this = this;\n\n      if (this.$hero) {\n        var offset = -(window.innerWidth * 0.05);\n        this.superTrigger.create({\n          trigger: this.$hero,\n          start: 'top top',\n          end: 'bottom top',\n          scrub: true,\n          onUpdate: function onUpdate(self) {\n            gsap/* default.to */.ZP.to(_this.$hero.querySelector('.image img'), {\n              scale: 1 + 0.1 * self.progress\n            });\n            gsap/* default.to */.ZP.to(_this.$hero.querySelector('.mask .bg'), {\n              y: offset * self.progress\n            });\n          }\n        });\n      }\n    }\n  }, {\n    key: \"initFeatures\",\n    value: function initFeatures() {\n      var _this2 = this;\n\n      this.featuresTimelines = [];\n\n      var _loop = function _loop(i) {\n        if (!_this2.appStore.isDesktop) {\n          _this2.domEvents.add(_this2.$featuresItems[i].querySelector('.trigger'), 'click', function () {\n            // Close menu\n            gsap/* default.to */.ZP.to(_this2.appUi.$header, {\n              y: '-100%',\n              duration: 1.4,\n              ease: 'expo.inOut'\n            });\n            _this2.appUi.header.isLocked = true;\n\n            var offset = _this2.$featuresItems[i].getBoundingClientRect().top;\n\n            _this2.appUi.previousScroll = document.documentElement.scrollTop + offset - 1;\n            gsap/* default.to */.ZP.to(document.documentElement, {\n              scrollTop: document.documentElement.scrollTop + offset,\n              duration: 1.4,\n              ease: 'expo.inOut',\n              onComplete: function onComplete() {\n                _this2.appUi.header.isLocked = false;\n              }\n            });\n\n            if (_this2.$featuresItems[i].classList.contains('open')) {\n              gsap/* default.to */.ZP.to(_this2.$featuresItems[i].querySelector('.info'), {\n                y: '50%',\n                ease: 'expo.inOut',\n                duration: 1.4\n              });\n              gsap/* default.to */.ZP.to(_this2.$featuresItems[i].querySelector('.info .wysiwyg'), {\n                opacity: 0.0001,\n                ease: 'power2.out',\n                duration: 0.4,\n                delay: 0\n              });\n\n              _this2.$featuresItems[i].classList.remove('open');\n            } else {\n              gsap/* default.to */.ZP.to(_this2.$featuresItems[i].querySelector('.info'), {\n                y: '0%',\n                ease: 'expo.inOut',\n                duration: 1.4\n              });\n              gsap/* default.to */.ZP.to(_this2.$featuresItems[i].querySelector('.info .wysiwyg'), {\n                opacity: 1,\n                ease: 'power2.out',\n                duration: 0.4,\n                delay: 1\n              });\n\n              _this2.$featuresItems[i].classList.add('open');\n            }\n          });\n        }\n\n        gsap/* default.set */.ZP.set(_this2.$featuresItems[i].querySelector('.background__bg'), {\n          y: _this2.appStore.isDesktop ? -window.innerHeight + 200 : -(window.innerHeight * 0.5) + 200,\n          scale: 1.2\n        }, 0);\n        gsap/* default.set */.ZP.set(_this2.$featuresItems[i].querySelector('.background__mask'), {\n          opacity: 1\n        }, 0);\n        var featureTimeline = gsap/* default.timeline */.ZP.timeline({\n          defaults: {\n            ease: 'none'\n          },\n          scrollTrigger: {\n            trigger: _this2.$featuresItems[i].querySelector('.background'),\n            scrub: true,\n            start: 'top bottom',\n            end: 'bottom bottom'\n          }\n        });\n        featureTimeline.to(_this2.$featuresItems[i].querySelector('.background__bg'), {\n          y: 0,\n          scale: 1\n        }, 0);\n        featureTimeline.to(_this2.$featuresItems[i].querySelector('.background__mask'), {\n          opacity: 0.0001,\n          duration: 0.5\n        }, 0);\n\n        _this2.featuresTimelines.push(featureTimeline);\n      };\n\n      for (var i = 0; i < this.$featuresItems.length; i++) {\n        _loop(i);\n      }\n    }\n  }, {\n    key: \"raf\",\n    value: function raf() {} // eslint-disable-line\n\n  }]);\n\n  return RendererMasterworks;\n}(renderer); // Don`t forget to export your renderer\n\n\n/* harmony default export */ const rendererMasterworks = (RendererMasterworks);\n;// CONCATENATED MODULE: ./app/src/js/renderers/rendererBlog.js\nfunction rendererBlog_typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { rendererBlog_typeof = function _typeof(obj) { return typeof obj; }; } else { rendererBlog_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return rendererBlog_typeof(obj); }\n\nfunction rendererBlog_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction rendererBlog_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction rendererBlog_createClass(Constructor, protoProps, staticProps) { if (protoProps) rendererBlog_defineProperties(Constructor.prototype, protoProps); if (staticProps) rendererBlog_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction rendererBlog_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) rendererBlog_setPrototypeOf(subClass, superClass); }\n\nfunction rendererBlog_setPrototypeOf(o, p) { rendererBlog_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return rendererBlog_setPrototypeOf(o, p); }\n\nfunction rendererBlog_createSuper(Derived) { var hasNativeReflectConstruct = rendererBlog_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = rendererBlog_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = rendererBlog_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return rendererBlog_possibleConstructorReturn(this, result); }; }\n\nfunction rendererBlog_possibleConstructorReturn(self, call) { if (call && (rendererBlog_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return rendererBlog_assertThisInitialized(self); }\n\nfunction rendererBlog_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction rendererBlog_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction rendererBlog_getPrototypeOf(o) { rendererBlog_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return rendererBlog_getPrototypeOf(o); }\n\n// Gsap\n\n\ngsap/* default.registerPlugin */.ZP.registerPlugin(ScrollTrigger/* default */.Z); // Import Renderer\n\n // import stylesDefault from './stylesDefault.css'; //eslint-disable-line\n// Utilities\n\n\n // Other\n// import Slider from '../classes/slider';\n\n\n\nvar RendererBlog = /*#__PURE__*/function (_Renderer) {\n  rendererBlog_inherits(RendererBlog, _Renderer);\n\n  var _super = rendererBlog_createSuper(RendererBlog);\n\n  function RendererBlog() {\n    rendererBlog_classCallCheck(this, RendererBlog);\n\n    return _super.apply(this, arguments);\n  }\n\n  rendererBlog_createClass(RendererBlog, [{\n    key: \"selectors\",\n    value: function selectors() {\n      this.$list = this.$el.querySelector('.blog__list');\n\n      if (this.$list) {\n        this.$listFilter = this.$list.querySelector('.filter');\n        this.$listFilterTrigger = this.$list.querySelector('.filter__trigger');\n        this.$listFilterInner = this.$list.querySelector('.filter__inner');\n        this.$listFilterItems = this.$list.querySelectorAll('.filter__item');\n      }\n    }\n  }, {\n    key: \"beforeEnter\",\n    value: function beforeEnter() {\n      this.setPosts();\n    }\n  }, {\n    key: \"enter\",\n    value: function enter() {\n      this.initPosts();\n      if (this.appStore.isDesktop) this.pinFilter();else this.initFilter();\n    }\n  }, {\n    key: \"initFilter\",\n    value: function initFilter() {\n      var _this = this;\n\n      this.filter = {\n        isOpen: false\n      };\n      gsap/* default.set */.ZP.set(this.$listFilterInner, {\n        opacity: 0.0001\n      });\n\n      if (this.$listFilterTrigger) {\n        this.domEvents.add(this.$listFilterTrigger, 'click', function () {\n          if (_this.filter.isOpen) _this.hideFilter();else _this.showFilter();\n        });\n      }\n    }\n  }, {\n    key: \"showFilter\",\n    value: function showFilter() {\n      gsap/* default.to */.ZP.to(this.$listFilterInner, {\n        opacity: 1,\n        ease: 'powe2.out',\n        duration: 0.2\n      });\n      this.filter.isOpen = true;\n    }\n  }, {\n    key: \"hideFilter\",\n    value: function hideFilter() {\n      gsap/* default.to */.ZP.to(this.$listFilterInner, {\n        opacity: 0.0001,\n        ease: 'powe2.out',\n        duration: 0.2\n      });\n      this.filter.isOpen = false;\n    }\n  }, {\n    key: \"pinFilter\",\n    value: function pinFilter() {\n      var _this2 = this;\n\n      if (this.$listFilter) {\n        var offset = this.$list.getBoundingClientRect().height - (this.$listFilter.getBoundingClientRect().height + window.innerWidth * 0.20);\n        this.superTrigger.create({\n          trigger: this.$list,\n          start: 'top top',\n          end: 'bottom ' + (this.$listFilter.getBoundingClientRect().height + window.innerWidth * 0.20) + 'px',\n          scrub: true,\n          onUpdate: function onUpdate(self) {\n            gsap/* default.set */.ZP.set(_this2.$listFilter, {\n              y: offset * self.progress\n            });\n          }\n        });\n      }\n    }\n  }, {\n    key: \"setPosts\",\n    value: function setPosts() {\n      var _this3 = this;\n\n      this.$posts = this.$el.querySelectorAll('.post');\n\n      if (this.$posts) {\n        for (var i = 0; i < this.$posts.length; i++) {\n          // Set el\n          if (this.appStore.isDesktop) {\n            gsap/* default.set */.ZP.set(this.$posts[i].querySelector('.image img'), {\n              scale: 1.1\n            });\n            this.domEvents.add(this.$posts[i], 'mouseenter', function (e, a, el) {\n              _this3.enterPost(e, a, el);\n            });\n            this.domEvents.add(this.$posts[i], 'mouseleave', function (e, a, el) {\n              _this3.leavePost(e, a, el);\n            });\n          } // Set titles\n\n\n          var $title = this.$posts[i].querySelector('.title');\n          var split = new SplitText($title, {\n            type: 'lines, words',\n            linesClass: 'line line--++',\n            wordsClass: 'word word--++',\n            charsClass: 'char char--++'\n          }); // eslint-disable-line\n\n          $title.classList.add('split');\n          this.splitTexts.push(split);\n          var lines = $title.querySelectorAll('.line');\n\n          for (var j = 0; j < lines.length; j++) {\n            gsap/* default.set */.ZP.set(lines[j], {\n              opacity: 0.0001,\n              y: '100%'\n            });\n          } // Set link\n\n\n          var $link = this.$posts[i].querySelector('.link');\n          gsap/* default.set */.ZP.set($link, {\n            y: '100%',\n            opacity: 0.0001\n          });\n          gsap/* default.set */.ZP.set($link.children[0], {\n            opacity: 0.0001\n          });\n          gsap/* default.set */.ZP.set($link.querySelector('svg'), {\n            opacity: 0.0001,\n            rotation: '450deg'\n          });\n          gsap/* default.set */.ZP.set($link.querySelector('svg circle'), {\n            strokeDashoffset: '1181.24px'\n          });\n        }\n      }\n    }\n  }, {\n    key: \"initPosts\",\n    value: function initPosts() {\n      var _this4 = this;\n\n      if (this.$posts) {\n        var _loop = function _loop(i) {\n          var _delay = i % 2 ? 0 : 0.1;\n\n          var scrolltrigger = ScrollTrigger/* default.create */.Z.create({\n            trigger: _this4.$posts[i],\n            start: 'center bottom',\n            once: true,\n            onEnter: function onEnter() {\n              // Trigger el\n              //gsap.to(this.$posts[i], { opacity: 1, y: '0%', ease: 'expo.out', duration: 2, delay: _delay });\n              // Trigger titles\n              var $title = _this4.$posts[i].querySelector('.title');\n\n              var lines = $title.querySelectorAll('.line');\n\n              for (var j = 0; j < lines.length; j++) {\n                gsap/* default.to */.ZP.to(lines[j], {\n                  opacity: 1,\n                  y: '0%',\n                  ease: 'expo.out',\n                  duration: 2,\n                  delay: j * 0.1 + _delay\n                });\n              } // Trigger links\n\n\n              var $link = _this4.$posts[i].querySelector('.link');\n\n              gsap/* default.to */.ZP.to($link, {\n                y: 0,\n                opacity: 1,\n                duration: 2,\n                ease: 'expo.out',\n                delay: _delay\n              });\n              gsap/* default.to */.ZP.to($link.children[0], {\n                opacity: 1,\n                duration: 2,\n                ease: 'expo.out',\n                delay: _delay\n              });\n              gsap/* default.to */.ZP.to($link.querySelector('svg'), {\n                opacity: 1,\n                rotation: '0',\n                duration: 2,\n                ease: 'expo.out',\n                delay: _delay\n              });\n              gsap/* default.to */.ZP.to($link.querySelector('svg circle'), {\n                strokeDashoffset: '0px',\n                duration: 2,\n                ease: 'expo.out',\n                delay: _delay\n              });\n            }\n          });\n        };\n\n        for (var i = 0; i < this.$posts.length; i++) {\n          _loop(i);\n        }\n      }\n    }\n  }, {\n    key: \"enterPost\",\n    value: function enterPost(e, a, el) {\n      gsap/* default.to */.ZP.to(el.querySelector('.image img'), {\n        scale: 1,\n        opacity: 1,\n        ease: 'expo.out',\n        duration: 0.6\n      });\n      gsap/* default.killTweensOf */.ZP.killTweensOf([el.querySelector('svg'), el.querySelector('svg circle')]);\n      gsap/* default.to */.ZP.to(el.querySelector('svg'), {\n        rotation: '450deg',\n        ease: 'expo.out',\n        duration: 0.8\n      });\n      gsap/* default.to */.ZP.to(el.querySelector('svg circle'), {\n        strokeDashoffset: '1181.24px',\n        ease: 'expo.out',\n        duration: 0.8\n      });\n    }\n  }, {\n    key: \"leavePost\",\n    value: function leavePost(e, a, el) {\n      gsap/* default.to */.ZP.to(el.querySelector('.image img'), {\n        scale: 1.1,\n        ease: 'expo.out',\n        duration: 0.6\n      });\n      gsap/* default.killTweensOf */.ZP.killTweensOf([el.querySelector('svg'), el.querySelector('svg circle')]);\n      gsap/* default.to */.ZP.to(el.querySelector('svg'), {\n        rotation: '0deg',\n        ease: 'expo.out',\n        duration: 0.8\n      });\n      gsap/* default.to */.ZP.to(el.querySelector('svg circle'), {\n        strokeDashoffset: '0px',\n        ease: 'expo.out',\n        duration: 0.8\n      });\n    }\n  }, {\n    key: \"raf\",\n    value: function raf() {} // eslint-disable-line\n\n  }]);\n\n  return RendererBlog;\n}(renderer); // Don`t forget to export your renderer\n\n\n/* harmony default export */ const rendererBlog = (RendererBlog);\n;// CONCATENATED MODULE: ./app/src/js/renderers/rendererBlogSingle.js\nfunction rendererBlogSingle_typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { rendererBlogSingle_typeof = function _typeof(obj) { return typeof obj; }; } else { rendererBlogSingle_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return rendererBlogSingle_typeof(obj); }\n\nfunction rendererBlogSingle_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction rendererBlogSingle_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction rendererBlogSingle_createClass(Constructor, protoProps, staticProps) { if (protoProps) rendererBlogSingle_defineProperties(Constructor.prototype, protoProps); if (staticProps) rendererBlogSingle_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction rendererBlogSingle_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) rendererBlogSingle_setPrototypeOf(subClass, superClass); }\n\nfunction rendererBlogSingle_setPrototypeOf(o, p) { rendererBlogSingle_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return rendererBlogSingle_setPrototypeOf(o, p); }\n\nfunction rendererBlogSingle_createSuper(Derived) { var hasNativeReflectConstruct = rendererBlogSingle_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = rendererBlogSingle_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = rendererBlogSingle_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return rendererBlogSingle_possibleConstructorReturn(this, result); }; }\n\nfunction rendererBlogSingle_possibleConstructorReturn(self, call) { if (call && (rendererBlogSingle_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return rendererBlogSingle_assertThisInitialized(self); }\n\nfunction rendererBlogSingle_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction rendererBlogSingle_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction rendererBlogSingle_getPrototypeOf(o) { rendererBlogSingle_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return rendererBlogSingle_getPrototypeOf(o); }\n\n// Gsap\n\n\ngsap/* default.registerPlugin */.ZP.registerPlugin(ScrollTrigger/* default */.Z); // Import Renderer\n\n // import stylesDefault from './stylesDefault.css'; //eslint-disable-line\n// Utilities\n\n\n\n // Other\n// import Slider from '../classes/slider';\n// import SplitText from '../classes/splitText';\n\nvar RendererBlogSingle = /*#__PURE__*/function (_Renderer) {\n  rendererBlogSingle_inherits(RendererBlogSingle, _Renderer);\n\n  var _super = rendererBlogSingle_createSuper(RendererBlogSingle);\n\n  function RendererBlogSingle() {\n    rendererBlogSingle_classCallCheck(this, RendererBlogSingle);\n\n    return _super.apply(this, arguments);\n  }\n\n  rendererBlogSingle_createClass(RendererBlogSingle, [{\n    key: \"selectors\",\n    value: function selectors() {\n      this.$flex = this.$el.querySelector('.blogsingle__flex');\n    }\n  }, {\n    key: \"events\",\n    value: function events() {} // eslint-disable-line\n\n  }, {\n    key: \"beforeEnter\",\n    value: function beforeEnter() {} // eslint-disable-line\n\n  }, {\n    key: \"enter\",\n    value: function enter() {\n      this.initGalleries();\n      this.initVideos();\n    }\n  }, {\n    key: \"initGalleries\",\n    value: function initGalleries() {\n      var _this = this;\n\n      this.galleries = [];\n      this.$galleries = this.$flex.querySelectorAll('.gallery');\n\n      if (this.$galleries) {\n        var _loop = function _loop(i) {\n          var images = _this.$galleries[0].querySelectorAll('.image');\n\n          var ratio = images[0].style.getPropertyValue('--aspectratio');\n          if (_this.appStore.isDesktop) gsap/* default.set */.ZP.set(_this.$galleries[i], {\n            width: 30 * ratio + 'vw'\n          });else gsap/* default.set */.ZP.set(_this.$galleries[i], {\n            width: 70 * ratio + 'vw'\n          });\n          var gallery = new Draggable_default({\n            target: _this.$galleries[i],\n            targetInner: _this.$galleries[i].children[0],\n            onDrag: function onDrag() {\n              gsap/* default.to */.ZP.to(_this.$galleries[i].children[1].children[0], {\n                scaleX: _this.galleries[i].draggable[0].x / _this.galleries[i].draggable[0].minX\n              });\n            }\n          });\n\n          _this.galleries.push(gallery);\n        };\n\n        for (var i = 0; i < this.$galleries.length; i++) {\n          _loop(i);\n        }\n      }\n    }\n  }, {\n    key: \"initVideos\",\n    value: function initVideos() {\n      var _this2 = this;\n\n      this.videos = [];\n      this.$videos = this.$flex.querySelectorAll('.video');\n\n      if (this.$videos) {\n        var _loop2 = function _loop2(i) {\n          _this2.domEvents.add(_this2.$videos[i].querySelector('.video__trigger'), 'click', function (e, a, el) {\n            gsap/* default.to */.ZP.to(_this2.$videos[i].querySelector('.video__overlay'), {\n              opacity: 0.0001,\n              ease: 'expo.out',\n              duration: 0.8\n            });\n            gsap/* default.to */.ZP.to(_this2.$videos[i].querySelector('.video__trigger'), {\n              scale: 0,\n              opacity: 0.0001,\n              ease: 'expo.out',\n              duration: 0.8\n            });\n            _this2.$videos[i].querySelector('.video__player').style.pointerEvents = 'all';\n\n            _this2.$videos[i].querySelector('.video__player video').setAttribute('controls', 'controls');\n\n            _this2.$videos[i].querySelector('.video__player video').play();\n          });\n        };\n\n        for (var i = 0; i < this.$videos.length; i++) {\n          _loop2(i);\n        }\n      }\n    }\n  }, {\n    key: \"raf\",\n    value: function raf() {} // eslint-disable-line\n\n  }]);\n\n  return RendererBlogSingle;\n}(renderer); // Don`t forget to export your renderer\n\n\n/* harmony default export */ const rendererBlogSingle = (RendererBlogSingle);\n;// CONCATENATED MODULE: ./app/src/js/renderers/RendererContact.js\nfunction RendererContact_typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { RendererContact_typeof = function _typeof(obj) { return typeof obj; }; } else { RendererContact_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return RendererContact_typeof(obj); }\n\nfunction RendererContact_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction RendererContact_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction RendererContact_createClass(Constructor, protoProps, staticProps) { if (protoProps) RendererContact_defineProperties(Constructor.prototype, protoProps); if (staticProps) RendererContact_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction RendererContact_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) RendererContact_setPrototypeOf(subClass, superClass); }\n\nfunction RendererContact_setPrototypeOf(o, p) { RendererContact_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return RendererContact_setPrototypeOf(o, p); }\n\nfunction RendererContact_createSuper(Derived) { var hasNativeReflectConstruct = RendererContact_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = RendererContact_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = RendererContact_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return RendererContact_possibleConstructorReturn(this, result); }; }\n\nfunction RendererContact_possibleConstructorReturn(self, call) { if (call && (RendererContact_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return RendererContact_assertThisInitialized(self); }\n\nfunction RendererContact_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction RendererContact_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction RendererContact_getPrototypeOf(o) { RendererContact_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return RendererContact_getPrototypeOf(o); }\n\n// Gsap\n\n\ngsap/* default.registerPlugin */.ZP.registerPlugin(ScrollTrigger/* default */.Z); // Import Renderer\n\n // import stylesDefault from './stylesDefault.css'; //eslint-disable-line\n// Utilities\n\n\n // Other\n// import Slider from '../classes/slider';\n// import SplitText from '../classes/splitText';\n\nvar RendererContact = /*#__PURE__*/function (_Renderer) {\n  RendererContact_inherits(RendererContact, _Renderer);\n\n  var _super = RendererContact_createSuper(RendererContact);\n\n  function RendererContact() {\n    RendererContact_classCallCheck(this, RendererContact);\n\n    return _super.apply(this, arguments);\n  }\n\n  RendererContact_createClass(RendererContact, [{\n    key: \"selectors\",\n    value: function selectors() {\n      this.$hero = this.$el.querySelector('.contact__hero');\n\n      if (this.$hero) {\n        this.$heroPin = this.$hero.querySelector('.subcolumns__item--pin');\n        this.$heroFix = this.$hero.querySelector('.subcolumns__item--fix');\n        this.$heroParallax = this.$hero.querySelector('.subcolumns__item--parallax');\n      }\n    } // preload()\n    // {\n    //     // Preloader\n    //     const _main = [];\n    //     const _secondary = [];\n    //     this.preloadItems = {\n    //         main: _main,\n    //         secondary: _secondary\n    //     };\n    // }\n\n  }, {\n    key: \"events\",\n    value: function events() {} // eslint-disable-line\n\n  }, {\n    key: \"beforeEnter\",\n    value: function beforeEnter() {} // eslint-disable-line\n\n  }, {\n    key: \"enter\",\n    value: function enter() {\n      this.appUi.$infoContent.querySelector('input[name=\"info-subject\"]').value = 'Información general';\n\n      if (this.appStore.isDesktop) {\n        this.pinSidebar();\n        this.parallaxSidebar();\n      }\n    }\n  }, {\n    key: \"pinSidebar\",\n    value: function pinSidebar() {\n      var _this = this;\n\n      if (this.$heroPin) {\n        var offset = this.$hero.getBoundingClientRect().height - this.$heroPin.getBoundingClientRect().height - this.$heroFix.getBoundingClientRect().height - window.innerWidth * 0.25;\n        this.superTrigger.create({\n          trigger: this.$hero,\n          start: 'top top',\n          end: offset + 'px top',\n          scrub: true,\n          onUpdate: function onUpdate(self) {\n            gsap/* default.set */.ZP.set(_this.$heroPin, {\n              y: offset * self.progress\n            });\n          }\n        });\n      }\n    }\n  }, {\n    key: \"parallaxSidebar\",\n    value: function parallaxSidebar() {\n      var _this2 = this;\n\n      if (this.$heroParallax) {\n        var offset = -(window.innerWidth * 0.05);\n        this.superTrigger.create({\n          trigger: this.$hero,\n          start: 'top top',\n          end: 'bottom bottom',\n          scrub: true,\n          onUpdate: function onUpdate(self) {\n            gsap/* default.set */.ZP.set(_this2.$heroParallax, {\n              y: offset * self.progress\n            });\n          }\n        });\n      }\n    }\n  }, {\n    key: \"raf\",\n    value: function raf() {} // eslint-disable-line\n\n  }]);\n\n  return RendererContact;\n}(renderer); // Don`t forget to export your renderer\n\n\n/* harmony default export */ const renderers_RendererContact = (RendererContact);\n;// CONCATENATED MODULE: ./app/src/js/transitions/transition.js\nfunction transition_typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { transition_typeof = function _typeof(obj) { return typeof obj; }; } else { transition_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return transition_typeof(obj); }\n\nfunction transition_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction transition_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction transition_createClass(Constructor, protoProps, staticProps) { if (protoProps) transition_defineProperties(Constructor.prototype, protoProps); if (staticProps) transition_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction transition_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) transition_setPrototypeOf(subClass, superClass); }\n\nfunction transition_setPrototypeOf(o, p) { transition_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return transition_setPrototypeOf(o, p); }\n\nfunction transition_createSuper(Derived) { var hasNativeReflectConstruct = transition_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = transition_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = transition_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return transition_possibleConstructorReturn(this, result); }; }\n\nfunction transition_possibleConstructorReturn(self, call) { if (call && (transition_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return transition_assertThisInitialized(self); }\n\nfunction transition_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction transition_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction transition_getPrototypeOf(o) { transition_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return transition_getPrototypeOf(o); }\n\n// App\n\n\n // Highway\n\n // Preload\n\n // GSAP Library\n\n\n // Transition\n\nvar Transition = /*#__PURE__*/function (_Highway$Transition) {\n  transition_inherits(Transition, _Highway$Transition);\n\n  var _super = transition_createSuper(Transition);\n\n  function Transition() {\n    transition_classCallCheck(this, Transition);\n\n    return _super.apply(this, arguments);\n  }\n\n  transition_createClass(Transition, [{\n    key: \"out\",\n    value: function out(_ref) {\n      var from = _ref.from,\n          done = _ref.done;\n      // Store\n      this.appStore = appStore; // App references\n\n      this.appCore = new app_appCore();\n      this.appUi = new app_appUi();\n      if (this.preloadMain) this.preloadMain.cancel();\n      if (this.preloadSecondary) this.preloadSecondary.cancel(); // Out animation\n\n      this.outAnimation(from, done);\n    }\n  }, {\n    key: \"outAnimation\",\n    value: function outAnimation(from, done) {\n      from.remove();\n      done();\n    }\n  }, {\n    key: \"in\",\n    value: function _in(_ref2) {\n      var _this = this;\n\n      var from = _ref2.from,\n          to = _ref2.to,\n          done = _ref2.done;\n      // Store\n      this.appStore = appStore; // App references\n\n      this.appCore = new app_appCore();\n      this.appUi = new app_appUi(); // Preloader\n\n      this.preloadMain = null;\n      this.preloadSecondary = null;\n      this.preloadDelay = 0; // Lazy load\n\n      this.lazyLoad = null; // Set animation\n\n      this.setAnimation(from, to);\n      this.preloadItems = this.appCore.highway.To.preloadItems;\n\n      if (this.preloadItems.main.length > 0) {\n        var _preloadOn = new Date().getTime();\n\n        this.preloadMain = preload_it_default()();\n        this.preloadMain.fetch(this.preloadItems.main); // this.preloadMain.onprogress = (event) => { console.log('Primary: ' + event.progress + '%'); };\n\n        this.preloadMain.oncomplete = function (items) {\n          var _preloadOff = new Date().getTime();\n\n          var _preloadDifference = (_preloadOff - _preloadOn) / 1000;\n\n          var _preloadDelay = Math.max(0, _this.preloadDelay - _preloadDifference);\n\n          gsap/* default.delayedCall */.ZP.delayedCall(_preloadDelay, function () {\n            // In animation\n            _this.inAnimation(from, to, done);\n          });\n        };\n\n        if (this.preloadItems.secondary.length > 0) {\n          this.preloadSecondary = preload_it_default()();\n          this.preloadSecondary.fetch(this.preloadItems.secondary); // this.preloadSecondary.onprogress = (event) => { console.log('Secondary: ' + event.progress + '%'); };\n        }\n      } else {\n        gsap/* default.delayedCall */.ZP.delayedCall(this.preloadDelay, function () {\n          // In animation\n          _this.inAnimation(from, to, done);\n        });\n      }\n    }\n  }, {\n    key: \"setAnimation\",\n    value: function setAnimation(from, to) {} // eslint-disable-line\n\n  }, {\n    key: \"inAnimation\",\n    value: function inAnimation(from, to, done) {\n      done();\n    }\n  }]);\n\n  return Transition;\n}(highway_module/* default.Transition */.Z.Transition);\n\n/* harmony default export */ const transition = (Transition);\n;// CONCATENATED MODULE: ./app/src/js/transitions/transitionFade.js\nfunction transitionFade_typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { transitionFade_typeof = function _typeof(obj) { return typeof obj; }; } else { transitionFade_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return transitionFade_typeof(obj); }\n\nfunction transitionFade_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction transitionFade_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction transitionFade_createClass(Constructor, protoProps, staticProps) { if (protoProps) transitionFade_defineProperties(Constructor.prototype, protoProps); if (staticProps) transitionFade_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction transitionFade_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) transitionFade_setPrototypeOf(subClass, superClass); }\n\nfunction transitionFade_setPrototypeOf(o, p) { transitionFade_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return transitionFade_setPrototypeOf(o, p); }\n\nfunction transitionFade_createSuper(Derived) { var hasNativeReflectConstruct = transitionFade_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = transitionFade_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = transitionFade_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return transitionFade_possibleConstructorReturn(this, result); }; }\n\nfunction transitionFade_possibleConstructorReturn(self, call) { if (call && (transitionFade_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return transitionFade_assertThisInitialized(self); }\n\nfunction transitionFade_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction transitionFade_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction transitionFade_getPrototypeOf(o) { transitionFade_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return transitionFade_getPrototypeOf(o); }\n\n// Import Transition\n // GSAP Library\n\n // Fade\n\nvar TransitionFade = /*#__PURE__*/function (_Transition) {\n  transitionFade_inherits(TransitionFade, _Transition);\n\n  var _super = transitionFade_createSuper(TransitionFade);\n\n  function TransitionFade() {\n    transitionFade_classCallCheck(this, TransitionFade);\n\n    return _super.apply(this, arguments);\n  }\n\n  transitionFade_createClass(TransitionFade, [{\n    key: \"outAnimation\",\n    value: function outAnimation(from, done) {\n      gsap/* default.fromTo */.ZP.fromTo(from, {\n        opacity: 1\n      }, {\n        opacity: 0,\n        duration: 0.8,\n        onComplete: function onComplete() {\n          from.remove();\n          done();\n        }\n      });\n    }\n  }, {\n    key: \"inAnimation\",\n    value: function inAnimation(from, to, done) {\n      window.scrollTo(0, 0);\n      document.documentElement.scrollTop = 0;\n      done();\n      gsap/* default.to */.ZP.to(to, {\n        opacity: 1,\n        duration: 0.8\n      });\n    }\n  }]);\n\n  return TransitionFade;\n}(transition);\n\n/* harmony default export */ const transitionFade = (TransitionFade);\n;// CONCATENATED MODULE: ./app/src/js/transitions/transitionMask.js\nfunction transitionMask_typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { transitionMask_typeof = function _typeof(obj) { return typeof obj; }; } else { transitionMask_typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return transitionMask_typeof(obj); }\n\nfunction transitionMask_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction transitionMask_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction transitionMask_createClass(Constructor, protoProps, staticProps) { if (protoProps) transitionMask_defineProperties(Constructor.prototype, protoProps); if (staticProps) transitionMask_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction transitionMask_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) transitionMask_setPrototypeOf(subClass, superClass); }\n\nfunction transitionMask_setPrototypeOf(o, p) { transitionMask_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return transitionMask_setPrototypeOf(o, p); }\n\nfunction transitionMask_createSuper(Derived) { var hasNativeReflectConstruct = transitionMask_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = transitionMask_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = transitionMask_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return transitionMask_possibleConstructorReturn(this, result); }; }\n\nfunction transitionMask_possibleConstructorReturn(self, call) { if (call && (transitionMask_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return transitionMask_assertThisInitialized(self); }\n\nfunction transitionMask_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction transitionMask_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction transitionMask_getPrototypeOf(o) { transitionMask_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return transitionMask_getPrototypeOf(o); }\n\n// Import Transition\n // GSAP Library\n\n // Mask\n\nvar TransitionMask = /*#__PURE__*/function (_Transition) {\n  transitionMask_inherits(TransitionMask, _Transition);\n\n  var _super = transitionMask_createSuper(TransitionMask);\n\n  function TransitionMask() {\n    transitionMask_classCallCheck(this, TransitionMask);\n\n    return _super.apply(this, arguments);\n  }\n\n  transitionMask_createClass(TransitionMask, [{\n    key: \"outAnimation\",\n    value: function outAnimation(from, done) {\n      gsap/* default.set */.ZP.set(this.appUi.$mask, {\n        display: 'block'\n      });\n      gsap/* default.fromTo */.ZP.fromTo(this.appUi.$mask.children[0], {\n        y: '-100%'\n      }, {\n        y: '0%',\n        duration: 1,\n        ease: 'expo.in',\n        delay: this.appUi.header.isOpen ? 0.8 : 0,\n        onStart: function onStart() {\n          gsap/* default.to */.ZP.to(from, {\n            y: '5vw',\n            duration: 1,\n            ease: 'expo.in'\n          });\n        },\n        onComplete: function onComplete() {\n          from.remove();\n          done();\n        }\n      });\n    }\n  }, {\n    key: \"inAnimation\",\n    value: function inAnimation(from, to, done) {\n      var _this = this;\n\n      gsap/* default.set */.ZP.set(this.appUi.$logo, {\n        y: 0\n      });\n      window.scrollTo(0, 0);\n      document.documentElement.scrollTop = 0;\n      done();\n      gsap/* default.to */.ZP.to(this.appUi.$mask.children[0], {\n        y: '100%',\n        duration: 1,\n        ease: 'expo.out',\n        onComplete: function onComplete() {\n          gsap/* default.set */.ZP.set(_this.appUi.$mask, {\n            display: 'none'\n          });\n        }\n      });\n    }\n  }]);\n\n  return TransitionMask;\n}(transition);\n\n/* harmony default export */ const transitionMask = (TransitionMask);\n;// CONCATENATED MODULE: ./app/src/js/app/appCore.js\nfunction appCore_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction appCore_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction appCore_createClass(Constructor, protoProps, staticProps) { if (protoProps) appCore_defineProperties(Constructor.prototype, protoProps); if (staticProps) appCore_defineProperties(Constructor, staticProps); return Constructor; }\n\n// app\n\n // classes\n\n // Highway\n\n // gsap\n\n // Import Renderers\n// import Renderer from '../renderers/renderer';\n\n\n\n\n\n\n\n\n\n\n // Import Transitions\n\n\n\n\nvar appCore_singleton = null;\n\nvar appCore = /*#__PURE__*/function () {\n  function appCore(data) {\n    appCore_classCallCheck(this, appCore);\n\n    if (!appCore_singleton) {\n      this.data = data;\n      appCore_singleton = this;\n    } else {\n      return appCore_singleton;\n    } // console.log('Constructor de appCore');\n    // store\n\n\n    this.appStore = appStore; // app references\n\n    this.appUi = new app_appUi(); // Events\n\n    this.domEvents = new domEvents_default(); // Highway core\n\n    this.highway = null;\n  }\n\n  appCore_createClass(appCore, [{\n    key: \"init\",\n    value: function init() {\n      var _this = this;\n\n      // Call Highway.Core once.\n      this.highway = new highway_module/* default.Core */.Z.Core({\n        renderers: {\n          home: rendererHome,\n          promotions: rendererPromotions,\n          promotionssingle: rendererPromotionsSingle,\n          about: rendererAbout,\n          philosophy: rendererPhilosophy,\n          masterworks: rendererMasterworks,\n          blog: rendererBlog,\n          blogsingle: rendererBlogSingle,\n          contact: renderers_RendererContact,\n          \"default\": rendererDefault\n        },\n        transitions: {\n          \"default\": this.appStore.isDesktop ? transitionMask : transitionFade\n        }\n      });\n      this.highway.on('NAVIGATE_OUT', function (_ref) {\n        var from = _ref.from,\n            trigger = _ref.trigger,\n            location = _ref.location;\n\n        _this.navigateOut(from, trigger, location);\n      });\n      this.highway.on('NAVIGATE_IN', function (_ref2) {\n        var to = _ref2.to,\n            trigger = _ref2.trigger,\n            location = _ref2.location;\n\n        _this.navigateIn(to, trigger, location);\n      });\n      this.highway.on('NAVIGATE_END', function (_ref3) {\n        var to = _ref3.to,\n            from = _ref3.from,\n            trigger = _ref3.trigger,\n            location = _ref3.location;\n\n        _this.navigateEnd(to, from, trigger, location);\n      }); // Cookie links\n\n      var cookieLink = document.querySelector('#cookie-law-info-bar .cookie_action_close_header');\n\n      if (cookieLink) {\n        cookieLink.href = 'javascript:void(0);';\n        cookieLink.setAttribute('data-router-disabled', ''); //this.highway.detach(cookieLink);\n      }\n    }\n  }, {\n    key: \"navigateStart\",\n    value: function navigateStart() {\n      // Start navigation on 0\n      window.scrollTo(0, 0);\n      document.documentElement.scrollTop = 0;\n      if (history.scrollRestoration) history.scrollRestoration = 'manual'; // Show submenu on homepage\n\n      if (this.appStore.current === 'home' && this.appStore.isDesktop) this.appUi.triggerSubmenu(true); // Position the menu on promotionSingle\n\n      if (this.appStore.current === 'promotionssingle' && this.appStore.isDesktop) gsap/* default.set */.ZP.set([this.appUi.$header], {\n        y: '-2.5vw'\n      });else gsap/* default.set */.ZP.set([this.appUi.$header], {\n        y: '0vw'\n      }); // Query admin bar links, and new page's admin bar links\n\n      var languageLinks = document.querySelectorAll('#header .menu-item-object-language_switcher a');\n\n      if (languageLinks) {\n        for (var i = 0; i < languageLinks.length; i++) {\n          languageLinks[i].setAttribute('data-router-disabled', '');\n        }\n\n        this.highway.detach(languageLinks);\n      }\n    }\n  }, {\n    key: \"navigateOut\",\n    value: function navigateOut(from, trigger, location) {\n      this.appStore.from = from.view.dataset.routerView; // Show submenu on homepage\n\n      if (this.appStore.from === 'home' && this.appStore.isDesktop) this.appUi.triggerSubmenu(false);\n      if (this.appUi.header.isOpen) this.appUi.triggerMenu();\n    }\n  }, {\n    key: \"navigateIn\",\n    value: function navigateIn(to, trigger, location) {\n      this.appStore.to = to.view.dataset.routerView; // Show submenu on homepage\n\n      if (this.appStore.to === 'home' && this.appStore.isDesktop) this.appUi.triggerSubmenu(true); // Position the menu on promotionSingle\n\n      if (this.appStore.to === 'promotionssingle' && this.appStore.isDesktop) gsap/* default.to */.ZP.to(this.appUi.$header, {\n        y: '-2.5vw',\n        duration: 1,\n        ease: 'expo.out'\n      });else gsap/* default.to */.ZP.to(this.appUi.$header, {\n        y: '0vw',\n        duration: 1,\n        ease: 'expo.out'\n      });\n    }\n  }, {\n    key: \"navigateEnd\",\n    value: function navigateEnd(to, from, trigger, location) {\n      this.appStore.to = to.view.dataset.routerView; // Remove active item\n\n      if (this.appUi.$header.querySelector('.active')) this.appUi.$header.querySelector('.active').classList.remove('active'); // Add active item\n\n      if (this.appUi.$header.querySelector('.menu-item--' + this.appStore.to)) this.appUi.$header.querySelector('.menu-item--' + this.appStore.to).classList.add('active'); // Set classes\n\n      document.querySelector('body').setAttribute('class', to.page.body.getAttribute('class')); // // Query admin bar links, and new page's admin bar links\n      // const oldLanguageLinks = document.querySelectorAll('#header a');\n      // const newLanguageLinks = to.page.body.querySelectorAll('#header a');\n      // // Replace every admin bar link's href value with new value\n      // if(oldLanguageLinks)\n      // {\n      //     for(let i = 0; i < newLanguageLinks.length; i++)\n      //     {\n      //         oldLanguageLinks[i].parentNode.setAttribute('class', newLanguageLinks[i].parentNode.getAttribute('class'));\n      //         oldLanguageLinks[i].href = newLanguageLinks[i].href;\n      //     }\n      //     // Detach admin bar links from Highway transitions\n      //     this.highway.detach(oldLanguageLinks);\n      // }\n    }\n  }, {\n    key: \"selectors\",\n    value: function selectors() {// Get all menu menuLinks\n      // this.$menuLinks = document.querySelectorAll('#menu ul a');\n    }\n  }, {\n    key: \"events\",\n    value: function events() {// for (let i = 0; i < this.$menuLinks.length; i++) {\n      //     this.domEvents.add(this.$menuLinks[i], 'mouseenter', (e, a, el) => { this.appUi.menuEnter(e, a, el); }, this);\n      //     this.domEvents.add(this.$menuLinks[i], 'mouseleave', (e, a, el) => { this.appUi.menuLeave(e, a, el); }, this);\n      // }\n    }\n  }, {\n    key: \"resize\",\n    value: function resize(width, height) {// console.log('Resize appCore:', width, height);\n      //  this.highway.Helpers.renderers[this.highway.properties.slug].prototype.resize();\n      // console.log(this.highway.Helpers.renderers.locales.prototype);\n    }\n  }, {\n    key: \"resizeOrientation\",\n    value: function resizeOrientation() {// gsap.to(document.documentElement, { opacity: 0.0001, duration: 0.6, ease: 'power2.out', onComplete: () => {\n      //     gsap.to(document.documentElement, { opacity: 1, duration: 0.6, ease: 'power2.out' });\n      // }});\n    }\n  }]);\n\n  return appCore;\n}();\n\n/* harmony default export */ const app_appCore = (appCore);\n;// CONCATENATED MODULE: ./app/src/js/utils/debounce.js\n//Copyright 2018 Vicente Lucendo - vicen@vlucendo.com\n//simple debounce with callback\n/* harmony default export */ function debounce(callback, delay) {\n  var timeout;\n  return function () {\n    clearTimeout(timeout);\n    timeout = setTimeout(callback, delay);\n  };\n}\n;\n// EXTERNAL MODULE: ./node_modules/bowser/es5.js\nvar es5 = __webpack_require__(206);\nvar es5_default = /*#__PURE__*/__webpack_require__.n(es5);\n;// CONCATENATED MODULE: ./app/src/js/app/app.js\nfunction app_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction app_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction app_createClass(Constructor, protoProps, staticProps) { if (protoProps) app_defineProperties(Constructor.prototype, protoProps); if (staticProps) app_defineProperties(Constructor, staticProps); return Constructor; }\n\n// css\n // eslint-disable-line\n// app\n\n\n\n // classes\n\n // gsap\n\n // utils\n\n\n\n\nvar Application = /*#__PURE__*/function () {\n  function Application(options) {\n    app_classCallCheck(this, Application);\n\n    // console.log('Constructor de app');\n    // store\n    this.appStore = appStore; // app references\n\n    this.appCore = new app_appCore();\n    this.appUi = new app_appUi(); // Events\n\n    this.domEvents = new domEvents_default(); // get current url\n\n    this.appStore.rootUrl = window.location.protocol + '// ' + window.location.host; // get client info\n\n    var clientInfo = es5_default().getParser(window.navigator.userAgent).parsedResult;\n    this.appStore.isDesktop = !(window.innerWidth < 1023 || window.innerWidth < window.innerHeight);\n    this.setOS(clientInfo);\n    this.setDevice(clientInfo);\n    this.setOrientation();\n    this.addClasses();\n    this.sayHello();\n    this.checkElements();\n    this.selectors();\n    this.events();\n    this.init();\n  }\n\n  app_createClass(Application, [{\n    key: \"setOS\",\n    value: function setOS(clientInfo) {\n      var os = clientInfo.os.name.toLowerCase(); // detect mac and ios, default windows\n\n      switch (os) {\n        case 'macos':\n          this.appStore.client.os = 'mac';\n          break;\n\n        case 'ios':\n          this.appStore.client.os = 'ios';\n          break;\n\n        default:\n          this.appStore.client.os = 'windows';\n      }\n    }\n  }, {\n    key: \"setDevice\",\n    value: function setDevice(clientInfo) {\n      // get device\n      this.appStore.client.device = clientInfo.platform.type === 'desktop' ? 'desktop' : 'mobile'; // detect browser (only the major ones, default is chrome)\n\n      switch (clientInfo.browser.name) {\n        case 'Internet Explorer':\n          this.appStore.client.browser = 'explorer';\n          break;\n\n        case 'Microsoft Edge':\n          this.appStore.client.browser = 'edge';\n          break;\n\n        case 'Firefox':\n          this.appStore.client.browser = 'firefox';\n          break;\n\n        case 'Safari':\n          this.appStore.client.browser = 'safari';\n          break;\n\n        default:\n          this.appStore.client.browser = 'chrome';\n      }\n    }\n  }, {\n    key: \"setOrientation\",\n    value: function setOrientation() {\n      this.appStore.client.orientation = this.appStore.client.sizes.width > this.appStore.client.sizes.height ? 'horizontal' : 'vertical';\n    }\n  }, {\n    key: \"addClasses\",\n    value: function addClasses() {\n      document.documentElement.classList.add(this.appStore.client.device);\n      document.documentElement.classList.add(this.appStore.client.os);\n      document.documentElement.classList.add(this.appStore.client.browser);\n    }\n  }, {\n    key: \"sayHello\",\n    value: function sayHello() {\n      if (this.appStore.client.browser === 'chrome' || this.appStore.client.browser === 'firefox') {\n        var args = ['\\n%c Developed with ♥ by Dgrees® - https:// dgrees.studio %c\\n', 'display: block; padding: 5px 10px; background: #000022; line-height: 40px; color: #ffffff;', 'background: #fff;'];\n        window.console.log.apply(console, args);\n      } else {\n        window.console.log('Developed by Dgrees®');\n      }\n    }\n  }, {\n    key: \"checkElements\",\n    value: function checkElements() {\n      if (this.appStore.isDesktop) {\n        this.$elementsMobile = document.querySelectorAll('[data-mobile]');\n\n        for (var i = 0; i < this.$elementsMobile.length; i++) {\n          this.$elementsMobile[i].remove();\n        }\n      } else {\n        this.$elementsDesktop = document.querySelectorAll('[data-desktop]');\n\n        for (var _i = 0; _i < this.$elementsDesktop.length; _i++) {\n          this.$elementsDesktop[_i].remove();\n        }\n      }\n    }\n  }, {\n    key: \"selectors\",\n    value: function selectors() {\n      this.appCore.selectors();\n      this.appUi.selectors();\n    }\n  }, {\n    key: \"events\",\n    value: function events() {\n      var _this = this;\n\n      // bind debounced resize\n      this.domEvents.add(window, 'resize', debounce(function () {\n        _this.resize(window.innerWidth, window.innerHeight);\n      }, 150));\n      var orientationEvent = 'onorientationchange' in window ? 'orientationchange' : 'resize';\n      this.domEvents.add(window, orientationEvent, debounce(function () {\n        _this.resizeOrientation(window.innerWidth, window.innerHeight);\n      }, 150));\n      this.appCore.events();\n      this.appUi.events();\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      this.appCore.init();\n      this.appUi.init();\n      var vh = window.innerHeight * 0.01;\n      document.documentElement.style.setProperty('--vh', \"\".concat(vh, \"px\"));\n      this.resize(window.innerWidth, window.innerHeight);\n    }\n  }, {\n    key: \"resize\",\n    value: function resize(width, height) {\n      // First we get the viewport height and we multiple it by 1% to get a value for a vh unit\n      if (this.appStore.isDesktop) {\n        var vh = window.innerHeight * 0.01;\n        document.documentElement.style.setProperty('--vh', \"\".concat(vh, \"px\"));\n      }\n\n      this.appStore.isDesktop = !(window.innerWidth < 1023 || window.innerWidth < window.innerHeight); // set size vars\n\n      this.appStore.client.sizes.width = width;\n      this.appStore.client.sizes.height = height;\n      this.appCore.resize(width, height);\n      this.appUi.resize(width, height);\n      if (this.appStore.currentSection !== null) this.appStore.currentSection.resize(width, height); // // Check orientation\n      // const newOrientation = this.appStore.client.sizes.width > this.appStore.client.sizes.height ? 'horizontal' : 'vertical';\n      // if(newOrientation !== this.appStore.client.orientation)\n      //     this.resizeOrientation(width, height, newOrientation);\n      // this.appStore.client.orientation = newOrientation;\n    }\n  }, {\n    key: \"resizeOrientation\",\n    value: function resizeOrientation(width, height, orientation) {\n      var vh = window.innerHeight * 0.01;\n      document.documentElement.style.setProperty('--vh', \"\".concat(vh, \"px\")); // Check orientation\n\n      var newOrientation = this.appStore.client.sizes.width > this.appStore.client.sizes.height ? 'horizontal' : 'vertical';\n      this.appStore.client.orientation = newOrientation;\n      this.appCore.resizeOrientation(width, height, orientation);\n      this.appUi.resizeOrientation(width, height, orientation);\n      if (this.appStore.currentSection !== null) this.appStore.currentSection.resizeOrientation(width, height, orientation);\n    }\n    /* _checkOrientation()\n    {\n        // if it's not affected by orientation pass the current one (0: horizontal, 1: vertical)\n        if(this.orientation === orientations.NONE)\n            this.// (this.appStore.client.sizes.width > this.appStore.client.sizes.height ? 0 : 1);\n         if(this.orientation === orientations.VERTICAL)\n        {\n            // if width is bigger than height\n            if(this.appStore.client.sizes.width > this.appStore.client.sizes.height)\n                this.rotateDevice(true);\n            else\n                this.rotateDevice(false);\n        }\n        else if(this.orientation === orientations.HORIZONTAL)\n        {\n            // if height is bigger than width\n            if(this.appStore.client.sizes.height > this.appStore.client.sizes.width)\n                this.rotateDevice(true);\n            else\n                this.rotateDevice(false);\n        }\n    } */\n    // rotateDevice(action){} // eslint-disable-line\n\n  }]);\n\n  return Application;\n}();\n\n/* harmony default export */ const app_app = (Application);\n;// CONCATENATED MODULE: ./app/src/js/loader.js\n//apps\n //on document ready create loader\n\nif (document.readyState !== 'loading') {\n  var app = new app_app();\n} else {\n  document.addEventListener('DOMContentLoaded', function () {\n    var app = new app_app();\n  }, false); //eslint-disable-line\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODE1LmpzIiwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDVkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUNuSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7O0FDajhCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3ZaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDdG1CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuOEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUMvU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUNoUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUN2Y0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUMzSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5Z0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFlQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JkQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUMvTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoc0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcFBBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdklBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcklBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUNUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2NhbGVkb25pYW4vLi9hcHAvc3JjL2pzL2FwcC9hcHBTdG9yZS5qcz85MWJhIiwid2VicGFjazovL2NhbGVkb25pYW4vLi9hcHAvc3JjL2pzL3V0aWxzL3N0cmluZy5qcz9lZTI4Iiwid2VicGFjazovL2NhbGVkb25pYW4vLi9hcHAvc3JjL2pzL3V0aWxzL2lzLmpzP2Y1NGUiLCJ3ZWJwYWNrOi8vY2FsZWRvbmlhbi8uL2FwcC9zcmMvanMvY2xhc3Nlcy9kb21FdmVudHMuanM/ZWEzOCIsIndlYnBhY2s6Ly9jYWxlZG9uaWFuLy4vYXBwL3NyYy9qcy9hcHAvYXBwVWkuanM/NjEyMiIsIndlYnBhY2s6Ly9jYWxlZG9uaWFuLy4vYXBwL3NyYy9qcy9jbGFzc2VzL3N1cGVyU2Nyb2xsZXIuanM/MDY4ZSIsIndlYnBhY2s6Ly9jYWxlZG9uaWFuLy4vYXBwL3NyYy9qcy91dGlscy9zdHJpbmdzLmpzPzQ1MWEiLCJ3ZWJwYWNrOi8vY2FsZWRvbmlhbi8uL2FwcC9zcmMvanMvY2xhc3Nlcy9zcGxpdFRleHQuanM/NzY3MSIsIndlYnBhY2s6Ly9jYWxlZG9uaWFuLy4vYXBwL3NyYy9qcy9yZW5kZXJlcnMvcmVuZGVyZXIuanM/MjgzYyIsIndlYnBhY2s6Ly9jYWxlZG9uaWFuLy4vYXBwL3NyYy9qcy9yZW5kZXJlcnMvcmVuZGVyZXJEZWZhdWx0LmpzPzgxNjYiLCJ3ZWJwYWNrOi8vY2FsZWRvbmlhbi8uL2FwcC9zcmMvanMvY2xhc3Nlcy9zdXBlckRyYWdnZXIuanM/NjVhNSIsIndlYnBhY2s6Ly9jYWxlZG9uaWFuLy4vYXBwL3NyYy9qcy91dGlscy9WZWxvY2l0eVRyYWNrZXIuanM/YThmNSIsIndlYnBhY2s6Ly9jYWxlZG9uaWFuLy4vYXBwL3NyYy9qcy9jbGFzc2VzL0luZXJ0aWFQbHVnaW4uanM/ODQzZSIsIndlYnBhY2s6Ly9jYWxlZG9uaWFuLy4vYXBwL3NyYy9qcy9jbGFzc2VzL0RyYWdnYWJsZS5qcz9kYjVkIiwid2VicGFjazovL2NhbGVkb25pYW4vLi9hcHAvc3JjL2pzL3JlbmRlcmVycy9yZW5kZXJlckhvbWUuanM/MjY5ZCIsIndlYnBhY2s6Ly9jYWxlZG9uaWFuLy4vYXBwL3NyYy9qcy9yZW5kZXJlcnMvcmVuZGVyZXJBYm91dC5qcz80OGYwIiwid2VicGFjazovL2NhbGVkb25pYW4vLi9hcHAvc3JjL2pzL3JlbmRlcmVycy9yZW5kZXJlclBoaWxvc29waHkuanM/OWI0NSIsIndlYnBhY2s6Ly9jYWxlZG9uaWFuLy4vYXBwL3NyYy9qcy9yZW5kZXJlcnMvcmVuZGVyZXJQcm9tb3Rpb25zLmpzP2VlNmUiLCJ3ZWJwYWNrOi8vY2FsZWRvbmlhbi8uL2FwcC9zcmMvanMvY29tcG9uZW50cy9zbGlkZXIuanM/NGQ5MSIsIndlYnBhY2s6Ly9jYWxlZG9uaWFuLy4vYXBwL3NyYy9qcy9yZW5kZXJlcnMvcmVuZGVyZXJQcm9tb3Rpb25zU2luZ2xlLmpzPzExZTYiLCJ3ZWJwYWNrOi8vY2FsZWRvbmlhbi8uL2FwcC9zcmMvanMvcmVuZGVyZXJzL3JlbmRlcmVyTWFzdGVyd29ya3MuanM/YjY4YiIsIndlYnBhY2s6Ly9jYWxlZG9uaWFuLy4vYXBwL3NyYy9qcy9yZW5kZXJlcnMvcmVuZGVyZXJCbG9nLmpzPzc3YjUiLCJ3ZWJwYWNrOi8vY2FsZWRvbmlhbi8uL2FwcC9zcmMvanMvcmVuZGVyZXJzL3JlbmRlcmVyQmxvZ1NpbmdsZS5qcz8zZTAzIiwid2VicGFjazovL2NhbGVkb25pYW4vLi9hcHAvc3JjL2pzL3JlbmRlcmVycy9SZW5kZXJlckNvbnRhY3QuanM/Y2QwZSIsIndlYnBhY2s6Ly9jYWxlZG9uaWFuLy4vYXBwL3NyYy9qcy90cmFuc2l0aW9ucy90cmFuc2l0aW9uLmpzP2E1ODkiLCJ3ZWJwYWNrOi8vY2FsZWRvbmlhbi8uL2FwcC9zcmMvanMvdHJhbnNpdGlvbnMvdHJhbnNpdGlvbkZhZGUuanM/YWJlOCIsIndlYnBhY2s6Ly9jYWxlZG9uaWFuLy4vYXBwL3NyYy9qcy90cmFuc2l0aW9ucy90cmFuc2l0aW9uTWFzay5qcz9jNzUxIiwid2VicGFjazovL2NhbGVkb25pYW4vLi9hcHAvc3JjL2pzL2FwcC9hcHBDb3JlLmpzPzE2YjAiLCJ3ZWJwYWNrOi8vY2FsZWRvbmlhbi8uL2FwcC9zcmMvanMvdXRpbHMvZGVib3VuY2UuanM/Zjg0YyIsIndlYnBhY2s6Ly9jYWxlZG9uaWFuLy4vYXBwL3NyYy9qcy9hcHAvYXBwLmpzPzk5MTQiLCJ3ZWJwYWNrOi8vY2FsZWRvbmlhbi8uL2FwcC9zcmMvanMvbG9hZGVyLmpzP2Y5NjMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQge1xuICBtYWluOiBudWxsLFxuICByb290VXJsOiBudWxsLFxuICBpc0Rlc2t0b3A6IG51bGwsXG4gIGZpcnN0TmF2aWdhdGlvbjogbnVsbCxcbiAgY3VycmVudFNlY3Rpb246IG51bGwsXG4gIGNsaWVudDoge1xuICAgIGJyb3dzZXI6ICcnLFxuICAgIGRldmljZTogJycsXG4gICAgbGFuZzogJ2VzJyxcbiAgICBvczogJycsXG4gICAgb3JpZW50YXRpb246IG51bGwsXG4gICAgc2l6ZXM6IHtcbiAgICAgIHdpZHRoOiB3aW5kb3cuaW5uZXJXaWR0aCxcbiAgICAgIGhlaWdodDogd2luZG93LmlubmVySGVpZ2h0XG4gICAgfSxcbiAgICBtb3VzZVBvc2l0aW9uOiB7XG4gICAgICB4OiB3aW5kb3cuaW5uZXJXaWR0aCAvIDIsXG4gICAgICB5OiB3aW5kb3cuaW5uZXJIZWlnaHQgLyAyXG4gICAgfVxuICB9XG59OyIsIi8vQ29weXJpZ2h0IDIwMTggVmljZW50ZSBMdWNlbmRvIC0gdmljZW5Admx1Y2VuZG8uY29tXG5leHBvcnQgdmFyIHN0cmluZyA9IHtcbiAgLy9jb252ZXJ0cyBhIHN0cmluZyBudW1iZXIgJyNGRkZGRkYnIHRvIGhleCAweGZmZmZmZiAtIGl0IGdldHMgdXNlZCBvbiBwaXhpXG4gIHRvSGV4OiBmdW5jdGlvbiB0b0hleChzdHIpIHtcbiAgICByZXR1cm4gcGFyc2VJbnQoc3RyLnN1YnN0cmluZygxKSwgMTYpO1xuICB9LFxuICAvL3RydWUgb3IgZmFsc2UgaWYgdGV4dCBpcyBvbiB0aGUgc3RyaW5nXG4gIGNvbnRhaW5zOiBmdW5jdGlvbiBjb250YWlucyhzdHIsIHRleHQpIHtcbiAgICByZXR1cm4gc3RyLmluZGV4T2YodGV4dCkgPiAtMTtcbiAgfVxufTsiLCIvL0NvcHlyaWdodCAyMDE4IFZpY2VudGUgTHVjZW5kbyAtIHZpY2VuQHZsdWNlbmRvLmNvbVxuaW1wb3J0IHsgc3RyaW5nIH0gZnJvbSAnLi9zdHJpbmcnO1xuZXhwb3J0IHZhciBpcyA9IHtcbiAgYXJyYXk6IGZ1bmN0aW9uIGFycmF5KGEpIHtcbiAgICByZXR1cm4gQXJyYXkuaXNBcnJheShhKTtcbiAgfSxcbiAgb2JqZWN0OiBmdW5jdGlvbiBvYmplY3QoYSkge1xuICAgIHJldHVybiBzdHJpbmcuY29udGFpbnMoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGEpLCAnT2JqZWN0Jyk7XG4gIH0sXG4gIHBhdGg6IGZ1bmN0aW9uIHBhdGgoYSkge1xuICAgIHJldHVybiBpcy5vYmooYSkgJiYgYS5oYXNPd25Qcm9wZXJ0eSgndG90YWxMZW5ndGgnKTtcbiAgfSxcbiAgLy9lc2xpbnQtZGlzYWJsZS1saW5lXG4gIHN2ZzogZnVuY3Rpb24gc3ZnKGEpIHtcbiAgICByZXR1cm4gYSBpbnN0YW5jZW9mIFNWR0VsZW1lbnQ7XG4gIH0sXG4gIG5vZGU6IGZ1bmN0aW9uIG5vZGUoYSkge1xuICAgIHJldHVybiBhLm5vZGVUeXBlIHx8IGlzLnN2ZyhhKTtcbiAgfSxcbiAgbm9kZUxpc3Q6IGZ1bmN0aW9uIG5vZGVMaXN0KGEpIHtcbiAgICByZXR1cm4gYSBpbnN0YW5jZW9mIE5vZGVMaXN0IHx8IGEgaW5zdGFuY2VvZiBIVE1MQ29sbGVjdGlvbjtcbiAgfSxcbiAgc3RyaW5nOiBmdW5jdGlvbiBzdHJpbmcoYSkge1xuICAgIHJldHVybiB0eXBlb2YgYSA9PT0gJ3N0cmluZyc7XG4gIH0sXG4gIG51bWJlcjogZnVuY3Rpb24gbnVtYmVyKGEpIHtcbiAgICByZXR1cm4gIWlzTmFOKHBhcnNlRmxvYXQoYSkpICYmIGlzRmluaXRlKGEpO1xuICB9LFxuICBcImZ1bmN0aW9uXCI6IGZ1bmN0aW9uIF9mdW5jdGlvbihhKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBhID09PSAnZnVuY3Rpb24nO1xuICB9LFxuICB1bmRlZmluZWQ6IGZ1bmN0aW9uIHVuZGVmaW5lZChhKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBhID09PSAndW5kZWZpbmVkJztcbiAgfSxcbiAgaGV4OiBmdW5jdGlvbiBoZXgoYSkge1xuICAgIHJldHVybiAvKF4jWzAtOUEtRl17Nn0kKXwoXiNbMC05QS1GXXszfSQpL2kudGVzdChhKTtcbiAgfSxcbiAgcmdiOiBmdW5jdGlvbiByZ2IoYSkge1xuICAgIHJldHVybiAvXnJnYi8udGVzdChhKTtcbiAgfSxcbiAgaHNsOiBmdW5jdGlvbiBoc2woYSkge1xuICAgIHJldHVybiAvXmhzbC8udGVzdChhKTtcbiAgfSxcbiAgY29sb3I6IGZ1bmN0aW9uIGNvbG9yKGEpIHtcbiAgICByZXR1cm4gaXMuaGV4KGEpIHx8IGlzLnJnYihhKSB8fCBpcy5oc2woYSk7XG4gIH1cbn07IiwiZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfVxuXG5mdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfVxuXG4vL0NvcHlyaWdodCAyMDE4IFZpY2VudGUgTHVjZW5kbyAtIHZpY2VuQHZsdWNlbmRvLmNvbVxuaW1wb3J0IHsgaXMgfSBmcm9tICcuLi91dGlscy9pcyc7XG5cbnZhciBfZGVmYXVsdCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIF9kZWZhdWx0KCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBfZGVmYXVsdCk7XG5cbiAgICB0aGlzLl9ldmVudENhY2hlID0gW107XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoX2RlZmF1bHQsIFt7XG4gICAga2V5OiBcIl9yZW1vdmVFdmVudFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVtb3ZlRXZlbnQoaW5kZXgpIHtcbiAgICAgIC8vcmVtb3ZlIGV2ZW50IGxpc3RlbmVyXG4gICAgICB0aGlzLl9ldmVudENhY2hlW2luZGV4XS5ub2RlLnJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5fZXZlbnRDYWNoZVtpbmRleF0uYWN0aW9uLCB0aGlzLl9ldmVudENhY2hlW2luZGV4XS5jYik7IC8vcmVtb3ZlIGVsZW1lbnQgZnJvbSBldmVudGNhY2hlXG5cblxuICAgICAgdGhpcy5fZXZlbnRDYWNoZS5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJhZGRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkKG5vZGUsIGV2ZW50TmFtZSwgX2Z1bmMpIHtcbiAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgIHZhciBjb250ZXh0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiBmYWxzZTtcbiAgICAgIHZhciBhcmcgPSBhcmd1bWVudHMubGVuZ3RoID4gNCAmJiBhcmd1bWVudHNbNF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s0XSA6IGZhbHNlO1xuICAgICAgdmFyIHJMaW5rID0gYXJndW1lbnRzLmxlbmd0aCA+IDUgJiYgYXJndW1lbnRzWzVdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNV0gOiBmYWxzZTtcblxuICAgICAgLy9ub2RlbGlzdCBvciBzaW5nbGUgbm9kZT9cbiAgICAgIHZhciBfbm9kZXMgPSBpcy5ub2RlTGlzdChub2RlKSB8fCBpcy5hcnJheShub2RlKSA/IG5vZGUgOiBbbm9kZV07IC8vbG9vcCB0aG91Z2ggdGhlIG5vZGVzXG5cblxuICAgICAgdmFyIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoaSkge1xuICAgICAgICAvL2NyZWF0ZSBjYWxsYmFjayBwYXNzaW5nIHRoZSBldmVudCwgYXJndW1lbnQgYW5kIHNvdXJjZSBub2RlXG4gICAgICAgIHZhciBfY2IgPSBjb250ZXh0ICE9PSBmYWxzZSA/IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgX2Z1bmMuY2FsbChjb250ZXh0LCBlLCBhcmcsIF9ub2Rlc1tpXSk7XG4gICAgICAgIH0gOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIF9mdW5jKGUsIGFyZywgX25vZGVzW2ldKTtcbiAgICAgICAgfTsgLy9hZGQgdGhlIGV2ZW50IHRvIHRoZSBub2RlIGV2ZW50IGNhY2hlXG5cblxuICAgICAgICBfdGhpcy5fZXZlbnRDYWNoZS5wdXNoKHtcbiAgICAgICAgICBub2RlOiBfbm9kZXNbaV0sXG4gICAgICAgICAgYWN0aW9uOiBldmVudE5hbWUsXG4gICAgICAgICAgZnVuYzogX2Z1bmMsXG4gICAgICAgICAgY2I6IF9jYixcbiAgICAgICAgICByb3V0ZXJMaW5rOiByTGlua1xuICAgICAgICB9KTsgLy9hZGQgdGhlIGV2ZW50IHRvIHRoZSBub2RlXG5cblxuICAgICAgICBfbm9kZXNbaV0uYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIF9jYik7XG4gICAgICB9O1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IF9ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBfbG9vcChpKTtcbiAgICAgIH1cbiAgICB9IC8vdGhpcyBmdW5jdGlvbiByZW1vdmVzIG5vbiByb3V0ZXIgZXZlbnRzIG1lZXRpbmcgdGhlIGNyaXRlcmlhXG5cbiAgfSwge1xuICAgIGtleTogXCJyZW1vdmVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlKG5vZGUsIGV2ZW50TmFtZSwgZnVuYykge1xuICAgICAgLy9ub2RlbGlzdCBvciBzaW5nbGUgbm9kZT9cbiAgICAgIHZhciBfbm9kZXMgPSBpcy5ub2RlTGlzdChub2RlKSB8fCBpcy5hcnJheShub2RlKSA/IG5vZGUgOiBbbm9kZV07IC8vbG9vcCB0aG91Z2ggdGhlIG5vZGVzXG5cblxuICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBfbm9kZXMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgdmFyIGkgPSAwO1xuXG4gICAgICAgIHdoaWxlIChpIDwgdGhpcy5fZXZlbnRDYWNoZS5sZW5ndGgpIHtcbiAgICAgICAgICAvL2NoZWNrIGlmIGl0IGlzIHRoZSBzYW1lIG5vZGUgYW5kIGlzIG5vdCBhIHJvdXRlciBsaW5rXG4gICAgICAgICAgaWYgKHRoaXMuX2V2ZW50Q2FjaGVbaV0ubm9kZSA9PT0gX25vZGVzW2tdICYmICF0aGlzLl9ldmVudENhY2hlW2ldLnJvdXRlckxpbmspIHtcbiAgICAgICAgICAgIGlmIChldmVudE5hbWUgJiYgZnVuYykge1xuICAgICAgICAgICAgICBpZiAodGhpcy5fZXZlbnRDYWNoZVtpXS5hY3Rpb24gPT09IGV2ZW50TmFtZSAmJiB0aGlzLl9ldmVudENhY2hlW2ldLmZ1bmMgPT09IGZ1bmMpIHRoaXMuX3JlbW92ZUV2ZW50KGkpO2Vsc2UgaSsrO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChldmVudE5hbWUpIHtcbiAgICAgICAgICAgICAgaWYgKHRoaXMuX2V2ZW50Q2FjaGVbaV0uYWN0aW9uID09PSBldmVudE5hbWUpIHRoaXMuX3JlbW92ZUV2ZW50KGkpO2Vsc2UgaSsrO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChmdW5jKSB7XG4gICAgICAgICAgICAgIGlmICh0aGlzLl9ldmVudENhY2hlW2ldLmZ1bmMgPT09IGZ1bmMpIHRoaXMuX3JlbW92ZUV2ZW50KGkpO2Vsc2UgaSsrO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlRXZlbnQoaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGkrKztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IC8vdGhpcyBmdW5jdGlvbiByZW1vdmVzIGFsbCBub24gcm91dGVyIGxpbmtzXG5cbiAgfSwge1xuICAgIGtleTogXCJyZW1vdmVBbGxcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlQWxsKCkge1xuICAgICAgdmFyIGkgPSAwO1xuXG4gICAgICB3aGlsZSAoaSA8IHRoaXMuX2V2ZW50Q2FjaGUubGVuZ3RoKSB7XG4gICAgICAgIGlmICghdGhpcy5fZXZlbnRDYWNoZVtpXS5yb3V0ZXJMaW5rKSB0aGlzLl9yZW1vdmVFdmVudChpKTtlbHNlIGkrKztcbiAgICAgIH1cbiAgICB9IC8vdGhpcyBmdW5jdGlvbiByZW1vdmVzIGV2ZXJ5dGhpbmcsIGl0IG11c3Qgb25seSBiZSB1c2VkIGJ5IGNvbXBvbmVudCBjbGFzc2VzIGFmdGVyIGVsZW1lbnRzIGFyZSByZW1vdmVkXG4gICAgLy9mcm9tIHRoZSBkb20gc28gdGhlcmUgYXJlIG5vdCBwcm9ibGVtcyB3aXRoIHVuYm91bmQgcm91dGVyIGxpbmtzIGNsaWNrZWQgYnkgdGhlIHVzZXIgcmVmcmVzaGluZyB0aGUgcGFnZVxuXG4gIH0sIHtcbiAgICBrZXk6IFwiZGVzdHJveVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgd2hpbGUgKHRoaXMuX2V2ZW50Q2FjaGUubGVuZ3RoID4gMCkge1xuICAgICAgICB0aGlzLl9yZW1vdmVFdmVudCgwKTtcbiAgICAgIH1cbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gX2RlZmF1bHQ7XG59KCk7XG5cbmV4cG9ydCB7IF9kZWZhdWx0IGFzIGRlZmF1bHQgfTsiLCJmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG5cbi8vIGFwcFxuaW1wb3J0IGFwcFN0b3JlIGZyb20gJy4vYXBwU3RvcmUnO1xuaW1wb3J0IGFwcENvcmUgZnJvbSAnLi9hcHBDb3JlJzsgLy8gY2xhc3Nlc1xuXG5pbXBvcnQgZG9tRXZlbnRzIGZyb20gJy4uL2NsYXNzZXMvZG9tRXZlbnRzJzsgLy8gZ3NhcFxuXG5pbXBvcnQgZ3NhcCBmcm9tICdnc2FwJztcbnZhciBfc2luZ2xldG9uID0gbnVsbDtcblxudmFyIGFwcFVpID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gYXBwVWkoZGF0YSkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBhcHBVaSk7XG5cbiAgICBpZiAoIV9zaW5nbGV0b24pIHtcbiAgICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gICAgICBfc2luZ2xldG9uID0gdGhpcztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIF9zaW5nbGV0b247XG4gICAgfSAvLyBzdG9yZVxuXG5cbiAgICB0aGlzLmFwcFN0b3JlID0gYXBwU3RvcmU7IC8vIGFwcCByZWZlcmVuY2VzXG5cbiAgICB0aGlzLmFwcENvcmUgPSBuZXcgYXBwQ29yZSgpOyAvLyBFdmVudHNcblxuICAgIHRoaXMuZG9tRXZlbnRzID0gbmV3IGRvbUV2ZW50cygpOyAvLyBDdXJzb3IgdmFyc1xuXG4gICAgdGhpcy5jdXJzb3IgPSB7XG4gICAgICBwb3NpdGlvbjoge1xuICAgICAgICB4OiAwLFxuICAgICAgICB5OiAwXG4gICAgICB9LFxuICAgICAgbGl2ZVBvc2l0aW9uOiB7XG4gICAgICAgIHg6IDAsXG4gICAgICAgIHk6IDBcbiAgICAgIH0sXG4gICAgICBsb2NrOiBmYWxzZVxuICAgIH07XG4gICAgdGhpcy5jdXJzb3JEcmFnID0ge1xuICAgICAgaXNPcGVuOiBmYWxzZSxcbiAgICAgIGlzUGxheWVkOiBmYWxzZSxcbiAgICAgIGlzUmVkdWNlZDogZmFsc2UsXG4gICAgICBvcGVuVGltZWxpbmU6IG51bGwsXG4gICAgICBjbG9zZVRpbWVsaW5lOiBudWxsXG4gICAgfTsgLy8gSW5mbyB2YXJzXG5cbiAgICB0aGlzLmluZm8gPSB7XG4gICAgICBpc09wZW46IGZhbHNlXG4gICAgfTtcbiAgICB0aGlzLmhlYWRlciA9IG51bGw7XG4gICAgdGhpcy5ndWlkZXMgPSBudWxsO1xuICAgIHRoaXMuYmFja2dyb3VuZCA9IG51bGw7XG4gICAgdGhpcy5sb2FkZXJEdXJhdGlvbiA9IDE7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoYXBwVWksIFt7XG4gICAga2V5OiBcImluaXRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgIHRoaXMuaGVhZGVyID0ge1xuICAgICAgICBpc09wZW46IGZhbHNlLFxuICAgICAgICBpc0FuaW1hdGluZzogZmFsc2UsXG4gICAgICAgIGlzTG9ja2VkOiBmYWxzZVxuICAgICAgfTtcbiAgICAgIHRoaXMuaW5pdExvYWRlcigpO1xuICAgICAgdGhpcy5pbml0TWVudSgpO1xuICAgICAgdGhpcy5pbml0U3VibWVudSgpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzZWxlY3RvcnNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2VsZWN0b3JzKCkge1xuICAgICAgLy8gRGVhZnVsdFxuICAgICAgdGhpcy4kYXBwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwcCcpO1xuICAgICAgdGhpcy4kbG9nbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dvJyk7IC8vIEN1cnNvclxuXG4gICAgICB0aGlzLiRjdXJzb3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Vyc29yJyk7XG4gICAgICB0aGlzLiRjdXJzb3JEb3QgPSB0aGlzLiRjdXJzb3IucXVlcnlTZWxlY3RvcignLmN1cnNvcl9fZG90Jyk7XG4gICAgICB0aGlzLiRjdXJzb3JNaW51cyA9IHRoaXMuJGN1cnNvci5xdWVyeVNlbGVjdG9yKCcuY3Vyc29yX19taW51cycpO1xuICAgICAgdGhpcy4kY3Vyc29yUGx1cyA9IHRoaXMuJGN1cnNvci5xdWVyeVNlbGVjdG9yKCcuY3Vyc29yX19wbHVzJyk7XG4gICAgICB0aGlzLiRjdXJzb3JEcmFnID0gdGhpcy4kY3Vyc29yLnF1ZXJ5U2VsZWN0b3IoJy5jdXJzb3JfX2RyYWcnKTsgLy8gTWFza1xuXG4gICAgICB0aGlzLiRtYXNrID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hc2snKTsgLy8gTG9hZGVyXG5cbiAgICAgIHRoaXMuJGxvYWRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkZXInKTtcblxuICAgICAgaWYgKHRoaXMuJGxvYWRlcikge1xuICAgICAgICB0aGlzLiRsb2FkZXJNYXNrID0gdGhpcy4kbG9hZGVyLnF1ZXJ5U2VsZWN0b3IoJy5tYXNrJyk7XG4gICAgICAgIHRoaXMuJGxvYWRlcklubmVyID0gdGhpcy4kbG9hZGVyLnF1ZXJ5U2VsZWN0b3IoJy5pbm5lcicpO1xuICAgICAgICB0aGlzLiRsb2FkZXJMb2dvID0gdGhpcy4kbG9hZGVyLnF1ZXJ5U2VsZWN0b3IoJy5pbm5lciAubGV0dGVybG9nbycpO1xuICAgICAgICB0aGlzLiRsb2FkZXJMb2dvTGV0dGVycyA9IHRoaXMuJGxvYWRlckxvZ28ucXVlcnlTZWxlY3RvckFsbCgnLmlubmVyIC5sZXR0ZXJsb2dvIC5sZXR0ZXInKTtcbiAgICAgICAgdGhpcy4kbG9hZGVyUHJvZ3Jlc3MgPSB0aGlzLiRsb2FkZXIucXVlcnlTZWxlY3RvcignLmlubmVyIC5wcm9ncmVzcycpO1xuICAgICAgfSAvLyBIZWFkZXJcblxuXG4gICAgICB0aGlzLiRoZWFkZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVhZGVyJyk7XG5cbiAgICAgIGlmICh0aGlzLiRoZWFkZXIpIHtcbiAgICAgICAgdGhpcy4kaGVhZGVyTG9nbyA9IHRoaXMuJGhlYWRlci5xdWVyeVNlbGVjdG9yKCcubG9nbycpO1xuICAgICAgICB0aGlzLiRoZWFkZXJNZW51ID0gdGhpcy4kaGVhZGVyLnF1ZXJ5U2VsZWN0b3IoJ25hdi5tZW51Jyk7XG4gICAgICAgIHRoaXMuJGhlYWRlck1lbnVJdGVtcyA9IHRoaXMuJGhlYWRlck1lbnUucXVlcnlTZWxlY3RvckFsbCgnbGknKTtcbiAgICAgICAgdGhpcy4kaGVhZGVyU3VibWVudSA9IHRoaXMuJGhlYWRlci5xdWVyeVNlbGVjdG9yKCduYXYuc3VibWVudScpO1xuICAgICAgICB0aGlzLiRoZWFkZXJTdWJtZW51SXRlbXMgPSB0aGlzLiRoZWFkZXJTdWJtZW51LnF1ZXJ5U2VsZWN0b3JBbGwoJ2xpJyk7XG4gICAgICAgIHRoaXMuJGhlYWRlclRyaWdnZXIgPSB0aGlzLiRoZWFkZXIucXVlcnlTZWxlY3RvcignLnRyaWdnZXInKTtcbiAgICAgICAgdGhpcy4kaGVhZGVyVHJpZ2dlclRleHQgPSB0aGlzLiRoZWFkZXJUcmlnZ2VyLnF1ZXJ5U2VsZWN0b3IoJy50ZXh0Jyk7XG4gICAgICAgIHRoaXMuJGhlYWRlclRyaWdnZXJJY29uID0gdGhpcy4kaGVhZGVyVHJpZ2dlci5xdWVyeVNlbGVjdG9yKCcuaWNvbicpO1xuICAgICAgfSAvLyBJbmZvXG5cblxuICAgICAgdGhpcy4kaW5mbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbmZvJyk7XG5cbiAgICAgIGlmICh0aGlzLiRpbmZvKSB7XG4gICAgICAgIHRoaXMuJGluZm9DbG9zZXIgPSB0aGlzLiRpbmZvLnF1ZXJ5U2VsZWN0b3IoJy5jbG9zZXInKTtcbiAgICAgICAgdGhpcy4kaW5mb01hc2sgPSB0aGlzLiRpbmZvLnF1ZXJ5U2VsZWN0b3IoJy5tYXNrJyk7XG4gICAgICAgIHRoaXMuJGluZm9Db250ZW50ID0gdGhpcy4kaW5mby5xdWVyeVNlbGVjdG9yKCcuY29udGVudCcpO1xuICAgICAgfSAvLyBHdWlkZXNcblxuXG4gICAgICB0aGlzLiRndWlkZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ3VpZGVzJyk7XG5cbiAgICAgIGlmICh0aGlzLiRndWlkZXMpIHtcbiAgICAgICAgdGhpcy4kZ3VpZGVzU3dpdGNoZXIgPSB0aGlzLiRndWlkZXMucXVlcnlTZWxlY3RvcignLmd1aWRlc19fc3dpdGNoZXInKTtcbiAgICAgICAgdGhpcy4kZ3VpZGVzU3dpdGNoZXIyID0gdGhpcy4kZ3VpZGVzLnF1ZXJ5U2VsZWN0b3IoJy5ndWlkZXNfX3N3aXRjaGVyMicpO1xuICAgICAgICB0aGlzLiRndWlkZXNIciA9IHRoaXMuJGd1aWRlcy5xdWVyeVNlbGVjdG9yKCcuZ3VpZGVzX19ob3Jpem9udGFsJyk7XG4gICAgICAgIHRoaXMuJGd1aWRlc1ZyID0gdGhpcy4kZ3VpZGVzLnF1ZXJ5U2VsZWN0b3IoJy5ndWlkZXNfX3ZlcnRpY2FsJyk7XG4gICAgICAgIHRoaXMuJGd1aWRlc0hyMiA9IHRoaXMuJGd1aWRlcy5xdWVyeVNlbGVjdG9yKCcuZ3VpZGVzX19ob3Jpem9udGFsMicpO1xuICAgICAgICB0aGlzLiRndWlkZXNWcjIgPSB0aGlzLiRndWlkZXMucXVlcnlTZWxlY3RvcignLmd1aWRlc19fdmVydGljYWwyJyk7XG4gICAgICB9IC8vIENvb2tpZXNcblxuXG4gICAgICB0aGlzLiRjb29raWVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nvb2tpZS1sYXctaW5mby1iYXInKTtcblxuICAgICAgaWYgKHRoaXMuJGNvb2tpZXMpIHtcbiAgICAgICAgdGhpcy4kY29va2llc0NvbmZpZ3VyZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2EuY2xpX3NldHRpbmdzX2J1dHRvbicpO1xuICAgICAgICB0aGlzLiRjb29raWVzTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2xpLW1vZGFsJyk7XG4gICAgICAgIHRoaXMuJGNvb2tpZXNDYXRlZ29yeSA9IHRoaXMuJGNvb2tpZXNNb2RhbC5xdWVyeVNlbGVjdG9yQWxsKCdhLmNsaS1uYXYtbGluaycpO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJldmVudHNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZXZlbnRzKCkge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgLy8gSGVhZGVyXG4gICAgICBpZiAodGhpcy4kaGVhZGVyKSB0aGlzLmRvbUV2ZW50cy5hZGQodGhpcy4kaGVhZGVyVHJpZ2dlciwgJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpcy50cmlnZ2VyTWVudSgpO1xuICAgICAgfSk7IC8vIEluZm9cblxuICAgICAgaWYgKHRoaXMuJGluZm8pIHtcbiAgICAgICAgdGhpcy5kb21FdmVudHMuYWRkKHRoaXMuJGluZm9NYXNrLCAnY2xpY2snLCBmdW5jdGlvbiAoZSwgYSwgZWwpIHtcbiAgICAgICAgICBfdGhpcy5jbG9zZUluZm8oKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZG9tRXZlbnRzLmFkZCh0aGlzLiRpbmZvQ2xvc2VyLCAnY2xpY2snLCBmdW5jdGlvbiAoZSwgYSwgZWwpIHtcbiAgICAgICAgICBfdGhpcy5jbG9zZUluZm8oKTtcbiAgICAgICAgfSk7XG4gICAgICB9IC8vIEd1aWRlc1xuXG5cbiAgICAgIGlmICh0aGlzLiRndWlkZXMpIHtcbiAgICAgICAgdGhpcy5kb21FdmVudHMuYWRkKHRoaXMuJGd1aWRlc1N3aXRjaGVyLCAnY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgX3RoaXMuZ3VpZGVzU3dpdGNoZXIoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZG9tRXZlbnRzLmFkZCh0aGlzLiRndWlkZXNTd2l0Y2hlcjIsICdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBfdGhpcy5ndWlkZXNTd2l0Y2hlcjIoKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLiRjdXJzb3IgJiYgdGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHRoaXMuZG9tRXZlbnRzLmFkZChkb2N1bWVudCwgJ21vdXNlbW92ZScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIF90aGlzLm1vdmVDdXJzb3IoZSk7XG4gICAgICB9KTsgLy8gdGhpcy5kb21FdmVudHMuYWRkKGRvY3VtZW50LCAnbW91c2Vtb3ZlJywgKGUsIGEsIGVsKSA9PiB7IHRoaXMuY3Vyc29yT3ZlcihlLCBhLCBlbCk7IH0pO1xuXG4gICAgICBpZiAoIXRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKSB7XG4gICAgICAgIHRoaXMucHJldmlvdXNTY3JvbGwgPSAwO1xuICAgICAgICB0aGlzLm1lbnVPcGVuZWQgPSB0cnVlO1xuICAgICAgICBnc2FwLnRvKHRoaXMuJGhlYWRlciwge1xuICAgICAgICAgIHk6ICcwJScsXG4gICAgICAgICAgZHVyYXRpb246IDAuOCxcbiAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmRvbUV2ZW50cy5hZGQod2luZG93LCAnc2Nyb2xsJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGlmIChfdGhpcy5oZWFkZXIuaXNPcGVuIHx8IF90aGlzLmhlYWRlci5pc0xvY2tlZCkgcmV0dXJuO1xuICAgICAgICAgIHZhciBzY3JvbGwgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wO1xuXG4gICAgICAgICAgaWYgKHNjcm9sbCA8IF90aGlzLnByZXZpb3VzU2Nyb2xsIHx8IHNjcm9sbCA8PSAwKSB7XG4gICAgICAgICAgICBpZiAoIV90aGlzLm1lbnVPcGVuZWQpIHtcbiAgICAgICAgICAgICAgX3RoaXMubWVudU9wZW5lZCA9IHRydWU7XG4gICAgICAgICAgICAgIGdzYXAudG8oX3RoaXMuJGhlYWRlciwge1xuICAgICAgICAgICAgICAgIHk6ICcwJScsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDAuOCxcbiAgICAgICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoX3RoaXMubWVudU9wZW5lZCkge1xuICAgICAgICAgICAgICBfdGhpcy5tZW51T3BlbmVkID0gZmFsc2U7XG4gICAgICAgICAgICAgIGdzYXAudG8oX3RoaXMuJGhlYWRlciwge1xuICAgICAgICAgICAgICAgIHk6ICctMTAwJScsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDAuOCxcbiAgICAgICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIF90aGlzLnByZXZpb3VzU2Nyb2xsID0gc2Nyb2xsO1xuICAgICAgICB9KTtcbiAgICAgIH0gLy8gQ29va2llc1xuXG5cbiAgICAgIGlmICh0aGlzLiRjb29raWVzQ29uZmlndXJlQnV0dG9uKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1zY3JpcHQtdXJsXG4gICAgICAgIHZhciBkaXNhYmxlZCA9ICdqYXZhc2NyaXB0OiB2b2lkKDApJztcbiAgICAgICAgdGhpcy4kY29va2llc0NvbmZpZ3VyZUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCBkaXNhYmxlZCk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLiRjb29raWVzTW9kYWwpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXNjcmlwdC11cmxcbiAgICAgICAgdmFyIF9kaXNhYmxlZCA9ICdqYXZhc2NyaXB0OiB2b2lkKDApJztcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuJGNvb2tpZXNDYXRlZ29yeS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHRoaXMuJGNvb2tpZXNDYXRlZ29yeVtpXS5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCBfZGlzYWJsZWQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImluaXRMb2FkZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdExvYWRlcigpIHtcbiAgICAgIC8vIEFuaW1hdGUgaW4gbmV4dCBzbGlkZVxuICAgICAgZ3NhcC50byh0aGlzLiRsb2FkZXJMb2dvLCB7XG4gICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgIGR1cmF0aW9uOiAwLjQsXG4gICAgICAgIGVhc2U6ICdwb3dlMi5vdXQnXG4gICAgICB9KTtcbiAgICAgIGlmICh0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCkgZ3NhcC50byh0aGlzLiRsb2FkZXJQcm9ncmVzcywge1xuICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICBkdXJhdGlvbjogMC40LFxuICAgICAgICBlYXNlOiAncG93ZTIub3V0J1xuICAgICAgfSk7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy4kbG9hZGVyTG9nb0xldHRlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKSBnc2FwLnNldCh0aGlzLiRsb2FkZXJMb2dvTGV0dGVyc1tpXSwge1xuICAgICAgICAgIHk6IC0od2luZG93LmlubmVySGVpZ2h0IC8gMiArIHdpbmRvdy5pbm5lcldpZHRoICogMC4wNSlcbiAgICAgICAgfSk7ZWxzZSBnc2FwLnNldCh0aGlzLiRsb2FkZXJMb2dvTGV0dGVyc1tpXSwge1xuICAgICAgICAgIG9wYWNpdHk6IDAuMDAwMVxuICAgICAgICB9KTtcbiAgICAgICAgZ3NhcC50byh0aGlzLiRsb2FkZXJMb2dvTGV0dGVyc1tpXSwge1xuICAgICAgICAgIHk6IDAsXG4gICAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnLFxuICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgZHVyYXRpb246IDEuMixcbiAgICAgICAgICBkZWxheTogMCArIGkgKiAwLjAyXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJoaWRlTG9hZGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGhpZGVMb2FkZXIoKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgaWYgKHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKSBnc2FwLnRvKHRoaXMuJGxvYWRlclByb2dyZXNzLCB7XG4gICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgZHVyYXRpb246IDAuNixcbiAgICAgICAgZWFzZTogJ3Bvd2UyLm91dCdcbiAgICAgIH0pO1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuJGxvYWRlckxvZ29MZXR0ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmICh0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCkgZ3NhcC50byh0aGlzLiRsb2FkZXJMb2dvTGV0dGVyc1tpXSwge1xuICAgICAgICAgIHk6IHdpbmRvdy5pbm5lckhlaWdodCAvIDIgKyB3aW5kb3cuaW5uZXJXaWR0aCAqIDAuMSxcbiAgICAgICAgICBlYXNlOiAnZXhwby5pbk91dCcsXG4gICAgICAgICAgZHVyYXRpb246IDEuMixcbiAgICAgICAgICBkZWxheTogMCArIGkgKiAwLjA1XG4gICAgICAgIH0pO2Vsc2UgZ3NhcC50byh0aGlzLiRsb2FkZXJMb2dvTGV0dGVyc1tpXSwge1xuICAgICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgICBlYXNlOiAnZXhwby5pbk91dCcsXG4gICAgICAgICAgZHVyYXRpb246IDEuMixcbiAgICAgICAgICBkZWxheTogMCArIGkgKiAwLjAyXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBnc2FwLnRvKFt0aGlzLiRsb2FkZXJNYXNrLCB0aGlzLiRsb2FkZXJJbm5lcl0sIHtcbiAgICAgICAgeTogJzEwMCUnLFxuICAgICAgICBkdXJhdGlvbjogMS44LFxuICAgICAgICBlYXNlOiAnZXhwby5pbk91dCcsXG4gICAgICAgIGRlbGF5OiB0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCA/IDAgOiAwLjgsXG4gICAgICAgIG9uQ29tcGxldGU6IGZ1bmN0aW9uIG9uQ29tcGxldGUoKSB7XG4gICAgICAgICAgZ3NhcC5zZXQoX3RoaXMyLiRsb2FkZXIsIHtcbiAgICAgICAgICAgIGRpc3BsYXk6ICdub25lJyxcbiAgICAgICAgICAgIG9uQ29tcGxldGU6IGZ1bmN0aW9uIG9uQ29tcGxldGUoKSB7XG4gICAgICAgICAgICAgIF90aGlzMi4kbG9hZGVyLnJlbW92ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9IC8vIGhpZGVMb2FkZXIoKVxuICAgIC8vIHtcbiAgICAvLyAgICAgLy8gZ3NhcC50byh0aGlzLiRsb2FkZXJQcm9ncmVzcywgeyBvcGFjaXR5OiAwLjAwMDEsIGR1cmF0aW9uOiAwLjYsIGVhc2U6ICdwb3dlMi5vdXQnIH0pO1xuICAgIC8vICAgICBnc2FwLnRvKHRoaXMuJGxvYWRlclByb2dyZXNzLCB7IG9wYWNpdHk6IDAuMDAwMSxcbiAgICAvLyAgICAgICAgIGR1cmF0aW9uOiAwLjYsXG4gICAgLy8gICAgICAgICBlYXNlOiAncG93ZTIub3V0JyxcbiAgICAvLyAgICAgICAgIG9uQ29tcGxldGU6ICgpID0+XG4gICAgLy8gICAgICAgICB7XG4gICAgLy8gICAgICAgICAgICAgZ3NhcC50byh0aGlzLiRsb2FkZXJJbm5lciwge1xuICAgIC8vICAgICAgICAgICAgICAgICB5OiAnLTEwMCUnLFxuICAgIC8vICAgICAgICAgICAgICAgICBkdXJhdGlvbjogdGhpcy5sb2FkZXJEdXJhdGlvbixcbiAgICAvLyAgICAgICAgICAgICAgICAgZWFzZTogJ3Bvd2VyNC5vdXQnLFxuICAgIC8vICAgICAgICAgICAgICAgICBvbkNvbXBsZXRlOiAoKSA9PlxuICAgIC8vICAgICAgICAgICAgICAgICB7XG4gICAgLy8gICAgICAgICAgICAgICAgICAgICBnc2FwLnNldCh0aGlzLiRsb2FkZXIsIHsgZGlzcGxheTogJ25vbmUnIH0pO1xuICAgIC8vICAgICAgICAgICAgICAgICB9XG4gICAgLy8gICAgICAgICAgICAgfSk7XG4gICAgLy8gICAgICAgICB9IH0pO1xuICAgIC8vIH1cblxuICB9LCB7XG4gICAga2V5OiBcImluaXRNZW51XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRNZW51KCkge1xuICAgICAgZ3NhcC5zZXQodGhpcy4kaGVhZGVyVHJpZ2dlclRleHQuY2hpbGRyZW5bMV0sIHtcbiAgICAgICAgeTogJy0xMDAlJ1xuICAgICAgfSk7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy4kaGVhZGVyTWVudUl0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGdzYXAuc2V0KHRoaXMuJGhlYWRlck1lbnVJdGVtc1tpXS5jaGlsZHJlblswXSwge1xuICAgICAgICAgIHk6ICctMTAwJSdcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInRyaWdnZXJNZW51XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHRyaWdnZXJNZW51KCkge1xuICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgIGlmICh0aGlzLmhlYWRlci5pc0FuaW1hdGluZykgcmV0dXJuO1xuICAgICAgdGhpcy5oZWFkZXIuaXNBbmltYXRpbmcgPSB0cnVlO1xuXG4gICAgICBpZiAoIXRoaXMuaGVhZGVyLmlzT3Blbikge1xuICAgICAgICAvLyBTZXQgb3ZlcmxheVxuICAgICAgICBnc2FwLnRvKHRoaXMuYXBwU3RvcmUuY3VycmVudFNlY3Rpb24uJG92ZXJsYXksIHtcbiAgICAgICAgICBvcGFjaXR5OiAwLjEsXG4gICAgICAgICAgZHVyYXRpb246IDAuOCxcbiAgICAgICAgICBlYXNlOiAncG93ZXIyLm91dCdcbiAgICAgICAgfSk7IC8vIFJlcG9zaXRpb24gbWVudSBvbiBwcm9tb3Rpb25zaW5nbGVcblxuICAgICAgICBpZiAodGhpcy5hcHBTdG9yZS5jdXJyZW50ID09PSAncHJvbW90aW9uc3NpbmdsZScgJiYgdGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIGdzYXAudG8odGhpcy4kaGVhZGVyLCB7XG4gICAgICAgICAgeTogJzB2dycsXG4gICAgICAgICAgZHVyYXRpb246IDAuOCxcbiAgICAgICAgICBlYXNlOiAnZXhwby5pbk91dCdcbiAgICAgICAgfSk7IC8vIEhpZGUgbG9nb1xuXG4gICAgICAgIGlmICh0aGlzLmFwcFN0b3JlLmN1cnJlbnQgIT09ICdob21lJyAmJiB0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCkgZ3NhcC50byh0aGlzLiRoZWFkZXJMb2dvLCB7XG4gICAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICAgIHBvaW50ZXJFdmVudHM6ICdub25lJyxcbiAgICAgICAgICBkdXJhdGlvbjogMC4yLFxuICAgICAgICAgIGVhc2U6ICdwb3dlcjIub3V0J1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAodGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHtcbiAgICAgICAgICBnc2FwLnRvKHRoaXMuJGFwcCwge1xuICAgICAgICAgICAgd2lsbENoYW5nZTogJ3RyYW5zZm9ybScsXG4gICAgICAgICAgICBzY2FsZTogMC45LFxuICAgICAgICAgICAgeTogJzV2dycsXG4gICAgICAgICAgICBkdXJhdGlvbjogMC44LFxuICAgICAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdGhpcy4kaGVhZGVyTWVudS5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ2FsbCc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZ3NhcC50byh0aGlzLiRhcHAsIHtcbiAgICAgICAgICAgIHdpbGxDaGFuZ2U6ICd0cmFuc2Zvcm0nLFxuICAgICAgICAgICAgeTogJzEwdncnLFxuICAgICAgICAgICAgZHVyYXRpb246IDAuOCxcbiAgICAgICAgICAgIGVhc2U6ICdleHBvLmluT3V0J1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHRoaXMuJGhlYWRlck1lbnUuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgZ3NhcC50byh0aGlzLiRoZWFkZXJNZW51LCB7XG4gICAgICAgICAgICB5OiAnMCUnLFxuICAgICAgICAgICAgZHVyYXRpb246IDAuOCxcbiAgICAgICAgICAgIGVhc2U6ICdleHBvLmluT3V0J1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xuICAgICAgICB9IC8vIEFuaW1hdGUgbWVudSBpdGVtc1xuXG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLiRoZWFkZXJNZW51SXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBnc2FwLnRvKHRoaXMuJGhlYWRlck1lbnVJdGVtc1tpXS5jaGlsZHJlblswXSwge1xuICAgICAgICAgICAgeTogJzAlJyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiB0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCA/IDAuOCA6IDAuMyxcbiAgICAgICAgICAgIGVhc2U6ICdleHBvLmluT3V0JyxcbiAgICAgICAgICAgIGRlbGF5OiB0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCA/IDAuMSArIGkgKiAwLjA1IDogMC41ICsgaSAqIDAuMDJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCkge1xuICAgICAgICAgIC8vIGdzYXAudG8odGhpcy4kaGVhZGVyVHJpZ2dlciwgeyB5OiAnMi41dncnLCBkdXJhdGlvbjogMC44LCBlYXNlOiAnZXhwby5pbk91dCcgfSk7XG4gICAgICAgICAgZ3NhcC50byh0aGlzLiRoZWFkZXJUcmlnZ2VyVGV4dC5jaGlsZHJlblsxXSwge1xuICAgICAgICAgICAgeTogJzAlJyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjgsXG4gICAgICAgICAgICBlYXNlOiAnZXhwby5pbk91dCcsXG4gICAgICAgICAgICBkZWxheTogMC4xXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZ3NhcC50byh0aGlzLiRoZWFkZXJUcmlnZ2VyVGV4dC5jaGlsZHJlblswXSwge1xuICAgICAgICAgICAgeTogJzEwMCUnLFxuICAgICAgICAgICAgZHVyYXRpb246IDAuOCxcbiAgICAgICAgICAgIGVhc2U6ICdleHBvLmluT3V0JyxcbiAgICAgICAgICAgIGRlbGF5OiAwLjFcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBnc2FwLnRvKHRoaXMuJGhlYWRlclRyaWdnZXJJY29uLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgICAgICByb3RhdGlvbjogJzQ1ZGVnJyxcbiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJyNmZmZmZmYnLFxuICAgICAgICAgICAgeTogJzVweCcsXG4gICAgICAgICAgICBkdXJhdGlvbjogMC44LFxuICAgICAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnLFxuICAgICAgICAgICAgZGVsYXk6IDAuMVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGdzYXAudG8odGhpcy4kaGVhZGVyVHJpZ2dlckljb24uY2hpbGRyZW5bMV0sIHtcbiAgICAgICAgICAgIHJvdGF0aW9uOiAnLTQ1ZGVnJyxcbiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJyNmZmZmZmYnLFxuICAgICAgICAgICAgeTogJy01cHgnLFxuICAgICAgICAgICAgZHVyYXRpb246IDAuOCxcbiAgICAgICAgICAgIGVhc2U6ICdleHBvLmluT3V0JyxcbiAgICAgICAgICAgIGRlbGF5OiAwLjFcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBnc2FwLnRvKHRoaXMuJGhlYWRlclRyaWdnZXJJY29uLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgICAgICByb3RhdGlvbjogJzQ1ZGVnJyxcbiAgICAgICAgICAgIHk6ICc1cHgnLFxuICAgICAgICAgICAgZHVyYXRpb246IDAuOCxcbiAgICAgICAgICAgIGVhc2U6ICdleHBvLmluT3V0JyxcbiAgICAgICAgICAgIGRlbGF5OiAwLjFcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBnc2FwLnRvKHRoaXMuJGhlYWRlclRyaWdnZXJJY29uLmNoaWxkcmVuWzFdLCB7XG4gICAgICAgICAgICByb3RhdGlvbjogJy00NWRlZycsXG4gICAgICAgICAgICB5OiAnLTVweCcsXG4gICAgICAgICAgICBkdXJhdGlvbjogMC44LFxuICAgICAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnLFxuICAgICAgICAgICAgZGVsYXk6IDAuMVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZ3NhcC5kZWxheWVkQ2FsbCgwLjgsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBfdGhpczMuaGVhZGVyLmlzQW5pbWF0aW5nID0gZmFsc2U7XG4gICAgICAgICAgX3RoaXMzLmhlYWRlci5pc09wZW4gPSB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFVuc2V0IG92ZXJsYXlcbiAgICAgICAgZ3NhcC50byh0aGlzLmFwcFN0b3JlLmN1cnJlbnRTZWN0aW9uLiRvdmVybGF5LCB7XG4gICAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICAgIGR1cmF0aW9uOiAwLjgsXG4gICAgICAgICAgZWFzZTogJ3Bvd2VyMi5vdXQnXG4gICAgICAgIH0pOyAvLyBSZXBvc2l0aW9uIG1lbnUgb24gcHJvbW90aW9uc2luZ2xlXG5cbiAgICAgICAgaWYgKHRoaXMuYXBwU3RvcmUuY3VycmVudCA9PT0gJ3Byb21vdGlvbnNzaW5nbGUnICYmIHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKSBnc2FwLnRvKHRoaXMuJGhlYWRlciwge1xuICAgICAgICAgIHk6ICctMi41dncnLFxuICAgICAgICAgIGR1cmF0aW9uOiAwLjgsXG4gICAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnXG4gICAgICAgIH0pOyAvLyBIaWRlIGxvZ29cblxuICAgICAgICBpZiAodGhpcy5hcHBTdG9yZS5jdXJyZW50ICE9PSAnaG9tZScgJiYgdGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIGdzYXAudG8odGhpcy4kaGVhZGVyTG9nbywge1xuICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgZHVyYXRpb246IDAuMixcbiAgICAgICAgICBwb2ludGVyRXZlbnRzOiAnaW5pdGlhbCcsXG4gICAgICAgICAgZWFzZTogJ3Bvd2VyMi5vdXQnLFxuICAgICAgICAgIGRlbGF5OiAwLjZcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKSB7XG4gICAgICAgICAgZ3NhcC50byh0aGlzLiRhcHAsIHtcbiAgICAgICAgICAgIHdpbGxDaGFuZ2U6ICcnLFxuICAgICAgICAgICAgc2NhbGU6IDEsXG4gICAgICAgICAgICB5OiAwLFxuICAgICAgICAgICAgZHVyYXRpb246IDAuOCxcbiAgICAgICAgICAgIGVhc2U6ICdleHBvLmluT3V0JyxcbiAgICAgICAgICAgIGNsZWFyUHJvcHM6ICdhbGwnXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdGhpcy4kaGVhZGVyTWVudS5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ25vbmUnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGdzYXAudG8odGhpcy4kYXBwLCB7XG4gICAgICAgICAgICB3aWxsQ2hhbmdlOiAndHJhbnNmb3JtJyxcbiAgICAgICAgICAgIHk6IDAsXG4gICAgICAgICAgICBkdXJhdGlvbjogMC44LFxuICAgICAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnLFxuICAgICAgICAgICAgY2xlYXJQcm9wczogJ2FsbCdcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBnc2FwLnRvKHRoaXMuJGhlYWRlck1lbnUsIHtcbiAgICAgICAgICAgIHk6ICctMTAwJScsXG4gICAgICAgICAgICBkdXJhdGlvbjogMC44LFxuICAgICAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnLFxuICAgICAgICAgICAgb25Db21wbGV0ZTogZnVuY3Rpb24gb25Db21wbGV0ZSgpIHtcbiAgICAgICAgICAgICAgX3RoaXMzLiRoZWFkZXJNZW51LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5vdmVyZmxvdyA9ICdpbml0aWFsJztcbiAgICAgICAgfSAvLyBBbmltYXRlIG1lbnUgaXRlbXNcblxuXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCB0aGlzLiRoZWFkZXJNZW51SXRlbXMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgZ3NhcC50byh0aGlzLiRoZWFkZXJNZW51SXRlbXNbX2ldLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgICAgICB5OiAnLTEwMCUnLFxuICAgICAgICAgICAgZHVyYXRpb246IHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wID8gMC44IDogMC40LFxuICAgICAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnLFxuICAgICAgICAgICAgZGVsYXk6IDBcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCkge1xuICAgICAgICAgIGdzYXAudG8odGhpcy4kaGVhZGVyVHJpZ2dlclRleHQuY2hpbGRyZW5bMV0sIHtcbiAgICAgICAgICAgIHk6ICctMTAwJScsXG4gICAgICAgICAgICBkdXJhdGlvbjogMC44LFxuICAgICAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnLFxuICAgICAgICAgICAgZGVsYXk6IDBcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBnc2FwLnRvKHRoaXMuJGhlYWRlclRyaWdnZXJUZXh0LmNoaWxkcmVuWzBdLCB7XG4gICAgICAgICAgICB5OiAnMCUnLFxuICAgICAgICAgICAgZHVyYXRpb246IDAuOCxcbiAgICAgICAgICAgIGVhc2U6ICdleHBvLmluT3V0JyxcbiAgICAgICAgICAgIGRlbGF5OiAwXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZ3NhcC50byh0aGlzLiRoZWFkZXJUcmlnZ2VySWNvbi5jaGlsZHJlblswXSwge1xuICAgICAgICAgICAgcm90YXRpb246ICcwZGVnJyxcbiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJyNFQzFDMjQnLFxuICAgICAgICAgICAgeTogJzAnLFxuICAgICAgICAgICAgZHVyYXRpb246IDAuOCxcbiAgICAgICAgICAgIGVhc2U6ICdleHBvLmluT3V0JyxcbiAgICAgICAgICAgIGRlbGF5OiAwXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZ3NhcC50byh0aGlzLiRoZWFkZXJUcmlnZ2VySWNvbi5jaGlsZHJlblsxXSwge1xuICAgICAgICAgICAgcm90YXRpb246ICcwZGVnJyxcbiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJyNFQzFDMjQnLFxuICAgICAgICAgICAgeTogJzAnLFxuICAgICAgICAgICAgZHVyYXRpb246IDAuOCxcbiAgICAgICAgICAgIGVhc2U6ICdleHBvLmluT3V0JyxcbiAgICAgICAgICAgIGRlbGF5OiAwXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZ3NhcC50byh0aGlzLiRoZWFkZXJUcmlnZ2VySWNvbi5jaGlsZHJlblswXSwge1xuICAgICAgICAgICAgcm90YXRpb246ICcwZGVnJyxcbiAgICAgICAgICAgIHk6ICcwJyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjgsXG4gICAgICAgICAgICBlYXNlOiAnZXhwby5pbk91dCcsXG4gICAgICAgICAgICBkZWxheTogMFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGdzYXAudG8odGhpcy4kaGVhZGVyVHJpZ2dlckljb24uY2hpbGRyZW5bMV0sIHtcbiAgICAgICAgICAgIHJvdGF0aW9uOiAnMGRlZycsXG4gICAgICAgICAgICB5OiAnMCcsXG4gICAgICAgICAgICBkdXJhdGlvbjogMC44LFxuICAgICAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnLFxuICAgICAgICAgICAgZGVsYXk6IDBcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGdzYXAuZGVsYXllZENhbGwoMC44LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgX3RoaXMzLmhlYWRlci5pc0FuaW1hdGluZyA9IGZhbHNlO1xuICAgICAgICAgIF90aGlzMy5oZWFkZXIuaXNPcGVuID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJpbml0U3VibWVudVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0U3VibWVudSgpIHtcbiAgICAgIHZhciBfdGhpczQgPSB0aGlzO1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuJGhlYWRlclN1Ym1lbnVJdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBnc2FwLnNldCh0aGlzLiRoZWFkZXJTdWJtZW51SXRlbXNbaV0uY2hpbGRyZW5bMF0sIHtcbiAgICAgICAgICB5OiAnLTEwMCUnXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmRvbUV2ZW50cy5hZGQodGhpcy4kaGVhZGVyU3VibWVudUl0ZW1zW2ldLCAnbW91c2VlbnRlcicsIGZ1bmN0aW9uIChlLCBhLCBlbCkge1xuICAgICAgICAgIF90aGlzNC5lbnRlclN1Ym1lbnUoZSwgYSwgZWwpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5kb21FdmVudHMuYWRkKHRoaXMuJGhlYWRlclN1Ym1lbnVJdGVtc1tpXSwgJ21vdXNlbGVhdmUnLCBmdW5jdGlvbiAoZSwgYSwgZWwpIHtcbiAgICAgICAgICBfdGhpczQubGVhdmVTdWJtZW51KGUsIGEsIGVsKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImVudGVyU3VibWVudVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBlbnRlclN1Ym1lbnUoZSwgYSwgZWwpIHtcbiAgICAgIGdzYXAudG8oZWwuY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0sIHtcbiAgICAgICAgeDogJzBweCcsXG4gICAgICAgIHNjYWxlWDogMSxcbiAgICAgICAgZHVyYXRpb246IDAuNCxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0J1xuICAgICAgfSk7XG4gICAgICBnc2FwLnRvKGVsLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzFdLCB7XG4gICAgICAgIHg6ICcxMnB4JyxcbiAgICAgICAgb3BhY2l0eTogMC40LFxuICAgICAgICBkdXJhdGlvbjogMC40LFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwibGVhdmVTdWJtZW51XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGxlYXZlU3VibWVudShlLCBhLCBlbCkge1xuICAgICAgZ3NhcC50byhlbC5jaGlsZHJlblswXS5jaGlsZHJlblswXSwge1xuICAgICAgICB4OiAnLTRweCcsXG4gICAgICAgIHNjYWxlWDogMCxcbiAgICAgICAgZHVyYXRpb246IDAuNCxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0J1xuICAgICAgfSk7XG4gICAgICBnc2FwLnRvKGVsLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzFdLCB7XG4gICAgICAgIHg6ICcwcHgnLFxuICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICBkdXJhdGlvbjogMC40LFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwidHJpZ2dlclN1Ym1lbnVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gdHJpZ2dlclN1Ym1lbnUoX3Nob3cpIHtcbiAgICAgIGlmIChfc2hvdykge1xuICAgICAgICBnc2FwLnRvKFt0aGlzLiRoZWFkZXJMb2dvLCB0aGlzLiRoZWFkZXJUcmlnZ2VyXSwge1xuICAgICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgICBwb2ludGVyRXZlbnRzOiAnbm9uZScsXG4gICAgICAgICAgZHVyYXRpb246IDAuMixcbiAgICAgICAgICBlYXNlOiAncG93ZXIyLm91dCdcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLiRoZWFkZXJTdWJtZW51SXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBnc2FwLnNldCh0aGlzLiRoZWFkZXJTdWJtZW51SXRlbXNbaV0uY2hpbGRyZW5bMF0sIHtcbiAgICAgICAgICAgIHk6ICctMTAwJSdcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBnc2FwLnRvKHRoaXMuJGhlYWRlclN1Ym1lbnVJdGVtc1tpXS5jaGlsZHJlblswXSwge1xuICAgICAgICAgICAgeTogJzAlJyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjgsXG4gICAgICAgICAgICBlYXNlOiAnZXhwby5pbk91dCcsXG4gICAgICAgICAgICBkZWxheTogMCArIGkgKiAwLjA1XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLiRoZWFkZXJTdWJtZW51LnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnYWxsJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGdzYXAudG8oW3RoaXMuJGhlYWRlckxvZ28sIHRoaXMuJGhlYWRlclRyaWdnZXJdLCB7XG4gICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICBwb2ludGVyRXZlbnRzOiAnaW5pdGlhbCcsXG4gICAgICAgICAgZHVyYXRpb246IDAuMixcbiAgICAgICAgICBlYXNlOiAncG93ZXIyLm91dCcsXG4gICAgICAgICAgZGVsYXk6IDAuOFxuICAgICAgICB9KTtcblxuICAgICAgICBmb3IgKHZhciBfaTIgPSAwOyBfaTIgPCB0aGlzLiRoZWFkZXJTdWJtZW51SXRlbXMubGVuZ3RoOyBfaTIrKykge1xuICAgICAgICAgIGdzYXAudG8odGhpcy4kaGVhZGVyU3VibWVudUl0ZW1zW19pMl0uY2hpbGRyZW5bMF0sIHtcbiAgICAgICAgICAgIHk6ICctMTAwJScsXG4gICAgICAgICAgICBkdXJhdGlvbjogMC44LFxuICAgICAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnLFxuICAgICAgICAgICAgZGVsYXk6IDAgKyAodGhpcy4kaGVhZGVyU3VibWVudUl0ZW1zLmxlbmd0aCAtIF9pMikgKiAwLjA1XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLiRoZWFkZXJTdWJtZW51LnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnbm9uZSc7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIm1vdmVDdXJzb3JcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gbW92ZUN1cnNvcihlKSB7XG4gICAgICBpZiAodGhpcy5jdXJzb3IubG9jaykgcmV0dXJuOyAvLyBDaGVjayB2ZWxvY2l0eVxuXG4gICAgICB0aGlzLmN1cnNvci5saXZlUG9zaXRpb24ueCA9IGUuY2xpZW50WDtcbiAgICAgIHRoaXMuY3Vyc29yLmxpdmVQb3NpdGlvbi55ID0gZS5jbGllbnRZO1xuICAgICAgdmFyIG1vdmVtZW50WCA9IHRoaXMuY3Vyc29yLmxpdmVQb3NpdGlvbi54IC0gdGhpcy5jdXJzb3IucG9zaXRpb24ueDtcbiAgICAgIHZhciBtb3ZlbWVudFkgPSB0aGlzLmN1cnNvci5saXZlUG9zaXRpb24ueSAtIHRoaXMuY3Vyc29yLnBvc2l0aW9uLnk7XG4gICAgICB2YXIgbW92ZW1lbnQgPSBNYXRoLnNxcnQobW92ZW1lbnRYICogbW92ZW1lbnRYICsgbW92ZW1lbnRZICogbW92ZW1lbnRZKTtcbiAgICAgIHZhciB2ZWxvY2l0eSA9IG1vdmVtZW50IC8gMTA7IC8vIHRoaXMuX2RyYWcudmVsb2NpdHkgPSBsZXJwKHRoaXMuX2RyYWcudmVsb2NpdHksIHZlbG9jaXR5LCB0aGlzLl9kcmFnLmVhc2UgKiAyKTtcblxuICAgICAgZ3NhcC50byh0aGlzLiRjdXJzb3JEb3QsIHtcbiAgICAgICAgeDogdGhpcy5jdXJzb3IubGl2ZVBvc2l0aW9uLngsXG4gICAgICAgIHk6IHRoaXMuY3Vyc29yLmxpdmVQb3NpdGlvbi55LFxuICAgICAgICBkdXJhdGlvbjogMSxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0J1xuICAgICAgfSk7XG4gICAgICBnc2FwLnRvKHRoaXMuJGN1cnNvck1pbnVzLCB7XG4gICAgICAgIHg6IHRoaXMuY3Vyc29yLmxpdmVQb3NpdGlvbi54LFxuICAgICAgICB5OiB0aGlzLmN1cnNvci5saXZlUG9zaXRpb24ueSxcbiAgICAgICAgZHVyYXRpb246IDEsXG4gICAgICAgIGVhc2U6ICdleHBvLm91dCdcbiAgICAgIH0pO1xuICAgICAgZ3NhcC50byh0aGlzLiRjdXJzb3JQbHVzLCB7XG4gICAgICAgIHg6IHRoaXMuY3Vyc29yLmxpdmVQb3NpdGlvbi54LFxuICAgICAgICB5OiB0aGlzLmN1cnNvci5saXZlUG9zaXRpb24ueSxcbiAgICAgICAgZHVyYXRpb246IDEsXG4gICAgICAgIGVhc2U6ICdleHBvLm91dCdcbiAgICAgIH0pO1xuICAgICAgZ3NhcC50byh0aGlzLiRjdXJzb3JEcmFnLCB7XG4gICAgICAgIHg6IHRoaXMuY3Vyc29yLmxpdmVQb3NpdGlvbi54LFxuICAgICAgICB5OiB0aGlzLmN1cnNvci5saXZlUG9zaXRpb24ueSxcbiAgICAgICAgZHVyYXRpb246IDEsXG4gICAgICAgIGVhc2U6ICdleHBvLm91dCdcbiAgICAgIH0pO1xuICAgICAgdGhpcy5jdXJzb3IucG9zaXRpb24ueCA9IHRoaXMuY3Vyc29yLmxpdmVQb3NpdGlvbi54O1xuICAgICAgdGhpcy5jdXJzb3IucG9zaXRpb24ueSA9IHRoaXMuY3Vyc29yLmxpdmVQb3NpdGlvbi55O1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJvcGVuSW5mb1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuSW5mbyhlKSB7XG4gICAgICBpZiAodGhpcy5pbmZvLmlzT3BlbikgcmV0dXJuO1xuICAgICAgdGhpcy5pbmZvLmlzT3BlbiA9IHRydWU7XG4gICAgICBpZiAodGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHRoaXMuYXBwU3RvcmUuY3VycmVudFNlY3Rpb24uc3VwZXJTY3JvbGxlci5fc2Nyb2xsLmVuYWJsZSA9IGZhbHNlOyAvLyBjb25zdCB0ZXh0Q29udGVudCA9IHRoaXMuJGZvcm0udGV4dENvbnRlbnQ7XG4gICAgICAvLyAvLyBjb25zdCBzaG9ydGNvZGUgPSAnPD9waHAgZWNobyBkb19zaG9ydGNvZGUoJyArIHRleHRDb250ZW50ICsgJyknO1xuICAgICAgLy8gY29uc3QgeW91ckhUTUwgPSAnPGRpdiBjbGFzcz1cIm15ZGl2XCI+PD9waHAgZG9fc2hvcnRjb2RlKFwiJyArIHRleHRDb250ZW50ICsgJ1wiKTs/PjwvZGl2Pic7XG4gICAgICAvLyAvLyBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdzZXJ2aWNlcy1yaWdodCcpWzBdLmlubmVySFRNTCA9IHlvdXJIVE1MO1xuICAgICAgLy8gdGhpcy4kaW5mb0NvbnRlbnQuY2hpbGRyZW5bMV0uaW5zZXJ0QWRqYWNlbnRIVE1MKCdhZnRlcmJlZ2luJywgeW91ckhUTUwpO1xuXG4gICAgICBnc2FwLnNldCh0aGlzLiRpbmZvLCB7XG4gICAgICAgIGRpc3BsYXk6ICdibG9jaydcbiAgICAgIH0pO1xuICAgICAgZ3NhcC5zZXQodGhpcy4kaW5mb0Nsb3Nlciwge1xuICAgICAgICBkaXNwbGF5OiAnYmxvY2snXG4gICAgICB9KTtcbiAgICAgIGdzYXAudG8odGhpcy4kaW5mb01hc2ssIHtcbiAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgZHVyYXRpb246IDAuMixcbiAgICAgICAgZWFzZTogJ3Bvd2VyMi5vdXQnXG4gICAgICB9KTtcbiAgICAgIGdzYXAudG8odGhpcy4kaW5mb0NvbnRlbnQsIHtcbiAgICAgICAgeDogJzAlJyxcbiAgICAgICAgZHVyYXRpb246IDEsXG4gICAgICAgIGVhc2U6ICdleHBvLmluT3V0J1xuICAgICAgfSk7XG4gICAgICBnc2FwLnRvKHRoaXMuJGluZm9DbG9zZXIsIHtcbiAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgZHVyYXRpb246IDAuMixcbiAgICAgICAgZWFzZTogJ3Bvd2VyMi5vdXQnLFxuICAgICAgICBkZWxheTogMVxuICAgICAgfSk7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImNsb3NlSW5mb1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9zZUluZm8oKSB7XG4gICAgICB2YXIgX3RoaXM1ID0gdGhpcztcblxuICAgICAgZ3NhcC50byh0aGlzLiRpbmZvQ2xvc2VyLCB7XG4gICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgZHVyYXRpb246IDAuMixcbiAgICAgICAgZWFzZTogJ3Bvd2VyMi5vdXQnXG4gICAgICB9KTtcbiAgICAgIGdzYXAudG8odGhpcy4kaW5mb0NvbnRlbnQsIHtcbiAgICAgICAgeDogJzEwMCUnLFxuICAgICAgICBkdXJhdGlvbjogMSxcbiAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnXG4gICAgICB9KTtcbiAgICAgIGdzYXAudG8odGhpcy4kaW5mb01hc2ssIHtcbiAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICBkdXJhdGlvbjogMC4yLFxuICAgICAgICBlYXNlOiAncG93ZXIyLm91dCcsXG4gICAgICAgIGRlbGF5OiAxLFxuICAgICAgICBvbkNvbXBsZXRlOiBmdW5jdGlvbiBvbkNvbXBsZXRlKCkge1xuICAgICAgICAgIGdzYXAuc2V0KF90aGlzNS4kaW5mb0Nsb3Nlciwge1xuICAgICAgICAgICAgZGlzcGxheTogJ25vbmUnXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZ3NhcC5zZXQoX3RoaXM1LiRpbmZvLCB7XG4gICAgICAgICAgICBkaXNwbGF5OiAnbm9uZSdcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBfdGhpczUuaW5mby5pc09wZW4gPSBmYWxzZTtcbiAgICAgICAgICBpZiAoX3RoaXM1LmFwcFN0b3JlLmlzRGVza3RvcCkgX3RoaXM1LmFwcFN0b3JlLmN1cnJlbnRTZWN0aW9uLnN1cGVyU2Nyb2xsZXIuX3Njcm9sbC5lbmFibGUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiZW50ZXJEcmFnQ3Vyc29yXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGVudGVyRHJhZ0N1cnNvcigpIHtcbiAgICAgIGdzYXAua2lsbFR3ZWVuc09mKFt0aGlzLiRjdXJzb3JEcmFnLCB0aGlzLiRjdXJzb3JEcmFnLmNoaWxkcmVuWzBdLCB0aGlzLiRjdXJzb3JEb3QsIHRoaXMuJGN1cnNvclBsdXNdKTtcbiAgICAgIHRoaXMuJGN1cnNvck1pbnVzLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgdGhpcy4kY3Vyc29yUGx1cy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgIHRoaXMuJGN1cnNvckRyYWcuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICBnc2FwLnRvKHRoaXMuJGN1cnNvckRvdCwge1xuICAgICAgICBzY2FsZTogMSxcbiAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICBkdXJhdGlvbjogMC4zLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICB9KTtcbiAgICAgIGdzYXAudG8odGhpcy4kY3Vyc29yTWludXMsIHtcbiAgICAgICAgc2NhbGU6IDEsXG4gICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgZHVyYXRpb246IDAuMyxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0J1xuICAgICAgfSk7XG4gICAgICBnc2FwLnRvKHRoaXMuJGN1cnNvclBsdXMsIHtcbiAgICAgICAgc2NhbGU6IDEsXG4gICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgZHVyYXRpb246IDAuMyxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0J1xuICAgICAgfSk7IC8vZ3NhcC50byh0aGlzLiRjdXJzb3JQbHVzLmNoaWxkcmVuWzBdLCB7IG9wYWNpdHk6IDAuMDAwMSwgZHVyYXRpb246IDAuMywgZWFzZTogJ2V4cG8ub3V0JywgZGVsYXk6IDAuMSB9KTtcblxuICAgICAgZ3NhcC50byh0aGlzLiRjdXJzb3JEcmFnLCB7XG4gICAgICAgIHNjYWxlOiAxLFxuICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICBkdXJhdGlvbjogMC4zLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICB9KTtcbiAgICAgIGdzYXAudG8odGhpcy4kY3Vyc29yRHJhZy5jaGlsZHJlblswXSwge1xuICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICBkdXJhdGlvbjogMC4zLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICBkZWxheTogMC4xXG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwibGVhdmVEcmFnQ3Vyc29yXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGxlYXZlRHJhZ0N1cnNvcigpIHtcbiAgICAgIHZhciBfdGhpczYgPSB0aGlzO1xuXG4gICAgICBnc2FwLmtpbGxUd2VlbnNPZihbdGhpcy4kY3Vyc29yRHJhZywgdGhpcy4kY3Vyc29yRHJhZy5jaGlsZHJlblswXSwgdGhpcy4kY3Vyc29yRG90LCB0aGlzLiRjdXJzb3JQbHVzXSk7XG4gICAgICBnc2FwLnRvKHRoaXMuJGN1cnNvckRvdCwge1xuICAgICAgICBzY2FsZTogMC4zNSxcbiAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgZHVyYXRpb246IDAuMyxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0J1xuICAgICAgfSk7XG4gICAgICBnc2FwLnRvKFt0aGlzLiRjdXJzb3JEcmFnLCB0aGlzLiRjdXJzb3JQbHVzXSwge1xuICAgICAgICBzY2FsZTogMC4zNSxcbiAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICBkdXJhdGlvbjogMC4zLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICB9KTtcbiAgICAgIGdzYXAudG8oW3RoaXMuJGN1cnNvckRyYWcuY2hpbGRyZW5bMF0sIHRoaXMuJGN1cnNvclBsdXMuY2hpbGRyZW5bMF1dLCB7XG4gICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgZHVyYXRpb246IDAuMyxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgb25Db21wbGV0ZTogZnVuY3Rpb24gb25Db21wbGV0ZSgpIHtcbiAgICAgICAgICBfdGhpczYuJGN1cnNvckRyYWcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICBfdGhpczYuJGN1cnNvck1pbnVzLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgX3RoaXM2LiRjdXJzb3JQbHVzLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gLy8gb3ZlckN1cnNvcihlLCBhLCBlbClcbiAgICAvLyB7XG4gICAgLy8gICAgIGlmKGUudGFyZ2V0LmNsb3Nlc3QoJ2EnKSAhPT0gbnVsbCB8fCBlLnRhcmdldC5jbG9zZXN0KCdkaXYnKS5jbGFzc0xpc3QuY29udGFpbnMoJ3RyaWdnZXInKSlcbiAgICAvLyAgICAge1xuICAgIC8vICAgICAgICAgaWYoIXRoaXMuaXNDdXJzb3JWaWV3aW5nKVxuICAgIC8vICAgICAgICAge1xuICAgIC8vICAgICAgICAgICAgIHRoaXMuaXNDdXJzb3JWaWV3aW5nID0gdHJ1ZTtcbiAgICAvLyAgICAgICAgICAgICBnc2FwLnRvKHRoaXMuJGN1cnNvci5jaGlsZHJlblswXSwgeyBzY2FsZTogMCwgZHVyYXRpb246IDAuOCwgZWFzZTogJ2V4cG8ub3V0JyB9KTtcbiAgICAvLyAgICAgICAgIH1cbiAgICAvLyAgICAgfVxuICAgIC8vICAgICBlbHNlIGlmKGUudGFyZ2V0LmNsb3Nlc3QoJ2RpdicpLmNsYXNzTGlzdC5jb250YWlucygnZHJhZycpIHx8IGUudGFyZ2V0LmNsb3Nlc3QoJ2RpdicpLmNsYXNzTGlzdC5jb250YWlucygnZG90JykpXG4gICAgLy8gICAgIHtcbiAgICAvLyAgICAgICAgIGlmKCF0aGlzLmlzQ3Vyc29yVmlld2luZylcbiAgICAvLyAgICAgICAgIHtcbiAgICAvLyAgICAgICAgICAgICB0aGlzLmlzQ3Vyc29yVmlld2luZyA9IHRydWU7XG4gICAgLy8gICAgICAgICAgICAgZ3NhcC50byh0aGlzLiRjdXJzb3IuY2hpbGRyZW5bMF0sIHsgc2NhbGU6IDAsIGR1cmF0aW9uOiAwLjgsIGVhc2U6ICdleHBvLm91dCcgfSk7XG4gICAgLy8gICAgICAgICAgICAgZ3NhcC50byh0aGlzLiRjdXJzb3IuY2hpbGRyZW5bMV0sIHsgc2NhbGU6IDAsIGR1cmF0aW9uOiAwLjgsIGVhc2U6ICdleHBvLm91dCcgfSk7XG4gICAgLy8gICAgICAgICB9XG4gICAgLy8gICAgIH1cbiAgICAvLyAgICAgZWxzZSBpZihlLnRhcmdldC5jbG9zZXN0KCdkaXYnKS5jbGFzc0xpc3QuY29udGFpbnMoJ3NsaWRlcl9fYnVsbGV0c19faXRlbScpKVxuICAgIC8vICAgICB7XG4gICAgLy8gICAgICAgICBpZighdGhpcy5pc0N1cnNvclZpZXdpbmcpXG4gICAgLy8gICAgICAgICB7XG4gICAgLy8gICAgICAgICAgICAgdGhpcy5pc0N1cnNvclZpZXdpbmcgPSB0cnVlO1xuICAgIC8vICAgICAgICAgICAgIGdzYXAudG8odGhpcy4kY3Vyc29yLmNoaWxkcmVuWzBdLCB7IHNjYWxlOiAwLjcsIG9wYWNpdHk6IDAuMiwgZHVyYXRpb246IDAuOCwgZWFzZTogJ2V4cG8ub3V0JyB9KTtcbiAgICAvLyAgICAgICAgICAgICBnc2FwLnRvKHRoaXMuJGN1cnNvci5jaGlsZHJlblsxXSwgeyBzY2FsZTogMCwgZHVyYXRpb246IDAuOCwgZWFzZTogJ2V4cG8ub3V0JyB9KTtcbiAgICAvLyAgICAgICAgIH1cbiAgICAvLyAgICAgfVxuICAgIC8vICAgICBlbHNlXG4gICAgLy8gICAgIHtcbiAgICAvLyAgICAgICAgIGlmKHRoaXMuaXNDdXJzb3JWaWV3aW5nKVxuICAgIC8vICAgICAgICAge1xuICAgIC8vICAgICAgICAgICAgIHRoaXMuaXNDdXJzb3JWaWV3aW5nID0gZmFsc2U7XG4gICAgLy8gICAgICAgICAgICAgZ3NhcC50byh0aGlzLiRjdXJzb3IuY2hpbGRyZW5bMF0sIHsgc2NhbGU6IDEsIG9wYWNpdHk6IDAuNSwgZHVyYXRpb246IDAuOCwgZWFzZTogJ2V4cG8ub3V0JyB9KTtcbiAgICAvLyAgICAgICAgICAgICBnc2FwLnRvKHRoaXMuJGN1cnNvci5jaGlsZHJlblsxXSwgeyBzY2FsZTogMSwgZHVyYXRpb246IDAuOCwgZWFzZTogJ2V4cG8ub3V0JyB9KTtcbiAgICAvLyAgICAgICAgIH1cbiAgICAvLyAgICAgfVxuICAgIC8vIH1cblxuICB9LCB7XG4gICAga2V5OiBcImd1aWRlc1N3aXRjaGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGd1aWRlc1N3aXRjaGVyKCkge1xuICAgICAgaWYgKHRoaXMuJGd1aWRlc0hyLnN0eWxlLmRpc3BsYXkgPT09ICdibG9jaycpIHtcbiAgICAgICAgZ3NhcC5zZXQodGhpcy4kZ3VpZGVzSHIsIHtcbiAgICAgICAgICBkaXNwbGF5OiAnbm9uZSdcbiAgICAgICAgfSk7XG4gICAgICAgIGdzYXAuc2V0KHRoaXMuJGd1aWRlc1ZyLCB7XG4gICAgICAgICAgZGlzcGxheTogJ25vbmUnXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZ3NhcC5zZXQodGhpcy4kZ3VpZGVzSHIsIHtcbiAgICAgICAgICBkaXNwbGF5OiAnYmxvY2snXG4gICAgICAgIH0pO1xuICAgICAgICBnc2FwLnNldCh0aGlzLiRndWlkZXNWciwge1xuICAgICAgICAgIGRpc3BsYXk6ICdibG9jaydcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImd1aWRlc1N3aXRjaGVyMlwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBndWlkZXNTd2l0Y2hlcjIoKSB7XG4gICAgICBpZiAodGhpcy4kZ3VpZGVzSHIyLnN0eWxlLmRpc3BsYXkgPT09ICdibG9jaycpIHtcbiAgICAgICAgZ3NhcC5zZXQodGhpcy4kZ3VpZGVzSHIyLCB7XG4gICAgICAgICAgZGlzcGxheTogJ25vbmUnXG4gICAgICAgIH0pO1xuICAgICAgICBnc2FwLnNldCh0aGlzLiRndWlkZXNWcjIsIHtcbiAgICAgICAgICBkaXNwbGF5OiAnbm9uZSdcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBnc2FwLnNldCh0aGlzLiRndWlkZXNIcjIsIHtcbiAgICAgICAgICBkaXNwbGF5OiAnYmxvY2snXG4gICAgICAgIH0pO1xuICAgICAgICBnc2FwLnNldCh0aGlzLiRndWlkZXNWcjIsIHtcbiAgICAgICAgICBkaXNwbGF5OiAnYmxvY2snXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJyZXNpemVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVzaXplKHdpZHRoLCBoZWlnaHQpIHsvLyB0aGlzLiRub3RpY2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm90aWNlJyk7XG4gICAgICAvLyBpZighdGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApXG4gICAgICAvLyB7XG4gICAgICAvLyAgICAgaWYod2lkdGggPiBoZWlnaHQpXG4gICAgICAvLyAgICAge1xuICAgICAgLy8gICAgICAgICBnc2FwLnNldCh0aGlzLiRub3RpY2UsIHsgZGlzcGxheTogJ2Jsb2NrJyB9KTtcbiAgICAgIC8vICAgICAgICAgdGhpcy4kbm90aWNlLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIChlKSA9PiB7IGUucHJldmVudERlZmF1bHQoKTsgfSk7XG4gICAgICAvLyAgICAgfVxuICAgICAgLy8gICAgIGVsc2VcbiAgICAgIC8vICAgICB7XG4gICAgICAvLyAgICAgICAgIGdzYXAuc2V0KHRoaXMuJG5vdGljZSwgeyBkaXNwbGF5OiAnbm9uZScgfSk7XG4gICAgICAvLyAgICAgfVxuICAgICAgLy8gfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJyZXNpemVPcmllbnRhdGlvblwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZXNpemVPcmllbnRhdGlvbigpIHt9IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcblxuICB9LCB7XG4gICAga2V5OiBcInNwbGl0XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNwbGl0KHgsIG4pIHtcbiAgICAgIGlmICh4IDwgbikge1xuICAgICAgICBkb2N1bWVudC53cml0ZSgnLTEgJyk7XG4gICAgICB9IGVsc2UgaWYgKHggJSBuID09PSAwKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgZG9jdW1lbnQud3JpdGUoeCAvIG4gKyAnICcpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgenAgPSBuIC0geCAlIG47XG4gICAgICAgIHZhciBwcCA9IE1hdGguZmxvb3IoeCAvIG4pO1xuXG4gICAgICAgIGZvciAodmFyIF9pMyA9IDA7IF9pMyA8IG47IF9pMysrKSB7XG4gICAgICAgICAgaWYgKF9pMyA+PSB6cCkgZG9jdW1lbnQud3JpdGUocHAgKyAxICsgJyAnKTtlbHNlIGRvY3VtZW50LndyaXRlKHBwICsgJyAnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzcGxpdEluUGFydHNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaXRJblBhcnRzKG51bSwgcGFydHMpIHtcbiAgICAgIHZhciBzdW1QYXJ0cyA9IDA7XG4gICAgICB2YXIgdG90YWxQYXJ0cyA9IFtdO1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhcnRzIC0gMTsgaSsrKSB7XG4gICAgICAgIHZhciBwbiA9IE1hdGgucmFuZG9tKCkgKiAobnVtIC0gc3VtUGFydHMpO1xuICAgICAgICBzdW1QYXJ0cyArPSBNYXRoLm1pbihwbiwgbnVtICogMC41KTtcbiAgICAgICAgdG90YWxQYXJ0cy5wdXNoKHN1bVBhcnRzKTtcbiAgICAgIH1cblxuICAgICAgc3VtUGFydHMgKz0gbnVtIC0gc3VtUGFydHM7XG4gICAgICB0b3RhbFBhcnRzLnB1c2goc3VtUGFydHMpO1xuICAgICAgcmV0dXJuIHRvdGFsUGFydHM7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIGFwcFVpO1xufSgpO1xuXG5leHBvcnQgZGVmYXVsdCBhcHBVaTsiLCJmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyBcIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mXCI7IGlmICh0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuLy8gdXRpbGl0aWVzXG5pbXBvcnQgVmlydHVhbFNjcm9sbCBmcm9tICd2aXJ0dWFsLXNjcm9sbCc7XG5pbXBvcnQgeyBnc2FwIH0gZnJvbSAnZ3NhcCc7XG5pbXBvcnQgYXBwU3RvcmUgZnJvbSAnLi4vYXBwL2FwcFN0b3JlJzsgLy8gZW1wdHkgZnVuY3Rpb25cblxudmFyIG5vb3AgPSBmdW5jdGlvbiBub29wKCkge307IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcblxuXG52YXIgX2RlZmF1bHQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBfZGVmYXVsdChvcHRpb25zKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBfZGVmYXVsdCk7XG5cbiAgICAvLyBzdG9yZVxuICAgIHRoaXMuYXBwU3RvcmUgPSBhcHBTdG9yZTsgLy8gaG9vayBmdW5jdGlvbnNcblxuICAgIHRoaXMuX29uUmFmID0gb3B0aW9ucy5vblJhZiB8fCBub29wO1xuICAgIHRoaXMuX29uU2Nyb2xsID0gb3B0aW9ucy5vblNjcm9sbCB8fCBub29wO1xuICAgIHRoaXMuX2N1cnJlbnRTZWN0aW9uID0gb3B0aW9ucy5jdXJyZW50U2VjdGlvbiA/IG9wdGlvbnMuY3VycmVudFNlY3Rpb24gOiBudWxsO1xuICAgIHRoaXMuX2dsb2JhbCA9IHtcbiAgICAgIHBlcmNlbnQ6IHtcbiAgICAgICAgeDogMCxcbiAgICAgICAgeTogMFxuICAgICAgfSxcbiAgICAgIG1vZGU6IG9wdGlvbnMubW9kZSB8fCAndmVydGljYWwnXG4gICAgfTtcblxuICAgIHZhciBsZXJwID0gZnVuY3Rpb24gbGVycCh2YWx1ZTEsIHZhbHVlMiwgYW1vdW50KSB7XG4gICAgICBhbW91bnQgPSBhbW91bnQgPCAwID8gMCA6IGFtb3VudDtcbiAgICAgIGFtb3VudCA9IGFtb3VudCA+IDEgPyAxIDogYW1vdW50O1xuICAgICAgcmV0dXJuIHZhbHVlMSArICh2YWx1ZTIgLSB2YWx1ZTEpICogYW1vdW50O1xuICAgIH07IC8vIHNjcm9sbCBwcm9wZXJ0aWVzXG5cblxuICAgIGlmIChvcHRpb25zLnNjcm9sbCkge1xuICAgICAgLy8gZGVmYXVsdCB2aXJ0dWFsU2Nyb2xsIG9wdGlvbnNcbiAgICAgIHRoaXMuX3ZpcnR1YWxTY3JvbGwgPSBudWxsO1xuICAgICAgdGhpcy5fdmlydHVhbFNjcm9sbE9wdGlvbnMgPSB7XG4gICAgICAgIGVsOiB0eXBlb2Ygb3B0aW9ucy5lbCAhPT0gJ3VuZGVmaW5lZCcgPyBfdHlwZW9mKG9wdGlvbnMuZWwpIDogd2luZG93LFxuICAgICAgICBtb3VzZU11bHRpcGxpZXI6IHR5cGVvZiBvcHRpb25zLm1vdXNlTXVsdGlwbGllciAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLm1vdXNlTXVsdGlwbGllciA6IHRoaXMuYXBwU3RvcmUuY2xpZW50Lm9zID09PSAnd2luZG93cycgPyAxIDogMC40LFxuICAgICAgICB0b3VjaE11bHRpcGxpZXI6IHR5cGVvZiBvcHRpb25zLnRvdWNoTXVsdGlwbGllciAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLnRvdWNoTXVsdGlwbGllciA6IDIsXG4gICAgICAgIGZpcmVmb3hNdWx0aXBsaWVyOiB0eXBlb2Ygb3B0aW9ucy5maXJlZm94TXVsdGlwbGllciAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmZpcmVmb3hNdWx0aXBsaWVyIDogNTAsXG4gICAgICAgIGxpbWl0SW5lcnRpYTogdHlwZW9mIG9wdGlvbnMubGltaXRJbmVydGlhICE9PSAndW5kZWZpbmVkJyA/IF90eXBlb2Yob3B0aW9ucy5saW1pdEluZXJ0aWEpIDogZmFsc2UsXG4gICAgICAgIHBhc3NpdmU6IHR5cGVvZiBvcHRpb25zLnBhc3NpdmUgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5wYXNpdmUgOiBmYWxzZSxcbiAgICAgICAgdXNlS2V5Ym9hcmQ6IGZhbHNlXG4gICAgICB9O1xuICAgICAgdGhpcy5fc2Nyb2xsID0ge1xuICAgICAgICBlbmFibGU6IHR5cGVvZiBvcHRpb25zLmVuYWJsZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmVuYWJsZSA6IHRydWUsXG4gICAgICAgIHRhcmdldDogb3B0aW9ucy5zY3JvbGxUYXJnZXQsXG4gICAgICAgIHdpZHRoOiAwLFxuICAgICAgICBoZWlnaHQ6IDAsXG4gICAgICAgIHRpbWVvdXQ6IGZhbHNlLFxuICAgICAgICBkcmFnZ2luZzogZmFsc2UsXG4gICAgICAgIHJhdGlvOiB7XG4gICAgICAgICAgeDogMCxcbiAgICAgICAgICB5OiAwXG4gICAgICAgIH0sXG4gICAgICAgIGNsaWNrZWRQb2ludDoge1xuICAgICAgICAgIHg6IDAsXG4gICAgICAgICAgeTogMFxuICAgICAgICB9LFxuICAgICAgICBwb3NpdGlvbjoge1xuICAgICAgICAgIHg6IDAsXG4gICAgICAgICAgeTogMFxuICAgICAgICB9LFxuICAgICAgICBsYXN0UG9zaXRpb246IHtcbiAgICAgICAgICB4OiAwLFxuICAgICAgICAgIHk6IDBcbiAgICAgICAgfSxcbiAgICAgICAgbGl2ZVBvc2l0aW9uOiB7XG4gICAgICAgICAgeDogMCxcbiAgICAgICAgICB5OiAwXG4gICAgICAgIH0sXG4gICAgICAgIG1heFNjcm9sbDoge1xuICAgICAgICAgIHg6IDAsXG4gICAgICAgICAgeTogMFxuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICB0aGlzLl9zY3JvbGxEb3duID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZ3NhcC5kZWxheWVkQ2FsbCgwLjIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBfdGhpcy5fc2Nyb2xsLnRhcmdldC5wYXJlbnROb2RlLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnbm9uZSc7XG4gICAgICAgIH0pOyAvLyBzZXQgZmxhZ1xuXG4gICAgICAgIF90aGlzLl9zY3JvbGwuZHJhZ2dpbmcgPSB0cnVlO1xuXG4gICAgICAgIF90aGlzLl9zY3JvbGwudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ2RyYWdnaW5nJyk7IC8vIGdldCB0aGUgcG9pbnQgdGhlIHVzZXIgY2xpY2tlZCBvbiB0aGUgYmFyXG5cblxuICAgICAgICBfdGhpcy5fc2Nyb2xsLmNsaWNrZWRQb2ludC54ID0gZS5jbGllbnRYIC0gX3RoaXMuX3Njcm9sbC5saXZlUG9zaXRpb24ueDtcbiAgICAgICAgX3RoaXMuX3Njcm9sbC5jbGlja2VkUG9pbnQueSA9IGUuY2xpZW50WSAtIF90aGlzLl9zY3JvbGwubGl2ZVBvc2l0aW9uLnk7IC8vIHRyYWNrIHRoZSBtb3VzZSBldmVudHNcblxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBfdGhpcy5fc2Nyb2xsRHJhZyk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBfdGhpcy5fc2Nyb2xsVXApO1xuICAgICAgfTtcblxuICAgICAgdGhpcy5fc2Nyb2xsRHJhZyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmIChfdGhpcy5fZ2xvYmFsLm1vZGUgPT09ICdob3Jpem9udGFsJykge1xuICAgICAgICAgIC8vIGNhbGN1bGF0ZSB0aGUgYW1vdW50IHRoZSB1c2VyIG1vdmVkIGZyb20gdGhlIGNsaWNrZWQgcG9pbnQgb24gdGhlIHNjcm9sbGJhciwgY2hlY2tpbmcgbGltaXRzXG4gICAgICAgICAgX3RoaXMuX3Njcm9sbC5wb3NpdGlvbi54ID0gTWF0aC5taW4oMCwgTWF0aC5tYXgoX3RoaXMuX3Njcm9sbC5tYXhTY3JvbGwueCwgZS5jbGllbnRYIC0gX3RoaXMuX3Njcm9sbC5jbGlja2VkUG9pbnQueCkpOyAvLyB1cGRhdGUgZ2xvYmFsIHBlcmNlbnRhZ2VcblxuICAgICAgICAgIF90aGlzLl9nbG9iYWwucGVyY2VudC54ID0gX3RoaXMuX3Njcm9sbC5wb3NpdGlvbi54IC8gX3RoaXMuX3Njcm9sbC5tYXhTY3JvbGwueDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBjYWxjdWxhdGUgdGhlIGFtb3VudCB0aGUgdXNlciBtb3ZlZCBmcm9tIHRoZSBjbGlja2VkIHBvaW50IG9uIHRoZSBzY3JvbGxiYXIsIGNoZWNraW5nIGxpbWl0c1xuICAgICAgICAgIF90aGlzLl9zY3JvbGwucG9zaXRpb24ueSA9IE1hdGgubWluKDAsIE1hdGgubWF4KF90aGlzLl9zY3JvbGwubWF4U2Nyb2xsLnksIGUuY2xpZW50WSAtIF90aGlzLl9zY3JvbGwuY2xpY2tlZFBvaW50LnkpKTsgLy8gdXBkYXRlIGdsb2JhbCBwZXJjZW50YWdlXG5cbiAgICAgICAgICBfdGhpcy5fZ2xvYmFsLnBlcmNlbnQueSA9IF90aGlzLl9zY3JvbGwucG9zaXRpb24ueSAvIF90aGlzLl9zY3JvbGwubWF4U2Nyb2xsLnk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHRoaXMuX3Njcm9sbFVwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBnc2FwLmRlbGF5ZWRDYWxsKDAuMiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIF90aGlzLl9zY3JvbGwudGFyZ2V0LnBhcmVudE5vZGUuc3R5bGUucG9pbnRlckV2ZW50cyA9ICdhbGwnO1xuICAgICAgICB9KTsgLy8gc3RvcCB0cmFja2luZyB0aGUgdHdvIG1vdXNlIGV2ZW50c1xuXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIF90aGlzLl9zY3JvbGxEcmFnKTtcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIF90aGlzLl9zY3JvbGxVcCk7IC8vIHNldCBmbGFnXG5cbiAgICAgICAgX3RoaXMuX3Njcm9sbC5kcmFnZ2luZyA9IGZhbHNlO1xuXG4gICAgICAgIF90aGlzLl9zY3JvbGwudGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoJ2RyYWdnaW5nJyk7XG4gICAgICB9OyAvLyBiaW5kIG1vdXNlZG93biBldmVudFxuXG5cbiAgICAgIGlmICh0aGlzLl9nbG9iYWwubW9kZSA9PT0gJ2hvcml6b250YWwnKSB0aGlzLl9zY3JvbGwudGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuX3Njcm9sbERvd24pO1xuXG4gICAgICB0aGlzLl9zY3JvbGxNb3ZlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgX3RoaXMuX29uU2Nyb2xsKCk7IC8vIFByZXZlbnQgcG9pbnRlcmV2ZW50cyBvbiBzY3JvbGxcblxuXG4gICAgICAgIF90aGlzLl9zY3JvbGwudGFyZ2V0LnBhcmVudE5vZGUuc3R5bGUucG9pbnRlckV2ZW50cyA9ICdub25lJztcbiAgICAgICAgY2xlYXJUaW1lb3V0KF90aGlzLl9zY3JvbGwudGltZW91dCk7XG4gICAgICAgIF90aGlzLl9zY3JvbGwudGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIF90aGlzLl9zY3JvbGwudGFyZ2V0LnBhcmVudE5vZGUuc3R5bGUucG9pbnRlckV2ZW50cyA9ICdhbGwnO1xuICAgICAgICB9LCAyMDApOyAvLyBjaGVjayBpZiBzY3JvbGwgaXMgYWxsb3dlZFxuXG4gICAgICAgIGlmICghX3RoaXMuX3Njcm9sbC5lbmFibGUpIHJldHVybjsgLy8gdXBkYXRlIHNjcm9sbFxuXG4gICAgICAgIGlmIChfdGhpcy5fZ2xvYmFsLm1vZGUgPT09ICdob3Jpem9udGFsJykge1xuICAgICAgICAgIC8vIGdldCBzY3JvbGwgdmFsdWVzXG4gICAgICAgICAgX3RoaXMuX3Njcm9sbC5wb3NpdGlvbi54ID0gTWF0aC5taW4oMCwgTWF0aC5tYXgoX3RoaXMuX3Njcm9sbC5tYXhTY3JvbGwueCwgX3RoaXMuX3Njcm9sbC5wb3NpdGlvbi54ICs9IGUuZGVsdGFZKSk7XG4gICAgICAgICAgX3RoaXMuX3Njcm9sbC5wb3NpdGlvbi54ID0gTWF0aC5taW4oMCwgTWF0aC5tYXgoX3RoaXMuX3Njcm9sbC5tYXhTY3JvbGwueCwgX3RoaXMuX3Njcm9sbC5wb3NpdGlvbi54ICs9IGUuZGVsdGFYKSk7XG4gICAgICAgICAgX3RoaXMuX2dsb2JhbC5wZXJjZW50LnggPSBfdGhpcy5fc2Nyb2xsLnBvc2l0aW9uLnggLyBfdGhpcy5fc2Nyb2xsLm1heFNjcm9sbC54O1xuICAgICAgICAgIF90aGlzLl9zY3JvbGwubGFzdFBvc2l0aW9uLnggPSBfdGhpcy5fc2Nyb2xsLnBvc2l0aW9uLng7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gZ2V0IHNjcm9sbCB2YWx1ZXNcbiAgICAgICAgICBfdGhpcy5fc2Nyb2xsLnBvc2l0aW9uLnkgPSBNYXRoLm1pbigwLCBNYXRoLm1heChfdGhpcy5fc2Nyb2xsLm1heFNjcm9sbC55LCBfdGhpcy5fc2Nyb2xsLnBvc2l0aW9uLnkgKz0gZS5kZWx0YVkpKTtcbiAgICAgICAgICBfdGhpcy5fZ2xvYmFsLnBlcmNlbnQueSA9IF90aGlzLl9zY3JvbGwucG9zaXRpb24ueSAvIF90aGlzLl9zY3JvbGwubWF4U2Nyb2xsLnk7XG4gICAgICAgICAgX3RoaXMuX3Njcm9sbC5sYXN0UG9zaXRpb24ueSA9IF90aGlzLl9zY3JvbGwucG9zaXRpb24ueTtcbiAgICAgICAgfVxuXG4gICAgICAgIGUub3JpZ2luYWxFdmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfTtcblxuICAgICAgdGhpcy5fc2Nyb2xsUmFmID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoX3RoaXMuX2dsb2JhbC5tb2RlID09PSAnaG9yaXpvbnRhbCcpIF90aGlzLl9zY3JvbGwubGl2ZVBvc2l0aW9uLnggPSBsZXJwKF90aGlzLl9zY3JvbGwubGl2ZVBvc2l0aW9uLngsIF90aGlzLl9zY3JvbGwubWF4U2Nyb2xsLnggKiBfdGhpcy5fZ2xvYmFsLnBlcmNlbnQueCwgMC4xKTtlbHNlIF90aGlzLl9zY3JvbGwubGl2ZVBvc2l0aW9uLnkgPSBsZXJwKF90aGlzLl9zY3JvbGwubGl2ZVBvc2l0aW9uLnksIF90aGlzLl9zY3JvbGwubWF4U2Nyb2xsLnkgKiBfdGhpcy5fZ2xvYmFsLnBlcmNlbnQueSwgMC4xKTtcbiAgICAgICAgX3RoaXMuX3Njcm9sbC50YXJnZXQuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZTNkKCcgKyBfdGhpcy5fc2Nyb2xsLmxpdmVQb3NpdGlvbi54ICsgJ3B4LCcgKyBfdGhpcy5fc2Nyb2xsLmxpdmVQb3NpdGlvbi55ICsgJ3B4LCAwcHgpJztcbiAgICAgIH07XG5cbiAgICAgIHRoaXMuX29uS2V5RG93biA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIC8vIFJldHVybiBpZiBpbnB1dCBpcyBmb2N1c2VkXG4gICAgICAgIHZhciAkaW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQnKTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8ICRpbnB1dHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5uYW1lID09PSAkaW5wdXRzW2ldLm5hbWUpIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSAvLyBpbml0IHNjcm9sbCB2YWx1ZXNcblxuXG4gICAgICAgIHZhciBzY3JvbGxYID0gMDtcbiAgICAgICAgdmFyIHNjcm9sbFkgPSAwOyAvLyBnZXQgd2luZG93IGhlaWdodCBhbmQgd2lkdGhcblxuICAgICAgICB2YXIgd2luZG93SGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0IC0gNDA7XG4gICAgICAgIHZhciB3aW5kb3dXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoIC0gNDA7IC8vIGNoZWNrIHByZXNzZWQga2V5XG5cbiAgICAgICAgc3dpdGNoIChlLmtleUNvZGUpIHtcbiAgICAgICAgICBjYXNlIDM3OlxuICAgICAgICAgICAgc2Nyb2xsWCA9IC0xMjA7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgMzg6XG4gICAgICAgICAgICBzY3JvbGxZID0gLTEyMDtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAzOTpcbiAgICAgICAgICAgIHNjcm9sbFggPSAxMjA7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgNDA6XG4gICAgICAgICAgICBzY3JvbGxZID0gMTIwO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlIDMyICYmIGUuc2hpZnRLZXk6XG4gICAgICAgICAgICBzY3JvbGxYID0gLXdpbmRvd1dpZHRoO1xuICAgICAgICAgICAgc2Nyb2xsWSA9IC13aW5kb3dIZWlnaHQ7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgMzI6XG4gICAgICAgICAgICBzY3JvbGxYID0gd2luZG93V2lkdGg7XG4gICAgICAgICAgICBzY3JvbGxZID0gd2luZG93SGVpZ2h0O1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IC8vIHVwZGF0ZSBzY3JvbGxcblxuXG4gICAgICAgIF90aGlzLnNjcm9sbFVwZGF0ZShzY3JvbGxYLCBzY3JvbGxZKTtcbiAgICAgIH07XG4gICAgfSAvLyBiYXIgcHJvcGVydGllc1xuXG5cbiAgICBpZiAob3B0aW9ucy5iYXIpIHtcbiAgICAgIHRoaXMuX2JhciA9IHtcbiAgICAgICAgZW5hYmxlOiB0cnVlLFxuICAgICAgICB0YXJnZXQ6IG9wdGlvbnMuYmFyVGFyZ2V0LFxuICAgICAgICB3aWR0aDogMCxcbiAgICAgICAgaGVpZ2h0OiAwLFxuICAgICAgICBkcmFnZ2luZzogZmFsc2UsXG4gICAgICAgIHJhdGlvOiB7XG4gICAgICAgICAgeDogMCxcbiAgICAgICAgICB5OiAwXG4gICAgICAgIH0sXG4gICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgeDogMCxcbiAgICAgICAgICB5OiAwXG4gICAgICAgIH0sXG4gICAgICAgIGxpdmVQb3NpdGlvbjoge1xuICAgICAgICAgIHg6IDAsXG4gICAgICAgICAgeTogMFxuICAgICAgICB9LFxuICAgICAgICBtYXhTY3JvbGw6IHtcbiAgICAgICAgICB4OiAwLFxuICAgICAgICAgIHk6IDBcbiAgICAgICAgfSxcbiAgICAgICAgY2xpY2tlZFBvaW50OiB7XG4gICAgICAgICAgeDogMCxcbiAgICAgICAgICB5OiAwXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHRoaXMuX2JhckRvd24gPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAvLyBzZXQgZmxhZ1xuICAgICAgICBfdGhpcy5fYmFyLmRyYWdnaW5nID0gdHJ1ZTtcblxuICAgICAgICBfdGhpcy5fYmFyLnRhcmdldC5jbGFzc0xpc3QuYWRkKCdkcmFnZ2luZycpOyAvLyBnZXQgdGhlIHBvaW50IHRoZSB1c2VyIGNsaWNrZWQgb24gdGhlIGJhclxuXG5cbiAgICAgICAgX3RoaXMuX2Jhci5jbGlja2VkUG9pbnQueCA9IGUuY2xpZW50WCAtIF90aGlzLl9iYXIubGl2ZVBvc2l0aW9uLng7XG4gICAgICAgIF90aGlzLl9iYXIuY2xpY2tlZFBvaW50LnkgPSBlLmNsaWVudFkgLSBfdGhpcy5fYmFyLmxpdmVQb3NpdGlvbi55OyAvLyB0cmFjayB0aGUgbW91c2UgZXZlbnRzXG5cbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgX3RoaXMuX2Jhck1vdmUpO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgX3RoaXMuX2JhclVwKTtcbiAgICAgIH07XG5cbiAgICAgIHRoaXMuX2Jhck1vdmUgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoX3RoaXMuX2dsb2JhbC5tb2RlID09PSAnaG9yaXpvbnRhbCcpIHtcbiAgICAgICAgICAvLyBjYWxjdWxhdGUgdGhlIGFtb3VudCB0aGUgdXNlciBtb3ZlZCBmcm9tIHRoZSBjbGlja2VkIHBvaW50IG9uIHRoZSBzY3JvbGxiYXIsIGNoZWNraW5nIGxpbWl0c1xuICAgICAgICAgIF90aGlzLl9iYXIucG9zaXRpb24ueCA9IE1hdGgubWluKE1hdGgubWF4KGUuY2xpZW50WCAtIF90aGlzLl9iYXIuY2xpY2tlZFBvaW50LngsIDApLCBfdGhpcy5fYmFyLm1heFNjcm9sbC54KTsgLy8gdXBkYXRlIGdsb2JhbCBwZXJjZW50YWdlXG5cbiAgICAgICAgICBfdGhpcy5fZ2xvYmFsLnBlcmNlbnQueCA9IF90aGlzLl9iYXIucG9zaXRpb24ueCAvIF90aGlzLl9iYXIubWF4U2Nyb2xsLng7XG4gICAgICAgICAgX3RoaXMuX3Njcm9sbC5wb3NpdGlvbi54ID0gX3RoaXMuX2dsb2JhbC5wZXJjZW50LnggKiBfdGhpcy5fc2Nyb2xsLm1heFNjcm9sbC54O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIGNhbGN1bGF0ZSB0aGUgYW1vdW50IHRoZSB1c2VyIG1vdmVkIGZyb20gdGhlIGNsaWNrZWQgcG9pbnQgb24gdGhlIHNjcm9sbGJhciwgY2hlY2tpbmcgbGltaXRzXG4gICAgICAgICAgX3RoaXMuX2Jhci5wb3NpdGlvbi55ID0gTWF0aC5taW4oTWF0aC5tYXgoZS5jbGllbnRZIC0gX3RoaXMuX2Jhci5jbGlja2VkUG9pbnQueSwgMCksIF90aGlzLl9iYXIubWF4U2Nyb2xsLnkpOyAvLyB1cGRhdGUgZ2xvYmFsIHBlcmNlbnRhZ2VcblxuICAgICAgICAgIF90aGlzLl9nbG9iYWwucGVyY2VudC55ID0gX3RoaXMuX2Jhci5wb3NpdGlvbi55IC8gX3RoaXMuX2Jhci5tYXhTY3JvbGwueTtcbiAgICAgICAgICBfdGhpcy5fc2Nyb2xsLnBvc2l0aW9uLnkgPSBfdGhpcy5fZ2xvYmFsLnBlcmNlbnQueSAqIF90aGlzLl9zY3JvbGwubWF4U2Nyb2xsLnk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHRoaXMuX2JhclVwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBzdG9wIHRyYWNraW5nIHRoZSB0d28gbW91c2UgZXZlbnRzXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIF90aGlzLl9iYXJNb3ZlKTtcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIF90aGlzLl9iYXJVcCk7IC8vIHNldCBmbGFnXG5cbiAgICAgICAgX3RoaXMuX2Jhci5kcmFnZ2luZyA9IGZhbHNlO1xuXG4gICAgICAgIF90aGlzLl9iYXIudGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoJ2RyYWdnaW5nJyk7XG4gICAgICB9O1xuXG4gICAgICB0aGlzLl9iYXJSYWYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChfdGhpcy5fZ2xvYmFsLm1vZGUgPT09ICdob3Jpem9udGFsJykgX3RoaXMuX2Jhci5saXZlUG9zaXRpb24ueCA9IGxlcnAoX3RoaXMuX2Jhci5saXZlUG9zaXRpb24ueCwgX3RoaXMuX2Jhci5tYXhTY3JvbGwueCAqIF90aGlzLl9nbG9iYWwucGVyY2VudC54LCAwLjEpO2Vsc2UgX3RoaXMuX2Jhci5saXZlUG9zaXRpb24ueSA9IGxlcnAoX3RoaXMuX2Jhci5saXZlUG9zaXRpb24ueSwgX3RoaXMuX2Jhci5tYXhTY3JvbGwueSAqIF90aGlzLl9nbG9iYWwucGVyY2VudC55LCAwLjEpO1xuICAgICAgICBfdGhpcy5fYmFyLnRhcmdldC5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlM2QoJyArIF90aGlzLl9iYXIubGl2ZVBvc2l0aW9uLnggKyAncHgsJyArIF90aGlzLl9iYXIubGl2ZVBvc2l0aW9uLnkgKyAncHgsIDBweCknO1xuICAgICAgfTsgLy8gYmluZCBtb3VzZWRvd24gZXZlbnRcblxuXG4gICAgICB0aGlzLl9iYXIudGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuX2JhckRvd24pO1xuICAgIH1cblxuICAgIHRoaXMuX3JhZiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICghX3RoaXMuX3Njcm9sbC5lbmFibGUpIHJldHVybjtcbiAgICAgIGlmIChfdGhpcy5fc2Nyb2xsKSBfdGhpcy5fc2Nyb2xsUmFmKCk7XG4gICAgICBpZiAoX3RoaXMuX2JhcikgX3RoaXMuX2JhclJhZigpO1xuXG4gICAgICBfdGhpcy5fb25SYWYoX3RoaXMuX3Njcm9sbC5saXZlUG9zaXRpb24sIF90aGlzLl9nbG9iYWwucGVyY2VudCk7XG4gICAgfTsgLy8gYmluZCB0byBnc2FwIHRpY2tlclxuXG5cbiAgICBnc2FwLnRpY2tlci5hZGQodGhpcy5fcmFmKTsgLy8gYmluZFxuXG4gICAgdGhpcy5pbml0KCk7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoX2RlZmF1bHQsIFt7XG4gICAga2V5OiBcImluaXRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICAvLyB2aXJ0dWFsc2Nyb2xsIHByb3BlcnRpZXNcbiAgICAgIGlmICh0aGlzLl92aXJ0dWFsU2Nyb2xsICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICB0aGlzLl92aXJ0dWFsU2Nyb2xsID0gbmV3IFZpcnR1YWxTY3JvbGwodGhpcy5fdmlydHVhbFNjcm9sbE9wdGlvbnMpO1xuXG4gICAgICAgIHRoaXMuX3ZpcnR1YWxTY3JvbGwub24oZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBfdGhpczIuX3Njcm9sbE1vdmUoZSk7XG4gICAgICAgIH0pOyAvLyBiaW5kIGtleWRvd24gZXZlbnRcblxuXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9vbktleURvd24pO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzY3JvbGxVcGRhdGVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2Nyb2xsVXBkYXRlKHNjcm9sbFgsIHNjcm9sbFkpIHtcbiAgICAgIC8vIFVwZGF0ZSBzY3JvbGwgdmFsdWVzXG4gICAgICB0aGlzLl9zY3JvbGwucG9zaXRpb24ueCA9IE1hdGgubWluKDAsIE1hdGgubWF4KHRoaXMuX3Njcm9sbC5wb3NpdGlvbi54IC09IHNjcm9sbFgsIHRoaXMuX3Njcm9sbC5tYXhTY3JvbGwueSkpO1xuICAgICAgdGhpcy5fc2Nyb2xsLnBvc2l0aW9uLnkgPSBNYXRoLm1pbigwLCBNYXRoLm1heCh0aGlzLl9zY3JvbGwucG9zaXRpb24ueSAtPSBzY3JvbGxZLCB0aGlzLl9zY3JvbGwubWF4U2Nyb2xsLnkpKTtcbiAgICAgIGdzYXAudG8odGhpcy5fZ2xvYmFsLnBlcmNlbnQsIHtcbiAgICAgICAgeDogdGhpcy5fc2Nyb2xsLnBvc2l0aW9uLnggLyB0aGlzLl9zY3JvbGwubWF4U2Nyb2xsLngsXG4gICAgICAgIHk6IHRoaXMuX3Njcm9sbC5wb3NpdGlvbi55IC8gdGhpcy5fc2Nyb2xsLm1heFNjcm9sbC55LFxuICAgICAgICBlYXNlOiAncG93ZXI0Lm91dCcsXG4gICAgICAgIGR1cmF0aW9uOiAwLjRcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzY3JvbGxBbmltYXRlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNjcm9sbEFuaW1hdGUoX3Bvc2l0aW9uKSB7XG4gICAgICB2YXIgX2R1cmF0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAyO1xuXG4gICAgICB2YXIgX2Vhc2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6ICdwb3dlcjQuaW5PdXQnO1xuXG4gICAgICB2YXIgX2ZvcmNlID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgPyBhcmd1bWVudHNbM10gOiB1bmRlZmluZWQ7XG5cbiAgICAgIF9kdXJhdGlvbiA9IHRoaXMuYXBwU3RvcmUuY2xpZW50LmJyb3dzZXIgPT09ICdmaXJlZm94JyA/IF9kdXJhdGlvbiAvIDIgOiBfZHVyYXRpb247XG4gICAgICBpZiAoIV9mb3JjZSAmJiAhdGhpcy5fc2Nyb2xsLmVuYWJsZSkgcmV0dXJuO1xuICAgICAgdGhpcy5fc2Nyb2xsLnBvc2l0aW9uLnkgPSBNYXRoLm1heCgtX3Bvc2l0aW9uLCB0aGlzLl9zY3JvbGwubWF4U2Nyb2xsLnkpO1xuICAgICAgZ3NhcC50byh0aGlzLl9nbG9iYWwucGVyY2VudCwge1xuICAgICAgICB5OiB0aGlzLl9zY3JvbGwucG9zaXRpb24ueSAvIHRoaXMuX3Njcm9sbC5tYXhTY3JvbGwueSxcbiAgICAgICAgZWFzZTogX2Vhc2UsXG4gICAgICAgIGR1cmF0aW9uOiBfZHVyYXRpb25cbiAgICAgIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzY3JvbGxSZXNpemVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2Nyb2xsUmVzaXplKCkge1xuICAgICAgLy9cbiAgICAgIHRoaXMuX3Njcm9sbC53aWR0aCA9IHRoaXMuX3Njcm9sbC50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGg7XG4gICAgICB0aGlzLl9zY3JvbGwuaGVpZ2h0ID0gdGhpcy5fc2Nyb2xsLnRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQ7XG4gICAgICB0aGlzLl9zY3JvbGwubWF4U2Nyb2xsLnggPSAtKHRoaXMuX3Njcm9sbC53aWR0aCAtIHdpbmRvdy5pbm5lcldpZHRoKTtcbiAgICAgIHRoaXMuX3Njcm9sbC5tYXhTY3JvbGwueSA9IC0odGhpcy5fc2Nyb2xsLmhlaWdodCAtIHdpbmRvdy5pbm5lckhlaWdodCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImJhclJlc2l6ZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBiYXJSZXNpemUoKSB7XG4gICAgICAvLyBnZXQgY29udGFpbmVyIGVsIHNpemVzXG4gICAgICB0aGlzLl9iYXIucGFyZW50V2lkdGggPSB0aGlzLl9iYXIudGFyZ2V0LnBhcmVudE5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGg7XG4gICAgICB0aGlzLl9iYXIucGFyZW50SGVpZ2h0ID0gdGhpcy5fYmFyLnRhcmdldC5wYXJlbnROb2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodDsgLy8gZ2V0IGJhciBzaXplXG5cbiAgICAgIGlmICh0aGlzLl9nbG9iYWwubW9kZSA9PT0gJ2hvcml6b250YWwnKSB7XG4gICAgICAgIHRoaXMuX2Jhci53aWR0aCA9IHRoaXMuX2Jhci5wYXJlbnRXaWR0aCAqIHRoaXMuX2Jhci5wYXJlbnRXaWR0aCAvIHRoaXMuX3Njcm9sbC53aWR0aDtcbiAgICAgICAgdGhpcy5fYmFyLmhlaWdodCA9IHRoaXMuX2Jhci50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0O1xuICAgICAgICB0aGlzLl9iYXIudGFyZ2V0LnN0eWxlLndpZHRoID0gdGhpcy5fYmFyLndpZHRoICsgJ3B4JztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX2Jhci53aWR0aCA9IHRoaXMuX2Jhci50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGg7XG4gICAgICAgIHRoaXMuX2Jhci5oZWlnaHQgPSB0aGlzLl9iYXIucGFyZW50SGVpZ2h0ICogdGhpcy5fYmFyLnBhcmVudEhlaWdodCAvIHRoaXMuX3Njcm9sbC5oZWlnaHQ7XG4gICAgICAgIHRoaXMuX2Jhci50YXJnZXQuc3R5bGUuaGVpZ2h0ID0gdGhpcy5fYmFyLmhlaWdodCArICdweCc7XG4gICAgICB9IC8vIGNhbGN1bGF0ZSBtYXhpbXVtIHNjcm9sbFxuXG5cbiAgICAgIHRoaXMuX2Jhci5tYXhTY3JvbGwueCA9IHRoaXMuX2Jhci5wYXJlbnRXaWR0aCAtIHRoaXMuX2Jhci53aWR0aDtcbiAgICAgIHRoaXMuX2Jhci5tYXhTY3JvbGwueSA9IHRoaXMuX2Jhci5wYXJlbnRIZWlnaHQgLSB0aGlzLl9iYXIuaGVpZ2h0O1xuICAgICAgdGhpcy5fYmFyLnJhdGlvLnggPSB0aGlzLl9iYXIud2lkdGggLyB0aGlzLl9iYXIucGFyZW50V2lkdGg7XG4gICAgICB0aGlzLl9iYXIucmF0aW8ueSA9IHRoaXMuX2Jhci5oZWlnaHQgLyB0aGlzLl9iYXIucGFyZW50SGVpZ2h0O1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJyZXNpemVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVzaXplKCkge1xuICAgICAgaWYgKHRoaXMuX3Njcm9sbCkgdGhpcy5zY3JvbGxSZXNpemUoKTtcbiAgICAgIGlmICh0aGlzLl9iYXIpIHRoaXMuYmFyUmVzaXplKCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImRlc3Ryb3lcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgIGdzYXAudGlja2VyLnJlbW92ZSh0aGlzLl9yYWYpO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBfZGVmYXVsdDtcbn0oKTtcblxuZXhwb3J0IHsgX2RlZmF1bHQgYXMgZGVmYXVsdCB9OyIsIi8qIVxuICogc3RyaW5nczogMy4yLjZcbiAqIGh0dHBzOi8vZ3JlZW5zb2NrLmNvbVxuICpcbiAqIENvcHlyaWdodCAyMDA4LTIwMjAsIEdyZWVuU29jay4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqIFN1YmplY3QgdG8gdGhlIHRlcm1zIGF0IGh0dHBzOi8vZ3JlZW5zb2NrLmNvbS9zdGFuZGFyZC1saWNlbnNlIG9yIGZvclxuICogQ2x1YiBHcmVlblNvY2sgbWVtYmVycywgdGhlIGFncmVlbWVudCBpc3N1ZWQgd2l0aCB0aGF0IG1lbWJlcnNoaXAuXG4gKiBAYXV0aG9yOiBKYWNrIERveWxlLCBqYWNrQGdyZWVuc29jay5jb21cbiovXG5cbi8qIGVzbGludC1kaXNhYmxlICovXG52YXIgX3RyaW1FeHAgPSAvKF5cXHMrfFxccyskKS9nO1xuZXhwb3J0IHZhciBlbW9qaUV4cCA9IC8oW1xcdUQ4MDAtXFx1REJGRl1bXFx1REMwMC1cXHVERkZGXSg/OltcXHUyMDBEXFx1RkUwRl1bXFx1RDgwMC1cXHVEQkZGXVtcXHVEQzAwLVxcdURGRkZdKXsyLH18XFx1RDgzRFxcdURDNjkoPzpcXHUyMDBEKD86KD86XFx1RDgzRFxcdURDNjlcXHUyMDBEKT9cXHVEODNEXFx1REM2N3woPzpcXHVEODNEXFx1REM2OVxcdTIwMEQpP1xcdUQ4M0RcXHVEQzY2KXxcXHVEODNDW1xcdURGRkItXFx1REZGRl0pfFxcdUQ4M0RcXHVEQzY5XFx1MjAwRCg/OlxcdUQ4M0RcXHVEQzY5XFx1MjAwRCk/XFx1RDgzRFxcdURDNjZcXHUyMDBEXFx1RDgzRFxcdURDNjZ8XFx1RDgzRFxcdURDNjlcXHUyMDBEKD86XFx1RDgzRFxcdURDNjlcXHUyMDBEKT9cXHVEODNEXFx1REM2N1xcdTIwMEQoPzpcXHVEODNEW1xcdURDNjZcXHVEQzY3XSl8XFx1RDgzQ1xcdURGRjNcXHVGRTBGXFx1MjAwRFxcdUQ4M0NcXHVERjA4fCg/OlxcdUQ4M0NbXFx1REZDM1xcdURGQzRcXHVERkNBXXxcXHVEODNEW1xcdURDNkVcXHVEQzcxXFx1REM3M1xcdURDNzdcXHVEQzgxXFx1REM4MlxcdURDODZcXHVEQzg3XFx1REU0NS1cXHVERTQ3XFx1REU0QlxcdURFNERcXHVERTRFXFx1REVBM1xcdURFQjQtXFx1REVCNl18XFx1RDgzRVtcXHVERDI2XFx1REQzNy1cXHVERDM5XFx1REQzRFxcdUREM0VcXHVEREQ2LVxcdURERERdKSg/OlxcdUQ4M0NbXFx1REZGQi1cXHVERkZGXSlcXHUyMDBEW1xcdTI2NDBcXHUyNjQyXVxcdUZFMEZ8XFx1RDgzRFxcdURDNjkoPzpcXHVEODNDW1xcdURGRkItXFx1REZGRl0pXFx1MjAwRCg/OlxcdUQ4M0NbXFx1REYzRVxcdURGNzNcXHVERjkzXFx1REZBNFxcdURGQThcXHVERkVCXFx1REZFRF18XFx1RDgzRFtcXHVEQ0JCXFx1RENCQ1xcdUREMjdcXHVERDJDXFx1REU4MFxcdURFOTJdKXwoPzpcXHVEODNDW1xcdURGQzNcXHVERkM0XFx1REZDQV18XFx1RDgzRFtcXHVEQzZFXFx1REM2RlxcdURDNzFcXHVEQzczXFx1REM3N1xcdURDODFcXHVEQzgyXFx1REM4NlxcdURDODdcXHVERTQ1LVxcdURFNDdcXHVERTRCXFx1REU0RFxcdURFNEVcXHVERUEzXFx1REVCNC1cXHVERUI2XXxcXHVEODNFW1xcdUREMjZcXHVERDM3LVxcdUREMzlcXHVERDNDLVxcdUREM0VcXHVEREQ2LVxcdUREREZdKVxcdTIwMERbXFx1MjY0MFxcdTI2NDJdXFx1RkUwRnxcXHVEODNDXFx1RERGRFxcdUQ4M0NcXHVEREYwfFxcdUQ4M0NcXHVEREY2XFx1RDgzQ1xcdURERTZ8XFx1RDgzQ1xcdURERjRcXHVEODNDXFx1RERGMnxcXHVEODNDXFx1RERFOSg/OlxcdUQ4M0NbXFx1RERFQVxcdURERUNcXHVEREVGXFx1RERGMFxcdURERjJcXHVEREY0XFx1RERGRl0pfFxcdUQ4M0NcXHVEREY3KD86XFx1RDgzQ1tcXHVEREVBXFx1RERGNFxcdURERjhcXHVEREZBXFx1RERGQ10pfFxcdUQ4M0NcXHVEREU4KD86XFx1RDgzQ1tcXHVEREU2XFx1RERFOFxcdURERTlcXHVEREVCLVxcdURERUVcXHVEREYwLVxcdURERjVcXHVEREY3XFx1RERGQS1cXHVEREZGXSl8KD86XFx1MjZGOXxcXHVEODNDW1xcdURGQ0JcXHVERkNDXXxcXHVEODNEXFx1REQ3NSkoPzpcXHVGRTBGXFx1MjAwRFtcXHUyNjQwXFx1MjY0Ml18KD86XFx1RDgzQ1tcXHVERkZCLVxcdURGRkZdKVxcdTIwMERbXFx1MjY0MFxcdTI2NDJdKVxcdUZFMEZ8KD86XFx1RDgzRFxcdURDNDFcXHVGRTBGXFx1MjAwRFxcdUQ4M0RcXHVEREU4fFxcdUQ4M0RcXHVEQzY5KD86XFx1RDgzQ1tcXHVERkZCLVxcdURGRkZdKVxcdTIwMERbXFx1MjY5NVxcdTI2OTZcXHUyNzA4XXxcXHVEODNEXFx1REM2OVxcdTIwMERbXFx1MjY5NVxcdTI2OTZcXHUyNzA4XXxcXHVEODNEXFx1REM2OCg/Oig/OlxcdUQ4M0NbXFx1REZGQi1cXHVERkZGXSlcXHUyMDBEW1xcdTI2OTVcXHUyNjk2XFx1MjcwOF18XFx1MjAwRFtcXHUyNjk1XFx1MjY5NlxcdTI3MDhdKSlcXHVGRTBGfFxcdUQ4M0NcXHVEREYyKD86XFx1RDgzQ1tcXHVEREU2XFx1RERFOC1cXHVEREVEXFx1RERGMC1cXHVEREZGXSl8XFx1RDgzRFxcdURDNjlcXHUyMDBEKD86XFx1RDgzQ1tcXHVERjNFXFx1REY3M1xcdURGOTNcXHVERkE0XFx1REZBOFxcdURGRUJcXHVERkVEXXxcXHVEODNEW1xcdURDQkJcXHVEQ0JDXFx1REQyN1xcdUREMkNcXHVERTgwXFx1REU5Ml18XFx1Mjc2NFxcdUZFMEZcXHUyMDBEKD86XFx1RDgzRFxcdURDOEJcXHUyMDBEKD86XFx1RDgzRFtcXHVEQzY4XFx1REM2OV0pfFxcdUQ4M0RbXFx1REM2OFxcdURDNjldKSl8XFx1RDgzQ1xcdURERjEoPzpcXHVEODNDW1xcdURERTYtXFx1RERFOFxcdURERUVcXHVEREYwXFx1RERGNy1cXHVEREZCXFx1RERGRV0pfFxcdUQ4M0NcXHVEREVGKD86XFx1RDgzQ1tcXHVEREVBXFx1RERGMlxcdURERjRcXHVEREY1XSl8XFx1RDgzQ1xcdURERUQoPzpcXHVEODNDW1xcdURERjBcXHVEREYyXFx1RERGM1xcdURERjdcXHVEREY5XFx1RERGQV0pfFxcdUQ4M0NcXHVEREVCKD86XFx1RDgzQ1tcXHVEREVFLVxcdURERjBcXHVEREYyXFx1RERGNFxcdURERjddKXxbI1xcKjAtOV1cXHVGRTBGXFx1MjBFM3xcXHVEODNDXFx1RERFNyg/OlxcdUQ4M0NbXFx1RERFNlxcdURERTdcXHVEREU5LVxcdURERUZcXHVEREYxLVxcdURERjRcXHVEREY2LVxcdURERjlcXHVEREZCXFx1RERGQ1xcdURERkVcXHVEREZGXSl8XFx1RDgzQ1xcdURERTYoPzpcXHVEODNDW1xcdURERTgtXFx1RERFQ1xcdURERUVcXHVEREYxXFx1RERGMlxcdURERjRcXHVEREY2LVxcdURERkFcXHVEREZDXFx1RERGRFxcdURERkZdKXxcXHVEODNDXFx1RERGRig/OlxcdUQ4M0NbXFx1RERFNlxcdURERjJcXHVEREZDXSl8XFx1RDgzQ1xcdURERjUoPzpcXHVEODNDW1xcdURERTZcXHVEREVBLVxcdURERURcXHVEREYwLVxcdURERjNcXHVEREY3LVxcdURERjlcXHVEREZDXFx1RERGRV0pfFxcdUQ4M0NcXHVEREZCKD86XFx1RDgzQ1tcXHVEREU2XFx1RERFOFxcdURERUFcXHVEREVDXFx1RERFRVxcdURERjNcXHVEREZBXSl8XFx1RDgzQ1xcdURERjMoPzpcXHVEODNDW1xcdURERTZcXHVEREU4XFx1RERFQS1cXHVEREVDXFx1RERFRVxcdURERjFcXHVEREY0XFx1RERGNVxcdURERjdcXHVEREZBXFx1RERGRl0pfFxcdUQ4M0NcXHVERkY0XFx1REI0MFxcdURDNjdcXHVEQjQwXFx1REM2Mig/OlxcdURCNDBcXHVEQzc3XFx1REI0MFxcdURDNkNcXHVEQjQwXFx1REM3M3xcXHVEQjQwXFx1REM3M1xcdURCNDBcXHVEQzYzXFx1REI0MFxcdURDNzR8XFx1REI0MFxcdURDNjVcXHVEQjQwXFx1REM2RVxcdURCNDBcXHVEQzY3KVxcdURCNDBcXHVEQzdGfFxcdUQ4M0RcXHVEQzY4KD86XFx1MjAwRCg/OlxcdTI3NjRcXHVGRTBGXFx1MjAwRCg/OlxcdUQ4M0RcXHVEQzhCXFx1MjAwRCk/XFx1RDgzRFxcdURDNjh8KD86KD86XFx1RDgzRFtcXHVEQzY4XFx1REM2OV0pXFx1MjAwRCk/XFx1RDgzRFxcdURDNjZcXHUyMDBEXFx1RDgzRFxcdURDNjZ8KD86KD86XFx1RDgzRFtcXHVEQzY4XFx1REM2OV0pXFx1MjAwRCk/XFx1RDgzRFxcdURDNjdcXHUyMDBEKD86XFx1RDgzRFtcXHVEQzY2XFx1REM2N10pfFxcdUQ4M0NbXFx1REYzRVxcdURGNzNcXHVERjkzXFx1REZBNFxcdURGQThcXHVERkVCXFx1REZFRF18XFx1RDgzRFtcXHVEQ0JCXFx1RENCQ1xcdUREMjdcXHVERDJDXFx1REU4MFxcdURFOTJdKXwoPzpcXHVEODNDW1xcdURGRkItXFx1REZGRl0pXFx1MjAwRCg/OlxcdUQ4M0NbXFx1REYzRVxcdURGNzNcXHVERjkzXFx1REZBNFxcdURGQThcXHVERkVCXFx1REZFRF18XFx1RDgzRFtcXHVEQ0JCXFx1RENCQ1xcdUREMjdcXHVERDJDXFx1REU4MFxcdURFOTJdKSl8XFx1RDgzQ1xcdURERjgoPzpcXHVEODNDW1xcdURERTYtXFx1RERFQVxcdURERUMtXFx1RERGNFxcdURERjctXFx1RERGOVxcdURERkJcXHVEREZELVxcdURERkZdKXxcXHVEODNDXFx1RERGMCg/OlxcdUQ4M0NbXFx1RERFQVxcdURERUMtXFx1RERFRVxcdURERjJcXHVEREYzXFx1RERGNVxcdURERjdcXHVEREZDXFx1RERGRVxcdURERkZdKXxcXHVEODNDXFx1RERGRSg/OlxcdUQ4M0NbXFx1RERFQVxcdURERjldKXxcXHVEODNDXFx1RERFRSg/OlxcdUQ4M0NbXFx1RERFOC1cXHVEREVBXFx1RERGMS1cXHVEREY0XFx1RERGNi1cXHVEREY5XSl8XFx1RDgzQ1xcdURERjkoPzpcXHVEODNDW1xcdURERTZcXHVEREU4XFx1RERFOVxcdURERUItXFx1RERFRFxcdURERUYtXFx1RERGNFxcdURERjdcXHVEREY5XFx1RERGQlxcdURERkNcXHVEREZGXSl8XFx1RDgzQ1xcdURERUMoPzpcXHVEODNDW1xcdURERTZcXHVEREU3XFx1RERFOS1cXHVEREVFXFx1RERGMS1cXHVEREYzXFx1RERGNS1cXHVEREZBXFx1RERGQ1xcdURERkVdKXxcXHVEODNDXFx1RERGQSg/OlxcdUQ4M0NbXFx1RERFNlxcdURERUNcXHVEREYyXFx1RERGM1xcdURERjhcXHVEREZFXFx1RERGRl0pfFxcdUQ4M0NcXHVEREVBKD86XFx1RDgzQ1tcXHVEREU2XFx1RERFOFxcdURERUFcXHVEREVDXFx1RERFRFxcdURERjctXFx1RERGQV0pfFxcdUQ4M0NcXHVEREZDKD86XFx1RDgzQ1tcXHVEREVCXFx1RERGOF0pfCg/OlxcdTI2Rjl8XFx1RDgzQ1tcXHVERkNCXFx1REZDQ118XFx1RDgzRFxcdURENzUpKD86XFx1RDgzQ1tcXHVERkZCLVxcdURGRkZdKXwoPzpcXHVEODNDW1xcdURGQzNcXHVERkM0XFx1REZDQV18XFx1RDgzRFtcXHVEQzZFXFx1REM3MVxcdURDNzNcXHVEQzc3XFx1REM4MVxcdURDODJcXHVEQzg2XFx1REM4N1xcdURFNDUtXFx1REU0N1xcdURFNEJcXHVERTREXFx1REU0RVxcdURFQTNcXHVERUI0LVxcdURFQjZdfFxcdUQ4M0VbXFx1REQyNlxcdUREMzctXFx1REQzOVxcdUREM0RcXHVERDNFXFx1RERENi1cXHVEREREXSkoPzpcXHVEODNDW1xcdURGRkItXFx1REZGRl0pfCg/OltcXHUyNjFEXFx1MjcwQS1cXHUyNzBEXXxcXHVEODNDW1xcdURGODVcXHVERkMyXFx1REZDN118XFx1RDgzRFtcXHVEQzQyXFx1REM0M1xcdURDNDYtXFx1REM1MFxcdURDNjZcXHVEQzY3XFx1REM3MFxcdURDNzJcXHVEQzc0LVxcdURDNzZcXHVEQzc4XFx1REM3Q1xcdURDODNcXHVEQzg1XFx1RENBQVxcdURENzRcXHVERDdBXFx1REQ5MFxcdUREOTVcXHVERDk2XFx1REU0Q1xcdURFNEZcXHVERUMwXFx1REVDQ118XFx1RDgzRVtcXHVERDE4LVxcdUREMUNcXHVERDFFXFx1REQxRlxcdUREMzAtXFx1REQzNlxcdURERDEtXFx1RERENV0pKD86XFx1RDgzQ1tcXHVERkZCLVxcdURGRkZdKXxcXHVEODNEXFx1REM2OCg/OlxcdTIwMEQoPzooPzooPzpcXHVEODNEW1xcdURDNjhcXHVEQzY5XSlcXHUyMDBEKT9cXHVEODNEXFx1REM2N3woPzooPzpcXHVEODNEW1xcdURDNjhcXHVEQzY5XSlcXHUyMDBEKT9cXHVEODNEXFx1REM2Nil8XFx1RDgzQ1tcXHVERkZCLVxcdURGRkZdKXwoPzpbXFx1MjYxRFxcdTI2RjlcXHUyNzBBLVxcdTI3MERdfFxcdUQ4M0NbXFx1REY4NVxcdURGQzItXFx1REZDNFxcdURGQzdcXHVERkNBLVxcdURGQ0NdfFxcdUQ4M0RbXFx1REM0MlxcdURDNDNcXHVEQzQ2LVxcdURDNTBcXHVEQzY2LVxcdURDNjlcXHVEQzZFXFx1REM3MC1cXHVEQzc4XFx1REM3Q1xcdURDODEtXFx1REM4M1xcdURDODUtXFx1REM4N1xcdURDQUFcXHVERDc0XFx1REQ3NVxcdUREN0FcXHVERDkwXFx1REQ5NVxcdUREOTZcXHVERTQ1LVxcdURFNDdcXHVERTRCLVxcdURFNEZcXHVERUEzXFx1REVCNC1cXHVERUI2XFx1REVDMFxcdURFQ0NdfFxcdUQ4M0VbXFx1REQxOC1cXHVERDFDXFx1REQxRVxcdUREMUZcXHVERDI2XFx1REQzMC1cXHVERDM5XFx1REQzRFxcdUREM0VcXHVEREQxLVxcdURERERdKSg/OlxcdUQ4M0NbXFx1REZGQi1cXHVERkZGXSk/fCg/OltcXHUyMzFBXFx1MjMxQlxcdTIzRTktXFx1MjNFQ1xcdTIzRjBcXHUyM0YzXFx1MjVGRFxcdTI1RkVcXHUyNjE0XFx1MjYxNVxcdTI2NDgtXFx1MjY1M1xcdTI2N0ZcXHUyNjkzXFx1MjZBMVxcdTI2QUFcXHUyNkFCXFx1MjZCRFxcdTI2QkVcXHUyNkM0XFx1MjZDNVxcdTI2Q0VcXHUyNkQ0XFx1MjZFQVxcdTI2RjJcXHUyNkYzXFx1MjZGNVxcdTI2RkFcXHUyNkZEXFx1MjcwNVxcdTI3MEFcXHUyNzBCXFx1MjcyOFxcdTI3NENcXHUyNzRFXFx1Mjc1My1cXHUyNzU1XFx1Mjc1N1xcdTI3OTUtXFx1Mjc5N1xcdTI3QjBcXHUyN0JGXFx1MkIxQlxcdTJCMUNcXHUyQjUwXFx1MkI1NV18XFx1RDgzQ1tcXHVEQzA0XFx1RENDRlxcdUREOEVcXHVERDkxLVxcdUREOUFcXHVEREU2LVxcdURERkZcXHVERTAxXFx1REUxQVxcdURFMkZcXHVERTMyLVxcdURFMzZcXHVERTM4LVxcdURFM0FcXHVERTUwXFx1REU1MVxcdURGMDAtXFx1REYyMFxcdURGMkQtXFx1REYzNVxcdURGMzctXFx1REY3Q1xcdURGN0UtXFx1REY5M1xcdURGQTAtXFx1REZDQVxcdURGQ0YtXFx1REZEM1xcdURGRTAtXFx1REZGMFxcdURGRjRcXHVERkY4LVxcdURGRkZdfFxcdUQ4M0RbXFx1REMwMC1cXHVEQzNFXFx1REM0MFxcdURDNDItXFx1RENGQ1xcdURDRkYtXFx1REQzRFxcdURENEItXFx1REQ0RVxcdURENTAtXFx1REQ2N1xcdUREN0FcXHVERDk1XFx1REQ5NlxcdUREQTRcXHVEREZCLVxcdURFNEZcXHVERTgwLVxcdURFQzVcXHVERUNDXFx1REVEMC1cXHVERUQyXFx1REVFQlxcdURFRUNcXHVERUY0LVxcdURFRjhdfFxcdUQ4M0VbXFx1REQxMC1cXHVERDNBXFx1REQzQy1cXHVERDNFXFx1REQ0MC1cXHVERDQ1XFx1REQ0Ny1cXHVERDRDXFx1REQ1MC1cXHVERDZCXFx1REQ4MC1cXHVERDk3XFx1RERDMFxcdURERDAtXFx1RERFNl0pfCg/OlsjXFwqMC05XFx4QTlcXHhBRVxcdTIwM0NcXHUyMDQ5XFx1MjEyMlxcdTIxMzlcXHUyMTk0LVxcdTIxOTlcXHUyMUE5XFx1MjFBQVxcdTIzMUFcXHUyMzFCXFx1MjMyOFxcdTIzQ0ZcXHUyM0U5LVxcdTIzRjNcXHUyM0Y4LVxcdTIzRkFcXHUyNEMyXFx1MjVBQVxcdTI1QUJcXHUyNUI2XFx1MjVDMFxcdTI1RkItXFx1MjVGRVxcdTI2MDAtXFx1MjYwNFxcdTI2MEVcXHUyNjExXFx1MjYxNFxcdTI2MTVcXHUyNjE4XFx1MjYxRFxcdTI2MjBcXHUyNjIyXFx1MjYyM1xcdTI2MjZcXHUyNjJBXFx1MjYyRVxcdTI2MkZcXHUyNjM4LVxcdTI2M0FcXHUyNjQwXFx1MjY0MlxcdTI2NDgtXFx1MjY1M1xcdTI2NjBcXHUyNjYzXFx1MjY2NVxcdTI2NjZcXHUyNjY4XFx1MjY3QlxcdTI2N0ZcXHUyNjkyLVxcdTI2OTdcXHUyNjk5XFx1MjY5QlxcdTI2OUNcXHUyNkEwXFx1MjZBMVxcdTI2QUFcXHUyNkFCXFx1MjZCMFxcdTI2QjFcXHUyNkJEXFx1MjZCRVxcdTI2QzRcXHUyNkM1XFx1MjZDOFxcdTI2Q0VcXHUyNkNGXFx1MjZEMVxcdTI2RDNcXHUyNkQ0XFx1MjZFOVxcdTI2RUFcXHUyNkYwLVxcdTI2RjVcXHUyNkY3LVxcdTI2RkFcXHUyNkZEXFx1MjcwMlxcdTI3MDVcXHUyNzA4LVxcdTI3MERcXHUyNzBGXFx1MjcxMlxcdTI3MTRcXHUyNzE2XFx1MjcxRFxcdTI3MjFcXHUyNzI4XFx1MjczM1xcdTI3MzRcXHUyNzQ0XFx1Mjc0N1xcdTI3NENcXHUyNzRFXFx1Mjc1My1cXHUyNzU1XFx1Mjc1N1xcdTI3NjNcXHUyNzY0XFx1Mjc5NS1cXHUyNzk3XFx1MjdBMVxcdTI3QjBcXHUyN0JGXFx1MjkzNFxcdTI5MzVcXHUyQjA1LVxcdTJCMDdcXHUyQjFCXFx1MkIxQ1xcdTJCNTBcXHUyQjU1XFx1MzAzMFxcdTMwM0RcXHUzMjk3XFx1MzI5OV18XFx1RDgzQ1tcXHVEQzA0XFx1RENDRlxcdURENzBcXHVERDcxXFx1REQ3RVxcdUREN0ZcXHVERDhFXFx1REQ5MS1cXHVERDlBXFx1RERFNi1cXHVEREZGXFx1REUwMVxcdURFMDJcXHVERTFBXFx1REUyRlxcdURFMzItXFx1REUzQVxcdURFNTBcXHVERTUxXFx1REYwMC1cXHVERjIxXFx1REYyNC1cXHVERjkzXFx1REY5NlxcdURGOTdcXHVERjk5LVxcdURGOUJcXHVERjlFLVxcdURGRjBcXHVERkYzLVxcdURGRjVcXHVERkY3LVxcdURGRkZdfFxcdUQ4M0RbXFx1REMwMC1cXHVEQ0ZEXFx1RENGRi1cXHVERDNEXFx1REQ0OS1cXHVERDRFXFx1REQ1MC1cXHVERDY3XFx1REQ2RlxcdURENzBcXHVERDczLVxcdUREN0FcXHVERDg3XFx1REQ4QS1cXHVERDhEXFx1REQ5MFxcdUREOTVcXHVERDk2XFx1RERBNFxcdUREQTVcXHVEREE4XFx1RERCMVxcdUREQjJcXHVEREJDXFx1RERDMi1cXHVEREM0XFx1REREMS1cXHVEREQzXFx1REREQy1cXHVERERFXFx1RERFMVxcdURERTNcXHVEREU4XFx1RERFRlxcdURERjNcXHVEREZBLVxcdURFNEZcXHVERTgwLVxcdURFQzVcXHVERUNCLVxcdURFRDJcXHVERUUwLVxcdURFRTVcXHVERUU5XFx1REVFQlxcdURFRUNcXHVERUYwXFx1REVGMy1cXHVERUY4XXxcXHVEODNFW1xcdUREMTAtXFx1REQzQVxcdUREM0MtXFx1REQzRVxcdURENDAtXFx1REQ0NVxcdURENDctXFx1REQ0Q1xcdURENTAtXFx1REQ2QlxcdUREODAtXFx1REQ5N1xcdUREQzBcXHVEREQwLVxcdURERTZdKVxcdUZFMEYpLztcbmV4cG9ydCBmdW5jdGlvbiBnZXRUZXh0KGUpIHtcbiAgdmFyIHR5cGUgPSBlLm5vZGVUeXBlLFxuICAgICAgcmVzdWx0ID0gXCJcIjtcblxuICBpZiAodHlwZSA9PT0gMSB8fCB0eXBlID09PSA5IHx8IHR5cGUgPT09IDExKSB7XG4gICAgaWYgKHR5cGVvZiBlLnRleHRDb250ZW50ID09PSBcInN0cmluZ1wiKSB7XG4gICAgICByZXR1cm4gZS50ZXh0Q29udGVudDtcbiAgICB9IGVsc2Uge1xuICAgICAgZm9yIChlID0gZS5maXJzdENoaWxkOyBlOyBlID0gZS5uZXh0U2libGluZykge1xuICAgICAgICByZXN1bHQgKz0gZ2V0VGV4dChlKTtcbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSBpZiAodHlwZSA9PT0gMyB8fCB0eXBlID09PSA0KSB7XG4gICAgcmV0dXJuIGUubm9kZVZhbHVlO1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn1cbmV4cG9ydCBmdW5jdGlvbiBzcGxpdElubmVySFRNTChlbGVtZW50LCBkZWxpbWl0ZXIsIHRyaW0pIHtcbiAgdmFyIG5vZGUgPSBlbGVtZW50LmZpcnN0Q2hpbGQsXG4gICAgICByZXN1bHQgPSBbXTtcblxuICB3aGlsZSAobm9kZSkge1xuICAgIGlmIChub2RlLm5vZGVUeXBlID09PSAzKSB7XG4gICAgICByZXN1bHQucHVzaC5hcHBseShyZXN1bHQsIGVtb2ppU2FmZVNwbGl0KChub2RlLm5vZGVWYWx1ZSArIFwiXCIpLnJlcGxhY2UoL15cXG4rL2csIFwiXCIpLnJlcGxhY2UoL1xccysvZywgXCIgXCIpLCBkZWxpbWl0ZXIsIHRyaW0pKTtcbiAgICB9IGVsc2UgaWYgKChub2RlLm5vZGVOYW1lICsgXCJcIikudG9Mb3dlckNhc2UoKSA9PT0gXCJiclwiKSB7XG4gICAgICByZXN1bHRbcmVzdWx0Lmxlbmd0aCAtIDFdICs9IFwiPGJyPlwiO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHQucHVzaChub2RlLm91dGVySFRNTCk7XG4gICAgfVxuXG4gICAgbm9kZSA9IG5vZGUubmV4dFNpYmxpbmc7XG4gIH1cblxuICByZXR1cm4gcmVzdWx0O1xufVxuLypcbi8vc21hbGxlciBrYiB2ZXJzaW9uIHRoYXQgb25seSBoYW5kbGVzIHRoZSBzaW1wbGVyIGVtb2ppJ3MsIHdoaWNoIGlzIG9mdGVuIHBlcmZlY3RseSBhZGVxdWF0ZS5cblxubGV0IF9lbW9qaSA9IFwiW1xcdUUwMDAtXFx1RjhGRl18XFx1RDgzQ1tcXHVEQzAwLVxcdURGRkZdfFxcdUQ4M0RbXFx1REMwMC1cXHVERkZGXXxbXFx1MjY5NC1cXHUyNjk3XXxcXHVEODNFW1xcdUREMTAtXFx1REQ1RF18W1xcdUQ4MDAtXFx1REJGRl1bXFx1REMwMC1cXHVERkZGXVwiLFxuXHRfZW1vamlFeHAgPSBuZXcgUmVnRXhwKF9lbW9qaSksXG5cdF9lbW9qaUFuZENoYXJzRXhwID0gbmV3IFJlZ0V4cChfZW1vamkgKyBcInwuXCIsIFwiZ1wiKSxcblx0X2Vtb2ppU2FmZVNwbGl0ID0gKHRleHQsIGRlbGltaXRlciwgdHJpbSkgPT4ge1xuXHRcdGlmICh0cmltKSB7XG5cdFx0XHR0ZXh0ID0gdGV4dC5yZXBsYWNlKF90cmltRXhwLCBcIlwiKTtcblx0XHR9XG5cdFx0cmV0dXJuICgoZGVsaW1pdGVyID09PSBcIlwiIHx8ICFkZWxpbWl0ZXIpICYmIF9lbW9qaUV4cC50ZXN0KHRleHQpKSA/IHRleHQubWF0Y2goX2Vtb2ppQW5kQ2hhcnNFeHApIDogdGV4dC5zcGxpdChkZWxpbWl0ZXIgfHwgXCJcIik7XG5cdH07XG4gKi9cblxuZXhwb3J0IGZ1bmN0aW9uIGVtb2ppU2FmZVNwbGl0KHRleHQsIGRlbGltaXRlciwgdHJpbSkge1xuICB0ZXh0ICs9IFwiXCI7IC8vIG1ha2Ugc3VyZSBpdCdzIGNhc3QgYXMgYSBzdHJpbmcuIFNvbWVvbmUgbWF5IHBhc3MgaW4gYSBudW1iZXIuXG5cbiAgaWYgKHRyaW0pIHtcbiAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKF90cmltRXhwLCBcIlwiKTtcbiAgfVxuXG4gIGlmIChkZWxpbWl0ZXIgJiYgZGVsaW1pdGVyICE9PSBcIlwiKSB7XG4gICAgcmV0dXJuIHRleHQucmVwbGFjZSgvPi9nLCBcIiZndDtcIikucmVwbGFjZSgvPC9nLCBcIiZsdDtcIikuc3BsaXQoZGVsaW1pdGVyKTtcbiAgfVxuXG4gIHZhciByZXN1bHQgPSBbXSxcbiAgICAgIGwgPSB0ZXh0Lmxlbmd0aCxcbiAgICAgIGkgPSAwLFxuICAgICAgaixcbiAgICAgIGNoYXJhY3RlcjtcblxuICBmb3IgKDsgaSA8IGw7IGkrKykge1xuICAgIGNoYXJhY3RlciA9IHRleHQuY2hhckF0KGkpO1xuXG4gICAgaWYgKGNoYXJhY3Rlci5jaGFyQ29kZUF0KDApID49IDB4RDgwMCAmJiBjaGFyYWN0ZXIuY2hhckNvZGVBdCgwKSA8PSAweERCRkYgfHwgdGV4dC5jaGFyQ29kZUF0KGkgKyAxKSA+PSAweEZFMDAgJiYgdGV4dC5jaGFyQ29kZUF0KGkgKyAxKSA8PSAweEZFMEYpIHtcbiAgICAgIC8vc3BlY2lhbCBlbW9qaSBjaGFyYWN0ZXJzIHVzZSAyIG9yIDQgdW5pY29kZSBjaGFyYWN0ZXJzIHRoYXQgd2UgbXVzdCBrZWVwIHRvZ2V0aGVyLlxuICAgICAgaiA9ICgodGV4dC5zdWJzdHIoaSwgMTIpLnNwbGl0KGVtb2ppRXhwKSB8fCBbXSlbMV0gfHwgXCJcIikubGVuZ3RoIHx8IDI7XG4gICAgICBjaGFyYWN0ZXIgPSB0ZXh0LnN1YnN0cihpLCBqKTtcbiAgICAgIHJlc3VsdC5lbW9qaSA9IDE7XG4gICAgICBpICs9IGogLSAxO1xuICAgIH1cblxuICAgIHJlc3VsdC5wdXNoKGNoYXJhY3RlciA9PT0gXCI+XCIgPyBcIiZndDtcIiA6IGNoYXJhY3RlciA9PT0gXCI8XCIgPyBcIiZsdDtcIiA6IGNoYXJhY3Rlcik7XG4gIH1cblxuICByZXR1cm4gcmVzdWx0O1xufSIsImZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IFwiQGJhYmVsL2hlbHBlcnMgLSB0eXBlb2ZcIjsgaWYgKHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiKSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfTsgfSBlbHNlIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH1cblxuLyohXG4gKiBTcGxpdFRleHQ6IDMuMi42XG4gKiBodHRwczovL2dyZWVuc29jay5jb21cbiAqXG4gKiBAbGljZW5zZSBDb3B5cmlnaHQgMjAwOC0yMDIwLCBHcmVlblNvY2suIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiBTdWJqZWN0IHRvIHRoZSB0ZXJtcyBhdCBodHRwczovL2dyZWVuc29jay5jb20vc3RhbmRhcmQtbGljZW5zZSBvciBmb3JcbiAqIENsdWIgR3JlZW5Tb2NrIG1lbWJlcnMsIHRoZSBhZ3JlZW1lbnQgaXNzdWVkIHdpdGggdGhhdCBtZW1iZXJzaGlwLlxuICogQGF1dGhvcjogSmFjayBEb3lsZSwgamFja0BncmVlbnNvY2suY29tXG4qL1xuXG4vKiBlc2xpbnQtZGlzYWJsZSAqL1xuaW1wb3J0IHsgZW1vamlFeHAsIGdldFRleHQgfSBmcm9tIFwiLi4vdXRpbHMvc3RyaW5ncy5qc1wiO1xuXG52YXIgX2RvYyxcbiAgICBfd2luLFxuICAgIF9jb3JlSW5pdHRlZCxcbiAgICBfc3RyaXBFeHAgPSAvKD86XFxyfFxcbnxcXHRcXHQpL2csXG4gICAgLy9maW5kIGNhcnJpYWdlIHJldHVybnMsIG5ldyBsaW5lIGZlZWRzIGFuZCBkb3VibGUtdGFicy5cbl9tdWx0aXBsZVNwYWNlc0V4cCA9IC8oPzpcXHNcXHMrKS9nLFxuICAgIF9pbml0Q29yZSA9IGZ1bmN0aW9uIF9pbml0Q29yZSgpIHtcbiAgX2RvYyA9IGRvY3VtZW50O1xuICBfd2luID0gd2luZG93O1xuICBfY29yZUluaXR0ZWQgPSAxO1xufSxcbiAgICBfYm9udXNWYWxpZGF0ZWQgPSAxLFxuICAgIC8vPG5hbWU+U3BsaXRUZXh0PC9uYW1lPlxuX2dldENvbXB1dGVkU3R5bGUgPSBmdW5jdGlvbiBfZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KSB7XG4gIHJldHVybiBfd2luLmdldENvbXB1dGVkU3R5bGUoZWxlbWVudCk7XG59LFxuICAgIF9pc0FycmF5ID0gQXJyYXkuaXNBcnJheSxcbiAgICBfc2xpY2UgPSBbXS5zbGljZSxcbiAgICBfdG9BcnJheSA9IGZ1bmN0aW9uIF90b0FycmF5KHZhbHVlLCBsZWF2ZVN0cmluZ3MpIHtcbiAgLy90YWtlcyBhbnkgdmFsdWUgYW5kIHJldHVybnMgYW4gYXJyYXkuIElmIGl0J3MgYSBzdHJpbmcgKGFuZCBsZWF2ZVN0cmluZ3MgaXNuJ3QgdHJ1ZSksIGl0J2xsIHVzZSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCkgYW5kIGNvbnZlcnQgdGhhdCB0byBhbiBhcnJheS4gSXQnbGwgYWxzbyBhY2NlcHQgaXRlcmFibGVzIGxpa2UgalF1ZXJ5IG9iamVjdHMuXG4gIHZhciB0eXBlO1xuICByZXR1cm4gX2lzQXJyYXkodmFsdWUpID8gdmFsdWUgOiAodHlwZSA9IF90eXBlb2YodmFsdWUpKSA9PT0gXCJzdHJpbmdcIiAmJiAhbGVhdmVTdHJpbmdzICYmIHZhbHVlID8gX3NsaWNlLmNhbGwoX2RvYy5xdWVyeVNlbGVjdG9yQWxsKHZhbHVlKSwgMCkgOiB2YWx1ZSAmJiB0eXBlID09PSBcIm9iamVjdFwiICYmIFwibGVuZ3RoXCIgaW4gdmFsdWUgPyBfc2xpY2UuY2FsbCh2YWx1ZSwgMCkgOiB2YWx1ZSA/IFt2YWx1ZV0gOiBbXTtcbn0sXG4gICAgX2lzQWJzb2x1dGUgPSBmdW5jdGlvbiBfaXNBYnNvbHV0ZSh2YXJzKSB7XG4gIHJldHVybiB2YXJzLnBvc2l0aW9uID09PSBcImFic29sdXRlXCIgfHwgdmFycy5hYnNvbHV0ZSA9PT0gdHJ1ZTtcbn0sXG4gICAgLy9zb21lIGNoYXJhY3RlcnMgYXJlIGNvbWJpbmluZyBtYXJrcyAodGhpbmsgZGlhY3JpdGljcy9hY2NlbnRzIGluIEV1cm9wZWFuIGxhbmd1YWdlcykgd2hpY2ggaW52b2x2ZSAyIG9yIDQgY2hhcmFjdGVycyB0aGF0IGNvbWJpbmUgaW4gdGhlIGJyb3dzZXIgdG8gZm9ybSBhIHNpbmdsZSBjaGFyYWN0ZXIuIFBhc3MgaW4gdGhlIHJlbWFpbmluZyB0ZXh0IGFuZCBhbiBhcnJheSBvZiB0aGUgc3BlY2lhbCBjaGFyYWN0ZXJzIHRvIHNlYXJjaCBmb3IgYW5kIGlmIHRoZSB0ZXh0IHN0YXJ0cyB3aXRoIG9uZSBvZiB0aG9zZSBzcGVjaWFsIGNoYXJhY3RlcnMsIGl0J2xsIHNwaXQgYmFjayB0aGUgbnVtYmVyIG9mIGNoYXJhY3RlcnMgdG8gcmV0YWluIChvZnRlbiAyIG9yIDQpLiBVc2VkIGluIHRoZSBzcGVjaWFsQ2hhcnMgZmVhdHVyZXMgdGhhdCB3YXMgaW50cm9kdWNlZCBpbiAwLjYuMC5cbl9maW5kU3BlY2lhbENoYXJzID0gZnVuY3Rpb24gX2ZpbmRTcGVjaWFsQ2hhcnModGV4dCwgY2hhcnMpIHtcbiAgdmFyIGkgPSBjaGFycy5sZW5ndGgsXG4gICAgICBzO1xuXG4gIHdoaWxlICgtLWkgPiAtMSkge1xuICAgIHMgPSBjaGFyc1tpXTtcblxuICAgIGlmICh0ZXh0LnN1YnN0cigwLCBzLmxlbmd0aCkgPT09IHMpIHtcbiAgICAgIHJldHVybiBzLmxlbmd0aDtcbiAgICB9XG4gIH1cbn0sXG4gICAgX2RpdlN0YXJ0ID0gXCIgc3R5bGU9J3Bvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6aW5saW5lLWJsb2NrOydcIixcbiAgICBfY3NzQ2xhc3NGdW5jID0gZnVuY3Rpb24gX2Nzc0NsYXNzRnVuYyhjc3NDbGFzcywgdGFnKSB7XG4gIGlmIChjc3NDbGFzcyA9PT0gdm9pZCAwKSB7XG4gICAgY3NzQ2xhc3MgPSBcIlwiO1xuICB9XG5cbiAgdmFyIGl0ZXJhdGUgPSB+Y3NzQ2xhc3MuaW5kZXhPZihcIisrXCIpLFxuICAgICAgbnVtID0gMTtcblxuICBpZiAoaXRlcmF0ZSkge1xuICAgIGNzc0NsYXNzID0gY3NzQ2xhc3Muc3BsaXQoXCIrK1wiKS5qb2luKFwiXCIpO1xuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gXCI8XCIgKyB0YWcgKyBfZGl2U3RhcnQgKyAoY3NzQ2xhc3MgPyBcIiBjbGFzcz0nXCIgKyBjc3NDbGFzcyArIChpdGVyYXRlID8gbnVtKysgOiBcIlwiKSArIFwiJz5cIiA6IFwiPlwiKTtcbiAgfTtcbn0sXG4gICAgX3N3YXBUZXh0ID0gZnVuY3Rpb24gX3N3YXBUZXh0KGVsZW1lbnQsIG9sZFRleHQsIG5ld1RleHQpIHtcbiAgdmFyIHR5cGUgPSBlbGVtZW50Lm5vZGVUeXBlO1xuXG4gIGlmICh0eXBlID09PSAxIHx8IHR5cGUgPT09IDkgfHwgdHlwZSA9PT0gMTEpIHtcbiAgICBmb3IgKGVsZW1lbnQgPSBlbGVtZW50LmZpcnN0Q2hpbGQ7IGVsZW1lbnQ7IGVsZW1lbnQgPSBlbGVtZW50Lm5leHRTaWJsaW5nKSB7XG4gICAgICBfc3dhcFRleHQoZWxlbWVudCwgb2xkVGV4dCwgbmV3VGV4dCk7XG4gICAgfVxuICB9IGVsc2UgaWYgKHR5cGUgPT09IDMgfHwgdHlwZSA9PT0gNCkge1xuICAgIGVsZW1lbnQubm9kZVZhbHVlID0gZWxlbWVudC5ub2RlVmFsdWUuc3BsaXQob2xkVGV4dCkuam9pbihuZXdUZXh0KTtcbiAgfVxufSxcbiAgICBfcHVzaFJldmVyc2VkID0gZnVuY3Rpb24gX3B1c2hSZXZlcnNlZChhLCBtZXJnZSkge1xuICB2YXIgaSA9IG1lcmdlLmxlbmd0aDtcblxuICB3aGlsZSAoLS1pID4gLTEpIHtcbiAgICBhLnB1c2gobWVyZ2VbaV0pO1xuICB9XG59LFxuICAgIF9pc0JlZm9yZVdvcmREZWxpbWl0ZXIgPSBmdW5jdGlvbiBfaXNCZWZvcmVXb3JkRGVsaW1pdGVyKGUsIHJvb3QsIHdvcmREZWxpbWl0ZXIpIHtcbiAgdmFyIG5leHQ7XG5cbiAgd2hpbGUgKGUgJiYgZSAhPT0gcm9vdCkge1xuICAgIG5leHQgPSBlLl9uZXh0IHx8IGUubmV4dFNpYmxpbmc7XG5cbiAgICBpZiAobmV4dCkge1xuICAgICAgcmV0dXJuIG5leHQudGV4dENvbnRlbnQuY2hhckF0KDApID09PSB3b3JkRGVsaW1pdGVyO1xuICAgIH1cblxuICAgIGUgPSBlLnBhcmVudE5vZGUgfHwgZS5fcGFyZW50O1xuICB9XG59LFxuICAgIF9kZVdvcmRpZnkgPSBmdW5jdGlvbiBfZGVXb3JkaWZ5KGUpIHtcbiAgdmFyIGNoaWxkcmVuID0gX3RvQXJyYXkoZS5jaGlsZE5vZGVzKSxcbiAgICAgIGwgPSBjaGlsZHJlbi5sZW5ndGgsXG4gICAgICBpLFxuICAgICAgY2hpbGQ7XG5cbiAgZm9yIChpID0gMDsgaSA8IGw7IGkrKykge1xuICAgIGNoaWxkID0gY2hpbGRyZW5baV07XG5cbiAgICBpZiAoY2hpbGQuX2lzU3BsaXQpIHtcbiAgICAgIF9kZVdvcmRpZnkoY2hpbGQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoaSAmJiBjaGlsZC5wcmV2aW91c1NpYmxpbmcubm9kZVR5cGUgPT09IDMpIHtcbiAgICAgICAgY2hpbGQucHJldmlvdXNTaWJsaW5nLm5vZGVWYWx1ZSArPSBjaGlsZC5ub2RlVHlwZSA9PT0gMyA/IGNoaWxkLm5vZGVWYWx1ZSA6IGNoaWxkLmZpcnN0Q2hpbGQubm9kZVZhbHVlO1xuICAgICAgfSBlbHNlIGlmIChjaGlsZC5ub2RlVHlwZSAhPT0gMykge1xuICAgICAgICBlLmluc2VydEJlZm9yZShjaGlsZC5maXJzdENoaWxkLCBjaGlsZCk7XG4gICAgICB9XG5cbiAgICAgIGUucmVtb3ZlQ2hpbGQoY2hpbGQpO1xuICAgIH1cbiAgfVxufSxcbiAgICBfZ2V0U3R5bGVBc051bWJlciA9IGZ1bmN0aW9uIF9nZXRTdHlsZUFzTnVtYmVyKG5hbWUsIGNvbXB1dGVkU3R5bGUpIHtcbiAgcmV0dXJuIHBhcnNlRmxvYXQoY29tcHV0ZWRTdHlsZVtuYW1lXSkgfHwgMDtcbn0sXG4gICAgX3NldFBvc2l0aW9uc0FmdGVyU3BsaXQgPSBmdW5jdGlvbiBfc2V0UG9zaXRpb25zQWZ0ZXJTcGxpdChlbGVtZW50LCB2YXJzLCBhbGxDaGFycywgYWxsV29yZHMsIGFsbExpbmVzLCBvcmlnV2lkdGgsIG9yaWdIZWlnaHQpIHtcbiAgdmFyIGNzID0gX2dldENvbXB1dGVkU3R5bGUoZWxlbWVudCksXG4gICAgICBwYWRkaW5nTGVmdCA9IF9nZXRTdHlsZUFzTnVtYmVyKFwicGFkZGluZ0xlZnRcIiwgY3MpLFxuICAgICAgbGluZU9mZnNldFkgPSAtOTk5LFxuICAgICAgYm9yZGVyVG9wQW5kQm90dG9tID0gX2dldFN0eWxlQXNOdW1iZXIoXCJib3JkZXJCb3R0b21XaWR0aFwiLCBjcykgKyBfZ2V0U3R5bGVBc051bWJlcihcImJvcmRlclRvcFdpZHRoXCIsIGNzKSxcbiAgICAgIGJvcmRlckxlZnRBbmRSaWdodCA9IF9nZXRTdHlsZUFzTnVtYmVyKFwiYm9yZGVyTGVmdFdpZHRoXCIsIGNzKSArIF9nZXRTdHlsZUFzTnVtYmVyKFwiYm9yZGVyUmlnaHRXaWR0aFwiLCBjcyksXG4gICAgICBwYWRUb3BBbmRCb3R0b20gPSBfZ2V0U3R5bGVBc051bWJlcihcInBhZGRpbmdUb3BcIiwgY3MpICsgX2dldFN0eWxlQXNOdW1iZXIoXCJwYWRkaW5nQm90dG9tXCIsIGNzKSxcbiAgICAgIHBhZExlZnRBbmRSaWdodCA9IF9nZXRTdHlsZUFzTnVtYmVyKFwicGFkZGluZ0xlZnRcIiwgY3MpICsgX2dldFN0eWxlQXNOdW1iZXIoXCJwYWRkaW5nUmlnaHRcIiwgY3MpLFxuICAgICAgbGluZVRocmVzaG9sZCA9IF9nZXRTdHlsZUFzTnVtYmVyKFwiZm9udFNpemVcIiwgY3MpICogMC4yLFxuICAgICAgdGV4dEFsaWduID0gY3MudGV4dEFsaWduLFxuICAgICAgY2hhckFycmF5ID0gW10sXG4gICAgICB3b3JkQXJyYXkgPSBbXSxcbiAgICAgIGxpbmVBcnJheSA9IFtdLFxuICAgICAgd29yZERlbGltaXRlciA9IHZhcnMud29yZERlbGltaXRlciB8fCBcIiBcIixcbiAgICAgIHRhZyA9IHZhcnMudGFnID8gdmFycy50YWcgOiB2YXJzLnNwYW4gPyBcInNwYW5cIiA6IFwiZGl2XCIsXG4gICAgICB0eXBlcyA9IHZhcnMudHlwZSB8fCB2YXJzLnNwbGl0IHx8IFwiY2hhcnMsd29yZHMsbGluZXNcIixcbiAgICAgIGxpbmVzID0gYWxsTGluZXMgJiYgfnR5cGVzLmluZGV4T2YoXCJsaW5lc1wiKSA/IFtdIDogbnVsbCxcbiAgICAgIHdvcmRzID0gfnR5cGVzLmluZGV4T2YoXCJ3b3Jkc1wiKSxcbiAgICAgIGNoYXJzID0gfnR5cGVzLmluZGV4T2YoXCJjaGFyc1wiKSxcbiAgICAgIGFic29sdXRlID0gX2lzQWJzb2x1dGUodmFycyksXG4gICAgICBsaW5lc0NsYXNzID0gdmFycy5saW5lc0NsYXNzLFxuICAgICAgaXRlcmF0ZUxpbmUgPSB+KGxpbmVzQ2xhc3MgfHwgXCJcIikuaW5kZXhPZihcIisrXCIpLFxuICAgICAgc3BhY2VOb2Rlc1RvUmVtb3ZlID0gW10sXG4gICAgICBpLFxuICAgICAgaixcbiAgICAgIGwsXG4gICAgICBub2RlLFxuICAgICAgbm9kZXMsXG4gICAgICBpc0NoaWxkLFxuICAgICAgY3VyTGluZSxcbiAgICAgIGFkZFdvcmRTcGFjZXMsXG4gICAgICBzdHlsZSxcbiAgICAgIGxpbmVOb2RlLFxuICAgICAgbGluZVdpZHRoLFxuICAgICAgb2Zmc2V0O1xuXG4gIGlmIChpdGVyYXRlTGluZSkge1xuICAgIGxpbmVzQ2xhc3MgPSBsaW5lc0NsYXNzLnNwbGl0KFwiKytcIikuam9pbihcIlwiKTtcbiAgfSAvL2NvcHkgYWxsIHRoZSBkZXNjZW5kYW50IG5vZGVzIGludG8gYW4gYXJyYXkgKHdlIGNhbid0IHVzZSBhIHJlZ3VsYXIgbm9kZUxpc3QgYmVjYXVzZSBpdCdzIGxpdmUgYW5kIHdlIG1heSBuZWVkIHRvIHJlbmVzdCB0aGluZ3MpXG5cblxuICBqID0gZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcIipcIik7XG4gIGwgPSBqLmxlbmd0aDtcbiAgbm9kZXMgPSBbXTtcblxuICBmb3IgKGkgPSAwOyBpIDwgbDsgaSsrKSB7XG4gICAgbm9kZXNbaV0gPSBqW2ldO1xuICB9IC8vZm9yIGFic29sdXRlIHBvc2l0aW9uaW5nLCB3ZSBuZWVkIHRvIHJlY29yZCB0aGUgeC95IG9mZnNldHMgYW5kIHdpZHRoL2hlaWdodCBmb3IgZXZlcnkgPGRpdj4uIEFuZCBldmVuIGlmIHdlJ3JlIG5vdCBwb3NpdGlvbmluZyB0aGluZ3MgYWJzb2x1dGVseSwgaW4gb3JkZXIgdG8gYWNjb21tb2RhdGUgbGluZXMsIHdlIG11c3QgZmlndXJlIG91dCB3aGVyZSB0aGUgeSBvZmZzZXQgY2hhbmdlcyBzbyB0aGF0IHdlIGNhbiBzZW5zZSB3aGVyZSB0aGUgbGluZXMgYnJlYWssIGFuZCB3ZSBwb3B1bGF0ZSB0aGUgbGluZXMgYXJyYXkuXG5cblxuICBpZiAobGluZXMgfHwgYWJzb2x1dGUpIHtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbDsgaSsrKSB7XG4gICAgICBub2RlID0gbm9kZXNbaV07XG4gICAgICBpc0NoaWxkID0gbm9kZS5wYXJlbnROb2RlID09PSBlbGVtZW50O1xuXG4gICAgICBpZiAoaXNDaGlsZCB8fCBhYnNvbHV0ZSB8fCBjaGFycyAmJiAhd29yZHMpIHtcbiAgICAgICAgb2Zmc2V0ID0gbm9kZS5vZmZzZXRUb3A7XG5cbiAgICAgICAgaWYgKGxpbmVzICYmIGlzQ2hpbGQgJiYgTWF0aC5hYnMob2Zmc2V0IC0gbGluZU9mZnNldFkpID4gbGluZVRocmVzaG9sZCAmJiAobm9kZS5ub2RlTmFtZSAhPT0gXCJCUlwiIHx8IGkgPT09IDApKSB7XG4gICAgICAgICAgLy93ZSBmb3VuZCBzb21lIHJhcmUgb2NjYXNpb25zIHdoZXJlIGEgY2VydGFpbiBjaGFyYWN0ZXIgbGlrZSAmIzgyMDk7IGNvdWxkIGNhdXNlIHRoZSBvZmZzZXRUb3AgdG8gYmUgb2ZmIGJ5IDEgcGl4ZWwsIHNvIHdlIGJ1aWxkIGluIGEgdGhyZXNob2xkLlxuICAgICAgICAgIGN1ckxpbmUgPSBbXTtcbiAgICAgICAgICBsaW5lcy5wdXNoKGN1ckxpbmUpO1xuICAgICAgICAgIGxpbmVPZmZzZXRZID0gb2Zmc2V0O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGFic29sdXRlKSB7XG4gICAgICAgICAgLy9yZWNvcmQgb2Zmc2V0IHggYW5kIHksIGFzIHdlbGwgYXMgd2lkdGggYW5kIGhlaWdodCBzbyB0aGF0IHdlIGNhbiBhY2Nlc3MgdGhlbSBsYXRlciBmb3IgcG9zaXRpb25pbmcuIEdyYWJiaW5nIHRoZW0gYXQgb25jZSBlbnN1cmVzIHdlIGRvbid0IHRyaWdnZXIgYSBicm93c2VyIHBhaW50ICYgd2UgbWF4aW1pemUgcGVyZm9ybWFuY2UuXG4gICAgICAgICAgbm9kZS5feCA9IG5vZGUub2Zmc2V0TGVmdDtcbiAgICAgICAgICBub2RlLl95ID0gb2Zmc2V0O1xuICAgICAgICAgIG5vZGUuX3cgPSBub2RlLm9mZnNldFdpZHRoO1xuICAgICAgICAgIG5vZGUuX2ggPSBub2RlLm9mZnNldEhlaWdodDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChsaW5lcykge1xuICAgICAgICAgIGlmIChub2RlLl9pc1NwbGl0ICYmIGlzQ2hpbGQgfHwgIWNoYXJzICYmIGlzQ2hpbGQgfHwgd29yZHMgJiYgaXNDaGlsZCB8fCAhd29yZHMgJiYgbm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUgPT09IGVsZW1lbnQgJiYgIW5vZGUucGFyZW50Tm9kZS5faXNTcGxpdCkge1xuICAgICAgICAgICAgY3VyTGluZS5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgbm9kZS5feCAtPSBwYWRkaW5nTGVmdDtcblxuICAgICAgICAgICAgaWYgKF9pc0JlZm9yZVdvcmREZWxpbWl0ZXIobm9kZSwgZWxlbWVudCwgd29yZERlbGltaXRlcikpIHtcbiAgICAgICAgICAgICAgbm9kZS5fd29yZEVuZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKG5vZGUubm9kZU5hbWUgPT09IFwiQlJcIiAmJiAobm9kZS5uZXh0U2libGluZyAmJiBub2RlLm5leHRTaWJsaW5nLm5vZGVOYW1lID09PSBcIkJSXCIgfHwgaSA9PT0gMCkpIHtcbiAgICAgICAgICAgIC8vdHdvIGNvbnNlY3V0aXZlIDxicj4gdGFncyBzaWduaWZ5IGEgbmV3IFtlbXB0eV0gbGluZS4gQWxzbywgaWYgdGhlIGVudGlyZSBibG9jayBvZiBjb250ZW50IFNUQVJUUyB3aXRoIGEgPGJyPiwgYWRkIGEgbGluZS5cbiAgICAgICAgICAgIGxpbmVzLnB1c2goW10pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZvciAoaSA9IDA7IGkgPCBsOyBpKyspIHtcbiAgICBub2RlID0gbm9kZXNbaV07XG4gICAgaXNDaGlsZCA9IG5vZGUucGFyZW50Tm9kZSA9PT0gZWxlbWVudDtcblxuICAgIGlmIChub2RlLm5vZGVOYW1lID09PSBcIkJSXCIpIHtcbiAgICAgIGlmIChsaW5lcyB8fCBhYnNvbHV0ZSkge1xuICAgICAgICBpZiAobm9kZS5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgbm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG5vZGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgbm9kZXMuc3BsaWNlKGktLSwgMSk7XG4gICAgICAgIGwtLTtcbiAgICAgIH0gZWxzZSBpZiAoIXdvcmRzKSB7XG4gICAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQobm9kZSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGlmIChhYnNvbHV0ZSkge1xuICAgICAgc3R5bGUgPSBub2RlLnN0eWxlO1xuXG4gICAgICBpZiAoIXdvcmRzICYmICFpc0NoaWxkKSB7XG4gICAgICAgIG5vZGUuX3ggKz0gbm9kZS5wYXJlbnROb2RlLl94O1xuICAgICAgICBub2RlLl95ICs9IG5vZGUucGFyZW50Tm9kZS5feTtcbiAgICAgIH1cblxuICAgICAgc3R5bGUubGVmdCA9IG5vZGUuX3ggKyBcInB4XCI7XG4gICAgICBzdHlsZS50b3AgPSBub2RlLl95ICsgXCJweFwiO1xuICAgICAgc3R5bGUucG9zaXRpb24gPSBcImFic29sdXRlXCI7XG4gICAgICBzdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiOyAvL2lmIHdlIGRvbid0IHNldCB0aGUgd2lkdGgvaGVpZ2h0LCB0aGluZ3MgY29sbGFwc2UgaW4gb2xkZXIgdmVyc2lvbnMgb2YgSUUgYW5kIHRoZSBvcmlnaW4gZm9yIHRyYW5zZm9ybXMgaXMgdGhyb3duIG9mZiBpbiBhbGwgYnJvd3NlcnMuXG5cbiAgICAgIHN0eWxlLndpZHRoID0gbm9kZS5fdyArIDEgKyBcInB4XCI7IC8vSUUgaXMgMXB4IHNob3J0IHNvbWV0aW1lcy4gQXZvaWQgd3JhcHBpbmdcblxuICAgICAgc3R5bGUuaGVpZ2h0ID0gbm9kZS5faCArIFwicHhcIjtcbiAgICB9XG5cbiAgICBpZiAoIXdvcmRzICYmIGNoYXJzKSB7XG4gICAgICAvL3dlIGFsd2F5cyBzdGFydCBvdXQgd3JhcHBpbmcgd29yZHMgaW4gdGhlaXIgb3duIDxkaXY+IHNvIHRoYXQgbGluZSBicmVha3MgaGFwcGVuIGNvcnJlY3RseSwgYnV0IGhlcmUgd2UnbGwgcmVtb3ZlIHRob3NlIDxkaXY+IHRhZ3MgaWYgbmVjZXNzYXJ5IGFuZCByZW5lc3QgdGhlIGNoYXJhY3RlcnMgZGlyZWN0bHkgaW50byB0aGUgZWxlbWVudCByYXRoZXIgdGhhbiBpbnNpZGUgdGhlIHdvcmQgPGRpdj5cbiAgICAgIGlmIChub2RlLl9pc1NwbGl0KSB7XG4gICAgICAgIG5vZGUuX25leHQgPSBub2RlLm5leHRTaWJsaW5nO1xuICAgICAgICBub2RlLnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQobm9kZSk7IC8vcHV0IGl0IGF0IHRoZSBlbmQgdG8ga2VlcCB0aGUgb3JkZXIgY29ycmVjdC5cbiAgICAgIH0gZWxzZSBpZiAobm9kZS5wYXJlbnROb2RlLl9pc1NwbGl0KSB7XG4gICAgICAgIG5vZGUuX3BhcmVudCA9IG5vZGUucGFyZW50Tm9kZTtcblxuICAgICAgICBpZiAoIW5vZGUucHJldmlvdXNTaWJsaW5nICYmIG5vZGUuZmlyc3RDaGlsZCkge1xuICAgICAgICAgIG5vZGUuZmlyc3RDaGlsZC5faXNGaXJzdCA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobm9kZS5uZXh0U2libGluZyAmJiBub2RlLm5leHRTaWJsaW5nLnRleHRDb250ZW50ID09PSBcIiBcIiAmJiAhbm9kZS5uZXh0U2libGluZy5uZXh0U2libGluZykge1xuICAgICAgICAgIC8vaWYgdGhlIGxhc3Qgbm9kZSBpbnNpZGUgYSBuZXN0ZWQgZWxlbWVudCBpcyBqdXN0IGEgc3BhY2UgKGxpa2UgVDxzcGFuPm5lc3RlZCA8L3NwYW4+KSwgcmVtb3ZlIGl0IG90aGVyd2lzZSBpdCdsbCBnZXQgcGxhY2VkIGluIHRoZSB3cm9uZyBvcmRlci4gRG9uJ3QgcmVtb3ZlIGl0IHJpZ2h0IGF3YXksIHRob3VnaCwgYmVjYXVzZSB3ZSBuZWVkIHRvIHNlbnNlIHdoZW4gd29yZHMvY2hhcmFjdGVycyBhcmUgYmVmb3JlIGEgc3BhY2UgbGlrZSBfaXNCZWZvcmVXb3JkRGVsaW1pdGVyKCkuIFJlbW92aW5nIGl0IG5vdyB3b3VsZCBtYWtlIHRoYXQgYSBmYWxzZSBuZWdhdGl2ZS5cbiAgICAgICAgICBzcGFjZU5vZGVzVG9SZW1vdmUucHVzaChub2RlLm5leHRTaWJsaW5nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG5vZGUuX25leHQgPSBub2RlLm5leHRTaWJsaW5nICYmIG5vZGUubmV4dFNpYmxpbmcuX2lzRmlyc3QgPyBudWxsIDogbm9kZS5uZXh0U2libGluZztcbiAgICAgICAgbm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG5vZGUpO1xuICAgICAgICBub2Rlcy5zcGxpY2UoaS0tLCAxKTtcbiAgICAgICAgbC0tO1xuICAgICAgfSBlbHNlIGlmICghaXNDaGlsZCkge1xuICAgICAgICBvZmZzZXQgPSAhbm9kZS5uZXh0U2libGluZyAmJiBfaXNCZWZvcmVXb3JkRGVsaW1pdGVyKG5vZGUucGFyZW50Tm9kZSwgZWxlbWVudCwgd29yZERlbGltaXRlcik7IC8vaWYgdGhpcyBpcyB0aGUgbGFzdCBsZXR0ZXIgaW4gdGhlIHdvcmQgKGFuZCB3ZSdyZSBub3QgYnJlYWtpbmcgYnkgbGluZXMgYW5kIG5vdCBwb3NpdGlvbmluZyB0aGluZ3MgYWJzb2x1dGVseSksIHdlIG5lZWQgdG8gYWRkIGEgc3BhY2UgYWZ0ZXJ3YXJkcyBzbyB0aGF0IHRoZSBjaGFyYWN0ZXJzIGRvbid0IGp1c3QgbWFzaCB0b2dldGhlclxuXG4gICAgICAgIGlmIChub2RlLnBhcmVudE5vZGUuX3BhcmVudCkge1xuICAgICAgICAgIG5vZGUucGFyZW50Tm9kZS5fcGFyZW50LmFwcGVuZENoaWxkKG5vZGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG9mZnNldCkge1xuICAgICAgICAgIG5vZGUucGFyZW50Tm9kZS5hcHBlbmRDaGlsZChfZG9jLmNyZWF0ZVRleHROb2RlKFwiIFwiKSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGFnID09PSBcInNwYW5cIikge1xuICAgICAgICAgIG5vZGUuc3R5bGUuZGlzcGxheSA9IFwiaW5saW5lXCI7IC8vc28gdGhhdCB3b3JkIGJyZWFrcyBhcmUgaG9ub3JlZCBwcm9wZXJseS5cbiAgICAgICAgfVxuXG4gICAgICAgIGNoYXJBcnJheS5wdXNoKG5vZGUpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAobm9kZS5wYXJlbnROb2RlLl9pc1NwbGl0ICYmICFub2RlLl9pc1NwbGl0ICYmIG5vZGUuaW5uZXJIVE1MICE9PSBcIlwiKSB7XG4gICAgICB3b3JkQXJyYXkucHVzaChub2RlKTtcbiAgICB9IGVsc2UgaWYgKGNoYXJzICYmICFub2RlLl9pc1NwbGl0KSB7XG4gICAgICBpZiAodGFnID09PSBcInNwYW5cIikge1xuICAgICAgICBub2RlLnN0eWxlLmRpc3BsYXkgPSBcImlubGluZVwiO1xuICAgICAgfVxuXG4gICAgICBjaGFyQXJyYXkucHVzaChub2RlKTtcbiAgICB9XG4gIH1cblxuICBpID0gc3BhY2VOb2Rlc1RvUmVtb3ZlLmxlbmd0aDtcblxuICB3aGlsZSAoLS1pID4gLTEpIHtcbiAgICBzcGFjZU5vZGVzVG9SZW1vdmVbaV0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzcGFjZU5vZGVzVG9SZW1vdmVbaV0pO1xuICB9XG5cbiAgaWYgKGxpbmVzKSB7XG4gICAgLy90aGUgbmV4dCA3IGxpbmVzIGp1c3QgZ2l2ZSB1cyB0aGUgbGluZSB3aWR0aCBpbiB0aGUgbW9zdCByZWxpYWJsZSB3YXkgYW5kIGZpZ3VyZSBvdXQgdGhlIGxlZnQgb2Zmc2V0IChpZiBwb3NpdGlvbiBpc24ndCByZWxhdGl2ZSBvciBhYnNvbHV0ZSkuIFdlIG11c3Qgc2V0IHRoZSB3aWR0aCBhbG9uZyB3aXRoIHRleHQtYWxpZ24gdG8gZW5zdXJlIGV2ZXJ5dGhpbmcgd29ya3MgcHJvcGVybHkgZm9yIHZhcmlvdXMgYWxpZ25tZW50cy5cbiAgICBpZiAoYWJzb2x1dGUpIHtcbiAgICAgIGxpbmVOb2RlID0gX2RvYy5jcmVhdGVFbGVtZW50KHRhZyk7XG4gICAgICBlbGVtZW50LmFwcGVuZENoaWxkKGxpbmVOb2RlKTtcbiAgICAgIGxpbmVXaWR0aCA9IGxpbmVOb2RlLm9mZnNldFdpZHRoICsgXCJweFwiO1xuICAgICAgb2Zmc2V0ID0gbGluZU5vZGUub2Zmc2V0UGFyZW50ID09PSBlbGVtZW50ID8gMCA6IGVsZW1lbnQub2Zmc2V0TGVmdDtcbiAgICAgIGVsZW1lbnQucmVtb3ZlQ2hpbGQobGluZU5vZGUpO1xuICAgIH1cblxuICAgIHN0eWxlID0gZWxlbWVudC5zdHlsZS5jc3NUZXh0O1xuICAgIGVsZW1lbnQuc3R5bGUuY3NzVGV4dCA9IFwiZGlzcGxheTpub25lO1wiOyAvL3RvIGltcHJvdmUgcGVyZm9ybWFuY2UsIHNldCBkaXNwbGF5Om5vbmUgb24gdGhlIGVsZW1lbnQgc28gdGhhdCB0aGUgYnJvd3NlciBkb2Vzbid0IGhhdmUgdG8gd29ycnkgYWJvdXQgcmVmbG93aW5nIG9yIHJlbmRlcmluZyB3aGlsZSB3ZSdyZSByZW5lc3RpbmcgdGhpbmdzLiBXZSdsbCByZXZlcnQgdGhlIGNzc1RleHQgbGF0ZXIuXG4gICAgLy93ZSBjYW4ndCB1c2UgZWxlbWVudC5pbm5lckhUTUwgPSBcIlwiIGJlY2F1c2UgdGhhdCBjYXVzZXMgSUUgdG8gbGl0ZXJhbGx5IGRlbGV0ZSBhbGwgdGhlIG5vZGVzIGFuZCB0aGVpciBjb250ZW50IGV2ZW4gdGhvdWdoIHdlJ3ZlIHN0b3JlZCB0aGVtIGluIGFuIGFycmF5ISBTbyB3ZSBtdXN0IGxvb3AgdGhyb3VnaCB0aGUgY2hpbGRyZW4gYW5kIHJlbW92ZSB0aGVtLlxuXG4gICAgd2hpbGUgKGVsZW1lbnQuZmlyc3RDaGlsZCkge1xuICAgICAgZWxlbWVudC5yZW1vdmVDaGlsZChlbGVtZW50LmZpcnN0Q2hpbGQpO1xuICAgIH1cblxuICAgIGFkZFdvcmRTcGFjZXMgPSB3b3JkRGVsaW1pdGVyID09PSBcIiBcIiAmJiAoIWFic29sdXRlIHx8ICF3b3JkcyAmJiAhY2hhcnMpO1xuXG4gICAgZm9yIChpID0gMDsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjdXJMaW5lID0gbGluZXNbaV07XG4gICAgICBsaW5lTm9kZSA9IF9kb2MuY3JlYXRlRWxlbWVudCh0YWcpO1xuICAgICAgbGluZU5vZGUuc3R5bGUuY3NzVGV4dCA9IFwiZGlzcGxheTpibG9jazt0ZXh0LWFsaWduOlwiICsgdGV4dEFsaWduICsgXCI7cG9zaXRpb246XCIgKyAoYWJzb2x1dGUgPyBcImFic29sdXRlO1wiIDogXCJyZWxhdGl2ZTtcIik7XG5cbiAgICAgIGlmIChsaW5lc0NsYXNzKSB7XG4gICAgICAgIGxpbmVOb2RlLmNsYXNzTmFtZSA9IGxpbmVzQ2xhc3MgKyAoaXRlcmF0ZUxpbmUgPyBpICsgMSA6IFwiXCIpO1xuICAgICAgfVxuXG4gICAgICBsaW5lQXJyYXkucHVzaChsaW5lTm9kZSk7XG4gICAgICBsID0gY3VyTGluZS5sZW5ndGg7XG5cbiAgICAgIGZvciAoaiA9IDA7IGogPCBsOyBqKyspIHtcbiAgICAgICAgaWYgKGN1ckxpbmVbal0ubm9kZU5hbWUgIT09IFwiQlJcIikge1xuICAgICAgICAgIG5vZGUgPSBjdXJMaW5lW2pdO1xuICAgICAgICAgIGxpbmVOb2RlLmFwcGVuZENoaWxkKG5vZGUpO1xuXG4gICAgICAgICAgaWYgKGFkZFdvcmRTcGFjZXMgJiYgbm9kZS5fd29yZEVuZCkge1xuICAgICAgICAgICAgbGluZU5vZGUuYXBwZW5kQ2hpbGQoX2RvYy5jcmVhdGVUZXh0Tm9kZShcIiBcIikpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChhYnNvbHV0ZSkge1xuICAgICAgICAgICAgaWYgKGogPT09IDApIHtcbiAgICAgICAgICAgICAgbGluZU5vZGUuc3R5bGUudG9wID0gbm9kZS5feSArIFwicHhcIjtcbiAgICAgICAgICAgICAgbGluZU5vZGUuc3R5bGUubGVmdCA9IHBhZGRpbmdMZWZ0ICsgb2Zmc2V0ICsgXCJweFwiO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBub2RlLnN0eWxlLnRvcCA9IFwiMHB4XCI7XG5cbiAgICAgICAgICAgIGlmIChvZmZzZXQpIHtcbiAgICAgICAgICAgICAgbm9kZS5zdHlsZS5sZWZ0ID0gbm9kZS5feCAtIG9mZnNldCArIFwicHhcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGwgPT09IDApIHtcbiAgICAgICAgLy9pZiB0aGVyZSBhcmUgbm8gbm9kZXMgaW4gdGhlIGxpbmUgKHR5cGljYWxseSBtZWFuaW5nIHRoZXJlIHdlcmUgdHdvIGNvbnNlY3V0aXZlIDxicj4gdGFncywganVzdCBhZGQgYSBub24tYnJlYWtpbmcgc3BhY2Ugc28gdGhhdCB0aGluZ3MgZGlzcGxheSBwcm9wZXJseS5cbiAgICAgICAgbGluZU5vZGUuaW5uZXJIVE1MID0gXCImbmJzcDtcIjtcbiAgICAgIH0gZWxzZSBpZiAoIXdvcmRzICYmICFjaGFycykge1xuICAgICAgICBfZGVXb3JkaWZ5KGxpbmVOb2RlKTtcblxuICAgICAgICBfc3dhcFRleHQobGluZU5vZGUsIFN0cmluZy5mcm9tQ2hhckNvZGUoMTYwKSwgXCIgXCIpO1xuICAgICAgfVxuXG4gICAgICBpZiAoYWJzb2x1dGUpIHtcbiAgICAgICAgbGluZU5vZGUuc3R5bGUud2lkdGggPSBsaW5lV2lkdGg7XG4gICAgICAgIGxpbmVOb2RlLnN0eWxlLmhlaWdodCA9IG5vZGUuX2ggKyBcInB4XCI7XG4gICAgICB9XG5cbiAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQobGluZU5vZGUpO1xuICAgIH1cblxuICAgIGVsZW1lbnQuc3R5bGUuY3NzVGV4dCA9IHN0eWxlO1xuICB9IC8vaWYgZXZlcnl0aGluZyBzaGlmdHMgdG8gYmVpbmcgcG9zaXRpb246YWJzb2x1dGUsIHRoZSBjb250YWluZXIgY2FuIGNvbGxhcHNlIGluIHRlcm1zIG9mIGhlaWdodCBvciB3aWR0aCwgc28gZml4IHRoYXQgaGVyZS5cblxuXG4gIGlmIChhYnNvbHV0ZSkge1xuICAgIGlmIChvcmlnSGVpZ2h0ID4gZWxlbWVudC5jbGllbnRIZWlnaHQpIHtcbiAgICAgIGVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gb3JpZ0hlaWdodCAtIHBhZFRvcEFuZEJvdHRvbSArIFwicHhcIjtcblxuICAgICAgaWYgKGVsZW1lbnQuY2xpZW50SGVpZ2h0IDwgb3JpZ0hlaWdodCkge1xuICAgICAgICAvL0lFOCBhbmQgZWFybGllciB1c2UgYSBkaWZmZXJlbnQgYm94IG1vZGVsIC0gd2UgbXVzdCBpbmNsdWRlIHBhZGRpbmcgYW5kIGJvcmRlcnNcbiAgICAgICAgZWxlbWVudC5zdHlsZS5oZWlnaHQgPSBvcmlnSGVpZ2h0ICsgYm9yZGVyVG9wQW5kQm90dG9tICsgXCJweFwiO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChvcmlnV2lkdGggPiBlbGVtZW50LmNsaWVudFdpZHRoKSB7XG4gICAgICBlbGVtZW50LnN0eWxlLndpZHRoID0gb3JpZ1dpZHRoIC0gcGFkTGVmdEFuZFJpZ2h0ICsgXCJweFwiO1xuXG4gICAgICBpZiAoZWxlbWVudC5jbGllbnRXaWR0aCA8IG9yaWdXaWR0aCkge1xuICAgICAgICAvL0lFOCBhbmQgZWFybGllciB1c2UgYSBkaWZmZXJlbnQgYm94IG1vZGVsIC0gd2UgbXVzdCBpbmNsdWRlIHBhZGRpbmcgYW5kIGJvcmRlcnNcbiAgICAgICAgZWxlbWVudC5zdHlsZS53aWR0aCA9IG9yaWdXaWR0aCArIGJvcmRlckxlZnRBbmRSaWdodCArIFwicHhcIjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBfcHVzaFJldmVyc2VkKGFsbENoYXJzLCBjaGFyQXJyYXkpO1xuXG4gIGlmICh3b3Jkcykge1xuICAgIF9wdXNoUmV2ZXJzZWQoYWxsV29yZHMsIHdvcmRBcnJheSk7XG4gIH1cblxuICBfcHVzaFJldmVyc2VkKGFsbExpbmVzLCBsaW5lQXJyYXkpO1xufSxcbiAgICBfc3BsaXRSYXdUZXh0ID0gZnVuY3Rpb24gX3NwbGl0UmF3VGV4dChlbGVtZW50LCB2YXJzLCB3b3JkU3RhcnQsIGNoYXJTdGFydCkge1xuICB2YXIgdGFnID0gdmFycy50YWcgPyB2YXJzLnRhZyA6IHZhcnMuc3BhbiA/IFwic3BhblwiIDogXCJkaXZcIixcbiAgICAgIHR5cGVzID0gdmFycy50eXBlIHx8IHZhcnMuc3BsaXQgfHwgXCJjaGFycyx3b3JkcyxsaW5lc1wiLFxuICAgICAgLy93b3JkcyA9ICh0eXBlcy5pbmRleE9mKFwid29yZHNcIikgIT09IC0xKSxcbiAgY2hhcnMgPSB+dHlwZXMuaW5kZXhPZihcImNoYXJzXCIpLFxuICAgICAgYWJzb2x1dGUgPSBfaXNBYnNvbHV0ZSh2YXJzKSxcbiAgICAgIHdvcmREZWxpbWl0ZXIgPSB2YXJzLndvcmREZWxpbWl0ZXIgfHwgXCIgXCIsXG4gICAgICBzcGFjZSA9IHdvcmREZWxpbWl0ZXIgIT09IFwiIFwiID8gXCJcIiA6IGFic29sdXRlID8gXCImIzE3MzsgXCIgOiBcIiBcIixcbiAgICAgIHdvcmRFbmQgPSBcIjwvXCIgKyB0YWcgKyBcIj5cIixcbiAgICAgIHdvcmRJc09wZW4gPSAxLFxuICAgICAgc3BlY2lhbENoYXJzID0gdmFycy5zcGVjaWFsQ2hhcnMgPyB0eXBlb2YgdmFycy5zcGVjaWFsQ2hhcnMgPT09IFwiZnVuY3Rpb25cIiA/IHZhcnMuc3BlY2lhbENoYXJzIDogX2ZpbmRTcGVjaWFsQ2hhcnMgOiBudWxsLFxuICAgICAgLy9zcGVjaWFsQ2hhcnMgY2FuIGJlIGFuIGFycmF5IG9yIGEgZnVuY3Rpb24uIEZvciBwZXJmb3JtYW5jZSByZWFzb25zLCB3ZSBhbHdheXMgc2V0IHRoaXMgbG9jYWwgXCJzcGVjaWFsQ2hhcnNcIiB0byBhIGZ1bmN0aW9uIHRvIHdoaWNoIHdlIHBhc3MgdGhlIHJlbWFpbmluZyB0ZXh0IGFuZCB3aGF0ZXZlciB0aGUgb3JpZ2luYWwgdmFycy5zcGVjaWFsQ2hhcnMgd2FzIHNvIHRoYXQgaWYgaXQncyBhbiBhcnJheSwgaXQgd29ya3Mgd2l0aCB0aGUgX2ZpbmRTcGVjaWFsQ2hhcnMoKSBmdW5jdGlvbi5cbiAgdGV4dCxcbiAgICAgIHNwbGl0VGV4dCxcbiAgICAgIGksXG4gICAgICBqLFxuICAgICAgbCxcbiAgICAgIGNoYXJhY3RlcixcbiAgICAgIGhhc1RhZ1N0YXJ0LFxuICAgICAgdGVzdFJlc3VsdCxcbiAgICAgIGNvbnRhaW5lciA9IF9kb2MuY3JlYXRlRWxlbWVudChcImRpdlwiKSxcbiAgICAgIHBhcmVudCA9IGVsZW1lbnQucGFyZW50Tm9kZTtcblxuICBwYXJlbnQuaW5zZXJ0QmVmb3JlKGNvbnRhaW5lciwgZWxlbWVudCk7XG4gIGNvbnRhaW5lci50ZXh0Q29udGVudCA9IGVsZW1lbnQubm9kZVZhbHVlO1xuICBwYXJlbnQucmVtb3ZlQ2hpbGQoZWxlbWVudCk7XG4gIGVsZW1lbnQgPSBjb250YWluZXI7XG4gIHRleHQgPSBnZXRUZXh0KGVsZW1lbnQpO1xuICBoYXNUYWdTdGFydCA9IHRleHQuaW5kZXhPZihcIjxcIikgIT09IC0xO1xuXG4gIGlmICh2YXJzLnJlZHVjZVdoaXRlU3BhY2UgIT09IGZhbHNlKSB7XG4gICAgdGV4dCA9IHRleHQucmVwbGFjZShfbXVsdGlwbGVTcGFjZXNFeHAsIFwiIFwiKS5yZXBsYWNlKF9zdHJpcEV4cCwgXCJcIik7XG4gIH1cblxuICBpZiAoaGFzVGFnU3RhcnQpIHtcbiAgICB0ZXh0ID0gdGV4dC5zcGxpdChcIjxcIikuam9pbihcInt7TFR9fVwiKTsgLy93ZSBjYW4ndCBsZWF2ZSBcIjxcIiBpbiB0aGUgc3RyaW5nLCBvciB3aGVuIHdlIHNldCB0aGUgaW5uZXJIVE1MLCBpdCBjYW4gYmUgaW50ZXJwcmV0ZWQgYXMgYSBub2RlXG4gIH1cblxuICBsID0gdGV4dC5sZW5ndGg7XG4gIHNwbGl0VGV4dCA9ICh0ZXh0LmNoYXJBdCgwKSA9PT0gXCIgXCIgPyBzcGFjZSA6IFwiXCIpICsgd29yZFN0YXJ0KCk7XG5cbiAgZm9yIChpID0gMDsgaSA8IGw7IGkrKykge1xuICAgIGNoYXJhY3RlciA9IHRleHQuY2hhckF0KGkpO1xuXG4gICAgaWYgKHNwZWNpYWxDaGFycyAmJiAodGVzdFJlc3VsdCA9IHNwZWNpYWxDaGFycyh0ZXh0LnN1YnN0cihpKSwgdmFycy5zcGVjaWFsQ2hhcnMpKSkge1xuICAgICAgLy8gbG9vayBmb3IgYW55IHNwZWNpYWxDaGFycyB0aGF0IHdlcmUgZGVjbGFyZWQuIFJlbWVtYmVyLCB0aGV5IGNhbiBiZSBwYXNzZWQgaW4gbGlrZSB7c3BlY2lhbENoYXJzOltcIuCkruClgFwiLCBcIuCkquCkvlwiLCBcIuCkueCliFwiXX0gb3IgYSBmdW5jdGlvbiBjb3VsZCBiZSBkZWZpbmVkIGluc3RlYWQuIEVpdGhlciB3YXksIHRoZSBmdW5jdGlvbiBzaG91bGQgcmV0dXJuIHRoZSBudW1iZXIgb2YgY2hhcmFjdGVycyB0aGF0IHNob3VsZCBiZSBncm91cGVkIHRvZ2V0aGVyIGZvciB0aGlzIFwiY2hhcmFjdGVyXCIuXG4gICAgICBjaGFyYWN0ZXIgPSB0ZXh0LnN1YnN0cihpLCB0ZXN0UmVzdWx0IHx8IDEpO1xuICAgICAgc3BsaXRUZXh0ICs9IGNoYXJzICYmIGNoYXJhY3RlciAhPT0gXCIgXCIgPyBjaGFyU3RhcnQoKSArIGNoYXJhY3RlciArIFwiPC9cIiArIHRhZyArIFwiPlwiIDogY2hhcmFjdGVyO1xuICAgICAgaSArPSB0ZXN0UmVzdWx0IC0gMTtcbiAgICB9IGVsc2UgaWYgKGNoYXJhY3RlciA9PT0gd29yZERlbGltaXRlciAmJiB0ZXh0LmNoYXJBdChpIC0gMSkgIT09IHdvcmREZWxpbWl0ZXIgJiYgaSkge1xuICAgICAgc3BsaXRUZXh0ICs9IHdvcmRJc09wZW4gPyB3b3JkRW5kIDogXCJcIjtcbiAgICAgIHdvcmRJc09wZW4gPSAwO1xuXG4gICAgICB3aGlsZSAodGV4dC5jaGFyQXQoaSArIDEpID09PSB3b3JkRGVsaW1pdGVyKSB7XG4gICAgICAgIC8vc2tpcCBvdmVyIGVtcHR5IHNwYWNlcyAodG8gYXZvaWQgbWFraW5nIHRoZW0gd29yZHMpXG4gICAgICAgIHNwbGl0VGV4dCArPSBzcGFjZTtcbiAgICAgICAgaSsrO1xuICAgICAgfVxuXG4gICAgICBpZiAoaSA9PT0gbCAtIDEpIHtcbiAgICAgICAgc3BsaXRUZXh0ICs9IHNwYWNlO1xuICAgICAgfSBlbHNlIGlmICh0ZXh0LmNoYXJBdChpICsgMSkgIT09IFwiKVwiKSB7XG4gICAgICAgIHNwbGl0VGV4dCArPSBzcGFjZSArIHdvcmRTdGFydCgpO1xuICAgICAgICB3b3JkSXNPcGVuID0gMTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGNoYXJhY3RlciA9PT0gXCJ7XCIgJiYgdGV4dC5zdWJzdHIoaSwgNikgPT09IFwie3tMVH19XCIpIHtcbiAgICAgIHNwbGl0VGV4dCArPSBjaGFycyA/IGNoYXJTdGFydCgpICsgXCJ7e0xUfX1cIiArIFwiPC9cIiArIHRhZyArIFwiPlwiIDogXCJ7e0xUfX1cIjtcbiAgICAgIGkgKz0gNTtcbiAgICB9IGVsc2UgaWYgKGNoYXJhY3Rlci5jaGFyQ29kZUF0KDApID49IDB4RDgwMCAmJiBjaGFyYWN0ZXIuY2hhckNvZGVBdCgwKSA8PSAweERCRkYgfHwgdGV4dC5jaGFyQ29kZUF0KGkgKyAxKSA+PSAweEZFMDAgJiYgdGV4dC5jaGFyQ29kZUF0KGkgKyAxKSA8PSAweEZFMEYpIHtcbiAgICAgIC8vc3BlY2lhbCBlbW9qaSBjaGFyYWN0ZXJzIHVzZSAyIG9yIDQgdW5pY29kZSBjaGFyYWN0ZXJzIHRoYXQgd2UgbXVzdCBrZWVwIHRvZ2V0aGVyLlxuICAgICAgaiA9ICgodGV4dC5zdWJzdHIoaSwgMTIpLnNwbGl0KGVtb2ppRXhwKSB8fCBbXSlbMV0gfHwgXCJcIikubGVuZ3RoIHx8IDI7XG4gICAgICBzcGxpdFRleHQgKz0gY2hhcnMgJiYgY2hhcmFjdGVyICE9PSBcIiBcIiA/IGNoYXJTdGFydCgpICsgdGV4dC5zdWJzdHIoaSwgaikgKyBcIjwvXCIgKyB0YWcgKyBcIj5cIiA6IHRleHQuc3Vic3RyKGksIGopO1xuICAgICAgaSArPSBqIC0gMTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3BsaXRUZXh0ICs9IGNoYXJzICYmIGNoYXJhY3RlciAhPT0gXCIgXCIgPyBjaGFyU3RhcnQoKSArIGNoYXJhY3RlciArIFwiPC9cIiArIHRhZyArIFwiPlwiIDogY2hhcmFjdGVyO1xuICAgIH1cbiAgfVxuXG4gIGVsZW1lbnQub3V0ZXJIVE1MID0gc3BsaXRUZXh0ICsgKHdvcmRJc09wZW4gPyB3b3JkRW5kIDogXCJcIik7XG5cbiAgaWYgKGhhc1RhZ1N0YXJ0KSB7XG4gICAgX3N3YXBUZXh0KHBhcmVudCwgXCJ7e0xUfX1cIiwgXCI8XCIpOyAvL25vdGU6IGRvbid0IHBlcmZvcm0gdGhpcyBvbiBcImVsZW1lbnRcIiBiZWNhdXNlIHRoYXQgZ2V0cyByZXBsYWNlZCB3aXRoIGFsbCBuZXcgZWxlbWVudHMgd2hlbiB3ZSBzZXQgZWxlbWVudC5vdXRlckhUTUwuXG5cbiAgfVxufSxcbiAgICBfc3BsaXQgPSBmdW5jdGlvbiBfc3BsaXQoZWxlbWVudCwgdmFycywgd29yZFN0YXJ0LCBjaGFyU3RhcnQpIHtcbiAgdmFyIGNoaWxkcmVuID0gX3RvQXJyYXkoZWxlbWVudC5jaGlsZE5vZGVzKSxcbiAgICAgIGwgPSBjaGlsZHJlbi5sZW5ndGgsXG4gICAgICBhYnNvbHV0ZSA9IF9pc0Fic29sdXRlKHZhcnMpLFxuICAgICAgaSxcbiAgICAgIGNoaWxkO1xuXG4gIGlmIChlbGVtZW50Lm5vZGVUeXBlICE9PSAzIHx8IGwgPiAxKSB7XG4gICAgdmFycy5hYnNvbHV0ZSA9IGZhbHNlO1xuXG4gICAgZm9yIChpID0gMDsgaSA8IGw7IGkrKykge1xuICAgICAgY2hpbGQgPSBjaGlsZHJlbltpXTtcblxuICAgICAgaWYgKGNoaWxkLm5vZGVUeXBlICE9PSAzIHx8IC9cXFMrLy50ZXN0KGNoaWxkLm5vZGVWYWx1ZSkpIHtcbiAgICAgICAgaWYgKGFic29sdXRlICYmIGNoaWxkLm5vZGVUeXBlICE9PSAzICYmIF9nZXRDb21wdXRlZFN0eWxlKGNoaWxkKS5kaXNwbGF5ID09PSBcImlubGluZVwiKSB7XG4gICAgICAgICAgLy9pZiB0aGVyZSdzIGEgY2hpbGQgbm9kZSB0aGF0J3MgZGlzcGxheTppbmxpbmUsIHN3aXRjaCBpdCB0byBpbmxpbmUtYmxvY2sgc28gdGhhdCBhYnNvbHV0ZSBwb3NpdGlvbmluZyB3b3JrcyBwcm9wZXJseSAobW9zdCBicm93c2VycyBkb24ndCByZXBvcnQgb2Zmc2V0VG9wL29mZnNldExlZnQgcHJvcGVybHkgaW5zaWRlIGEgPHNwYW4+IGZvciBleGFtcGxlKVxuICAgICAgICAgIGNoaWxkLnN0eWxlLmRpc3BsYXkgPSBcImlubGluZS1ibG9ja1wiO1xuICAgICAgICAgIGNoaWxkLnN0eWxlLnBvc2l0aW9uID0gXCJyZWxhdGl2ZVwiO1xuICAgICAgICB9XG5cbiAgICAgICAgY2hpbGQuX2lzU3BsaXQgPSB0cnVlO1xuXG4gICAgICAgIF9zcGxpdChjaGlsZCwgdmFycywgd29yZFN0YXJ0LCBjaGFyU3RhcnQpOyAvL2Rvbid0IHNwbGl0IGxpbmVzIG9uIGNoaWxkIGVsZW1lbnRzXG5cbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXJzLmFic29sdXRlID0gYWJzb2x1dGU7XG4gICAgZWxlbWVudC5faXNTcGxpdCA9IHRydWU7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgX3NwbGl0UmF3VGV4dChlbGVtZW50LCB2YXJzLCB3b3JkU3RhcnQsIGNoYXJTdGFydCk7XG59O1xuXG5leHBvcnQgdmFyIFNwbGl0VGV4dCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIFNwbGl0VGV4dChlbGVtZW50LCB2YXJzKSB7XG4gICAgaWYgKCFfY29yZUluaXR0ZWQpIHtcbiAgICAgIF9pbml0Q29yZSgpO1xuICAgIH1cblxuICAgIHRoaXMuZWxlbWVudHMgPSBfdG9BcnJheShlbGVtZW50KTtcbiAgICB0aGlzLmNoYXJzID0gW107XG4gICAgdGhpcy53b3JkcyA9IFtdO1xuICAgIHRoaXMubGluZXMgPSBbXTtcbiAgICB0aGlzLl9vcmlnaW5hbHMgPSBbXTtcbiAgICB0aGlzLnZhcnMgPSB2YXJzIHx8IHt9O1xuXG4gICAgaWYgKF9ib251c1ZhbGlkYXRlZCkge1xuICAgICAgdGhpcy5zcGxpdCh2YXJzKTtcbiAgICB9XG4gIH1cblxuICB2YXIgX3Byb3RvID0gU3BsaXRUZXh0LnByb3RvdHlwZTtcblxuICBfcHJvdG8uc3BsaXQgPSBmdW5jdGlvbiBzcGxpdCh2YXJzKSB7XG4gICAgaWYgKHRoaXMuaXNTcGxpdCkge1xuICAgICAgdGhpcy5yZXZlcnQoKTtcbiAgICB9XG5cbiAgICB0aGlzLnZhcnMgPSB2YXJzID0gdmFycyB8fCB0aGlzLnZhcnM7XG4gICAgdGhpcy5fb3JpZ2luYWxzLmxlbmd0aCA9IHRoaXMuY2hhcnMubGVuZ3RoID0gdGhpcy53b3Jkcy5sZW5ndGggPSB0aGlzLmxpbmVzLmxlbmd0aCA9IDA7XG5cbiAgICB2YXIgaSA9IHRoaXMuZWxlbWVudHMubGVuZ3RoLFxuICAgICAgICB0YWcgPSB2YXJzLnRhZyA/IHZhcnMudGFnIDogdmFycy5zcGFuID8gXCJzcGFuXCIgOiBcImRpdlwiLFxuICAgICAgICB3b3JkU3RhcnQgPSBfY3NzQ2xhc3NGdW5jKHZhcnMud29yZHNDbGFzcywgdGFnKSxcbiAgICAgICAgY2hhclN0YXJ0ID0gX2Nzc0NsYXNzRnVuYyh2YXJzLmNoYXJzQ2xhc3MsIHRhZyksXG4gICAgICAgIG9yaWdIZWlnaHQsXG4gICAgICAgIG9yaWdXaWR0aCxcbiAgICAgICAgZTsgLy93ZSBzcGxpdCBpbiByZXZlcnNlZCBvcmRlciBzbyB0aGF0IGlmL3doZW4gd2UgcG9zaXRpb246YWJzb2x1dGUgZWxlbWVudHMsIHRoZXkgZG9uJ3QgYWZmZWN0IHRoZSBwb3NpdGlvbiBvZiB0aGUgb25lcyBhZnRlciB0aGVtIGluIHRoZSBkb2N1bWVudCBmbG93IChzaGlmdGluZyB0aGVtIHVwIGFzIHRoZXkncmUgdGFrZW4gb3V0IG9mIHRoZSBkb2N1bWVudCBmbG93KS5cblxuXG4gICAgd2hpbGUgKC0taSA+IC0xKSB7XG4gICAgICBlID0gdGhpcy5lbGVtZW50c1tpXTtcbiAgICAgIHRoaXMuX29yaWdpbmFsc1tpXSA9IGUuaW5uZXJIVE1MO1xuICAgICAgb3JpZ0hlaWdodCA9IGUuY2xpZW50SGVpZ2h0O1xuICAgICAgb3JpZ1dpZHRoID0gZS5jbGllbnRXaWR0aDtcblxuICAgICAgX3NwbGl0KGUsIHZhcnMsIHdvcmRTdGFydCwgY2hhclN0YXJ0KTtcblxuICAgICAgX3NldFBvc2l0aW9uc0FmdGVyU3BsaXQoZSwgdmFycywgdGhpcy5jaGFycywgdGhpcy53b3JkcywgdGhpcy5saW5lcywgb3JpZ1dpZHRoLCBvcmlnSGVpZ2h0KTtcbiAgICB9XG5cbiAgICB0aGlzLmNoYXJzLnJldmVyc2UoKTtcbiAgICB0aGlzLndvcmRzLnJldmVyc2UoKTtcbiAgICB0aGlzLmxpbmVzLnJldmVyc2UoKTtcbiAgICB0aGlzLmlzU3BsaXQgPSB0cnVlO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIF9wcm90by5yZXZlcnQgPSBmdW5jdGlvbiByZXZlcnQoKSB7XG4gICAgdmFyIG9yaWdpbmFscyA9IHRoaXMuX29yaWdpbmFscztcblxuICAgIGlmICghb3JpZ2luYWxzKSB7XG4gICAgICB0aHJvdyBcInJldmVydCgpIGNhbGwgd2Fzbid0IHNjb3BlZCBwcm9wZXJseS5cIjtcbiAgICB9XG5cbiAgICB0aGlzLmVsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGUsIGkpIHtcbiAgICAgIHJldHVybiBlLmlubmVySFRNTCA9IG9yaWdpbmFsc1tpXTtcbiAgICB9KTtcbiAgICB0aGlzLmNoYXJzID0gW107XG4gICAgdGhpcy53b3JkcyA9IFtdO1xuICAgIHRoaXMubGluZXMgPSBbXTtcbiAgICB0aGlzLmlzU3BsaXQgPSBmYWxzZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBTcGxpdFRleHQuY3JlYXRlID0gZnVuY3Rpb24gY3JlYXRlKGVsZW1lbnQsIHZhcnMpIHtcbiAgICByZXR1cm4gbmV3IFNwbGl0VGV4dChlbGVtZW50LCB2YXJzKTtcbiAgfTtcblxuICByZXR1cm4gU3BsaXRUZXh0O1xufSgpO1xuU3BsaXRUZXh0LnZlcnNpb24gPSBcIjMuMi42XCI7XG5leHBvcnQgeyBTcGxpdFRleHQgYXMgZGVmYXVsdCB9OyIsImZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IFwiQGJhYmVsL2hlbHBlcnMgLSB0eXBlb2ZcIjsgaWYgKHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiKSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfTsgfSBlbHNlIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfVxuXG5mdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb25cIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfVxuXG5mdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfVxuXG5mdW5jdGlvbiBfY3JlYXRlU3VwZXIoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKTsgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkgeyB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksIHJlc3VsdDsgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHsgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjsgcmVzdWx0ID0gUmVmbGVjdC5jb25zdHJ1Y3QoU3VwZXIsIGFyZ3VtZW50cywgTmV3VGFyZ2V0KTsgfSBlbHNlIHsgcmVzdWx0ID0gU3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfSByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTsgfTsgfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpKSB7IHJldHVybiBjYWxsOyB9IGVsc2UgaWYgKGNhbGwgIT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRGVyaXZlZCBjb25zdHJ1Y3RvcnMgbWF5IG9ubHkgcmV0dXJuIG9iamVjdCBvciB1bmRlZmluZWRcIik7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH1cblxuZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSB7IGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJ1bmRlZmluZWRcIiB8fCAhUmVmbGVjdC5jb25zdHJ1Y3QpIHJldHVybiBmYWxzZTsgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTsgaWYgKHR5cGVvZiBQcm94eSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gdHJ1ZTsgdHJ5IHsgQm9vbGVhbi5wcm90b3R5cGUudmFsdWVPZi5jYWxsKFJlZmxlY3QuY29uc3RydWN0KEJvb2xlYW4sIFtdLCBmdW5jdGlvbiAoKSB7fSkpOyByZXR1cm4gdHJ1ZTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2U7IH0gfVxuXG5mdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9XG5cbi8vIGFwcFxuaW1wb3J0IGFwcENvcmUgZnJvbSAnLi4vYXBwL2FwcENvcmUnO1xuaW1wb3J0IGFwcFN0b3JlIGZyb20gJy4uL2FwcC9hcHBTdG9yZSc7XG5pbXBvcnQgYXBwVWkgZnJvbSAnLi4vYXBwL2FwcFVpJzsgLy8gY2xhc3Nlc1xuXG5pbXBvcnQgZG9tRXZlbnRzIGZyb20gJy4uL2NsYXNzZXMvZG9tRXZlbnRzJzsgLy8gSGlnaHdheVxuXG5pbXBvcnQgSGlnaHdheSBmcm9tICdAZG9nc3R1ZGlvL2hpZ2h3YXknOyAvLyBQcmVsb2FkXG5cbmltcG9ydCBQcmVsb2FkIGZyb20gJ3ByZWxvYWQtaXQnO1xuaW1wb3J0IExhenlMb2FkIGZyb20gJ2xhenlsb2FkJzsgLy8gVXRpbGl0aWVzXG5cbmltcG9ydCBTdXBlclNjcm9sbGVyIGZyb20gJy4uL2NsYXNzZXMvc3VwZXJTY3JvbGxlcic7XG5pbXBvcnQgU3BsaXRUZXh0IGZyb20gJy4uL2NsYXNzZXMvc3BsaXRUZXh0JzsgLy8gaW1wb3J0IFN1cGVyT2JzZXJ2ZXIgZnJvbSAnLi4vY2xhc3Nlcy9zdXBlck9ic2VydmVyJztcbi8vIEdzYXBcblxuaW1wb3J0IGdzYXAgZnJvbSAnZ3NhcCc7XG5pbXBvcnQgU2Nyb2xsVHJpZ2dlciBmcm9tICdnc2FwL1Njcm9sbFRyaWdnZXInO1xuZ3NhcC5yZWdpc3RlclBsdWdpbihTY3JvbGxUcmlnZ2VyKTtcblxudmFyIFJlbmRlcmVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfSGlnaHdheSRSZW5kZXJlcikge1xuICBfaW5oZXJpdHMoUmVuZGVyZXIsIF9IaWdod2F5JFJlbmRlcmVyKTtcblxuICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKFJlbmRlcmVyKTtcblxuICBmdW5jdGlvbiBSZW5kZXJlcihwcm9wZXJ0aWVzKSB7XG4gICAgdmFyIF90aGlzO1xuXG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJlbmRlcmVyKTtcblxuICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcHJvcGVydGllcyk7IC8vIHN0b3JlXG5cbiAgICBfdGhpcy5hcHBTdG9yZSA9IGFwcFN0b3JlOyAvLyBhcHAgcmVmZXJlbmNlc1xuXG4gICAgX3RoaXMuYXBwQ29yZSA9IG5ldyBhcHBDb3JlKCk7XG4gICAgX3RoaXMuYXBwVWkgPSBuZXcgYXBwVWkoKTsgLy8gRXZlbnRzXG5cbiAgICBfdGhpcy5kb21FdmVudHMgPSBuZXcgZG9tRXZlbnRzKCk7IC8vIFNhdmUgc2x1Z1xuICAgIC8vIGlmKHRoaXMuYXBwU3RvcmUuZnJvbSA9PT0gJ2hvbWUnKVxuICAgIC8vICAgICB0aGlzLmFwcFVpLm5hdmlnYXRpb24uaXNMb2NrZWQgPSB0cnVlO1xuXG4gICAgX3RoaXMuaGFzaCA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoICE9PSAnJyA/IHdpbmRvdy5sb2NhdGlvbi5oYXNoIDogbnVsbDtcbiAgICBfdGhpcy5wYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xuICAgIF90aGlzLmFwcFN0b3JlLmZpcnN0TmF2aWdhdGlvbiA9IF90aGlzLmFwcFN0b3JlLmN1cnJlbnRTZWN0aW9uID09PSBudWxsO1xuICAgIF90aGlzLmFwcFN0b3JlLmN1cnJlbnQgPSBfdGhpcy5wcm9wZXJ0aWVzLnNsdWc7XG4gICAgX3RoaXMuYXBwU3RvcmUuY3VycmVudFN1YiA9IF90aGlzLmFwcFN0b3JlLmN1cnJlbnQgPT09ICdwcm9qZWN0JyA/IGxvY2F0aW9uLnBhdGhuYW1lLnNwbGl0KCcvJylbbG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKS5sZW5ndGggLSAyXSA6IG51bGw7XG4gICAgX3RoaXMuYXBwU3RvcmUuY3VycmVudFNlY3Rpb24gPSBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKTsgLy8gaWYodGhpcy5hcHBTdG9yZS5maXJzdE5hdmlnYXRpb24pXG4gICAgLy8gICAgIHRoaXMuYXBwU3RvcmUuZmlyc3ROYXZpZ2F0aW9uKCk7XG4gICAgLy8gUHJlbG9hZGVyXG5cbiAgICBfdGhpcy5wcmVsb2FkTWFpbiA9IG51bGw7XG4gICAgX3RoaXMucHJlbG9hZFNlY29uZGFyeSA9IG51bGw7XG4gICAgX3RoaXMucHJlbG9hZERlbGF5ID0gX3RoaXMuYXBwU3RvcmUuaXNEZXNrdG9wID8gMyA6IDEuMjsgLy90aGlzLnByZWxvYWREZWxheSA9IDA7XG5cbiAgICBfdGhpcy5wcmVsb2FkSXRlbXMgPSB7XG4gICAgICBtYWluOiBbXSxcbiAgICAgIC8vIE1hbmRhdG9yeSBpdGVtc1xuICAgICAgc2Vjb25kYXJ5OiBbXSAvLyBTZWNvbmRhcnkgaXRlbXNcblxuICAgIH07IC8vIFNjcm9sbFxuXG4gICAgX3RoaXMuc3VwZXJTY3JvbGxlciA9IG51bGw7XG4gICAgX3RoaXMuc3VwZXJUcmlnZ2VyID0gbnVsbDtcbiAgICBpZiAoaGlzdG9yeS5zY3JvbGxSZXN0b3JhdGlvbikgaGlzdG9yeS5zY3JvbGxSZXN0b3JhdGlvbiA9ICdtYW51YWwnO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIF9jcmVhdGVDbGFzcyhSZW5kZXJlciwgW3tcbiAgICBrZXk6IFwib25FbnRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvbkVudGVyKCkge1xuICAgICAgdGhpcy5jaGVja0VsZW1lbnRzKCk7XG4gICAgICB0aGlzLnByZXNlbGVjdG9ycygpO1xuICAgICAgdGhpcy5zZWxlY3RvcnMoKTtcbiAgICAgIHRoaXMuZXZlbnRzKCk7XG4gICAgICB0aGlzLnByZWxvYWQoKTtcbiAgICAgIHRoaXMuc3BsaXRUZXh0cyA9IFtdO1xuXG4gICAgICBpZiAoIXRoaXMucGFyYW1zLmhhcygndHJwLWVkaXQtdHJhbnNsYXRpb24nKSkge1xuICAgICAgICAvLyBTZXQgYW5pbWF0aW9uc1xuICAgICAgICB0aGlzLnNldExhYmVscygpO1xuICAgICAgICB0aGlzLnNldFRpdGxlcygpO1xuICAgICAgICB0aGlzLnNldERlc2NyaXB0aW9ucygpO1xuICAgICAgICB0aGlzLnNldEltYWdlcygpO1xuICAgICAgICB0aGlzLnNldExpbmtzKCk7XG4gICAgICAgIHRoaXMuc2V0TWluaWxpbmVzKCk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuYmVmb3JlRW50ZXIoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiY2hlY2tFbGVtZW50c1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjaGVja0VsZW1lbnRzKCkge1xuICAgICAgaWYgKHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKSB7XG4gICAgICAgIHRoaXMuJGVsZW1lbnRzTW9iaWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtbW9iaWxlXScpO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy4kZWxlbWVudHNNb2JpbGUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB0aGlzLiRlbGVtZW50c01vYmlsZVtpXS5yZW1vdmUoKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy4kZWxlbWVudHNEZXNrdG9wID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtZGVza3RvcF0nKTtcblxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgdGhpcy4kZWxlbWVudHNEZXNrdG9wLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgIHRoaXMuJGVsZW1lbnRzRGVza3RvcFtfaV0ucmVtb3ZlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicHJlc2VsZWN0b3JzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHByZXNlbGVjdG9ycygpIHtcbiAgICAgIC8vIFNldCByZWZlcmVuY2UgdG8gY3VycmVudCBzZWN0aW9uXG4gICAgICB0aGlzLiRlbCA9IHRoaXMud3JhcC5sYXN0RWxlbWVudENoaWxkO1xuICAgICAgdGhpcy4kaW5uZXIgPSB0aGlzLiRlbC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1zY3JvbGwtd3JhcHBlcl0gLmlubmVyJyk7XG4gICAgICB0aGlzLiRzY3JvbGxiYXIgPSB0aGlzLiRlbC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1zY3JvbGwtd3JhcHBlcl0gLnNjcm9sbGJhcicpO1xuICAgICAgdGhpcy4kb3ZlcmxheSA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3IoJy5vdmVybGF5Jyk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInNlbGVjdG9yc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzZWxlY3RvcnMoKSB7fSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG5cbiAgfSwge1xuICAgIGtleTogXCJldmVudHNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZXZlbnRzKCkge30gLy8gZXNsaW50LWRpc2FibGUtbGluZVxuXG4gIH0sIHtcbiAgICBrZXk6IFwicHJlbG9hZFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBwcmVsb2FkKCkge30gLy8gZXNsaW50LWRpc2FibGUtbGluZVxuXG4gIH0sIHtcbiAgICBrZXk6IFwiYmVmb3JlRW50ZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gYmVmb3JlRW50ZXIoKSB7fSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG5cbiAgfSwge1xuICAgIGtleTogXCJvbkVudGVyQ29tcGxldGVkXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIG9uRW50ZXJDb21wbGV0ZWQoKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgLy8gTGF6eSBsb2FkXG4gICAgICB0aGlzLmxhenlMb2FkID0gbmV3IExhenlMb2FkKHRoaXMubGF6eUxvYWQsIHtcbiAgICAgICAgcm9vdDogbnVsbCxcbiAgICAgICAgcm9vdE1hcmdpbjogd2luZG93LmlubmVySGVpZ2h0ICogMC4yNSArICdweCcsXG4gICAgICAgIHRocmVzaG9sZDogMFxuICAgICAgfSk7IC8vIHRoaXMubGF6eUxvYWQubG9hZEltYWdlcygpO1xuICAgICAgLy8gSWYgZmlyc3QgbmF2aWdhdGlvbiBhbmQgbmVlZCBwcmVsb2FkXG5cbiAgICAgIGlmICh0aGlzLnByZWxvYWRJdGVtcy5tYWluLmxlbmd0aCA+IDAgJiYgdGhpcy5hcHBTdG9yZS5maXJzdE5hdmlnYXRpb24pIHtcbiAgICAgICAgdmFyIF9pbmRleCA9IDA7XG5cbiAgICAgICAgdmFyIF9wcmVsb2FkT24gPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcblxuICAgICAgICB0aGlzLnByZWxvYWRNYWluID0gUHJlbG9hZCgpO1xuICAgICAgICB0aGlzLnByZWxvYWRNYWluLmZldGNoKHRoaXMucHJlbG9hZEl0ZW1zLm1haW4pOyAvLyB0aGlzLnByZWxvYWRNYWluLm9ucHJvZ3Jlc3MgPSAoZXZlbnQpID0+IHsgdGhpcy5hcHBVaS4kbG9hZGVyUHJvZ3Jlc3MuaW5uZXJIVE1MID0gZXZlbnQucHJvZ3Jlc3MgKyAnJSc7IH07XG5cbiAgICAgICAgdGhpcy5wcmVsb2FkTWFpbi5vbnByb2dyZXNzID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgdmFyIF9hbW91bnQgPSBldmVudC5wcm9ncmVzcyAvIDEwMDtcblxuICAgICAgICAgIGNvbnNvbGUubG9nKF9hbW91bnQpO1xuICAgICAgICAgIGdzYXAudG8oX3RoaXMyLmFwcFVpLiRsb2FkZXJQcm9ncmVzcy5jaGlsZHJlblswXSwge1xuICAgICAgICAgICAgc2NhbGVYOiBNYXRoLm1pbihfYW1vdW50LCAwLjk1KSxcbiAgICAgICAgICAgIGVhc2U6ICdleHBvLmluT3V0JyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiBfdGhpczIucHJlbG9hZERlbGF5IC8gKF90aGlzMi5wcmVsb2FkSXRlbXMubWFpbi5sZW5ndGggKyAxKSxcbiAgICAgICAgICAgIGRlbGF5OiBfdGhpczIucHJlbG9hZERlbGF5IC8gKF90aGlzMi5wcmVsb2FkSXRlbXMubWFpbi5sZW5ndGggKyAxKSAqIF9pbmRleFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIF9pbmRleCsrO1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMucHJlbG9hZE1haW4ub25jb21wbGV0ZSA9IGZ1bmN0aW9uIChpdGVtcykge1xuICAgICAgICAgIHZhciBfcHJlbG9hZE9mZiA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuXG4gICAgICAgICAgdmFyIF9wcmVsb2FkRGlmZmVyZW5jZSA9IChfcHJlbG9hZE9mZiAtIF9wcmVsb2FkT24pIC8gMTAwMDtcblxuICAgICAgICAgIHZhciBfcHJlbG9hZERlbGF5ID0gTWF0aC5tYXgoMCwgX3RoaXMyLnByZWxvYWREZWxheSAtIF9wcmVsb2FkRGlmZmVyZW5jZSk7XG5cbiAgICAgICAgICBnc2FwLmRlbGF5ZWRDYWxsKF9wcmVsb2FkRGVsYXksIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGdzYXAudG8oX3RoaXMyLmFwcFVpLiRsb2FkZXJQcm9ncmVzcy5jaGlsZHJlblswXSwge1xuICAgICAgICAgICAgICBzY2FsZVg6IDEsXG4gICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgICAgICAgIGR1cmF0aW9uOiAwLjIsXG4gICAgICAgICAgICAgIG9uQ29tcGxldGU6IGZ1bmN0aW9uIG9uQ29tcGxldGUoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMyLnN0YXJ0KCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgfSAvLyBpZiBmaXJzdCBuYXZpZ2F0aW9uIGJ1dCBkb250IG5lZWQgcHJlbG9hZHNcbiAgICAgIGVsc2UgaWYgKHRoaXMucHJlbG9hZEl0ZW1zLm1haW4ubGVuZ3RoID09PSAwICYmIHRoaXMuYXBwU3RvcmUuZmlyc3ROYXZpZ2F0aW9uKSB7XG4gICAgICAgIC8vIEZha2UgcHJvZ3Jlc3NcbiAgICAgICAgdmFyIHNwbGl0UHJvZ3Jlc3MgPSB0aGlzLmFwcFVpLnNwbGl0SW5QYXJ0cygxLCA1KTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNwbGl0UHJvZ3Jlc3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB2YXIgX2R1cmF0aW9uID0gaSA9PT0gMCA/IHRoaXMucHJlbG9hZERlbGF5ICogc3BsaXRQcm9ncmVzc1swXSA6IHRoaXMucHJlbG9hZERlbGF5ICogc3BsaXRQcm9ncmVzc1tpXSAtIHRoaXMucHJlbG9hZERlbGF5ICogc3BsaXRQcm9ncmVzc1tpIC0gMV07XG5cbiAgICAgICAgICB2YXIgX2RlbGF5ID0gaSA9PT0gMCA/IDAgOiB0aGlzLnByZWxvYWREZWxheSAqIHNwbGl0UHJvZ3Jlc3NbaSAtIDFdO1xuXG4gICAgICAgICAgZ3NhcC50byh0aGlzLmFwcFVpLiRsb2FkZXJQcm9ncmVzcy5jaGlsZHJlblswXSwge1xuICAgICAgICAgICAgc2NhbGVYOiBzcGxpdFByb2dyZXNzW2ldLFxuICAgICAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnLFxuICAgICAgICAgICAgZHVyYXRpb246IF9kdXJhdGlvbixcbiAgICAgICAgICAgIGRlbGF5OiBfZGVsYXlcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGdzYXAuZGVsYXllZENhbGwodGhpcy5wcmVsb2FkRGVsYXksIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBfdGhpczIuc3RhcnQoKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnN0YXJ0KCk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInN0YXJ0XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHN0YXJ0KCkge1xuICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgIGlmICh0aGlzLmFwcFN0b3JlLmZpcnN0TmF2aWdhdGlvbikge1xuICAgICAgICAvLyBSZW1vdmUgbG9hZGVyXG4gICAgICAgIHRoaXMuYXBwVWkuaGlkZUxvYWRlcigpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnNjcm9sbCgpO1xuXG4gICAgICBpZiAodGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHtcbiAgICAgICAgaWYgKHRoaXMuYXBwU3RvcmUuZmlyc3ROYXZpZ2F0aW9uKSBnc2FwLmZyb21Ubyh0aGlzLmFwcFN0b3JlLmN1cnJlbnRTZWN0aW9uLiRlbCwge1xuICAgICAgICAgIHk6ICctNXZ3J1xuICAgICAgICB9LCB7XG4gICAgICAgICAgeTogJzB2dycsXG4gICAgICAgICAgZHVyYXRpb246IDEuOCxcbiAgICAgICAgICBlYXNlOiAnZXhwby5pbk91dCdcbiAgICAgICAgfSk7ZWxzZSBnc2FwLmZyb21Ubyh0aGlzLmFwcFN0b3JlLmN1cnJlbnRTZWN0aW9uLiRlbCwge1xuICAgICAgICAgIHk6ICctNXZ3J1xuICAgICAgICB9LCB7XG4gICAgICAgICAgeTogJzB2dycsXG4gICAgICAgICAgZHVyYXRpb246IDEsXG4gICAgICAgICAgZWFzZTogJ2V4cG8ub3V0J1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh0aGlzLmFwcFN0b3JlLmZpcnN0TmF2aWdhdGlvbikgZ3NhcC50byh0aGlzLmFwcFN0b3JlLmN1cnJlbnRTZWN0aW9uLiRlbCwge1xuICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgZHVyYXRpb246IDEsXG4gICAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgICBkZWxheTogMS44XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5hcHBTdG9yZS5maXJzdE5hdmlnYXRpb24pIHRoaXMuYXBwQ29yZS5uYXZpZ2F0ZVN0YXJ0KCk7XG5cbiAgICAgIGlmICghdGhpcy5wYXJhbXMuaGFzKCd0cnAtZWRpdC10cmFuc2xhdGlvbicpKSB7XG4gICAgICAgIC8vIEluaXQgYW5pbWF0aW9uc1xuICAgICAgICB0aGlzLmluaXRMYWJlbHMoKTtcbiAgICAgICAgdGhpcy5pbml0VGl0bGVzKCk7XG4gICAgICAgIHRoaXMuaW5pdERlc2NyaXB0aW9ucygpO1xuICAgICAgICB0aGlzLmluaXRJbWFnZXMoKTtcbiAgICAgICAgdGhpcy5pbml0TGlua3MoKTtcbiAgICAgICAgdGhpcy5pbml0TWluaWxpbmVzKCk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuaW5pdEluZm8oKTtcbiAgICAgIHRoaXMucHJlZW50ZXIoKTtcbiAgICAgIGdzYXAuZGVsYXllZENhbGwodGhpcy5hcHBTdG9yZS5maXJzdE5hdmlnYXRpb24gPyAxLjggOiAxLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aGlzMy5lbnRlcigpO1xuXG4gICAgICAgIGlmIChfdGhpczMuc3VwZXJTY3JvbGxlcikgX3RoaXMzLnN1cGVyU2Nyb2xsZXIuX3Njcm9sbC5lbmFibGUgPSB0cnVlO1xuICAgICAgICBpZiAoX3RoaXMzLmhhc2gpIF90aGlzMy5zY3JvbGxUbyhfdGhpczMuaGFzaCk7XG5cbiAgICAgICAgX3RoaXMzLmJlZm9yZVJlc2l6ZSh3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0KTtcbiAgICAgIH0pO1xuXG4gICAgICBpZiAodGhpcy5wcmVsb2FkSXRlbXMuc2Vjb25kYXJ5Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgdGhpcy5wcmVsb2FkU2Vjb25kYXJ5ID0gUHJlbG9hZCgpO1xuICAgICAgICB0aGlzLnByZWxvYWRTZWNvbmRhcnkuZmV0Y2godGhpcy5wcmVsb2FkSXRlbXMuc2Vjb25kYXJ5KTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwic2Nyb2xsXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNjcm9sbCgpIHtcbiAgICAgIHZhciBfdGhpczQgPSB0aGlzO1xuXG4gICAgICBpZiAodGhpcy4kaW5uZXIpIHtcbiAgICAgICAgaWYgKHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKSB7XG4gICAgICAgICAgLy8gU3VwZXJzY3JvbGxlclxuICAgICAgICAgIHRoaXMuc3VwZXJTY3JvbGxlciA9IG5ldyBTdXBlclNjcm9sbGVyKHtcbiAgICAgICAgICAgIGVuYWJsZTogZmFsc2UsXG4gICAgICAgICAgICBzY3JvbGw6IHRydWUsXG4gICAgICAgICAgICBzY3JvbGxUYXJnZXQ6IHRoaXMuJGlubmVyLFxuICAgICAgICAgICAgYmFyOiB0cnVlLFxuICAgICAgICAgICAgYmFyVGFyZ2V0OiB0aGlzLiRzY3JvbGxiYXIuY2hpbGRyZW5bMF0sXG4gICAgICAgICAgICBvblJhZjogZnVuY3Rpb24gb25SYWYoc2Nyb2xsLCBwZXJjZW50KSB7XG4gICAgICAgICAgICAgIF90aGlzNC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKTtcblxuICAgICAgICAgICAgICBpZiAoX3RoaXM0LmFwcFN0b3JlLmN1cnJlbnQgPT09ICdob21lJykge1xuICAgICAgICAgICAgICAgIGlmIChfdGhpczQuYXBwVWkuJGhlYWRlclN1Ym1lbnUpIGdzYXAudG8oX3RoaXM0LmFwcFVpLiRoZWFkZXJTdWJtZW51LCB7XG4gICAgICAgICAgICAgICAgICB5OiBzY3JvbGwueSAqIDIsXG4gICAgICAgICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzNC5hcHBVaS4kbG9nbykgZ3NhcC50byhfdGhpczQuYXBwVWkuJGxvZ28sIHtcbiAgICAgICAgICAgICAgICAgIHk6IHNjcm9sbC55ICogMixcbiAgICAgICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChfdGhpczQuYXBwVWkuJGhlYWRlclRyaWdnZXIgJiYgX3RoaXM0LmFwcFN0b3JlLmN1cnJlbnQgPT09ICdob21lJykge1xuICAgICAgICAgICAgICAgIGlmIChzY3JvbGwueSA8PSAtd2luZG93LmlubmVySGVpZ2h0KSBnc2FwLnRvKF90aGlzNC5hcHBVaS4kaGVhZGVyVHJpZ2dlciwge1xuICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCdcbiAgICAgICAgICAgICAgICB9KTtlbHNlIGdzYXAudG8oX3RoaXM0LmFwcFVpLiRoZWFkZXJUcmlnZ2VyLCB7XG4gICAgICAgICAgICAgICAgICBvcGFjaXR5OiAwLjAwMDEsXG4gICAgICAgICAgICAgICAgICBwb2ludGVyRXZlbnRzOiAnaW5pdGlhbCcsXG4gICAgICAgICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoX3RoaXM0LnN1cGVyVHJpZ2dlcikgX3RoaXM0LnN1cGVyVHJpZ2dlci51cGRhdGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTsgLy8gU2Nyb2xsIFRyaWdnZXJcblxuICAgICAgICAgIHRoaXMuc3VwZXJUcmlnZ2VyID0gU2Nyb2xsVHJpZ2dlcjtcbiAgICAgICAgICB0aGlzLnN1cGVyVHJpZ2dlci5kZWZhdWx0cyh7XG4gICAgICAgICAgICBzY3JvbGxlcjogdGhpcy4kaW5uZXJcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0aGlzLnN1cGVyVHJpZ2dlci5zY3JvbGxlclByb3h5KHRoaXMuJGlubmVyLCB7XG4gICAgICAgICAgICBzY3JvbGxUb3A6IGZ1bmN0aW9uIHNjcm9sbFRvcCh2YWx1ZSkge1xuICAgICAgICAgICAgICByZXR1cm4gLV90aGlzNC5zdXBlclNjcm9sbGVyLl9zY3JvbGwubGl2ZVBvc2l0aW9uLnk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0Qm91bmRpbmdDbGllbnRSZWN0OiBmdW5jdGlvbiBnZXRCb3VuZGluZ0NsaWVudFJlY3QoKSB7XG4gICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdG9wOiAwLFxuICAgICAgICAgICAgICAgIGxlZnQ6IDAsXG4gICAgICAgICAgICAgICAgd2lkdGg6IHdpbmRvdy5pbm5lcldpZHRoLFxuICAgICAgICAgICAgICAgIGhlaWdodDogd2luZG93LmlubmVySGVpZ2h0XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdGhpcy5zdXBlclRyaWdnZXIucmVmcmVzaCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuc3VwZXJUcmlnZ2VyID0gU2Nyb2xsVHJpZ2dlcjtcbiAgICAgICAgICB0aGlzLnN1cGVyVHJpZ2dlci5jb25maWcoe1xuICAgICAgICAgICAgYXV0b1JlZnJlc2hFdmVudHM6ICdET01Db250ZW50TG9hZGVkLGxvYWQnLFxuICAgICAgICAgICAgc3luY0ludGVydmFsOiA5OTk5OTk5OTlcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0aGlzLnN1cGVyVHJpZ2dlci5yZWZyZXNoKCk7XG4gICAgICAgICAgZ3NhcC50aWNrZXIuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzNC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0aGlzLnN1cGVyVHJpZ2dlclRsID0gZ3NhcC50aW1lbGluZSh7XG4gICAgICAgICAgICBkZWZhdWx0czoge1xuICAgICAgICAgICAgICBlYXNlOiAnbm9uZSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzY3JvbGxUcmlnZ2VyOiB7XG4gICAgICAgICAgICAgIHRyaWdnZXI6IHRoaXMuJGFwcCxcbiAgICAgICAgICAgICAgc2NydWI6IHRydWUsXG4gICAgICAgICAgICAgIHN0YXJ0OiAndG9wIHRvcCcsXG4gICAgICAgICAgICAgIGVuZDogJ2JvdHRvbSBib3R0b20nLFxuICAgICAgICAgICAgICBvblVwZGF0ZTogZnVuY3Rpb24gb25VcGRhdGUoc2VsZikge1xuICAgICAgICAgICAgICAgIF90aGlzNC5zdXBlclNjcm9sbGVyTW9iaWxlID0gc2VsZi5wcm9ncmVzcyAqIHNlbGYuZW5kOyAvLyBpZih0aGlzLmFwcFVpLiRoZWFkZXIpXG4gICAgICAgICAgICAgICAgLy8gICAgIGdzYXAudG8odGhpcy5hcHBVaS4kaGVhZGVyLCB7IHk6IC0oc2VsZi5wcm9ncmVzcyAqIHRoaXMuJGlubmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCkgfSk7XG4gICAgICAgICAgICAgICAgLy8gaWYodGhpcy5hcHBVaS4kbG9nbylcbiAgICAgICAgICAgICAgICAvLyAgICAgZ3NhcC50byh0aGlzLmFwcFVpLiRsb2dvLCB7IHk6IC0oc2VsZi5wcm9ncmVzcyAqIHRoaXMuJGlubmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCkgLyAyIH0pO1xuICAgICAgICAgICAgICAgIC8vIGlmKHRoaXMuYXBwVWkuJGhlYWRlclRyaWdnZXJUZXh0ICYmICF0aGlzLmFwcFN0b3JlLmlzRGVza3RvcClcbiAgICAgICAgICAgICAgICAvLyAgICAgZ3NhcC50byh0aGlzLmFwcFVpLiRoZWFkZXJUcmlnZ2VyVGV4dCwgeyB5OiAtKHNlbGYucHJvZ3Jlc3MgKiB0aGlzLiRpbm5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQpIC8gMiB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInByZWVudGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHByZWVudGVyKCkge31cbiAgfSwge1xuICAgIGtleTogXCJzY3JvbGxUb1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzY3JvbGxUbyhoYXNoKSB7XG4gICAgICB2YXIgJHRhcmdldCA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3IoaGFzaCk7XG5cbiAgICAgIGlmICgkdGFyZ2V0KSB7XG4gICAgICAgIGlmICh0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCkge1xuICAgICAgICAgIHZhciBvZmZzZXQgPSAkdGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnkgKyB0aGlzLnN1cGVyU2Nyb2xsZXIuX3Njcm9sbC5saXZlUG9zaXRpb24ueTtcblxuICAgICAgICAgIHRoaXMuc3VwZXJTY3JvbGxlci5zY3JvbGxBbmltYXRlKG9mZnNldCwgMiwgJ3Bvd2VyNC5pbk91dCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBfb2Zmc2V0ID0gJHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS55ICsgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDtcblxuICAgICAgICAgIGdzYXAudG8oZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCB7XG4gICAgICAgICAgICBzY3JvbGxUb3A6IF9vZmZzZXQsXG4gICAgICAgICAgICBkdXJhdGlvbjogMixcbiAgICAgICAgICAgIGVhc2U6ICdwb3dlcjQuaW5PdXQnXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmVxdWVzdEFuaW1hdGlvbkZyYW1lXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlcXVlc3RBbmltYXRpb25GcmFtZSgpIHtcbiAgICAgIGlmICh0aGlzLnN1cGVyVHJpZ2dlcikgdGhpcy5zdXBlclRyaWdnZXIudXBkYXRlKCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInNldExhYmVsc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRMYWJlbHMoKSB7XG4gICAgICBpZiAodGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHRoaXMuJGxhYmVscyA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5sYWJlbDpub3QoLnByb21vdGlvbiAubGFiZWwpJyk7ZWxzZSB0aGlzLiRsYWJlbHMgPSB0aGlzLiRlbC5xdWVyeVNlbGVjdG9yQWxsKCcubGFiZWwnKTtcblxuICAgICAgaWYgKHRoaXMuJGxhYmVscykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuJGxhYmVscy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHZhciBzcGxpdCA9IG5ldyBTcGxpdFRleHQodGhpcy4kbGFiZWxzW2ldLCB7XG4gICAgICAgICAgICB0eXBlOiAnbGluZXMsIHdvcmRzJyxcbiAgICAgICAgICAgIGxpbmVzQ2xhc3M6ICdsaW5lIGxpbmUtLSsrJyxcbiAgICAgICAgICAgIHdvcmRzQ2xhc3M6ICd3b3JkIHdvcmQtLSsrJyxcbiAgICAgICAgICAgIGNoYXJzQ2xhc3M6ICdjaGFyIGNoYXItLSsrJ1xuICAgICAgICAgIH0pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG5cbiAgICAgICAgICB0aGlzLnNwbGl0VGV4dHMucHVzaChzcGxpdCk7XG4gICAgICAgICAgdGhpcy4kbGFiZWxzW2ldLmNsYXNzTGlzdC5hZGQoJ3NwbGl0Jyk7XG4gICAgICAgICAgdmFyIGxpbmVzID0gdGhpcy4kbGFiZWxzW2ldLnF1ZXJ5U2VsZWN0b3JBbGwoJy5saW5lJyk7XG5cbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGxpbmVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICB2YXIgd29yZHMgPSBsaW5lc1tqXS5xdWVyeVNlbGVjdG9yQWxsKCc6c2NvcGUgPiAud29yZCw6c2NvcGUgPiBzdHJvbmcnKTtcblxuICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCB3b3Jkcy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICBnc2FwLnNldCh3b3Jkc1trXSwge1xuICAgICAgICAgICAgICAgIHk6ICcxMDAlJ1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwic2V0VGl0bGVzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNldFRpdGxlcygpIHtcbiAgICAgIHRoaXMuJHRpdGxlcyA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy50aXRsZTpub3QoLnBvc3QgLnRpdGxlKScpO1xuXG4gICAgICBpZiAodGhpcy4kdGl0bGVzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy4kdGl0bGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgdmFyIHNwbGl0ID0gbmV3IFNwbGl0VGV4dCh0aGlzLiR0aXRsZXNbaV0sIHtcbiAgICAgICAgICAgIHR5cGU6ICdsaW5lcywgd29yZHMnLFxuICAgICAgICAgICAgbGluZXNDbGFzczogJ2xpbmUgbGluZS0tKysnLFxuICAgICAgICAgICAgd29yZHNDbGFzczogJ3dvcmQgd29yZC0tKysnLFxuICAgICAgICAgICAgY2hhcnNDbGFzczogJ2NoYXIgY2hhci0tKysnXG4gICAgICAgICAgfSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcblxuICAgICAgICAgIHRoaXMuc3BsaXRUZXh0cy5wdXNoKHNwbGl0KTtcbiAgICAgICAgICB0aGlzLiR0aXRsZXNbaV0uY2xhc3NMaXN0LmFkZCgnc3BsaXQnKTtcbiAgICAgICAgICB2YXIgbGluZXMgPSB0aGlzLiR0aXRsZXNbaV0ucXVlcnlTZWxlY3RvckFsbCgnLmxpbmUnKTtcblxuICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbGluZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgIHZhciB3b3JkcyA9IGxpbmVzW2pdLnF1ZXJ5U2VsZWN0b3JBbGwoJzpzY29wZSA+IC53b3JkLDpzY29wZSA+IHN0cm9uZycpO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHdvcmRzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgIC8vIGlmKHdvcmRzW2tdLnRhZ05hbWUgPT09ICdESVYnKVxuICAgICAgICAgICAgICAvLyAgICAgLy9nc2FwLnNldCh3b3Jkc1trXSwgeyBvcGFjaXR5OiAwLjAwMDEgfSk7XG4gICAgICAgICAgICAgIC8vIGVsc2VcbiAgICAgICAgICAgICAgaWYgKHdvcmRzW2tdLnRhZ05hbWUgPT09ICdTVFJPTkcnKSB3b3Jkc1trXS5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWVuZCcsICc8c3BhbiBjbGFzcz1cIm1hc2tcIj48L3NwYW4+Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRoaXMuJHRpdGxlc0luZm8gPSB0aGlzLiRlbC5xdWVyeVNlbGVjdG9yQWxsKCcuaW5mbyAudGl0bGUnKTtcblxuICAgICAgaWYgKHRoaXMuJHRpdGxlc0luZm8pIHtcbiAgICAgICAgZm9yICh2YXIgX2kyID0gMDsgX2kyIDwgdGhpcy4kdGl0bGVzSW5mby5sZW5ndGg7IF9pMisrKSB7XG4gICAgICAgICAgdmFyIF9zcGxpdCA9IG5ldyBTcGxpdFRleHQodGhpcy4kdGl0bGVzSW5mb1tfaTJdLCB7XG4gICAgICAgICAgICB0eXBlOiAnbGluZXMsIHdvcmRzJyxcbiAgICAgICAgICAgIGxpbmVzQ2xhc3M6ICdsaW5lIGxpbmUtLSsrJyxcbiAgICAgICAgICAgIHdvcmRzQ2xhc3M6ICd3b3JkIHdvcmQtLSsrJyxcbiAgICAgICAgICAgIGNoYXJzQ2xhc3M6ICdjaGFyIGNoYXItLSsrJ1xuICAgICAgICAgIH0pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG5cblxuICAgICAgICAgIHRoaXMuc3BsaXRUZXh0cy5wdXNoKF9zcGxpdCk7XG5cbiAgICAgICAgICB0aGlzLiR0aXRsZXNJbmZvW19pMl0uY2xhc3NMaXN0LmFkZCgnc3BsaXQnKTtcblxuICAgICAgICAgIHZhciBfbGluZXMgPSB0aGlzLiR0aXRsZXNJbmZvW19pMl0ucXVlcnlTZWxlY3RvckFsbCgnLmxpbmUnKTtcblxuICAgICAgICAgIGZvciAodmFyIF9qID0gMDsgX2ogPCBfbGluZXMubGVuZ3RoOyBfaisrKSB7XG4gICAgICAgICAgICB2YXIgX3dvcmRzID0gX2xpbmVzW19qXS5xdWVyeVNlbGVjdG9yQWxsKCc6c2NvcGUgPiAud29yZCw6c2NvcGUgPiBzdHJvbmcnKTtcblxuICAgICAgICAgICAgZm9yICh2YXIgX2sgPSAwOyBfayA8IF93b3Jkcy5sZW5ndGg7IF9rKyspIHtcbiAgICAgICAgICAgICAgZ3NhcC5zZXQoX3dvcmRzW19rXSwge1xuICAgICAgICAgICAgICAgIHk6ICcxMDAlJ1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwic2V0RGVzY3JpcHRpb25zXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNldERlc2NyaXB0aW9ucygpIHtcbiAgICAgIHRoaXMuJGRlc2NyaXB0aW9ucyA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy53eXNpd3lnOm5vdCgucHJpbmNpcGxlcyAucHJpbmNpcGxlc19faXRlbSAuaW5mbyAud3lzaXd5ZywgLmZlYXR1cmVzIC5mZWF0dXJlc19faXRlbSAuaW5mbyAud3lzaXd5ZyknKTtcblxuICAgICAgaWYgKHRoaXMuJGRlc2NyaXB0aW9ucykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuJGRlc2NyaXB0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGdzYXAuc2V0KHRoaXMuJGRlc2NyaXB0aW9uc1tpXSwge1xuICAgICAgICAgICAgeTogdGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3AgPyAnNXZ3JyA6ICcyMHB4JyxcbiAgICAgICAgICAgIHNjYWxlWTogMS4xLFxuICAgICAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICAgICAgd2lsbENoYW5nZTogJ3RyYW5zaXRpb24sIG9wYWNpdHknXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwic2V0SW1hZ2VzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNldEltYWdlcygpIHtcbiAgICAgIHRoaXMuJGltYWdlc01hc2sgPSB0aGlzLiRlbC5xdWVyeVNlbGVjdG9yQWxsKCcuaW1hZ2UtLW1hc2snKTtcblxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLiRpbWFnZXNNYXNrLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGdzYXAuc2V0KHRoaXMuJGltYWdlc01hc2tbaV0sIHtcbiAgICAgICAgICB5OiAnLTEwMiUnXG4gICAgICAgIH0pO1xuICAgICAgICBnc2FwLnNldCh0aGlzLiRpbWFnZXNNYXNrW2ldLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgICAgeTogJzEwMiUnXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICB0aGlzLiRpbWFnZXNBcHBlYXIgPSB0aGlzLiRlbC5xdWVyeVNlbGVjdG9yQWxsKCcuaW1hZ2UtLWFwcGVhcicpO1xuXG4gICAgICBmb3IgKHZhciBfaTMgPSAwOyBfaTMgPCB0aGlzLiRpbWFnZXNBcHBlYXIubGVuZ3RoOyBfaTMrKykge1xuICAgICAgICBnc2FwLnNldCh0aGlzLiRpbWFnZXNBcHBlYXJbX2kzXSwge1xuICAgICAgICAgIHk6ICc1dncnXG4gICAgICAgIH0pO1xuICAgICAgICBnc2FwLnNldCh0aGlzLiRpbWFnZXNBcHBlYXJbX2kzXS5jaGlsZHJlblswXSwge1xuICAgICAgICAgIHNjYWxlOiAxLjIsXG4gICAgICAgICAgb3BhY2l0eTogMC4wMDAxXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzZXRMaW5rc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRMaW5rcygpIHtcbiAgICAgIHZhciBfdGhpczUgPSB0aGlzO1xuXG4gICAgICB0aGlzLiRsaW5rcyA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5saW5rOm5vdCgucG9zdCAubGluayknKTtcblxuICAgICAgaWYgKHRoaXMuJGxpbmtzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy4kbGlua3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBnc2FwLnNldCh0aGlzLiRsaW5rc1tpXSwge1xuICAgICAgICAgICAgeTogdGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3AgPyAnMTB2dycgOiAnNDBweCcsXG4gICAgICAgICAgICBvcGFjaXR5OiAwLjAwMDFcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBnc2FwLnNldCh0aGlzLiRsaW5rc1tpXS5jaGlsZHJlblswXSwge1xuICAgICAgICAgICAgb3BhY2l0eTogMC4wMDAxXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZ3NhcC5zZXQodGhpcy4kbGlua3NbaV0ucXVlcnlTZWxlY3Rvcignc3ZnJyksIHtcbiAgICAgICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgICAgIHJvdGF0aW9uOiAnNDUwZGVnJ1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGdzYXAuc2V0KHRoaXMuJGxpbmtzW2ldLnF1ZXJ5U2VsZWN0b3IoJ3N2ZyBjaXJjbGUnKSwge1xuICAgICAgICAgICAgc3Ryb2tlRGFzaG9mZnNldDogJzExODEuMjRweCdcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0aGlzLmRvbUV2ZW50cy5hZGQodGhpcy4kbGlua3NbaV0sICdtb3VzZWVudGVyJywgZnVuY3Rpb24gKGUsIGEsIGVsKSB7XG4gICAgICAgICAgICBfdGhpczUuZW50ZXJMaW5rKGUsIGEsIGVsKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0aGlzLmRvbUV2ZW50cy5hZGQodGhpcy4kbGlua3NbaV0sICdtb3VzZWxlYXZlJywgZnVuY3Rpb24gKGUsIGEsIGVsKSB7XG4gICAgICAgICAgICBfdGhpczUubGVhdmVMaW5rKGUsIGEsIGVsKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzZXRNaW5pbGluZXNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0TWluaWxpbmVzKCkge1xuICAgICAgdGhpcy4kbWluaWxpbmVzID0gdGhpcy4kZWwucXVlcnlTZWxlY3RvckFsbCgnLm1pbmlsaW5lJyk7XG5cbiAgICAgIGlmICh0aGlzLiRtaW5pbGluZXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLiRtaW5pbGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBnc2FwLnNldCh0aGlzLiRtaW5pbGluZXNbaV0sIHtcbiAgICAgICAgICAgIHNjYWxlWDogMFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImVudGVyTGlua1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBlbnRlckxpbmsoZSwgYSwgZWwpIHtcbiAgICAgIC8vIGdzYXAudG8oZWwuY2hpbGRyZW5bMV0sIHsgeDogJy0xcmVtJywgZWFzZTogJ2V4cG8ub3V0JywgZHVyYXRpb246IDAuOCB9KTtcbiAgICAgIGdzYXAua2lsbFR3ZWVuc09mKFtlbC5xdWVyeVNlbGVjdG9yKCdzdmcnKSwgZWwucXVlcnlTZWxlY3Rvcignc3ZnIGNpcmNsZScpXSk7XG4gICAgICBnc2FwLnRvKGVsLnF1ZXJ5U2VsZWN0b3IoJ3N2ZycpLCB7XG4gICAgICAgIHJvdGF0aW9uOiAnNDUwZGVnJyxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgZHVyYXRpb246IDAuOFxuICAgICAgfSk7XG4gICAgICBnc2FwLnRvKGVsLnF1ZXJ5U2VsZWN0b3IoJ3N2ZyBjaXJjbGUnKSwge1xuICAgICAgICBzdHJva2VEYXNob2Zmc2V0OiAnMTE4MS4yNHB4JyxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgZHVyYXRpb246IDAuOFxuICAgICAgfSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImxlYXZlTGlua1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBsZWF2ZUxpbmsoZSwgYSwgZWwpIHtcbiAgICAgIC8vIGdzYXAudG8oZWwuY2hpbGRyZW5bMV0sIHsgeDogJzAnLCBlYXNlOiAnZXhwby5vdXQnLCBkdXJhdGlvbjogMC44IH0pO1xuICAgICAgZ3NhcC5raWxsVHdlZW5zT2YoW2VsLnF1ZXJ5U2VsZWN0b3IoJ3N2ZycpLCBlbC5xdWVyeVNlbGVjdG9yKCdzdmcgY2lyY2xlJyldKTtcbiAgICAgIGdzYXAudG8oZWwucXVlcnlTZWxlY3Rvcignc3ZnJyksIHtcbiAgICAgICAgcm90YXRpb246ICcwZGVnJyxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgZHVyYXRpb246IDAuOFxuICAgICAgfSk7XG4gICAgICBnc2FwLnRvKGVsLnF1ZXJ5U2VsZWN0b3IoJ3N2ZyBjaXJjbGUnKSwge1xuICAgICAgICBzdHJva2VEYXNob2Zmc2V0OiAnMHB4JyxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgZHVyYXRpb246IDAuOFxuICAgICAgfSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImluaXRMYWJlbHNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdExhYmVscygpIHtcbiAgICAgIHZhciBfdGhpczYgPSB0aGlzO1xuXG4gICAgICBpZiAodGhpcy4kbGFiZWxzKSB7XG4gICAgICAgIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKGkpIHtcbiAgICAgICAgICBTY3JvbGxUcmlnZ2VyLmNyZWF0ZSh7XG4gICAgICAgICAgICB0cmlnZ2VyOiBfdGhpczYuJGxhYmVsc1tpXSxcbiAgICAgICAgICAgIC8vIHN0YXJ0OiAndG9wIDgwJScsXG4gICAgICAgICAgICBvbkVudGVyOiBmdW5jdGlvbiBvbkVudGVyKCkge1xuICAgICAgICAgICAgICB2YXIgbGluZXMgPSBfdGhpczYuJGxhYmVsc1tpXS5xdWVyeVNlbGVjdG9yQWxsKCcubGluZScpO1xuXG4gICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbGluZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgd29yZHMgPSBsaW5lc1tqXS5xdWVyeVNlbGVjdG9yQWxsKCc6c2NvcGUgPiAud29yZCwgOnNjb3BlID4gc3Ryb25nJyk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHdvcmRzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICBnc2FwLnRvKHdvcmRzW2tdLCB7XG4gICAgICAgICAgICAgICAgICAgIHk6IDAsXG4gICAgICAgICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAxLjQsXG4gICAgICAgICAgICAgICAgICAgIGRlbGF5OiAwLjEgKyBrICogMC4wNVxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLiRsYWJlbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBfbG9vcChpKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJpbml0VGl0bGVzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRUaXRsZXMoKSB7XG4gICAgICB2YXIgX3RoaXM3ID0gdGhpcztcblxuICAgICAgaWYgKHRoaXMuJHRpdGxlcykge1xuICAgICAgICB2YXIgX2xvb3AyID0gZnVuY3Rpb24gX2xvb3AyKGkpIHtcbiAgICAgICAgICBTY3JvbGxUcmlnZ2VyLmNyZWF0ZSh7XG4gICAgICAgICAgICB0cmlnZ2VyOiBfdGhpczcuJHRpdGxlc1tpXSxcbiAgICAgICAgICAgIC8vIHN0YXJ0OiAndG9wIDgwJScsXG4gICAgICAgICAgICBvbkVudGVyOiBmdW5jdGlvbiBvbkVudGVyKCkge1xuICAgICAgICAgICAgICB2YXIgbGluZXMgPSBfdGhpczcuJHRpdGxlc1tpXS5xdWVyeVNlbGVjdG9yQWxsKCcubGluZScpO1xuXG4gICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbGluZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgd29yZHMgPSBsaW5lc1tqXS5xdWVyeVNlbGVjdG9yQWxsKCc6c2NvcGUgPiAud29yZCwgOnNjb3BlID4gc3Ryb25nJyk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHdvcmRzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAvLyBpZih3b3Jkc1trXS50YWdOYW1lID09PSAnRElWJylcbiAgICAgICAgICAgICAgICAgIC8vICAgICBnc2FwLnRvKHdvcmRzW2tdLCB7IG9wYWNpdHk6IDEsIGVhc2U6ICdwb3dlcjIub3V0JywgZGVsYXk6IChqICogMC4xKSArIChrICogMC4wNSkgfSk7XG4gICAgICAgICAgICAgICAgICAvLyBlbHNlXG4gICAgICAgICAgICAgICAgICBpZiAod29yZHNba10udGFnTmFtZSA9PT0gJ1NUUk9ORycgJiYgd29yZHNba10ucXVlcnlTZWxlY3RvcignLm1hc2snKSkgZ3NhcC50byh3b3Jkc1trXS5xdWVyeVNlbGVjdG9yKCcubWFzaycpLCB7XG4gICAgICAgICAgICAgICAgICAgIHNjYWxlWDogMCxcbiAgICAgICAgICAgICAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnLFxuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMS4yLFxuICAgICAgICAgICAgICAgICAgICBkZWxheTogaiAqIDAuMSArIGsgKiAwLjA1XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuJHRpdGxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIF9sb29wMihpKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy4kdGl0bGVzSW5mbykge1xuICAgICAgICB2YXIgX2xvb3AzID0gZnVuY3Rpb24gX2xvb3AzKF9pNCkge1xuICAgICAgICAgIFNjcm9sbFRyaWdnZXIuY3JlYXRlKHtcbiAgICAgICAgICAgIHRyaWdnZXI6IF90aGlzNy4kdGl0bGVzSW5mb1tfaTRdLFxuICAgICAgICAgICAgLy8gc3RhcnQ6ICd0b3AgODAlJyxcbiAgICAgICAgICAgIG9uRW50ZXI6IGZ1bmN0aW9uIG9uRW50ZXIoKSB7XG4gICAgICAgICAgICAgIHZhciBsaW5lcyA9IF90aGlzNy4kdGl0bGVzSW5mb1tfaTRdLnF1ZXJ5U2VsZWN0b3JBbGwoJy5saW5lJyk7XG5cbiAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBsaW5lcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciB3b3JkcyA9IGxpbmVzW2pdLnF1ZXJ5U2VsZWN0b3JBbGwoJzpzY29wZSA+IC53b3JkLCA6c2NvcGUgPiBzdHJvbmcnKTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgd29yZHMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgIGdzYXAudG8od29yZHNba10sIHtcbiAgICAgICAgICAgICAgICAgICAgeTogMCxcbiAgICAgICAgICAgICAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDEuNCxcbiAgICAgICAgICAgICAgICAgICAgZGVsYXk6IGogKiAwLjEgKyBrICogMC4wNVxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgZm9yICh2YXIgX2k0ID0gMDsgX2k0IDwgdGhpcy4kdGl0bGVzSW5mby5sZW5ndGg7IF9pNCsrKSB7XG4gICAgICAgICAgX2xvb3AzKF9pNCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiaW5pdERlc2NyaXB0aW9uc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0RGVzY3JpcHRpb25zKCkge1xuICAgICAgdmFyIF90aGlzOCA9IHRoaXM7XG5cbiAgICAgIGlmICh0aGlzLiRkZXNjcmlwdGlvbnMpIHtcbiAgICAgICAgdmFyIF9sb29wNCA9IGZ1bmN0aW9uIF9sb29wNChpKSB7XG4gICAgICAgICAgU2Nyb2xsVHJpZ2dlci5jcmVhdGUoe1xuICAgICAgICAgICAgdHJpZ2dlcjogX3RoaXM4LiRkZXNjcmlwdGlvbnNbaV0sXG4gICAgICAgICAgICBzdGFydDogX3RoaXM4LmFwcFN0b3JlLmlzRGVza3RvcCA/ICd0b3AgYm90dG9tJyA6ICd0b3AgODAlJyxcbiAgICAgICAgICAgIG9uY2U6IHRydWUsXG4gICAgICAgICAgICBvbkVudGVyOiBmdW5jdGlvbiBvbkVudGVyKCkge1xuICAgICAgICAgICAgICBnc2FwLnRvKF90aGlzOC4kZGVzY3JpcHRpb25zW2ldLCB7XG4gICAgICAgICAgICAgICAgeTogJzAnLFxuICAgICAgICAgICAgICAgIHNjYWxlWTogMSxcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAyLFxuICAgICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgICAgICAgICAgY2xlYXJQcm9wczogJ2FsbCdcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLiRkZXNjcmlwdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBfbG9vcDQoaSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiaW5pdEltYWdlc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0SW1hZ2VzKCkge1xuICAgICAgdmFyIF90aGlzOSA9IHRoaXM7XG5cbiAgICAgIHZhciBfbG9vcDUgPSBmdW5jdGlvbiBfbG9vcDUoaSkge1xuICAgICAgICBTY3JvbGxUcmlnZ2VyLmNyZWF0ZSh7XG4gICAgICAgICAgdHJpZ2dlcjogX3RoaXM5LiRpbWFnZXNNYXNrW2ldLFxuICAgICAgICAgIHN0YXJ0OiAndG9wIDgwJScsXG4gICAgICAgICAgb25jZTogdHJ1ZSxcbiAgICAgICAgICBvbkVudGVyOiBmdW5jdGlvbiBvbkVudGVyKCkge1xuICAgICAgICAgICAgZ3NhcC50byhfdGhpczkuJGltYWdlc01hc2tbaV0sIHtcbiAgICAgICAgICAgICAgeTogJzAlJyxcbiAgICAgICAgICAgICAgZHVyYXRpb246IDEuOCxcbiAgICAgICAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnLFxuICAgICAgICAgICAgICBkZWxheTogMFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBnc2FwLnRvKF90aGlzOS4kaW1hZ2VzTWFza1tpXS5jaGlsZHJlblswXSwge1xuICAgICAgICAgICAgICB5OiAnMCUnLFxuICAgICAgICAgICAgICBzY2FsZTogMSxcbiAgICAgICAgICAgICAgZHVyYXRpb246IDEuOCxcbiAgICAgICAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnLFxuICAgICAgICAgICAgICBkZWxheTogMFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH07XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy4kaW1hZ2VzTWFzay5sZW5ndGg7IGkrKykge1xuICAgICAgICBfbG9vcDUoaSk7XG4gICAgICB9XG5cbiAgICAgIHZhciBfbG9vcDYgPSBmdW5jdGlvbiBfbG9vcDYoX2k1KSB7XG4gICAgICAgIFNjcm9sbFRyaWdnZXIuY3JlYXRlKHtcbiAgICAgICAgICB0cmlnZ2VyOiBfdGhpczkuJGltYWdlc0FwcGVhcltfaTVdLFxuICAgICAgICAgIHN0YXJ0OiAndG9wIGJvdHRvbScsXG4gICAgICAgICAgb25jZTogdHJ1ZSxcbiAgICAgICAgICBvbkVudGVyOiBmdW5jdGlvbiBvbkVudGVyKCkge1xuICAgICAgICAgICAgZ3NhcC50byhfdGhpczkuJGltYWdlc0FwcGVhcltfaTVdLCB7XG4gICAgICAgICAgICAgIHk6ICcwJScsXG4gICAgICAgICAgICAgIGR1cmF0aW9uOiAyLFxuICAgICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICAgICAgICBkZWxheTogMFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBnc2FwLnRvKF90aGlzOS4kaW1hZ2VzQXBwZWFyW19pNV0uY2hpbGRyZW5bMF0sIHtcbiAgICAgICAgICAgICAgc2NhbGU6IDEsXG4gICAgICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgICAgIGR1cmF0aW9uOiAxLjIsXG4gICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgICAgICAgIGRlbGF5OiAwXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgZm9yICh2YXIgX2k1ID0gMDsgX2k1IDwgdGhpcy4kaW1hZ2VzQXBwZWFyLmxlbmd0aDsgX2k1KyspIHtcbiAgICAgICAgX2xvb3A2KF9pNSk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImluaXRMaW5rc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0TGlua3MoKSB7XG4gICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7XG5cbiAgICAgIGlmICh0aGlzLiRsaW5rcykge1xuICAgICAgICB2YXIgX2xvb3A3ID0gZnVuY3Rpb24gX2xvb3A3KGkpIHtcbiAgICAgICAgICBTY3JvbGxUcmlnZ2VyLmNyZWF0ZSh7XG4gICAgICAgICAgICB0cmlnZ2VyOiBfdGhpczEwLiRsaW5rc1tpXSxcbiAgICAgICAgICAgIHN0YXJ0OiAndG9wIGJvdHRvbScsXG4gICAgICAgICAgICBvbmNlOiB0cnVlLFxuICAgICAgICAgICAgb25FbnRlcjogZnVuY3Rpb24gb25FbnRlcigpIHtcbiAgICAgICAgICAgICAgZ3NhcC50byhfdGhpczEwLiRsaW5rc1tpXSwge1xuICAgICAgICAgICAgICAgIHk6IDAsXG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogMixcbiAgICAgICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBnc2FwLnRvKF90aGlzMTAuJGxpbmtzW2ldLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogMixcbiAgICAgICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBnc2FwLnRvKF90aGlzMTAuJGxpbmtzW2ldLnF1ZXJ5U2VsZWN0b3IoJ3N2ZycpLCB7XG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgICAgICByb3RhdGlvbjogJzAnLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAyLFxuICAgICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCdcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGdzYXAudG8oX3RoaXMxMC4kbGlua3NbaV0ucXVlcnlTZWxlY3Rvcignc3ZnIGNpcmNsZScpLCB7XG4gICAgICAgICAgICAgICAgc3Ryb2tlRGFzaG9mZnNldDogJzBweCcsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDIsXG4gICAgICAgICAgICAgICAgZWFzZTogJ2V4cG8ub3V0J1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuJGxpbmtzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgX2xvb3A3KGkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImluaXRNaW5pbGluZXNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdE1pbmlsaW5lcygpIHtcbiAgICAgIHZhciBfdGhpczExID0gdGhpcztcblxuICAgICAgaWYgKHRoaXMuJG1pbmlsaW5lcykge1xuICAgICAgICB2YXIgX2xvb3A4ID0gZnVuY3Rpb24gX2xvb3A4KGkpIHtcbiAgICAgICAgICBTY3JvbGxUcmlnZ2VyLmNyZWF0ZSh7XG4gICAgICAgICAgICB0cmlnZ2VyOiBfdGhpczExLiRtaW5pbGluZXNbaV0sXG4gICAgICAgICAgICBzdGFydDogJ3RvcCA4MCUnLFxuICAgICAgICAgICAgb25jZTogdHJ1ZSxcbiAgICAgICAgICAgIG9uRW50ZXI6IGZ1bmN0aW9uIG9uRW50ZXIoKSB7XG4gICAgICAgICAgICAgIGdzYXAudG8oX3RoaXMxMS4kbWluaWxpbmVzW2ldLCB7XG4gICAgICAgICAgICAgICAgc2NhbGVYOiAxLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAxLFxuICAgICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCdcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLiRtaW5pbGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBfbG9vcDgoaSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiaW5pdEluZm9cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdEluZm8oKSB7XG4gICAgICB2YXIgX3RoaXMxMiA9IHRoaXM7XG5cbiAgICAgIC8vIENoZWNrIGluZm90cmlnZ2VyIHNpZGViYXIgZWxlbWVudFxuICAgICAgdGhpcy4kaW5mb3RyaWdnZXIgPSB0aGlzLiRlbC5xdWVyeVNlbGVjdG9yKCcuaW5mb3RyaWdnZXInKTtcblxuICAgICAgaWYgKHRoaXMuJGluZm90cmlnZ2VyKSB7XG4gICAgICAgIGdzYXAudG8odGhpcy4kaW5mb3RyaWdnZXIsIHtcbiAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgIGVhc2U6ICdwb3dlcjIub3V0JyxcbiAgICAgICAgICBkdXJhdGlvbjogMC44LFxuICAgICAgICAgIGRlbGF5OiAxXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmRvbUV2ZW50cy5hZGQodGhpcy4kaW5mb3RyaWdnZXIsICdjbGljaycsIGZ1bmN0aW9uIChlLCBhLCBlbCkge1xuICAgICAgICAgIF90aGlzMTIuYXBwVWkub3BlbkluZm8oZSk7XG4gICAgICAgIH0pO1xuICAgICAgfSAvLyBDaGVjayBpbmZvdHJpZ2dlciBidXR0b24gZWxlbWVudHNcblxuXG4gICAgICB0aGlzLiRidXR0b250cmlnZ2VycyA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5idXR0b24tLWluZm90cmlnZ2VyJyk7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy4kYnV0dG9udHJpZ2dlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdGhpcy5kb21FdmVudHMuYWRkKHRoaXMuJGJ1dHRvbnRyaWdnZXJzW2ldLCAnY2xpY2snLCBmdW5jdGlvbiAoZSwgYSwgZWwpIHtcbiAgICAgICAgICBfdGhpczEyLmFwcFVpLm9wZW5JbmZvKGUpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5hcHBVaS5pbmZvLmlzT3BlbiA9IGZhbHNlO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJiZWZvcmVSZXNpemVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gYmVmb3JlUmVzaXplKHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgIGlmICh0aGlzLnN1cGVyU2Nyb2xsZXIpIHRoaXMuc3VwZXJTY3JvbGxlci5yZXNpemUoKTtcbiAgICAgIHRoaXMucmVzaXplKHdpZHRoLCBoZWlnaHQpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJyZXNpemVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVzaXplKHdpZHRoLCBoZWlnaHQpIHt9IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcblxuICB9LCB7XG4gICAga2V5OiBcInJlc2l6ZU9yaWVudGF0aW9uXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2l6ZU9yaWVudGF0aW9uKHdpZHRoLCBoZWlnaHQsIG9yaWVudGF0aW9uKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuc3BsaXRUZXh0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLnNwbGl0VGV4dHNbaV0ucmV2ZXJ0KCk7XG4gICAgICB9IC8vdGhpcy5zZXRJbWFnZXMoKTtcblxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJlbnRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBlbnRlcigpIHt9IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcblxuICB9LCB7XG4gICAga2V5OiBcIm9uTGVhdmVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gb25MZWF2ZSgpIHtcbiAgICAgIHRoaXMubGVhdmUoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwibGVhdmVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gbGVhdmUoKSB7XG4gICAgICBpZiAodGhpcy5kb21FdmVudHMpIHRoaXMuZG9tRXZlbnRzLmRlc3Ryb3koKTtcbiAgICAgIGlmICh0aGlzLnN1cGVyU2Nyb2xsZXIpIHRoaXMuc3VwZXJTY3JvbGxlci5kZXN0cm95KCk7XG4gICAgICBpZiAodGhpcy5zdXBlckRyYWdnZXIpIHRoaXMuc3VwZXJEcmFnZ2VyLmRlc3Ryb3koKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwib25MZWF2ZUNvbXBsZXRlZFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvbkxlYXZlQ29tcGxldGVkKCkge1xuICAgICAgdGhpcy5hZnRlckxlYXZlKCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImFmdGVyTGVhdmVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gYWZ0ZXJMZWF2ZSgpIHt9IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcblxuICB9XSk7XG5cbiAgcmV0dXJuIFJlbmRlcmVyO1xufShIaWdod2F5LlJlbmRlcmVyKTsgLy8gRG9uYHQgZm9yZ2V0IHRvIGV4cG9ydCB5b3VyIHJlbmRlcmVyXG5cblxuZXhwb3J0IGRlZmF1bHQgUmVuZGVyZXI7IiwiZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgXCJAYmFiZWwvaGVscGVycyAtIHR5cGVvZlwiOyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2Yob2JqKTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvblwiKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9XG5cbmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVTdXBlcihEZXJpdmVkKSB7IHZhciBoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0ID0gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpOyByZXR1cm4gZnVuY3Rpb24gX2NyZWF0ZVN1cGVySW50ZXJuYWwoKSB7IHZhciBTdXBlciA9IF9nZXRQcm90b3R5cGVPZihEZXJpdmVkKSwgcmVzdWx0OyBpZiAoaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCkgeyB2YXIgTmV3VGFyZ2V0ID0gX2dldFByb3RvdHlwZU9mKHRoaXMpLmNvbnN0cnVjdG9yOyByZXN1bHQgPSBSZWZsZWN0LmNvbnN0cnVjdChTdXBlciwgYXJndW1lbnRzLCBOZXdUYXJnZXQpOyB9IGVsc2UgeyByZXN1bHQgPSBTdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9IHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCByZXN1bHQpOyB9OyB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikpIHsgcmV0dXJuIGNhbGw7IH0gZWxzZSBpZiAoY2FsbCAhPT0gdm9pZCAwKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJEZXJpdmVkIGNvbnN0cnVjdG9ycyBtYXkgb25seSByZXR1cm4gb2JqZWN0IG9yIHVuZGVmaW5lZFwiKTsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfVxuXG5mdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIHNlbGY7IH1cblxuZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcInVuZGVmaW5lZFwiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiB0cnVlOyB0cnkgeyBCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoQm9vbGVhbiwgW10sIGZ1bmN0aW9uICgpIHt9KSk7IHJldHVybiB0cnVlOyB9IGNhdGNoIChlKSB7IHJldHVybiBmYWxzZTsgfSB9XG5cbmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH1cblxuLy8gR3NhcFxuaW1wb3J0IGdzYXAgZnJvbSAnZ3NhcCc7XG5pbXBvcnQgU2Nyb2xsVHJpZ2dlciBmcm9tICdnc2FwL1Njcm9sbFRyaWdnZXInO1xuZ3NhcC5yZWdpc3RlclBsdWdpbihTY3JvbGxUcmlnZ2VyKTsgLy8gSW1wb3J0IFJlbmRlcmVyXG5cbmltcG9ydCBSZW5kZXJlciBmcm9tICcuL3JlbmRlcmVyLmpzJzsgLy8gaW1wb3J0IHN0eWxlc0RlZmF1bHQgZnJvbSAnLi9zdHlsZXNEZWZhdWx0LmNzcyc7IC8vZXNsaW50LWRpc2FibGUtbGluZVxuLy8gVXRpbGl0aWVzXG5cbmltcG9ydCBEb21FdmVudHMgZnJvbSAnLi4vY2xhc3Nlcy9kb21FdmVudHMnO1xuaW1wb3J0IFN1cGVyU2Nyb2xsZXIgZnJvbSAnLi4vY2xhc3Nlcy9zdXBlclNjcm9sbGVyJzsgLy8gT3RoZXJcbi8vIGltcG9ydCBTbGlkZXIgZnJvbSAnLi4vY2xhc3Nlcy9zbGlkZXInO1xuLy8gaW1wb3J0IFNwbGl0VGV4dCBmcm9tICcuLi9jbGFzc2VzL3NwbGl0VGV4dCc7XG5cbnZhciBSZW5kZXJlckRlZmF1bHQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9SZW5kZXJlcikge1xuICBfaW5oZXJpdHMoUmVuZGVyZXJEZWZhdWx0LCBfUmVuZGVyZXIpO1xuXG4gIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoUmVuZGVyZXJEZWZhdWx0KTtcblxuICBmdW5jdGlvbiBSZW5kZXJlckRlZmF1bHQoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJlbmRlcmVyRGVmYXVsdCk7XG5cbiAgICByZXR1cm4gX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoUmVuZGVyZXJEZWZhdWx0LCBbe1xuICAgIGtleTogXCJzZWxlY3RvcnNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2VsZWN0b3JzKCkge30gLy8gZXNsaW50LWRpc2FibGUtbGluZVxuXG4gIH0sIHtcbiAgICBrZXk6IFwiZXZlbnRzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGV2ZW50cygpIHt9IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcblxuICB9LCB7XG4gICAga2V5OiBcImJlZm9yZUVudGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGJlZm9yZUVudGVyKCkge30gLy8gZXNsaW50LWRpc2FibGUtbGluZVxuXG4gIH0sIHtcbiAgICBrZXk6IFwiZW50ZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZW50ZXIoKSB7fSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG5cbiAgfSwge1xuICAgIGtleTogXCJyYWZcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmFmKCkge30gLy8gZXNsaW50LWRpc2FibGUtbGluZVxuXG4gIH1dKTtcblxuICByZXR1cm4gUmVuZGVyZXJEZWZhdWx0O1xufShSZW5kZXJlcik7IC8vIERvbmB0IGZvcmdldCB0byBleHBvcnQgeW91ciByZW5kZXJlclxuXG5cbmV4cG9ydCBkZWZhdWx0IFJlbmRlcmVyRGVmYXVsdDsiLCJmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG5cbmltcG9ydCB7IGdzYXAgfSBmcm9tICdnc2FwJzsgLy9lbXB0eSBmdW5jdGlvblxuXG52YXIgbm9vcCA9IGZ1bmN0aW9uIG5vb3AoKSB7fTsgLy9lc2xpbnQtZGlzYWJsZS1saW5lXG5cblxudmFyIGxlcnAgPSBmdW5jdGlvbiBsZXJwKGEsIGIsIG4pIHtcbiAgcmV0dXJuICgxIC0gbikgKiBhICsgbiAqIGI7XG59O1xuXG52YXIgX2RlZmF1bHQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBfZGVmYXVsdChvcHRpb25zKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBfZGVmYXVsdCk7XG5cbiAgICAvL2hvb2sgZnVuY3Rpb25zXG4gICAgdGhpcy5fb25SYWYgPSBvcHRpb25zLm9uUmFmIHx8IG5vb3A7XG4gICAgdGhpcy5fb25Nb3VzZUVudGVyID0gb3B0aW9ucy5vbk1vdXNlRW50ZXIgfHwgbm9vcDtcbiAgICB0aGlzLl9vbk1vdXNlTGVhdmUgPSBvcHRpb25zLm9uTW91c2VMZWF2ZSB8fCBub29wO1xuICAgIHRoaXMuX29uRHJhZ1N0YXJ0ID0gb3B0aW9ucy5vbkRyYWdTdGFydCB8fCBub29wO1xuICAgIHRoaXMuX29uRHJhZ01vdmUgPSBvcHRpb25zLm9uRHJhZ01vdmUgfHwgbm9vcDtcbiAgICB0aGlzLl9vbkRyYWdFbmQgPSBvcHRpb25zLm9uRHJhZ0VuZCB8fCBub29wO1xuICAgIHRoaXMuX29uU25hcCA9IG9wdGlvbnMub25TbmFwIHx8IG5vb3A7XG4gICAgdGhpcy5fb25TbmFwTGltaXRzID0gb3B0aW9ucy5fb25TbmFwTGltaXRzIHx8IG5vb3A7XG4gICAgdGhpcy5yQUYgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5fZHJhZyA9IHtcbiAgICAgIGVuYWJsZTogdHlwZW9mIG9wdGlvbnMuZW5hYmxlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuZW5hYmxlIDogdHJ1ZSxcbiAgICAgIGVsOiBvcHRpb25zLmVsLFxuICAgICAgZWxDbGlja2FibGVzOiBvcHRpb25zLmVsQ2xpY2thYmxlcyB8fCBbXSxcbiAgICAgIGlubmVyOiBvcHRpb25zLmlubmVyIHx8IG9wdGlvbnMuZWwuY2hpbGRyZW5bMF0sXG4gICAgICBlYXNlOiBvcHRpb25zLmVhc2UgfHwgMC4xLFxuICAgICAgc3BlZWQ6IG9wdGlvbnMuc3BlZWQgfHwgMixcbiAgICAgIGRyYWdnaW5nOiBmYWxzZSxcbiAgICAgIHdpZHRoOiAwLFxuICAgICAgaGVpZ2h0OiAwLFxuICAgICAgdmVsb2NpdHk6IDAsXG4gICAgICBkaXJlY3Rpb246IDAsXG4gICAgICBvbjoge1xuICAgICAgICB4OiAwLFxuICAgICAgICB5OiAwXG4gICAgICB9LFxuICAgICAgb2ZmOiB7XG4gICAgICAgIHg6IDAsXG4gICAgICAgIHk6IDBcbiAgICAgIH0sXG4gICAgICBvZmZzZXQ6IHtcbiAgICAgICAgeDogMCxcbiAgICAgICAgeTogMFxuICAgICAgfSxcbiAgICAgIG1vdmVtZW50OiB7XG4gICAgICAgIHg6IDAsXG4gICAgICAgIHk6IDBcbiAgICAgIH0sXG4gICAgICBwb3NpdGlvbjoge1xuICAgICAgICB4OiAwLFxuICAgICAgICB5OiAwXG4gICAgICB9LFxuICAgICAgbGFzdFBvc2l0aW9uOiB7XG4gICAgICAgIHg6IDAsXG4gICAgICAgIHk6IDBcbiAgICAgIH0sXG4gICAgICBsaXZlUG9zaXRpb246IHtcbiAgICAgICAgeDogMCxcbiAgICAgICAgeTogMFxuICAgICAgfSxcbiAgICAgIG1pbjoge1xuICAgICAgICB4OiAwLFxuICAgICAgICB5OiAwXG4gICAgICB9LFxuICAgICAgbWF4OiB7XG4gICAgICAgIHg6IDAsXG4gICAgICAgIHk6IDBcbiAgICAgIH0sXG4gICAgICB0b3RhbDogMCxcbiAgICAgIHNuYXA6IHR5cGVvZiBvcHRpb25zLnNuYXAgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5zbmFwIDogZmFsc2UsXG4gICAgICBzbmFwUG9zaXRpb25zOiBbXSxcbiAgICAgIHNuYXBMaW1pdHM6IFtdLFxuICAgICAgc25hcEFuaW1hdGluZzogZmFsc2UsXG4gICAgICBpbmVydGlhOiB0eXBlb2Ygb3B0aW9ucy5pbmVydGlhICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuaW5lcnRpYSA6IDAuNCxcbiAgICAgIGVsYXN0aWNpdHk6IHR5cGVvZiBvcHRpb25zLmVsYXN0aWNpdHkgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5lbGFzdGljaXR5IDogZmFsc2UsXG4gICAgICBlbGFzdGljaXR5VHlwZTogdHlwZW9mIG9wdGlvbnMuZWxhc3RpY2l0eVR5cGUgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5lbGFzdGljaXR5VHlwZSA6IDFcbiAgICB9O1xuICAgIGlmICh0aGlzLl9kcmFnLnNuYXAgJiYgdGhpcy5fZHJhZy5pbmVydGlhID09PSAwKSB0aHJvdyBFcnJvcignSWYgc25hcCBpcyB0cnVlLCBpbmVydGlhIHNob3VsZCBiZSBncmVhdCB0aGFuIDAnKTtcblxuICAgIHRoaXMucmFmID0gZnVuY3Rpb24gKCkge1xuICAgICAgX3RoaXMuX29uUmFmKF90aGlzLl9kcmFnKTsgLy9Nb3ZlIGlubmVyXG5cblxuICAgICAgX3RoaXMuX2RyYWcubGl2ZVBvc2l0aW9uLnggPSBsZXJwKF90aGlzLl9kcmFnLmxpdmVQb3NpdGlvbi54LCBfdGhpcy5fZHJhZy5wb3NpdGlvbi54LCBfdGhpcy5fZHJhZy5lYXNlKTtcbiAgICAgIF90aGlzLiRkcmFnSW5uZXIuc3R5bGUudHJhbnNmb3JtID0gXCJ0cmFuc2xhdGUzZChcIi5jb25jYXQoX3RoaXMuX2RyYWcubGl2ZVBvc2l0aW9uLngsIFwicHgsIDAsIDApXCIpO1xuXG4gICAgICBpZiAoX3RoaXMuX2RyYWcuZWxhc3RpY2l0eSkge1xuICAgICAgICAvL0NoZWNrIHZlbG9jaXR5XG4gICAgICAgIHZhciBtb3ZlbWVudFggPSBNYXRoLmFicyhfdGhpcy5fZHJhZy5saXZlUG9zaXRpb24ueCAtIF90aGlzLl9kcmFnLnBvc2l0aW9uLngpO1xuICAgICAgICB2YXIgbW92ZW1lbnQgPSBNYXRoLnNxcnQobW92ZW1lbnRYICogbW92ZW1lbnRYICsgbW92ZW1lbnRYICogbW92ZW1lbnRYKTtcbiAgICAgICAgdmFyIHZlbG9jaXR5ID0gbW92ZW1lbnQgLyAxMDtcbiAgICAgICAgX3RoaXMuX2RyYWcudmVsb2NpdHkgPSBsZXJwKF90aGlzLl9kcmFnLnZlbG9jaXR5LCB2ZWxvY2l0eSwgX3RoaXMuX2RyYWcuZWFzZSAqIDIpOyAvL0RvIGVsYXN0aWNpdHlcblxuICAgICAgICB2YXIgZWxhc3RpY2l0eSA9IF90aGlzLl9kcmFnLnZlbG9jaXR5ICogLV90aGlzLl9kcmFnLmRpcmVjdGlvbjtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IF90aGlzLiRkcmFnSXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBpZiAoX3RoaXMuX2RyYWcuZWxhc3RpY2l0eVR5cGUgPT09IDEgPyBfdGhpcy5fZHJhZy5kaXJlY3Rpb24gPCAwIDogX3RoaXMuX2RyYWcuZGlyZWN0aW9uID4gMCkgX3RoaXMuJGRyYWdJdGVtc1tpXS5zdHlsZS50cmFuc2Zvcm0gPSBcInRyYW5zbGF0ZTNkKFwiLmNvbmNhdChpICogZWxhc3RpY2l0eSwgXCJweCwgMCwgMClcIik7ZWxzZSBfdGhpcy4kZHJhZ0l0ZW1zW2ldLnN0eWxlLnRyYW5zZm9ybSA9IFwidHJhbnNsYXRlM2QoXCIuY29uY2F0KChfdGhpcy4kZHJhZ0l0ZW1zLmxlbmd0aCAtIGkpICogZWxhc3RpY2l0eSwgXCJweCwgMCwgMClcIik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5zZWxlY3RvcnMoKTtcbiAgICB0aGlzLmluaXQoKTtcbiAgfVxuXG4gIF9jcmVhdGVDbGFzcyhfZGVmYXVsdCwgW3tcbiAgICBrZXk6IFwic2VsZWN0b3JzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNlbGVjdG9ycygpIHtcbiAgICAgIHRoaXMuJGRyYWcgPSB0aGlzLl9kcmFnLmVsO1xuICAgICAgdGhpcy4kZHJhZ0lubmVyID0gdGhpcy5fZHJhZy5pbm5lcjtcbiAgICAgIHRoaXMuJGRyYWdJdGVtcyA9IHRoaXMuX2RyYWcuaW5uZXIuY2hpbGRyZW47XG4gICAgICB0aGlzLiRkcmFnQ2xpY2thYmxlcyA9IHRoaXMuX2RyYWcuZWxDbGlja2FibGVzO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJpbml0XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgdGhpcy5zZXRCb3VuZHMoKTsgLy9hZGQgcmVxdWVzdEFuaW1hdGlvbkZyYW1lXG5cbiAgICAgIGdzYXAudGlja2VyLmFkZCh0aGlzLnJhZik7IC8vYWRkIGV2ZW50c1xuICAgICAgLy90aGlzLiRkcmFnSW5uZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4geyB0aGlzLmNsaWNrKGUpOyB9KTtcblxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLiRkcmFnQ2xpY2thYmxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLiRkcmFnQ2xpY2thYmxlc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgX3RoaXMyLmNsaWNrKGUpO1xuICAgICAgICB9LCB0cnVlKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy4kZHJhZ0lubmVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIF90aGlzMi5vbihlKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy4kZHJhZy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgX3RoaXMyLmVudGVyKGUpO1xuICAgICAgfSk7XG4gICAgICB0aGlzLiRkcmFnLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBfdGhpczIubGVhdmUoZSk7XG4gICAgICB9KTtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIF90aGlzMi5tb3ZlKGUpO1xuICAgICAgfSk7XG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgX3RoaXMyLm9mZihlKTtcbiAgICAgIH0pO1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgX3RoaXMyLnJlc2l6ZShlKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzZXRCb3VuZHNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0Qm91bmRzKCkge1xuICAgICAgdmFyIGRyYWdCb3VuZGluZyA9IHRoaXMuJGRyYWcuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICB2YXIgZHJhZ0lubmVyQm91bmRpbmcgPSB0aGlzLiRkcmFnSW5uZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICB0aGlzLl9kcmFnLndpZHRoID0gZHJhZ0JvdW5kaW5nLndpZHRoO1xuICAgICAgdGhpcy5fZHJhZy5oZWlnaHQgPSBkcmFnQm91bmRpbmcuaGVpZ2h0O1xuICAgICAgdGhpcy5fZHJhZy5taW4ueCA9IGRyYWdCb3VuZGluZy53aWR0aCAtIGRyYWdJbm5lckJvdW5kaW5nLndpZHRoO1xuICAgICAgdGhpcy5fZHJhZy5tYXgueCA9IDA7XG4gICAgICB0aGlzLl9kcmFnLm9mZnNldC54ID0gZHJhZ0JvdW5kaW5nLng7IC8vQ2hlY2sgbGltaXRzIGZvciBpbmVydGlhXG5cbiAgICAgIHRoaXMuX2RyYWcuc25hcExpbWl0cy5wdXNoKDApO1xuXG4gICAgICB0aGlzLl9kcmFnLnNuYXBMaW1pdHMucHVzaChkcmFnQm91bmRpbmcud2lkdGggLSBkcmFnSW5uZXJCb3VuZGluZy53aWR0aCk7XG5cbiAgICAgIGlmICh0aGlzLl9kcmFnLnNuYXApIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLiRkcmFnSXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB2YXIgYm91bmRzID0gdGhpcy4kZHJhZ0l0ZW1zW2ldLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICAgIHZhciBzbmFwID0gYm91bmRzLnggLSB0aGlzLl9kcmFnLm9mZnNldC54O1xuXG4gICAgICAgICAgdGhpcy5fZHJhZy5zbmFwUG9zaXRpb25zLnB1c2goLXNuYXApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImNsaWNrXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNsaWNrKGUpIHtcbiAgICAgIGlmIChNYXRoLmFicyh0aGlzLl9kcmFnLm9uLnggLSB0aGlzLl9kcmFnLm9mZi54KSA+IDEwKSB7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiZW50ZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZW50ZXIoKSB7XG4gICAgICB0aGlzLl9vbk1vdXNlRW50ZXIoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwib25cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gb24oZSkge1xuICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgIHRoaXMuX2RyYWcuZHJhZ2dpbmcgPSB0cnVlO1xuICAgICAgdGhpcy5fZHJhZy5vbi54ID0gZS5jbGllbnRYO1xuICAgICAgdGhpcy5vblRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3RoaXMzLl9vbkRyYWdTdGFydCgpO1xuXG4gICAgICAgIF90aGlzMy4kZHJhZy5jbGFzc0xpc3QuYWRkKCdpcy0tZHJhZ2dpbmcnKTtcbiAgICAgIH0sIDEyMCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIm1vdmVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gbW92ZShlKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBpZiAoIXRoaXMuX2RyYWcuZHJhZ2dpbmcgfHwgIXRoaXMuX2RyYWcuZW5hYmxlKSByZXR1cm47XG5cbiAgICAgIHRoaXMuX29uRHJhZ01vdmUoKTtcblxuICAgICAgdGhpcy5fZHJhZy5tb3ZlbWVudCA9IGUuY2xpZW50WCAtIHRoaXMuX2RyYWcub24ueDtcbiAgICAgIHRoaXMuX2RyYWcuZGlyZWN0aW9uID0gTWF0aC5zaWduKGUuY2xpZW50WCAtIHRoaXMuX2RyYWcub24ueCk7XG4gICAgICB0aGlzLl9kcmFnLnBvc2l0aW9uLnggPSB0aGlzLl9kcmFnLmxhc3RQb3NpdGlvbi54ICsgZS5jbGllbnRYIC0gdGhpcy5fZHJhZy5vbi54O1xuICAgICAgdGhpcy5fZHJhZy5wb3NpdGlvbi54ID0gTWF0aC5taW4odGhpcy5fZHJhZy5tYXgueCArIHRoaXMuX2RyYWcud2lkdGggLyA0ICogdGhpcy5fZHJhZy5pbmVydGlhLCBNYXRoLm1heCh0aGlzLl9kcmFnLnBvc2l0aW9uLngsIHRoaXMuX2RyYWcubWluLnggLSB0aGlzLl9kcmFnLndpZHRoIC8gNCAqIHRoaXMuX2RyYWcuaW5lcnRpYSkpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJvZmZcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gb2ZmKGUpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLm9uVGltZW91dCk7XG4gICAgICBpZiAoIXRoaXMuX2RyYWcuZHJhZ2dpbmcpIHJldHVybjtcbiAgICAgIHRoaXMuX2RyYWcuZHJhZ2dpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMuX2RyYWcub2ZmLnggPSBlLmNsaWVudFg7XG4gICAgICB0aGlzLl9kcmFnLmxhc3RQb3NpdGlvbi54ID0gdGhpcy5fZHJhZy5wb3NpdGlvbi54O1xuXG4gICAgICB0aGlzLl9vbkRyYWdFbmQoKTtcblxuICAgICAgdGhpcy4kZHJhZy5jbGFzc0xpc3QucmVtb3ZlKCdpcy0tZHJhZ2dpbmcnKTtcblxuICAgICAgaWYgKHRoaXMuX2RyYWcucG9zaXRpb24ueCA+IDAgfHwgdGhpcy5fZHJhZy5wb3NpdGlvbi54IDwgdGhpcy5fZHJhZy5taW4ueCkge1xuICAgICAgICB0aGlzLnNuYXBMaW1pdHMoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh0aGlzLl9kcmFnLnNuYXApIHRoaXMuc25hcCgpO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJsZWF2ZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBsZWF2ZSgpIHtcbiAgICAgIHRoaXMuX29uTW91c2VMZWF2ZSgpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzbmFwXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNuYXAoKSB7XG4gICAgICAvL3RoaXMuX2RyYWcuc25hcEFuaW1hdGluZyA9IHRydWU7XG4gICAgICB2YXIgZ29hbCA9IHRoaXMuX2RyYWcucG9zaXRpb24ueDtcblxuICAgICAgdmFyIGNsb3Nlc3QgPSB0aGlzLl9kcmFnLnNuYXBQb3NpdGlvbnMucmVkdWNlKGZ1bmN0aW9uIChwcmV2LCBjdXJyKSB7XG4gICAgICAgIHJldHVybiBNYXRoLmFicyhjdXJyIC0gZ29hbCkgPCBNYXRoLmFicyhwcmV2IC0gZ29hbCkgPyBjdXJyIDogcHJldjtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9kcmFnLnBvc2l0aW9uLnggPSBjbG9zZXN0O1xuICAgICAgdGhpcy5fZHJhZy5sYXN0UG9zaXRpb24ueCA9IGNsb3Nlc3Q7XG5cbiAgICAgIHRoaXMuX29uU25hcCgpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzbmFwTGltaXRzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNuYXBMaW1pdHMoKSB7XG4gICAgICAvL3RoaXMuX2RyYWcuc25hcEFuaW1hdGluZyA9IHRydWU7XG4gICAgICB2YXIgZ29hbCA9IHRoaXMuX2RyYWcucG9zaXRpb24ueDtcblxuICAgICAgdmFyIGNsb3Nlc3QgPSB0aGlzLl9kcmFnLnNuYXBMaW1pdHMucmVkdWNlKGZ1bmN0aW9uIChwcmV2LCBjdXJyKSB7XG4gICAgICAgIHJldHVybiBNYXRoLmFicyhjdXJyIC0gZ29hbCkgPCBNYXRoLmFicyhwcmV2IC0gZ29hbCkgPyBjdXJyIDogcHJldjtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9kcmFnLnBvc2l0aW9uLnggPSBjbG9zZXN0O1xuICAgICAgdGhpcy5fZHJhZy5sYXN0UG9zaXRpb24ueCA9IGNsb3Nlc3Q7XG5cbiAgICAgIHRoaXMuX29uU25hcExpbWl0cygpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJsZXJwXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGxlcnAodmFsdWUxLCB2YWx1ZTIsIGFtb3VudCkge1xuICAgICAgYW1vdW50ID0gYW1vdW50IDwgMCA/IDAgOiBhbW91bnQ7XG4gICAgICBhbW91bnQgPSBhbW91bnQgPiAxID8gMSA6IGFtb3VudDtcbiAgICAgIHJldHVybiB2YWx1ZTEgKyAodmFsdWUyIC0gdmFsdWUxKSAqIGFtb3VudDtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmVzaXplXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2l6ZSgpIHtcbiAgICAgIHRoaXMuc2V0Qm91bmRzKCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImRlc3Ryb3lcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgIC8vZW1wdHkgb3B0aW9uc1xuICAgICAgdGhpcy5fZHJhZyA9IHt9OyAvL3JlbW92ZSByZXF1ZXN0QW5pbWF0aW9uRnJhbWVcblxuICAgICAgZ3NhcC50aWNrZXIucmVtb3ZlKHRoaXMucmFmKTsgLy9SZW1vdmUgZXZlbnRzXG5cbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMub24pO1xuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5yZXNpemUpO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBfZGVmYXVsdDtcbn0oKTtcblxuZXhwb3J0IHsgX2RlZmF1bHQgYXMgZGVmYXVsdCB9OyIsImZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLyohXG4gKiBWZWxvY2l0eVRyYWNrZXI6IDMuNi4xXG4gKiBodHRwczovL2dyZWVuc29jay5jb21cbiAqXG4gKiBDb3B5cmlnaHQgMjAwOC0yMDIxLCBHcmVlblNvY2suIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiBTdWJqZWN0IHRvIHRoZSB0ZXJtcyBhdCBodHRwczovL2dyZWVuc29jay5jb20vc3RhbmRhcmQtbGljZW5zZSBvciBmb3JcbiAqIENsdWIgR3JlZW5Tb2NrIG1lbWJlcnMsIHRoZSBhZ3JlZW1lbnQgaXNzdWVkIHdpdGggdGhhdCBtZW1iZXJzaGlwLlxuICogQGF1dGhvcjogSmFjayBEb3lsZSwgamFja0BncmVlbnNvY2suY29tXG4qL1xuXG4vKiBlc2xpbnQtZGlzYWJsZSAqL1xudmFyIGdzYXAsXG4gICAgX2NvcmVJbml0dGVkLFxuICAgIF90b0FycmF5LFxuICAgIF9nZXRVbml0LFxuICAgIF9maXJzdCxcbiAgICBfdGlja2VyLFxuICAgIF90aW1lMSxcbiAgICBfdGltZTIsXG4gICAgX2dldENhY2hlLFxuICAgIF9nZXRHU0FQID0gZnVuY3Rpb24gX2dldEdTQVAoKSB7XG4gIHJldHVybiBnc2FwIHx8IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgJiYgKGdzYXAgPSB3aW5kb3cuZ3NhcCk7XG59LFxuICAgIF9sb29rdXAgPSB7fSxcbiAgICBfcm91bmQgPSBmdW5jdGlvbiBfcm91bmQodmFsdWUpIHtcbiAgcmV0dXJuIE1hdGgucm91bmQodmFsdWUgKiAxMDAwMCkgLyAxMDAwMDtcbn0sXG4gICAgX2dldElEID0gZnVuY3Rpb24gX2dldElEKHRhcmdldCkge1xuICByZXR1cm4gX2dldENhY2hlKHRhcmdldCkuaWQ7XG59LFxuICAgIF9nZXRCeVRhcmdldCA9IGZ1bmN0aW9uIF9nZXRCeVRhcmdldCh0YXJnZXQpIHtcbiAgcmV0dXJuIF9sb29rdXBbX2dldElEKHR5cGVvZiB0YXJnZXQgPT09IFwic3RyaW5nXCIgPyBfdG9BcnJheSh0YXJnZXQpWzBdIDogdGFyZ2V0KV07XG59LFxuICAgIF9vblRpY2sgPSBmdW5jdGlvbiBfb25UaWNrKHRpbWUpIHtcbiAgdmFyIHB0ID0gX2ZpcnN0LFxuICAgICAgdmFsOyAvL2lmIHRoZSBmcmFtZSByYXRlIGlzIHRvbyBoaWdoLCB3ZSB3b24ndCBiZSBhYmxlIHRvIHRyYWNrIHRoZSB2ZWxvY2l0eSBhcyB3ZWxsLCBzbyBvbmx5IHVwZGF0ZSB0aGUgdmFsdWVzIGFib3V0IDIwIHRpbWVzIHBlciBzZWNvbmRcblxuICBpZiAodGltZSAtIF90aW1lMSA+PSAwLjA1KSB7XG4gICAgX3RpbWUyID0gX3RpbWUxO1xuICAgIF90aW1lMSA9IHRpbWU7XG5cbiAgICB3aGlsZSAocHQpIHtcbiAgICAgIHZhbCA9IHB0LmcocHQudCwgcHQucCk7XG5cbiAgICAgIGlmICh2YWwgIT09IHB0LnYxIHx8IHRpbWUgLSBwdC50MSA+IDAuMikge1xuICAgICAgICAvL3VzZSBhIHRocmVzaG9sZCBvZiAwLjIgc2Vjb25kcyBmb3IgemVyb2luZy1vdXQgdmVsb2NpdHkuIElmIHdlIG9ubHkgdXNlIDAuMDUgYW5kIHRoaW5ncyB1cGRhdGUgc2xpZ2h0bHkgc2xvd2VyLCBsaWtlIHNvbWUgQW5kcm9pZCBkZXZpY2VzIGRpc3BhdGNoIFwidG91Y2htb3ZlXCIgZXZlbnRzIHNsdWdnaXNobHkgc28gMiBvciAzIHRpY2tzIG9mIHRoZSBnc2FwLnRpY2tlciBtYXkgZWxhcHNlIGluYmV0d2VlbiwgdGh1cyBpdCBtYXkgYXBwZWFyIGxpa2UgdGhlIG9iamVjdCBpcyBub3QgbW92aW5nIGJ1dCBpdCBhY3R1YWxseSBpcyBidXQgaXQncyBub3QgdXBkYXRpbmcgYXMgZnJlcXVlbnRseS4gQSB0aHJlc2hvbGQgb2YgMC4yIHNlY29uZHMgc2VlbXMgdG8gYmUgYSBnb29kIGJhbGFuY2UuIFdlIHdhbnQgdG8gdXBkYXRlIHRoaW5ncyBmcmVxdWVudGx5ICgwLjA1IHNlY29uZHMpIHdoZW4gdGhleSdyZSBtb3Zpbmcgc28gdGhhdCB3ZSBjYW4gcmVzcG9uZCB0byBmYXN0IG1vdGlvbnMgYWNjdXJhdGVseSwgYnV0IHdlIHdhbnQgdG8gYmUgbW9yZSByZXNpc3RhbnQgdG8gZ28gYmFjayB0byBhIHplcm8gdmVsb2NpdHkuXG4gICAgICAgIHB0LnYyID0gcHQudjE7XG4gICAgICAgIHB0LnYxID0gdmFsO1xuICAgICAgICBwdC50MiA9IHB0LnQxO1xuICAgICAgICBwdC50MSA9IHRpbWU7XG4gICAgICB9XG5cbiAgICAgIHB0ID0gcHQuX25leHQ7XG4gICAgfVxuICB9XG59LFxuICAgIF90eXBlcyA9IHtcbiAgZGVnOiAzNjAsXG4gIHJhZDogTWF0aC5QSSAqIDJcbn0sXG4gICAgX2luaXRDb3JlID0gZnVuY3Rpb24gX2luaXRDb3JlKCkge1xuICBnc2FwID0gX2dldEdTQVAoKTtcblxuICBpZiAoZ3NhcCkge1xuICAgIF90b0FycmF5ID0gZ3NhcC51dGlscy50b0FycmF5O1xuICAgIF9nZXRVbml0ID0gZ3NhcC51dGlscy5nZXRVbml0O1xuICAgIF9nZXRDYWNoZSA9IGdzYXAuY29yZS5nZXRDYWNoZTtcbiAgICBfdGlja2VyID0gZ3NhcC50aWNrZXI7XG4gICAgX2NvcmVJbml0dGVkID0gMTtcbiAgfVxufTtcblxudmFyIFByb3BUcmFja2VyID0gZnVuY3Rpb24gUHJvcFRyYWNrZXIodGFyZ2V0LCBwcm9wZXJ0eSwgdHlwZSwgbmV4dCkge1xuICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUHJvcFRyYWNrZXIpO1xuXG4gIHRoaXMudCA9IHRhcmdldDtcbiAgdGhpcy5wID0gcHJvcGVydHk7XG4gIHRoaXMuZyA9IHRhcmdldC5fZ3NhcC5nZXQ7XG4gIHRoaXMuckNhcCA9IF90eXBlc1t0eXBlIHx8IF9nZXRVbml0KHRoaXMuZyh0YXJnZXQsIHByb3BlcnR5KSldOyAvL3JvdGF0aW9uYWwgY2FwIChmb3IgZGVncmVlcywgXCJkZWdcIiwgaXQncyAzNjAgYW5kIGZvciByYWRpYW5zLCBcInJhZFwiLCBpdCdzIE1hdGguUEkgKiAyKVxuXG4gIHRoaXMudjEgPSB0aGlzLnYyID0gMDtcbiAgdGhpcy50MSA9IHRoaXMudDIgPSBfdGlja2VyLnRpbWU7XG5cbiAgaWYgKG5leHQpIHtcbiAgICB0aGlzLl9uZXh0ID0gbmV4dDtcbiAgICBuZXh0Ll9wcmV2ID0gdGhpcztcbiAgfVxufTtcblxuZXhwb3J0IHZhciBWZWxvY2l0eVRyYWNrZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBWZWxvY2l0eVRyYWNrZXIodGFyZ2V0LCBwcm9wZXJ0eSkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBWZWxvY2l0eVRyYWNrZXIpO1xuXG4gICAgaWYgKCFfY29yZUluaXR0ZWQpIHtcbiAgICAgIF9pbml0Q29yZSgpO1xuICAgIH1cblxuICAgIHRoaXMudGFyZ2V0ID0gX3RvQXJyYXkodGFyZ2V0KVswXTtcbiAgICBfbG9va3VwW19nZXRJRCh0aGlzLnRhcmdldCldID0gdGhpcztcbiAgICB0aGlzLl9wcm9wcyA9IHt9O1xuICAgIHByb3BlcnR5ICYmIHRoaXMuYWRkKHByb3BlcnR5KTtcbiAgfVxuXG4gIF9jcmVhdGVDbGFzcyhWZWxvY2l0eVRyYWNrZXIsIFt7XG4gICAga2V5OiBcImdldFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBnZXQocHJvcGVydHksIHNraXBSZWNlbnRUaWNrKSB7XG4gICAgICB2YXIgcHQgPSB0aGlzLl9wcm9wc1twcm9wZXJ0eV0gfHwgY29uc29sZS53YXJuKFwiTm90IHRyYWNraW5nIFwiICsgcHJvcGVydHkgKyBcIiB2ZWxvY2l0eS5cIiksXG4gICAgICAgICAgdmFsLFxuICAgICAgICAgIGRpZixcbiAgICAgICAgICByb3RhdGlvbkNhcDtcbiAgICAgIHZhbCA9IHBhcnNlRmxvYXQoc2tpcFJlY2VudFRpY2sgPyBwdC52MSA6IHB0LmcocHQudCwgcHQucCkpO1xuICAgICAgZGlmID0gdmFsIC0gcGFyc2VGbG9hdChwdC52Mik7XG4gICAgICByb3RhdGlvbkNhcCA9IHB0LnJDYXA7XG5cbiAgICAgIGlmIChyb3RhdGlvbkNhcCkge1xuICAgICAgICAvL3JvdGF0aW9uYWwgdmFsdWVzIG5lZWQgc3BlY2lhbCBpbnRlcnByZXRhdGlvbiBzbyB0aGF0IGlmLCBmb3IgZXhhbXBsZSwgdGhleSBnbyBmcm9tIDE3OSB0byAtMTc4IGRlZ3JlZXMgaXQgaXMgaW50ZXJwcmV0ZWQgYXMgYSBjaGFuZ2Ugb2YgMyBpbnN0ZWFkIG9mIC0zNTcuXG4gICAgICAgIGRpZiA9IGRpZiAlIHJvdGF0aW9uQ2FwO1xuXG4gICAgICAgIGlmIChkaWYgIT09IGRpZiAlIChyb3RhdGlvbkNhcCAvIDIpKSB7XG4gICAgICAgICAgZGlmID0gZGlmIDwgMCA/IGRpZiArIHJvdGF0aW9uQ2FwIDogZGlmIC0gcm90YXRpb25DYXA7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIF9yb3VuZChkaWYgLyAoKHNraXBSZWNlbnRUaWNrID8gcHQudDEgOiBfdGlja2VyLnRpbWUpIC0gcHQudDIpKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiZ2V0QWxsXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGdldEFsbCgpIHtcbiAgICAgIHZhciByZXN1bHQgPSB7fSxcbiAgICAgICAgICBwcm9wcyA9IHRoaXMuX3Byb3BzLFxuICAgICAgICAgIHA7XG5cbiAgICAgIGZvciAocCBpbiBwcm9wcykge1xuICAgICAgICByZXN1bHRbcF0gPSB0aGlzLmdldChwKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiaXNUcmFja2luZ1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpc1RyYWNraW5nKHByb3BlcnR5KSB7XG4gICAgICByZXR1cm4gcHJvcGVydHkgaW4gdGhpcy5fcHJvcHM7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImFkZFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBhZGQocHJvcGVydHksIHR5cGUpIHtcbiAgICAgIGlmICghKHByb3BlcnR5IGluIHRoaXMuX3Byb3BzKSkge1xuICAgICAgICBpZiAoIV9maXJzdCkge1xuICAgICAgICAgIF90aWNrZXIuYWRkKF9vblRpY2spO1xuXG4gICAgICAgICAgX3RpbWUxID0gX3RpbWUyID0gX3RpY2tlci50aW1lO1xuICAgICAgICB9XG5cbiAgICAgICAgX2ZpcnN0ID0gdGhpcy5fcHJvcHNbcHJvcGVydHldID0gbmV3IFByb3BUcmFja2VyKHRoaXMudGFyZ2V0LCBwcm9wZXJ0eSwgdHlwZSwgX2ZpcnN0KTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmVtb3ZlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZShwcm9wZXJ0eSkge1xuICAgICAgdmFyIHB0ID0gdGhpcy5fcHJvcHNbcHJvcGVydHldLFxuICAgICAgICAgIHByZXYsXG4gICAgICAgICAgbmV4dDtcblxuICAgICAgaWYgKHB0KSB7XG4gICAgICAgIHByZXYgPSBwdC5fcHJldjtcbiAgICAgICAgbmV4dCA9IHB0Ll9uZXh0O1xuXG4gICAgICAgIGlmIChwcmV2KSB7XG4gICAgICAgICAgcHJldi5fbmV4dCA9IG5leHQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobmV4dCkge1xuICAgICAgICAgIG5leHQuX3ByZXYgPSBwcmV2O1xuICAgICAgICB9IGVsc2UgaWYgKF9maXJzdCA9PT0gcHQpIHtcbiAgICAgICAgICBfdGlja2VyLnJlbW92ZShfb25UaWNrKTtcblxuICAgICAgICAgIF9maXJzdCA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICBkZWxldGUgdGhpcy5fcHJvcHNbcHJvcGVydHldO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJraWxsXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGtpbGwoc2hhbGxvdykge1xuICAgICAgZm9yICh2YXIgcCBpbiB0aGlzLl9wcm9wcykge1xuICAgICAgICB0aGlzLnJlbW92ZShwKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFzaGFsbG93KSB7XG4gICAgICAgIGRlbGV0ZSBfbG9va3VwW19nZXRJRCh0aGlzLnRhcmdldCldO1xuICAgICAgfVxuICAgIH1cbiAgfV0sIFt7XG4gICAga2V5OiBcInJlZ2lzdGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlZ2lzdGVyKGNvcmUpIHtcbiAgICAgIGdzYXAgPSBjb3JlO1xuXG4gICAgICBfaW5pdENvcmUoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwidHJhY2tcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gdHJhY2sodGFyZ2V0cywgcHJvcGVydGllcywgdHlwZXMpIHtcbiAgICAgIGlmICghX2NvcmVJbml0dGVkKSB7XG4gICAgICAgIF9pbml0Q29yZSgpO1xuICAgICAgfVxuXG4gICAgICB2YXIgcmVzdWx0ID0gW10sXG4gICAgICAgICAgdGFyZ3MgPSBfdG9BcnJheSh0YXJnZXRzKSxcbiAgICAgICAgICBhID0gcHJvcGVydGllcy5zcGxpdChcIixcIiksXG4gICAgICAgICAgdCA9ICh0eXBlcyB8fCBcIlwiKS5zcGxpdChcIixcIiksXG4gICAgICAgICAgaSA9IHRhcmdzLmxlbmd0aCxcbiAgICAgICAgICB0cmFja2VyLFxuICAgICAgICAgIGo7XG5cbiAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgdHJhY2tlciA9IF9nZXRCeVRhcmdldCh0YXJnc1tpXSkgfHwgbmV3IFZlbG9jaXR5VHJhY2tlcih0YXJnc1tpXSk7XG4gICAgICAgIGogPSBhLmxlbmd0aDtcblxuICAgICAgICB3aGlsZSAoai0tKSB7XG4gICAgICAgICAgdHJhY2tlci5hZGQoYVtqXSwgdFtqXSB8fCB0WzBdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJlc3VsdC5wdXNoKHRyYWNrZXIpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJ1bnRyYWNrXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHVudHJhY2sodGFyZ2V0cywgcHJvcGVydGllcykge1xuICAgICAgdmFyIHByb3BzID0gKHByb3BlcnRpZXMgfHwgXCJcIikuc3BsaXQoXCIsXCIpO1xuXG4gICAgICBfdG9BcnJheSh0YXJnZXRzKS5mb3JFYWNoKGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICAgICAgdmFyIHRyYWNrZXIgPSBfZ2V0QnlUYXJnZXQodGFyZ2V0KTtcblxuICAgICAgICBpZiAodHJhY2tlcikge1xuICAgICAgICAgIGlmICghcHJvcHMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0cmFja2VyLmtpbGwoMSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByb3BzLmZvckVhY2goZnVuY3Rpb24gKHApIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHRyYWNrZXIucmVtb3ZlKHApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiaXNUcmFja2luZ1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpc1RyYWNraW5nKHRhcmdldCwgcHJvcGVydHkpIHtcbiAgICAgIHZhciB0cmFja2VyID0gX2dldEJ5VGFyZ2V0KHRhcmdldCk7XG5cbiAgICAgIHJldHVybiB0cmFja2VyICYmIHRyYWNrZXIuaXNUcmFja2luZyhwcm9wZXJ0eSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImdldFZlbG9jaXR5XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGdldFZlbG9jaXR5KHRhcmdldCwgcHJvcGVydHkpIHtcbiAgICAgIHZhciB0cmFja2VyID0gX2dldEJ5VGFyZ2V0KHRhcmdldCk7XG5cbiAgICAgIHJldHVybiAhdHJhY2tlciB8fCAhdHJhY2tlci5pc1RyYWNraW5nKHByb3BlcnR5KSA/IGNvbnNvbGUud2FybihcIk5vdCB0cmFja2luZyB2ZWxvY2l0eSBvZiBcIiArIHByb3BlcnR5KSA6IHRyYWNrZXIuZ2V0KHByb3BlcnR5KTtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gVmVsb2NpdHlUcmFja2VyO1xufSgpO1xuVmVsb2NpdHlUcmFja2VyLmdldEJ5VGFyZ2V0ID0gX2dldEJ5VGFyZ2V0O1xuX2dldEdTQVAoKSAmJiBnc2FwLnJlZ2lzdGVyUGx1Z2luKFZlbG9jaXR5VHJhY2tlcik7XG5leHBvcnQgeyBWZWxvY2l0eVRyYWNrZXIgYXMgZGVmYXVsdCB9OyIsImZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IFwiQGJhYmVsL2hlbHBlcnMgLSB0eXBlb2ZcIjsgaWYgKHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiKSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfTsgfSBlbHNlIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH1cblxuLyohXG4gKiBJbmVydGlhUGx1Z2luIDMuNi4xXG4gKiBodHRwczovL2dyZWVuc29jay5jb21cbiAqXG4gKiBAbGljZW5zZSBDb3B5cmlnaHQgMjAwOC0yMDIxLCBHcmVlblNvY2suIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiBTdWJqZWN0IHRvIHRoZSB0ZXJtcyBhdCBodHRwczovL2dyZWVuc29jay5jb20vc3RhbmRhcmQtbGljZW5zZSBvciBmb3JcbiAqIENsdWIgR3JlZW5Tb2NrIG1lbWJlcnMsIHRoZSBhZ3JlZW1lbnQgaXNzdWVkIHdpdGggdGhhdCBtZW1iZXJzaGlwLlxuICogQGF1dGhvcjogSmFjayBEb3lsZSwgamFja0BncmVlbnNvY2suY29tXG4qL1xuXG4vKiBlc2xpbnQtZGlzYWJsZSAqL1xuaW1wb3J0IHsgVmVsb2NpdHlUcmFja2VyIH0gZnJvbSBcIi4uL3V0aWxzL1ZlbG9jaXR5VHJhY2tlci5qc1wiO1xuXG52YXIgZ3NhcCxcbiAgICBfY29yZUluaXR0ZWQsXG4gICAgX3BhcnNlRWFzZSxcbiAgICBfdG9BcnJheSxcbiAgICBfcG93ZXIzLFxuICAgIF9jb25maWcsXG4gICAgX2dldFVuaXQsXG4gICAgUHJvcFR3ZWVuLFxuICAgIF9nZXRDYWNoZSxcbiAgICBfY2hlY2tQb2ludFJhdGlvLFxuICAgIF9jbGFtcCxcbiAgICBfcHJvY2Vzc2luZ1ZhcnMsXG4gICAgX2dldFRyYWNrZXIgPSBWZWxvY2l0eVRyYWNrZXIuZ2V0QnlUYXJnZXQsXG4gICAgX2dldEdTQVAgPSBmdW5jdGlvbiBfZ2V0R1NBUCgpIHtcbiAgcmV0dXJuIGdzYXAgfHwgdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiAmJiAoZ3NhcCA9IHdpbmRvdy5nc2FwKSAmJiBnc2FwLnJlZ2lzdGVyUGx1Z2luICYmIGdzYXA7XG59LFxuICAgIF9pc1N0cmluZyA9IGZ1bmN0aW9uIF9pc1N0cmluZyh2YWx1ZSkge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiO1xufSxcbiAgICBfaXNOdW1iZXIgPSBmdW5jdGlvbiBfaXNOdW1iZXIodmFsdWUpIHtcbiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIjtcbn0sXG4gICAgX2lzT2JqZWN0ID0gZnVuY3Rpb24gX2lzT2JqZWN0KHZhbHVlKSB7XG4gIHJldHVybiBfdHlwZW9mKHZhbHVlKSA9PT0gXCJvYmplY3RcIjtcbn0sXG4gICAgX2lzRnVuY3Rpb24gPSBmdW5jdGlvbiBfaXNGdW5jdGlvbih2YWx1ZSkge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSBcImZ1bmN0aW9uXCI7XG59LFxuICAgIF9ib251c1ZhbGlkYXRlZCA9IDEsXG4gICAgLy88bmFtZT5JbmVydGlhUGx1Z2luPC9uYW1lPlxuX2lzQXJyYXkgPSBBcnJheS5pc0FycmF5LFxuICAgIF9lbXB0eUZ1bmMgPSBmdW5jdGlvbiBfZW1wdHlGdW5jKHApIHtcbiAgcmV0dXJuIHA7XG59LFxuICAgIF9iaWdOdW0gPSAxZTEwLFxuICAgIF90aW55TnVtID0gMSAvIF9iaWdOdW0sXG4gICAgX2NoZWNrUG9pbnQgPSAwLjA1LFxuICAgIF9yb3VuZCA9IGZ1bmN0aW9uIF9yb3VuZCh2YWx1ZSkge1xuICByZXR1cm4gTWF0aC5yb3VuZCh2YWx1ZSAqIDEwMDAwKSAvIDEwMDAwO1xufSxcbiAgICBfZXh0ZW5kID0gZnVuY3Rpb24gX2V4dGVuZChvYmosIGRlZmF1bHRzLCBleGNsdWRlKSB7XG4gIGZvciAodmFyIHAgaW4gZGVmYXVsdHMpIHtcbiAgICBpZiAoIShwIGluIG9iaikgJiYgcCAhPT0gZXhjbHVkZSkge1xuICAgICAgb2JqW3BdID0gZGVmYXVsdHNbcF07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG9iajtcbn0sXG4gICAgX2RlZXBDbG9uZSA9IGZ1bmN0aW9uIF9kZWVwQ2xvbmUob2JqKSB7XG4gIHZhciBjb3B5ID0ge30sXG4gICAgICBwLFxuICAgICAgdjtcblxuICBmb3IgKHAgaW4gb2JqKSB7XG4gICAgY29weVtwXSA9IF9pc09iamVjdCh2ID0gb2JqW3BdKSA/IF9kZWVwQ2xvbmUodikgOiB2O1xuICB9XG5cbiAgcmV0dXJuIGNvcHk7XG59LFxuICAgIF9nZXRDbG9zZXN0ID0gZnVuY3Rpb24gX2dldENsb3Nlc3QobiwgdmFsdWVzLCBtYXgsIG1pbiwgcmFkaXVzKSB7XG4gIHZhciBpID0gdmFsdWVzLmxlbmd0aCxcbiAgICAgIGNsb3Nlc3QgPSAwLFxuICAgICAgYWJzRGlmID0gX2JpZ051bSxcbiAgICAgIHZhbCxcbiAgICAgIGRpZixcbiAgICAgIHAsXG4gICAgICBkaXN0O1xuXG4gIGlmIChfaXNPYmplY3QobikpIHtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICB2YWwgPSB2YWx1ZXNbaV07XG4gICAgICBkaWYgPSAwO1xuXG4gICAgICBmb3IgKHAgaW4gbikge1xuICAgICAgICBkaXN0ID0gdmFsW3BdIC0gbltwXTtcbiAgICAgICAgZGlmICs9IGRpc3QgKiBkaXN0O1xuICAgICAgfVxuXG4gICAgICBpZiAoZGlmIDwgYWJzRGlmKSB7XG4gICAgICAgIGNsb3Nlc3QgPSBpO1xuICAgICAgICBhYnNEaWYgPSBkaWY7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKChyYWRpdXMgfHwgX2JpZ051bSkgPCBfYmlnTnVtICYmIHJhZGl1cyA8IE1hdGguc3FydChhYnNEaWYpKSB7XG4gICAgICByZXR1cm4gbjtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgdmFsID0gdmFsdWVzW2ldO1xuICAgICAgZGlmID0gdmFsIC0gbjtcblxuICAgICAgaWYgKGRpZiA8IDApIHtcbiAgICAgICAgZGlmID0gLWRpZjtcbiAgICAgIH1cblxuICAgICAgaWYgKGRpZiA8IGFic0RpZiAmJiB2YWwgPj0gbWluICYmIHZhbCA8PSBtYXgpIHtcbiAgICAgICAgY2xvc2VzdCA9IGk7XG4gICAgICAgIGFic0RpZiA9IGRpZjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gdmFsdWVzW2Nsb3Nlc3RdO1xufSxcbiAgICBfcGFyc2VFbmQgPSBmdW5jdGlvbiBfcGFyc2VFbmQoY3VyUHJvcCwgZW5kLCBtYXgsIG1pbiwgbmFtZSwgcmFkaXVzKSB7XG4gIGlmIChjdXJQcm9wLmVuZCA9PT0gXCJhdXRvXCIpIHtcbiAgICByZXR1cm4gY3VyUHJvcDtcbiAgfVxuXG4gIHZhciBlbmRWYXIgPSBjdXJQcm9wLmVuZCxcbiAgICAgIGFkanVzdGVkRW5kLFxuICAgICAgcDtcbiAgbWF4ID0gaXNOYU4obWF4KSA/IF9iaWdOdW0gOiBtYXg7XG4gIG1pbiA9IGlzTmFOKG1pbikgPyAtX2JpZ051bSA6IG1pbjtcblxuICBpZiAoX2lzT2JqZWN0KGVuZCkpIHtcbiAgICAvL2ZvciBvYmplY3RzLCBsaWtlIHt4LCB5fSB3aGVyZSB0aGV5J3JlIGxpbmtlZCBhbmQgd2UgbXVzdCBwYXNzIGFuIG9iamVjdCB0byB0aGUgZnVuY3Rpb24gb3IgZmluZCB0aGUgY2xvc2VzdCB2YWx1ZSBpbiBhbiBhcnJheS5cbiAgICBhZGp1c3RlZEVuZCA9IGVuZC5jYWxjdWxhdGVkID8gZW5kIDogKF9pc0Z1bmN0aW9uKGVuZFZhcikgPyBlbmRWYXIoZW5kKSA6IF9nZXRDbG9zZXN0KGVuZCwgZW5kVmFyLCBtYXgsIG1pbiwgcmFkaXVzKSkgfHwgZW5kO1xuXG4gICAgaWYgKCFlbmQuY2FsY3VsYXRlZCkge1xuICAgICAgZm9yIChwIGluIGFkanVzdGVkRW5kKSB7XG4gICAgICAgIGVuZFtwXSA9IGFkanVzdGVkRW5kW3BdO1xuICAgICAgfVxuXG4gICAgICBlbmQuY2FsY3VsYXRlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgYWRqdXN0ZWRFbmQgPSBhZGp1c3RlZEVuZFtuYW1lXTtcbiAgfSBlbHNlIHtcbiAgICBhZGp1c3RlZEVuZCA9IF9pc0Z1bmN0aW9uKGVuZFZhcikgPyBlbmRWYXIoZW5kKSA6IF9pc0FycmF5KGVuZFZhcikgPyBfZ2V0Q2xvc2VzdChlbmQsIGVuZFZhciwgbWF4LCBtaW4sIHJhZGl1cykgOiBwYXJzZUZsb2F0KGVuZFZhcik7XG4gIH1cblxuICBpZiAoYWRqdXN0ZWRFbmQgPiBtYXgpIHtcbiAgICBhZGp1c3RlZEVuZCA9IG1heDtcbiAgfSBlbHNlIGlmIChhZGp1c3RlZEVuZCA8IG1pbikge1xuICAgIGFkanVzdGVkRW5kID0gbWluO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBtYXg6IGFkanVzdGVkRW5kLFxuICAgIG1pbjogYWRqdXN0ZWRFbmQsXG4gICAgdW5pdEZhY3RvcjogY3VyUHJvcC51bml0RmFjdG9yXG4gIH07XG59LFxuICAgIF9nZXROdW1PckRlZmF1bHQgPSBmdW5jdGlvbiBfZ2V0TnVtT3JEZWZhdWx0KHZhcnMsIHByb3BlcnR5LCBkZWZhdWx0VmFsdWUpIHtcbiAgcmV0dXJuIGlzTmFOKHZhcnNbcHJvcGVydHldKSA/IGRlZmF1bHRWYWx1ZSA6ICt2YXJzW3Byb3BlcnR5XTtcbn0sXG4gICAgX2NhbGN1bGF0ZUNoYW5nZSA9IGZ1bmN0aW9uIF9jYWxjdWxhdGVDaGFuZ2UodmVsb2NpdHksIGR1cmF0aW9uKSB7XG4gIHJldHVybiBkdXJhdGlvbiAqIF9jaGVja1BvaW50ICogdmVsb2NpdHkgLyBfY2hlY2tQb2ludFJhdGlvO1xufSxcbiAgICBfY2FsY3VsYXRlRHVyYXRpb24gPSBmdW5jdGlvbiBfY2FsY3VsYXRlRHVyYXRpb24oc3RhcnQsIGVuZCwgdmVsb2NpdHkpIHtcbiAgcmV0dXJuIE1hdGguYWJzKChlbmQgLSBzdGFydCkgKiBfY2hlY2tQb2ludFJhdGlvIC8gdmVsb2NpdHkgLyBfY2hlY2tQb2ludCk7XG59LFxuICAgIF9yZXNlcnZlZFByb3BzID0ge1xuICByZXNpc3RhbmNlOiAxLFxuICBjaGVja3BvaW50OiAxLFxuICBwcmV2ZW50T3ZlcnNob290OiAxLFxuICBsaW5rZWRQcm9wczogMSxcbiAgcmFkaXVzOiAxLFxuICBkdXJhdGlvbjogMVxufSxcbiAgICBfcHJvY2Vzc0xpbmtlZFByb3BzID0gZnVuY3Rpb24gX3Byb2Nlc3NMaW5rZWRQcm9wcyh0YXJnZXQsIHZhcnMsIGdldFZhbCwgcmVzaXN0YW5jZSkge1xuICBpZiAodmFycy5saW5rZWRQcm9wcykge1xuICAgIC8vd2hlbiB0aGVyZSBhcmUgbGlua2VkUHJvcHMgKHR5cGljYWxseSBcIngseVwiIHdoZXJlIHNuYXBwaW5nIGhhcyB0byBmYWN0b3IgaW4gbXVsdGlwbGUgcHJvcGVydGllcywgd2UgbXVzdCBmaXJzdCBwb3B1bGF0ZSBhbiBvYmplY3Qgd2l0aCBhbGwgb2YgdGhvc2UgZW5kIHZhbHVlcywgdGhlbiBmZWVkIGl0IHRvIHRoZSBmdW5jdGlvbiB0aGF0IG1ha2UgYW55IG5lY2Vzc2FyeSBhbHRlcmF0aW9ucy4gU28gdGhlIHBvaW50IG9mIHRoaXMgZmlyc3QgbG9vcCBpcyB0byBzaW1wbHkgYnVpbGQgYW4gb2JqZWN0IChsaWtlIHt4OjEwMCwgeToyMDQuNX0pIGZvciBmZWVkaW5nIGludG8gdGhhdCBmdW5jdGlvbiB3aGljaCB3ZSdsbCBkbyBsYXRlciBpbiB0aGUgXCJyZWFsXCIgbG9vcC5cbiAgICB2YXIgbGlua2VkUHJvcE5hbWVzID0gdmFycy5saW5rZWRQcm9wcy5zcGxpdChcIixcIiksXG4gICAgICAgIGxpbmtlZFByb3BzID0ge30sXG4gICAgICAgIGksXG4gICAgICAgIHAsXG4gICAgICAgIGN1clByb3AsXG4gICAgICAgIGN1clZlbG9jaXR5LFxuICAgICAgICB0cmFja2VyLFxuICAgICAgICBjdXJEdXJhdGlvbjtcblxuICAgIGZvciAoaSA9IDA7IGkgPCBsaW5rZWRQcm9wTmFtZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHAgPSBsaW5rZWRQcm9wTmFtZXNbaV07XG4gICAgICBjdXJQcm9wID0gdmFyc1twXTtcblxuICAgICAgaWYgKGN1clByb3ApIHtcbiAgICAgICAgaWYgKF9pc051bWJlcihjdXJQcm9wLnZlbG9jaXR5KSkge1xuICAgICAgICAgIGN1clZlbG9jaXR5ID0gY3VyUHJvcC52ZWxvY2l0eTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0cmFja2VyID0gdHJhY2tlciB8fCBfZ2V0VHJhY2tlcih0YXJnZXQpO1xuICAgICAgICAgIGN1clZlbG9jaXR5ID0gdHJhY2tlciAmJiB0cmFja2VyLmlzVHJhY2tpbmcocCkgPyB0cmFja2VyLmdldChwKSA6IDA7XG4gICAgICAgIH1cblxuICAgICAgICBjdXJEdXJhdGlvbiA9IE1hdGguYWJzKGN1clZlbG9jaXR5IC8gX2dldE51bU9yRGVmYXVsdChjdXJQcm9wLCBcInJlc2lzdGFuY2VcIiwgcmVzaXN0YW5jZSkpO1xuICAgICAgICBsaW5rZWRQcm9wc1twXSA9IHBhcnNlRmxvYXQoZ2V0VmFsKHRhcmdldCwgcCkpICsgX2NhbGN1bGF0ZUNoYW5nZShjdXJWZWxvY2l0eSwgY3VyRHVyYXRpb24pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBsaW5rZWRQcm9wcztcbiAgfVxufSxcbiAgICBfY2FsY3VsYXRlVHdlZW5EdXJhdGlvbiA9IGZ1bmN0aW9uIF9jYWxjdWxhdGVUd2VlbkR1cmF0aW9uKHRhcmdldCwgdmFycykge1xuICB2YXIgbWF4RHVyYXRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IDEwO1xuICB2YXIgbWluRHVyYXRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IDAuMjtcbiAgdmFyIG92ZXJzaG9vdFRvbGVyYW5jZSA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ICYmIGFyZ3VtZW50c1s0XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzRdIDogMTtcbiAgdmFyIHJlY29yZEVuZCA9IGFyZ3VtZW50cy5sZW5ndGggPiA1ICYmIGFyZ3VtZW50c1s1XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzVdIDogMDtcbiAgX2lzU3RyaW5nKHRhcmdldCkgJiYgKHRhcmdldCA9IF90b0FycmF5KHRhcmdldClbMF0pO1xuXG4gIGlmICghdGFyZ2V0KSB7XG4gICAgcmV0dXJuIDA7XG4gIH1cblxuICB2YXIgZHVyYXRpb24gPSAwLFxuICAgICAgY2xpcHBlZER1cmF0aW9uID0gX2JpZ051bSxcbiAgICAgIGluZXJ0aWFWYXJzID0gdmFycy5pbmVydGlhIHx8IHZhcnMsXG4gICAgICBnZXRWYWwgPSBfZ2V0Q2FjaGUodGFyZ2V0KS5nZXQsXG4gICAgICByZXNpc3RhbmNlID0gX2dldE51bU9yRGVmYXVsdChpbmVydGlhVmFycywgXCJyZXNpc3RhbmNlXCIsIF9jb25maWcucmVzaXN0YW5jZSksXG4gICAgICBwLFxuICAgICAgY3VyUHJvcCxcbiAgICAgIGN1ckR1cmF0aW9uLFxuICAgICAgY3VyVmVsb2NpdHksXG4gICAgICBjdXJWYWwsXG4gICAgICBlbmQsXG4gICAgICBjdXJDbGlwcGVkRHVyYXRpb24sXG4gICAgICB0cmFja2VyLFxuICAgICAgdW5pdEZhY3RvcixcbiAgICAgIGxpbmtlZFByb3BzOyAvL3doZW4gdGhlcmUgYXJlIGxpbmtlZFByb3BzICh0eXBpY2FsbHkgXCJ4LHlcIiB3aGVyZSBzbmFwcGluZyBoYXMgdG8gZmFjdG9yIGluIG11bHRpcGxlIHByb3BlcnRpZXMsIHdlIG11c3QgZmlyc3QgcG9wdWxhdGUgYW4gb2JqZWN0IHdpdGggYWxsIG9mIHRob3NlIGVuZCB2YWx1ZXMsIHRoZW4gZmVlZCBpdCB0byB0aGUgZnVuY3Rpb24gdGhhdCBtYWtlIGFueSBuZWNlc3NhcnkgYWx0ZXJhdGlvbnMuIFNvIHRoZSBwb2ludCBvZiB0aGlzIGZpcnN0IGxvb3AgaXMgdG8gc2ltcGx5IGJ1aWxkIGFuIG9iamVjdCAobGlrZSB7eDoxMDAsIHk6MjA0LjV9KSBmb3IgZmVlZGluZyBpbnRvIHRoYXQgZnVuY3Rpb24gd2hpY2ggd2UnbGwgZG8gbGF0ZXIgaW4gdGhlIFwicmVhbFwiIGxvb3AuXG5cblxuICBsaW5rZWRQcm9wcyA9IF9wcm9jZXNzTGlua2VkUHJvcHModGFyZ2V0LCBpbmVydGlhVmFycywgZ2V0VmFsLCByZXNpc3RhbmNlKTtcblxuICBmb3IgKHAgaW4gaW5lcnRpYVZhcnMpIHtcbiAgICBpZiAoIV9yZXNlcnZlZFByb3BzW3BdKSB7XG4gICAgICBjdXJQcm9wID0gaW5lcnRpYVZhcnNbcF07XG5cbiAgICAgIGlmICghX2lzT2JqZWN0KGN1clByb3ApKSB7XG4gICAgICAgIHRyYWNrZXIgPSB0cmFja2VyIHx8IF9nZXRUcmFja2VyKHRhcmdldCk7XG5cbiAgICAgICAgaWYgKHRyYWNrZXIgJiYgdHJhY2tlci5pc1RyYWNraW5nKHApKSB7XG4gICAgICAgICAgY3VyUHJvcCA9IF9pc051bWJlcihjdXJQcm9wKSA/IHtcbiAgICAgICAgICAgIHZlbG9jaXR5OiBjdXJQcm9wXG4gICAgICAgICAgfSA6IHtcbiAgICAgICAgICAgIHZlbG9jaXR5OiB0cmFja2VyLmdldChwKVxuICAgICAgICAgIH07IC8vaWYgd2UncmUgdHJhY2tpbmcgdGhpcyBwcm9wZXJ0eSwgd2Ugc2hvdWxkIHVzZSB0aGUgdHJhY2tpbmcgdmVsb2NpdHkgYW5kIHRoZW4gdXNlIHRoZSBudW1lcmljIHZhbHVlIHRoYXQgd2FzIHBhc3NlZCBpbiBhcyB0aGUgbWluIGFuZCBtYXggc28gdGhhdCBpdCB0d2VlbnMgZXhhY3RseSB0aGVyZS5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjdXJWZWxvY2l0eSA9ICtjdXJQcm9wIHx8IDA7XG4gICAgICAgICAgY3VyRHVyYXRpb24gPSBNYXRoLmFicyhjdXJWZWxvY2l0eSAvIHJlc2lzdGFuY2UpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChfaXNPYmplY3QoY3VyUHJvcCkpIHtcbiAgICAgICAgaWYgKF9pc051bWJlcihjdXJQcm9wLnZlbG9jaXR5KSkge1xuICAgICAgICAgIGN1clZlbG9jaXR5ID0gY3VyUHJvcC52ZWxvY2l0eTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0cmFja2VyID0gdHJhY2tlciB8fCBfZ2V0VHJhY2tlcih0YXJnZXQpO1xuICAgICAgICAgIGN1clZlbG9jaXR5ID0gdHJhY2tlciAmJiB0cmFja2VyLmlzVHJhY2tpbmcocCkgPyB0cmFja2VyLmdldChwKSA6IDA7XG4gICAgICAgIH1cblxuICAgICAgICBjdXJEdXJhdGlvbiA9IF9jbGFtcChtaW5EdXJhdGlvbiwgbWF4RHVyYXRpb24sIE1hdGguYWJzKGN1clZlbG9jaXR5IC8gX2dldE51bU9yRGVmYXVsdChjdXJQcm9wLCBcInJlc2lzdGFuY2VcIiwgcmVzaXN0YW5jZSkpKTtcbiAgICAgICAgY3VyVmFsID0gcGFyc2VGbG9hdChnZXRWYWwodGFyZ2V0LCBwKSkgfHwgMDtcbiAgICAgICAgZW5kID0gY3VyVmFsICsgX2NhbGN1bGF0ZUNoYW5nZShjdXJWZWxvY2l0eSwgY3VyRHVyYXRpb24pO1xuXG4gICAgICAgIGlmIChcImVuZFwiIGluIGN1clByb3ApIHtcbiAgICAgICAgICBjdXJQcm9wID0gX3BhcnNlRW5kKGN1clByb3AsIGxpbmtlZFByb3BzICYmIHAgaW4gbGlua2VkUHJvcHMgPyBsaW5rZWRQcm9wcyA6IGVuZCwgY3VyUHJvcC5tYXgsIGN1clByb3AubWluLCBwLCBpbmVydGlhVmFycy5yYWRpdXMpO1xuXG4gICAgICAgICAgaWYgKHJlY29yZEVuZCkge1xuICAgICAgICAgICAgX3Byb2Nlc3NpbmdWYXJzID09PSB2YXJzICYmIChfcHJvY2Vzc2luZ1ZhcnMgPSBpbmVydGlhVmFycyA9IF9kZWVwQ2xvbmUodmFycykpO1xuICAgICAgICAgICAgaW5lcnRpYVZhcnNbcF0gPSBfZXh0ZW5kKGN1clByb3AsIGluZXJ0aWFWYXJzW3BdLCBcImVuZFwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoXCJtYXhcIiBpbiBjdXJQcm9wICYmIGVuZCA+ICtjdXJQcm9wLm1heCArIF90aW55TnVtKSB7XG4gICAgICAgICAgdW5pdEZhY3RvciA9IGN1clByb3AudW5pdEZhY3RvciB8fCBfY29uZmlnLnVuaXRGYWN0b3JzW3BdIHx8IDE7IC8vc29tZSB2YWx1ZXMgYXJlIG1lYXN1cmVkIGluIHNwZWNpYWwgdW5pdHMgbGlrZSByYWRpYW5zIGluIHdoaWNoIGNhc2Ugb3VyIHRocmVzaG9sZHMgbmVlZCB0byBiZSBhZGp1c3RlZCBhY2NvcmRpbmdseS5cbiAgICAgICAgICAvL2lmIHRoZSB2YWx1ZSBpcyBhbHJlYWR5IGV4Y2VlZGluZyB0aGUgbWF4IG9yIHRoZSB2ZWxvY2l0eSBpcyB0b28gbG93LCB0aGUgZHVyYXRpb24gY2FuIGVuZCB1cCBiZWluZyB1bmNvbWZvcnRhYmx5IGxvbmcgYnV0IGluIG1vc3Qgc2l0dWF0aW9ucywgdXNlcnMgd2FudCB0aGUgc25hcHBpbmcgdG8gb2NjdXIgcmVsYXRpdmVseSBxdWlja2x5ICgwLjc1IHNlY29uZHMpLCBzbyB3ZSBpbXBsZW1lbnQgYSBjYXAgaGVyZSB0byBtYWtlIHRoaW5ncyBtb3JlIGludHVpdGl2ZS4gSWYgdGhlIG1heCBhbmQgbWluIG1hdGNoLCBpdCBtZWFucyB3ZSdyZSBhbmltYXRpbmcgdG8gYSBwYXJ0aWN1bGFyIHZhbHVlIGFuZCB3ZSBkb24ndCB3YW50IHRvIHNob3J0ZW4gdGhlIHRpbWUgdW5sZXNzIHRoZSB2ZWxvY2l0eSBpcyByZWFsbHkgc2xvdy4gRXhhbXBsZTogYSByb3RhdGlvbiB3aGVyZSB0aGUgc3RhcnQgYW5kIG5hdHVyYWwgZW5kIHZhbHVlIGFyZSBsZXNzIHRoYW4gdGhlIHNuYXBwaW5nIHNwb3QsIGJ1dCB0aGUgbmF0dXJhbCBlbmQgaXMgcHJldHR5IGNsb3NlIHRvIHRoZSBzbmFwLlxuXG4gICAgICAgICAgY3VyQ2xpcHBlZER1cmF0aW9uID0gY3VyVmFsID4gY3VyUHJvcC5tYXggJiYgY3VyUHJvcC5taW4gIT09IGN1clByb3AubWF4IHx8IGN1clZlbG9jaXR5ICogdW5pdEZhY3RvciA+IC0xNSAmJiBjdXJWZWxvY2l0eSAqIHVuaXRGYWN0b3IgPCA0NSA/IG1pbkR1cmF0aW9uICsgKG1heER1cmF0aW9uIC0gbWluRHVyYXRpb24pICogMC4xIDogX2NhbGN1bGF0ZUR1cmF0aW9uKGN1clZhbCwgY3VyUHJvcC5tYXgsIGN1clZlbG9jaXR5KTtcblxuICAgICAgICAgIGlmIChjdXJDbGlwcGVkRHVyYXRpb24gKyBvdmVyc2hvb3RUb2xlcmFuY2UgPCBjbGlwcGVkRHVyYXRpb24pIHtcbiAgICAgICAgICAgIGNsaXBwZWREdXJhdGlvbiA9IGN1ckNsaXBwZWREdXJhdGlvbiArIG92ZXJzaG9vdFRvbGVyYW5jZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoXCJtaW5cIiBpbiBjdXJQcm9wICYmIGVuZCA8ICtjdXJQcm9wLm1pbiAtIF90aW55TnVtKSB7XG4gICAgICAgICAgdW5pdEZhY3RvciA9IGN1clByb3AudW5pdEZhY3RvciB8fCBfY29uZmlnLnVuaXRGYWN0b3JzW3BdIHx8IDE7IC8vc29tZSB2YWx1ZXMgYXJlIG1lYXN1cmVkIGluIHNwZWNpYWwgdW5pdHMgbGlrZSByYWRpYW5zIGluIHdoaWNoIGNhc2Ugb3VyIHRocmVzaG9sZHMgbmVlZCB0byBiZSBhZGp1c3RlZCBhY2NvcmRpbmdseS5cbiAgICAgICAgICAvL2lmIHRoZSB2YWx1ZSBpcyBhbHJlYWR5IGV4Y2VlZGluZyB0aGUgbWluIG9yIGlmIHRoZSB2ZWxvY2l0eSBpcyB0b28gbG93LCB0aGUgZHVyYXRpb24gY2FuIGVuZCB1cCBiZWluZyB1bmNvbWZvcnRhYmx5IGxvbmcgYnV0IGluIG1vc3Qgc2l0dWF0aW9ucywgdXNlcnMgd2FudCB0aGUgc25hcHBpbmcgdG8gb2NjdXIgcmVsYXRpdmVseSBxdWlja2x5ICgwLjc1IHNlY29uZHMpLCBzbyB3ZSBpbXBsZW1lbnQgYSBjYXAgaGVyZSB0byBtYWtlIHRoaW5ncyBtb3JlIGludHVpdGl2ZS5cblxuICAgICAgICAgIGN1ckNsaXBwZWREdXJhdGlvbiA9IGN1clZhbCA8IGN1clByb3AubWluICYmIGN1clByb3AubWluICE9PSBjdXJQcm9wLm1heCB8fCBjdXJWZWxvY2l0eSAqIHVuaXRGYWN0b3IgPiAtNDUgJiYgY3VyVmVsb2NpdHkgKiB1bml0RmFjdG9yIDwgMTUgPyBtaW5EdXJhdGlvbiArIChtYXhEdXJhdGlvbiAtIG1pbkR1cmF0aW9uKSAqIDAuMSA6IF9jYWxjdWxhdGVEdXJhdGlvbihjdXJWYWwsIGN1clByb3AubWluLCBjdXJWZWxvY2l0eSk7XG5cbiAgICAgICAgICBpZiAoY3VyQ2xpcHBlZER1cmF0aW9uICsgb3ZlcnNob290VG9sZXJhbmNlIDwgY2xpcHBlZER1cmF0aW9uKSB7XG4gICAgICAgICAgICBjbGlwcGVkRHVyYXRpb24gPSBjdXJDbGlwcGVkRHVyYXRpb24gKyBvdmVyc2hvb3RUb2xlcmFuY2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY3VyQ2xpcHBlZER1cmF0aW9uID4gZHVyYXRpb24gJiYgKGR1cmF0aW9uID0gY3VyQ2xpcHBlZER1cmF0aW9uKTtcbiAgICAgIH1cblxuICAgICAgY3VyRHVyYXRpb24gPiBkdXJhdGlvbiAmJiAoZHVyYXRpb24gPSBjdXJEdXJhdGlvbik7XG4gICAgfVxuICB9XG5cbiAgZHVyYXRpb24gPiBjbGlwcGVkRHVyYXRpb24gJiYgKGR1cmF0aW9uID0gY2xpcHBlZER1cmF0aW9uKTtcbiAgcmV0dXJuIGR1cmF0aW9uID4gbWF4RHVyYXRpb24gPyBtYXhEdXJhdGlvbiA6IGR1cmF0aW9uIDwgbWluRHVyYXRpb24gPyBtaW5EdXJhdGlvbiA6IGR1cmF0aW9uO1xufSxcbiAgICBfaW5pdENvcmUgPSBmdW5jdGlvbiBfaW5pdENvcmUoKSB7XG4gIGdzYXAgPSBfZ2V0R1NBUCgpO1xuXG4gIGlmIChnc2FwKSB7XG4gICAgX3BhcnNlRWFzZSA9IGdzYXAucGFyc2VFYXNlO1xuICAgIF90b0FycmF5ID0gZ3NhcC51dGlscy50b0FycmF5O1xuICAgIF9nZXRVbml0ID0gZ3NhcC51dGlscy5nZXRVbml0O1xuICAgIF9nZXRDYWNoZSA9IGdzYXAuY29yZS5nZXRDYWNoZTtcbiAgICBfY2xhbXAgPSBnc2FwLnV0aWxzLmNsYW1wO1xuICAgIF9wb3dlcjMgPSBfcGFyc2VFYXNlKFwicG93ZXIzXCIpO1xuICAgIF9jaGVja1BvaW50UmF0aW8gPSBfcG93ZXIzKDAuMDUpO1xuICAgIFByb3BUd2VlbiA9IGdzYXAuY29yZS5Qcm9wVHdlZW47XG4gICAgZ3NhcC5jb25maWcoe1xuICAgICAgcmVzaXN0YW5jZTogMTAwLFxuICAgICAgdW5pdEZhY3RvcnM6IHtcbiAgICAgICAgdGltZTogMTAwMCxcbiAgICAgICAgdG90YWxUaW1lOiAxMDAwLFxuICAgICAgICBwcm9ncmVzczogMTAwMCxcbiAgICAgICAgdG90YWxQcm9ncmVzczogMTAwMFxuICAgICAgfVxuICAgIH0pO1xuICAgIF9jb25maWcgPSBnc2FwLmNvbmZpZygpO1xuICAgIGdzYXAucmVnaXN0ZXJQbHVnaW4oVmVsb2NpdHlUcmFja2VyKTtcbiAgICBfY29yZUluaXR0ZWQgPSAxO1xuICB9XG59O1xuXG5leHBvcnQgdmFyIEluZXJ0aWFQbHVnaW4gPSB7XG4gIHZlcnNpb246IFwiMy42LjFcIixcbiAgbmFtZTogXCJpbmVydGlhXCIsXG4gIHJlZ2lzdGVyOiBmdW5jdGlvbiByZWdpc3Rlcihjb3JlKSB7XG4gICAgZ3NhcCA9IGNvcmU7XG5cbiAgICBfaW5pdENvcmUoKTtcbiAgfSxcbiAgaW5pdDogZnVuY3Rpb24gaW5pdCh0YXJnZXQsIHZhcnMsIHR3ZWVuLCBpbmRleCwgdGFyZ2V0cykge1xuICAgIF9jb3JlSW5pdHRlZCB8fCBfaW5pdENvcmUoKTtcblxuICAgIHZhciB0cmFja2VyID0gX2dldFRyYWNrZXIodGFyZ2V0KTtcblxuICAgIGlmICh2YXJzID09PSBcImF1dG9cIikge1xuICAgICAgaWYgKCF0cmFja2VyKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIk5vIGluZXJ0aWEgdHJhY2tpbmcgb24gXCIgKyB0YXJnZXQgKyBcIi4gSW5lcnRpYVBsdWdpbi50cmFjayh0YXJnZXQpIGZpcnN0LlwiKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXJzID0gdHJhY2tlci5nZXRBbGwoKTtcbiAgICB9XG5cbiAgICB0aGlzLnRhcmdldCA9IHRhcmdldDtcbiAgICB0aGlzLnR3ZWVuID0gdHdlZW47XG4gICAgX3Byb2Nlc3NpbmdWYXJzID0gdmFyczsgLy8gZ2V0cyBzd2FwcGVkIGluc2lkZSBfY2FsY3VsYXRlVHdlZW5EdXJhdGlvbigpIGlmIHRoZXJlJ3MgYSBmdW5jdGlvbi1iYXNlZCB2YWx1ZSBlbmNvdW50ZXJlZCAodG8gYXZvaWQgZG91YmxlLWNhbGxpbmcgaXQpXG5cbiAgICB2YXIgY2FjaGUgPSB0YXJnZXQuX2dzYXAsXG4gICAgICAgIGdldFZhbCA9IGNhY2hlLmdldCxcbiAgICAgICAgZHVyID0gdmFycy5kdXJhdGlvbixcbiAgICAgICAgZHVySXNPYmogPSBfaXNPYmplY3QoZHVyKSxcbiAgICAgICAgcHJldmVudE92ZXJzaG9vdCA9IHZhcnMucHJldmVudE92ZXJzaG9vdCB8fCBkdXJJc09iaiAmJiBkdXIub3ZlcnNob290ID09PSAwLFxuICAgICAgICByZXNpc3RhbmNlID0gX2dldE51bU9yRGVmYXVsdCh2YXJzLCBcInJlc2lzdGFuY2VcIiwgX2NvbmZpZy5yZXNpc3RhbmNlKSxcbiAgICAgICAgZHVyYXRpb24gPSBfaXNOdW1iZXIoZHVyKSA/IGR1ciA6IF9jYWxjdWxhdGVUd2VlbkR1cmF0aW9uKHRhcmdldCwgdmFycywgZHVySXNPYmogJiYgZHVyLm1heCB8fCAxMCwgZHVySXNPYmogJiYgZHVyLm1pbiB8fCAwLjIsIGR1cklzT2JqICYmIFwib3ZlcnNob290XCIgaW4gZHVyID8gK2R1ci5vdmVyc2hvb3QgOiBwcmV2ZW50T3ZlcnNob290ID8gMCA6IDEsIHRydWUpLFxuICAgICAgICBwLFxuICAgICAgICBjdXJQcm9wLFxuICAgICAgICBjdXJWYWwsXG4gICAgICAgIHVuaXQsXG4gICAgICAgIHZlbG9jaXR5LFxuICAgICAgICBjaGFuZ2UxLFxuICAgICAgICBlbmQsXG4gICAgICAgIGNoYW5nZTIsXG4gICAgICAgIGxpbmtlZFByb3BzO1xuXG4gICAgdmFycyA9IF9wcm9jZXNzaW5nVmFycztcbiAgICBfcHJvY2Vzc2luZ1ZhcnMgPSAwOyAvL3doZW4gdGhlcmUgYXJlIGxpbmtlZFByb3BzICh0eXBpY2FsbHkgXCJ4LHlcIiB3aGVyZSBzbmFwcGluZyBoYXMgdG8gZmFjdG9yIGluIG11bHRpcGxlIHByb3BlcnRpZXMsIHdlIG11c3QgZmlyc3QgcG9wdWxhdGUgYW4gb2JqZWN0IHdpdGggYWxsIG9mIHRob3NlIGVuZCB2YWx1ZXMsIHRoZW4gZmVlZCBpdCB0byB0aGUgZnVuY3Rpb24gdGhhdCBtYWtlIGFueSBuZWNlc3NhcnkgYWx0ZXJhdGlvbnMuIFNvIHRoZSBwb2ludCBvZiB0aGlzIGZpcnN0IGxvb3AgaXMgdG8gc2ltcGx5IGJ1aWxkIGFuIG9iamVjdCAobGlrZSB7eDoxMDAsIHk6MjA0LjV9KSBmb3IgZmVlZGluZyBpbnRvIHRoYXQgZnVuY3Rpb24gd2hpY2ggd2UnbGwgZG8gbGF0ZXIgaW4gdGhlIFwicmVhbFwiIGxvb3AuXG5cbiAgICBsaW5rZWRQcm9wcyA9IF9wcm9jZXNzTGlua2VkUHJvcHModGFyZ2V0LCB2YXJzLCBnZXRWYWwsIHJlc2lzdGFuY2UpO1xuXG4gICAgZm9yIChwIGluIHZhcnMpIHtcbiAgICAgIGlmICghX3Jlc2VydmVkUHJvcHNbcF0pIHtcbiAgICAgICAgY3VyUHJvcCA9IHZhcnNbcF07XG4gICAgICAgIF9pc0Z1bmN0aW9uKGN1clByb3ApICYmIChjdXJQcm9wID0gY3VyUHJvcChpbmRleCwgdGFyZ2V0LCB0YXJnZXRzKSk7XG5cbiAgICAgICAgaWYgKF9pc051bWJlcihjdXJQcm9wKSkge1xuICAgICAgICAgIHZlbG9jaXR5ID0gY3VyUHJvcDtcbiAgICAgICAgfSBlbHNlIGlmIChfaXNPYmplY3QoY3VyUHJvcCkgJiYgIWlzTmFOKGN1clByb3AudmVsb2NpdHkpKSB7XG4gICAgICAgICAgdmVsb2NpdHkgPSArY3VyUHJvcC52ZWxvY2l0eTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAodHJhY2tlciAmJiB0cmFja2VyLmlzVHJhY2tpbmcocCkpIHtcbiAgICAgICAgICAgIHZlbG9jaXR5ID0gdHJhY2tlci5nZXQocCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkVSUk9SOiBObyB2ZWxvY2l0eSB3YXMgZGVmaW5lZCBmb3IgXCIgKyB0YXJnZXQgKyBcIiBwcm9wZXJ0eTogXCIgKyBwKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjaGFuZ2UxID0gX2NhbGN1bGF0ZUNoYW5nZSh2ZWxvY2l0eSwgZHVyYXRpb24pO1xuICAgICAgICBjaGFuZ2UyID0gMDtcbiAgICAgICAgY3VyVmFsID0gZ2V0VmFsKHRhcmdldCwgcCk7XG4gICAgICAgIHVuaXQgPSBfZ2V0VW5pdChjdXJWYWwpO1xuICAgICAgICBjdXJWYWwgPSBwYXJzZUZsb2F0KGN1clZhbCk7XG5cbiAgICAgICAgaWYgKF9pc09iamVjdChjdXJQcm9wKSkge1xuICAgICAgICAgIGVuZCA9IGN1clZhbCArIGNoYW5nZTE7XG5cbiAgICAgICAgICBpZiAoXCJlbmRcIiBpbiBjdXJQcm9wKSB7XG4gICAgICAgICAgICBjdXJQcm9wID0gX3BhcnNlRW5kKGN1clByb3AsIGxpbmtlZFByb3BzICYmIHAgaW4gbGlua2VkUHJvcHMgPyBsaW5rZWRQcm9wcyA6IGVuZCwgY3VyUHJvcC5tYXgsIGN1clByb3AubWluLCBwLCB2YXJzLnJhZGl1cyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKFwibWF4XCIgaW4gY3VyUHJvcCAmJiArY3VyUHJvcC5tYXggPCBlbmQpIHtcbiAgICAgICAgICAgIGlmIChwcmV2ZW50T3ZlcnNob290IHx8IGN1clByb3AucHJldmVudE92ZXJzaG9vdCkge1xuICAgICAgICAgICAgICBjaGFuZ2UxID0gY3VyUHJvcC5tYXggLSBjdXJWYWw7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBjaGFuZ2UyID0gY3VyUHJvcC5tYXggLSBjdXJWYWwgLSBjaGFuZ2UxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSBpZiAoXCJtaW5cIiBpbiBjdXJQcm9wICYmICtjdXJQcm9wLm1pbiA+IGVuZCkge1xuICAgICAgICAgICAgaWYgKHByZXZlbnRPdmVyc2hvb3QgfHwgY3VyUHJvcC5wcmV2ZW50T3ZlcnNob290KSB7XG4gICAgICAgICAgICAgIGNoYW5nZTEgPSBjdXJQcm9wLm1pbiAtIGN1clZhbDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNoYW5nZTIgPSBjdXJQcm9wLm1pbiAtIGN1clZhbCAtIGNoYW5nZTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fcHJvcHMucHVzaChwKTtcblxuICAgICAgICB0aGlzLl9wdCA9IG5ldyBQcm9wVHdlZW4odGhpcy5fcHQsIHRhcmdldCwgcCwgY3VyVmFsLCAwLCBfZW1wdHlGdW5jLCAwLCBjYWNoZS5zZXQodGFyZ2V0LCBwLCB0aGlzKSk7XG4gICAgICAgIHRoaXMuX3B0LnUgPSB1bml0IHx8IDA7XG4gICAgICAgIHRoaXMuX3B0LmMxID0gY2hhbmdlMTtcbiAgICAgICAgdGhpcy5fcHQuYzIgPSBjaGFuZ2UyO1xuICAgICAgfVxuICAgIH1cblxuICAgIHR3ZWVuLmR1cmF0aW9uKGR1cmF0aW9uKTtcbiAgICByZXR1cm4gX2JvbnVzVmFsaWRhdGVkO1xuICB9LFxuICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihyYXRpbywgZGF0YSkge1xuICAgIHZhciBwdCA9IGRhdGEuX3B0O1xuICAgIHJhdGlvID0gX3Bvd2VyMyhkYXRhLnR3ZWVuLl90aW1lIC8gZGF0YS50d2Vlbi5fZHVyKTtcblxuICAgIHdoaWxlIChwdCkge1xuICAgICAgcHQuc2V0KHB0LnQsIHB0LnAsIF9yb3VuZChwdC5zICsgcHQuYzEgKiByYXRpbyArIHB0LmMyICogcmF0aW8gKiByYXRpbykgKyBwdC51LCBwdC5kLCByYXRpbyk7XG4gICAgICBwdCA9IHB0Ll9uZXh0O1xuICAgIH1cbiAgfVxufTtcblwidHJhY2ssdW50cmFjayxpc1RyYWNraW5nLGdldFZlbG9jaXR5LGdldEJ5VGFyZ2V0XCIuc3BsaXQoXCIsXCIpLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHtcbiAgcmV0dXJuIEluZXJ0aWFQbHVnaW5bbmFtZV0gPSBWZWxvY2l0eVRyYWNrZXJbbmFtZV07XG59KTtcbl9nZXRHU0FQKCkgJiYgZ3NhcC5yZWdpc3RlclBsdWdpbihJbmVydGlhUGx1Z2luKTtcbmV4cG9ydCB7IEluZXJ0aWFQbHVnaW4gYXMgZGVmYXVsdCwgVmVsb2NpdHlUcmFja2VyIH07IiwiZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfVxuXG5mdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfVxuXG4vLyBHc2FwXG5pbXBvcnQgeyBnc2FwIH0gZnJvbSAnZ3NhcCc7XG5pbXBvcnQgeyBEcmFnZ2FibGUgfSBmcm9tICdnc2FwL0RyYWdnYWJsZSc7XG5pbXBvcnQgSW5lcnRpYVBsdWdpbiBmcm9tICcuL0luZXJ0aWFQbHVnaW4nO1xuZ3NhcC5yZWdpc3RlclBsdWdpbihEcmFnZ2FibGUpO1xuZ3NhcC5yZWdpc3RlclBsdWdpbihJbmVydGlhUGx1Z2luKTsgLy9lbXB0eSBmdW5jdGlvblxuXG52YXIgbm9vcCA9IGZ1bmN0aW9uIG5vb3AoKSB7fTsgLy9lc2xpbnQtZGlzYWJsZS1saW5lXG5cblxudmFyIGxlcnAgPSBmdW5jdGlvbiBsZXJwKGEsIGIsIG4pIHtcbiAgcmV0dXJuICgxIC0gbikgKiBhICsgbiAqIGI7XG59OyAvLyBVdGlsaXRpZXNcblxuXG5pbXBvcnQgRG9tRXZlbnRzIGZyb20gJy4vZG9tRXZlbnRzJztcblxudmFyIF9kZWZhdWx0ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gX2RlZmF1bHQob3B0aW9ucykge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBfZGVmYXVsdCk7XG5cbiAgICAvL2hvb2sgZnVuY3Rpb25zXG4gICAgdGhpcy5fb25EcmFnU3RhcnQgPSBvcHRpb25zLm9uRHJhZ1N0YXJ0IHx8IG5vb3A7XG4gICAgdGhpcy5fb25EcmFnID0gb3B0aW9ucy5vbkRyYWcgfHwgbm9vcDtcbiAgICB0aGlzLl9vbkRyYWdFbmQgPSBvcHRpb25zLm9uRHJhZ0VuZCB8fCBub29wO1xuICAgIHRoaXMuX29uUHJvZ3Jlc3MgPSBvcHRpb25zLm9uUHJvZ3Jlc3MgfHwgbm9vcDtcbiAgICB0aGlzLl9vblByZXNzID0gb3B0aW9ucy5vblByZXNzIHx8IG5vb3A7XG4gICAgdGhpcy5fb25SZWxlYXNlID0gb3B0aW9ucy5vblJlbGVhc2UgfHwgbm9vcDsgLy8gdGhpcy5fb25TbmFwID0gb3B0aW9ucy5vblNuYXAgfHwgbm9vcDtcbiAgICAvLyB0aGlzLl9vblNuYXBMaW1pdHMgPSBvcHRpb25zLl9vblNuYXBMaW1pdHMgfHwgbm9vcDtcblxuICAgIHRoaXMuc2xpZGVyID0gb3B0aW9ucy50YXJnZXQ7XG4gICAgdGhpcy5zbGlkZXJDb250ZW50ID0gb3B0aW9ucy50YXJnZXRJbm5lcjtcbiAgICB0aGlzLnNuYXAgPSB0eXBlb2Ygb3B0aW9ucy5zbmFwICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuc25hcCA6IGZhbHNlO1xuICAgIHRoaXMuaXRlbSA9IHRoaXMuc2xpZGVyQ29udGVudC5xdWVyeVNlbGVjdG9yKCcuc2xpZGVyX19pdGVtJyk7XG4gICAgdGhpcy5kcmFnZ2FibGUgPSBudWxsO1xuICAgIHRoaXMuZGl2Tm9kZSA9IG51bGw7XG4gICAgdGhpcy5jdXJyZW50ID0gMDtcbiAgICB0aGlzLmxhc3QgPSAwOyAvLyB0aGlzLkJvdW5kSXRlbVdpZHRoID0gdGhpcy5pdGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoO1xuICAgIC8vIHRoaXMuc3R5bGVSaWdodEl0ZW0gPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLnNsaWRlckNvbnRlbnQucXVlcnlTZWxlY3RvcignYScpLCBudWxsKTtcbiAgICAvLyB0aGlzLlNuYXBJdGVtID0gdGhpcy5Cb3VuZEl0ZW1XaWR0aCArIChwYXJzZUludCh0aGlzLnN0eWxlUmlnaHRJdGVtLm1hcmdpblJpZ2h0LCAxMCkpO1xuXG4gICAgdGhpcy5pbml0KCk7XG4gIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWVtcHR5LWZ1bmN0aW9uXG5cblxuICBfY3JlYXRlQ2xhc3MoX2RlZmF1bHQsIFt7XG4gICAga2V5OiBcImV2ZW50c1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBldmVudHMoKSB7fVxuICB9LCB7XG4gICAga2V5OiBcImNyZWF0ZURyYWdnYWJsZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVEcmFnZ2FibGUoKSB7XG4gICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICB0aGlzLmRyYWdnYWJsZSA9IERyYWdnYWJsZS5jcmVhdGUodGhpcy5zbGlkZXJDb250ZW50LCB7XG4gICAgICAgIHR5cGU6ICd4JyxcbiAgICAgICAgbG9ja0F4aXM6IHRydWUsXG4gICAgICAgIGF1dG9TY3JvbGw6IHRydWUsXG4gICAgICAgIGRyYWdSZXNpc3RhbmNlOiAwLjEsXG4gICAgICAgIGVkZ2VSZXNpc3RhbmNlOiAwLjgsXG4gICAgICAgIGJvdW5kczogdGhpcy5zbGlkZXIsXG4gICAgICAgIGluZXJ0aWE6IHRydWUsXG4gICAgICAgIHRocm93UHJvcHM6IHRydWUsXG4gICAgICAgIHNuYXA6IGZ1bmN0aW9uIHNuYXAodmFsdWUpIHtcbiAgICAgICAgICByZXR1cm4gX3RoaXMuc25hcCA/IE1hdGgucm91bmQodmFsdWUgLyAtX3RoaXMuaXRlbS5vZmZzZXRXaWR0aCkgKiAtX3RoaXMuaXRlbS5vZmZzZXRXaWR0aCA6IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBvbkRyYWc6IGZ1bmN0aW9uIG9uRHJhZygpIHtcbiAgICAgICAgICBfdGhpcy5fb25EcmFnKF90aGlzKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25UaHJvd1VwZGF0ZTogZnVuY3Rpb24gb25UaHJvd1VwZGF0ZSgpIHtcbiAgICAgICAgICBfdGhpcy5fb25EcmFnKCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uRHJhZ1N0YXJ0OiBmdW5jdGlvbiBvbkRyYWdTdGFydCgpIHtcbiAgICAgICAgICBfdGhpcy5fb25EcmFnU3RhcnQoKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25EcmFnRW5kOiBmdW5jdGlvbiBvbkRyYWdFbmQoKSB7XG4gICAgICAgICAgX3RoaXMuX29uRHJhZ0VuZCgpO1xuICAgICAgICB9LFxuICAgICAgICBvblByb2dyZXNzOiBmdW5jdGlvbiBvblByb2dyZXNzKGUpIHtcbiAgICAgICAgICBfdGhpcy5fb25Qcm9ncmVzcyhlKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25QcmVzczogZnVuY3Rpb24gb25QcmVzcyhlKSB7XG4gICAgICAgICAgX3RoaXMuX29uUHJlc3MoZSk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uUmVsZWFzZTogZnVuY3Rpb24gb25SZWxlYXNlKGUpIHtcbiAgICAgICAgICBfdGhpcy5fb25SZWxlYXNlKGUpO1xuICAgICAgICB9IC8vIHNuYXA6IHtcbiAgICAgICAgLy8gICAgIHg6IChlbmRWYWx1ZSkgPT4ge1xuICAgICAgICAvLyAgICAgICAgIHJldHVybiBNYXRoLnJvdW5kKGVuZFZhbHVlIC8gdGhpcy5TbmFwSXRlbSkgKiB0aGlzLlNuYXBJdGVtO1xuICAgICAgICAvLyAgICAgfSxcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gb25QcmVzczogKGUpID0+XG4gICAgICAgIC8vIHtcbiAgICAgICAgLy8gICAgIGdzYXAudG8odGhpcy5zbGlkZXJDb250ZW50LCB7IHNjYWxlOiAwLjksIGVhc2U6ICdwb3dlcjEub3V0JywgZHVyYXRpb246IDEgfSk7XG4gICAgICAgIC8vICAgICAvLyBnc2FwLnRvKHRoaXMuJGNpcmNsZSwgeyBzY2FsZTogLjgsIGVhc2U6ICdwb3dlcjEub3V0JywgZHVyYXRpb246IC41IH0pO1xuICAgICAgICAvLyAgICAgLy8gdGhpcy4kY2lyY2xlLnF1ZXJ5U2VsZWN0b3IoJy5sYWJlbCcpLmlubmVySFRNTCA9IFwiXCI7XG4gICAgICAgIC8vICAgICAvLyB0aGlzLiRjaXJjbGUucXVlcnlTZWxlY3RvcignLmxhYmVsJykuYXBwZW5kQ2hpbGQoXG4gICAgICAgIC8vICAgICAvLyAgICAgdGhpcy4kY2lyY2xlLnF1ZXJ5U2VsZWN0b3IoJy5sYWJlbCcpLm93bmVyRG9jdW1lbnQuaW1wb3J0Tm9kZSh0aGlzLmRvYy5kb2N1bWVudEVsZW1lbnQsIHRydWUpKTtcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gb25SZWxlYXNlOiAoKSA9PlxuICAgICAgICAvLyB7XG4gICAgICAgIC8vICAgICBnc2FwLnRvKHRoaXMuc2xpZGVyQ29udGVudCwgeyBzY2FsZTogMSwgZWFzZTogJ3Bvd2VyMS5vdXQnLCBkdXJhdGlvbjogMSB9KTtcbiAgICAgICAgLy8gICAgIC8vIGdzYXAudG8odGhpcy4kY2lyY2xlLCB7IHNjYWxlOiAxLCBlYXNlOiAncG93ZXIxLm91dCcsIGR1cmF0aW9uOiAuNSB9KTtcbiAgICAgICAgLy8gICAgIC8vIHRoaXMuJGNpcmNsZS5xdWVyeVNlbGVjdG9yKCcubGFiZWwnKS5pbm5lckhUTUwgPSBcIkRSQUdcIjtcbiAgICAgICAgLy8gfVxuXG4gICAgICB9KTtcbiAgICB9IC8vIHNldCB1cCBkb3RzXG5cbiAgfSwge1xuICAgIGtleTogXCJzZXR1cERvdHNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0dXBEb3RzKCkge1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnNsaWRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLmRpdk5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGhpcy5kaXZOb2RlLmNsYXNzTGlzdC5hZGQoJ25hdl9kb3QnKTtcbiAgICAgICAgdGhpcy5kaXZOb2RlLmlkID0gJ2RvdF8nICsgaSArICcnO1xuICAgICAgICB0aGlzLiRuYXZEb3RzLmFwcGVuZENoaWxkKHRoaXMuZGl2Tm9kZSk7IC8vIHRoaXMuZGl2Tm9kZSA9IDtcbiAgICAgICAgLy8gdGhpcy4kbmF2RG90cy5wcmVwZW5kKCc8ZGl2IGNsYXNzPVwibmF2X2RvdFwiIGlkPVwiZG90XycgKyBpICsgJ1wiPjwvZGl2PicpO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJyZXNpemVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVzaXplKCkgey8vIHRoaXMuQm91bmRJdGVtV2lkdGggPSB0aGlzLml0ZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGg7XG4gICAgICAvLyB0aGlzLnN0eWxlUmlnaHRJdGVtID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGhpcy5zbGlkZXJDb250ZW50LnF1ZXJ5U2VsZWN0b3IoJ2EnKSwgbnVsbCk7XG4gICAgICAvLyB0aGlzLlNuYXBJdGVtID0gdGhpcy5Cb3VuZEl0ZW1XaWR0aCArIChwYXJzZUludCh0aGlzLnN0eWxlUmlnaHRJdGVtLm1hcmdpblJpZ2h0LCAxMCkpO1xuICAgICAgLy9nc2FwLnRvKHRoaXMuc2xpZGVyLCB7IHg6IDAsIGVhc2U6ICdwb3dlcjQuaW5PdXQnLCBkdXJhdGlvbjogMSB9KTtcbiAgICAgIC8vIHRoaXMuQm91bmRJdGVtV2lkdGggPSB0aGlzLml0ZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGg7XG4gICAgICAvLyB0aGlzLnN0eWxlUmlnaHRJdGVtID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGhpcy5zbGlkZXJDb250ZW50LnF1ZXJ5U2VsZWN0b3IoJ2EnKSwgbnVsbCk7XG4gICAgICAvLyB0aGlzLlNuYXBJdGVtID0gdGhpcy5Cb3VuZEl0ZW1XaWR0aCArIChwYXJzZUludCh0aGlzLnN0eWxlUmlnaHRJdGVtLm1hcmdpblJpZ2h0LCAxMCkpO1xuICAgICAgLy8gaWYgKHdpbmRvdy5pbm5lcldpZHRoID49IDEwMjUpIHtcbiAgICAgIC8vICAgICB0aGlzLmRyYWdnYWJsZVswXS5kaXNhYmxlKCk7XG4gICAgICAvLyAgICAgZ3NhcC50byh0aGlzLnNsaWRlciwgeyB4OiAwLCBlYXNlOiAncG93ZXI0LmluT3V0JywgZHVyYXRpb246IDEgfSk7XG4gICAgICAvLyB9XG4gICAgICAvLyBlbHNlXG4gICAgICAvLyAgICAgdGhpcy5kcmFnZ2FibGVbMF0uZW5hYmxlKCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImRlc3Ryb3lcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgIHRoaXMuZHJhZ2dhYmxlLmtpbGwoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiaW5pdFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgdGhpcy5jcmVhdGVEcmFnZ2FibGUoKTsgLy8gdGhpcy5zZXR1cERvdHMoKTtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gX2RlZmF1bHQ7XG59KCk7XG5cbmV4cG9ydCB7IF9kZWZhdWx0IGFzIGRlZmF1bHQgfTsiLCJmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyBcIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mXCI7IGlmICh0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uXCIpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7IH1cblxuZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH1cblxuZnVuY3Rpb24gX2NyZWF0ZVN1cGVyKERlcml2ZWQpIHsgdmFyIGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QgPSBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCk7IHJldHVybiBmdW5jdGlvbiBfY3JlYXRlU3VwZXJJbnRlcm5hbCgpIHsgdmFyIFN1cGVyID0gX2dldFByb3RvdHlwZU9mKERlcml2ZWQpLCByZXN1bHQ7IGlmIChoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KSB7IHZhciBOZXdUYXJnZXQgPSBfZ2V0UHJvdG90eXBlT2YodGhpcykuY29uc3RydWN0b3I7IHJlc3VsdCA9IFJlZmxlY3QuY29uc3RydWN0KFN1cGVyLCBhcmd1bWVudHMsIE5ld1RhcmdldCk7IH0gZWxzZSB7IHJlc3VsdCA9IFN1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IH0gcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIHJlc3VsdCk7IH07IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSkgeyByZXR1cm4gY2FsbDsgfSBlbHNlIGlmIChjYWxsICE9PSB2b2lkIDApIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkRlcml2ZWQgY29uc3RydWN0b3JzIG1heSBvbmx5IHJldHVybiBvYmplY3Qgb3IgdW5kZWZpbmVkXCIpOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9XG5cbmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gc2VsZjsgfVxuXG5mdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkgeyBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwidW5kZWZpbmVkXCIgfHwgIVJlZmxlY3QuY29uc3RydWN0KSByZXR1cm4gZmFsc2U7IGlmIChSZWZsZWN0LmNvbnN0cnVjdC5zaGFtKSByZXR1cm4gZmFsc2U7IGlmICh0eXBlb2YgUHJveHkgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIHRydWU7IHRyeSB7IEJvb2xlYW4ucHJvdG90eXBlLnZhbHVlT2YuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChCb29sZWFuLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgcmV0dXJuIHRydWU7IH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlOyB9IH1cblxuZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfVxuXG4vLyBHc2FwXG5pbXBvcnQgZ3NhcCBmcm9tICdnc2FwJztcbmltcG9ydCBTY3JvbGxUcmlnZ2VyIGZyb20gJ2dzYXAvU2Nyb2xsVHJpZ2dlcic7XG5nc2FwLnJlZ2lzdGVyUGx1Z2luKFNjcm9sbFRyaWdnZXIpOyAvLyBJbXBvcnQgUmVuZGVyZXJcblxuaW1wb3J0IFJlbmRlcmVyIGZyb20gJy4vcmVuZGVyZXIuanMnOyAvLyBpbXBvcnQgc3R5bGVzRGVmYXVsdCBmcm9tICcuL3N0eWxlc0RlZmF1bHQuY3NzJzsgLy9lc2xpbnQtZGlzYWJsZS1saW5lXG4vLyBVdGlsaXRpZXNcblxuaW1wb3J0IFN1cGVyRHJhZ2dlciBmcm9tICcuLi9jbGFzc2VzL3N1cGVyRHJhZ2dlcic7XG5pbXBvcnQgRHJhZ2dhYmxlIGZyb20gJy4uL2NsYXNzZXMvRHJhZ2dhYmxlJzsgLy8gT3RoZXJcbi8vIGltcG9ydCBTbGlkZXIgZnJvbSAnLi4vY2xhc3Nlcy9zbGlkZXInO1xuLy8gaW1wb3J0IFNwbGl0VGV4dCBmcm9tICcuLi9jbGFzc2VzL3NwbGl0VGV4dCc7XG5cbnZhciBSZW5kZXJlckhvbWUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9SZW5kZXJlcikge1xuICBfaW5oZXJpdHMoUmVuZGVyZXJIb21lLCBfUmVuZGVyZXIpO1xuXG4gIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoUmVuZGVyZXJIb21lKTtcblxuICBmdW5jdGlvbiBSZW5kZXJlckhvbWUoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJlbmRlcmVySG9tZSk7XG5cbiAgICByZXR1cm4gX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoUmVuZGVyZXJIb21lLCBbe1xuICAgIGtleTogXCJzZWxlY3RvcnNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2VsZWN0b3JzKCkge1xuICAgICAgdGhpcy4kaGVybyA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3IoJy5ob21lX19oZXJvJyk7XG4gICAgICB0aGlzLiRwb3N0ZXIgPSB0aGlzLiRlbC5xdWVyeVNlbGVjdG9yKCcuaG9tZV9fcG9zdGVyJyk7XG4gICAgICB0aGlzLiRtYXN0ZXJ3b3JrcyA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3IoJy5ob21lX19tYXN0ZXJ3b3JrcycpO1xuICAgICAgdGhpcy4kcmVsYXRlZCA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3IoJy5ob21lX19yZWxhdGVkJyk7IC8vIFZpZGVvXG5cbiAgICAgIHRoaXMuJHZpZGVvID0gdGhpcy4kaGVyby5xdWVyeVNlbGVjdG9yKCcudmlkZW8nKTtcblxuICAgICAgaWYgKHRoaXMuJHZpZGVvKSB7XG4gICAgICAgIHRoaXMuJHZpZGVvTG9vcCA9IHRoaXMuJHZpZGVvLnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fbG9vcCcpO1xuICAgICAgICB0aGlzLiR2aWRlb0xvb3BJdGVtID0gdGhpcy4kdmlkZW8ucXVlcnlTZWxlY3RvcignLnZpZGVvX19sb29wIHZpZGVvJyk7XG4gICAgICAgIHRoaXMuJHZpZGVvUG9zdGVyID0gdGhpcy4kdmlkZW8ucXVlcnlTZWxlY3RvcignLnZpZGVvX19wb3N0ZXInKTtcbiAgICAgICAgdGhpcy4kdmlkZW9UcmlnZ2VyID0gdGhpcy4kdmlkZW8ucXVlcnlTZWxlY3RvcignLnZpZGVvX190cmlnZ2VyJyk7XG4gICAgICAgIHRoaXMuJHZpZGVvTW9kYWwgPSB0aGlzLiRlbC5xdWVyeVNlbGVjdG9yKCcudmlkZW8tLW1vZGFsJyk7XG4gICAgICAgIHRoaXMuJHZpZGVvTWFzayA9IHRoaXMuJHZpZGVvTW9kYWwucXVlcnlTZWxlY3RvcignLnZpZGVvX19tYXNrJyk7XG4gICAgICAgIHRoaXMuJHZpZGVvUGxheWVyID0gdGhpcy4kdmlkZW9Nb2RhbC5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX3BsYXllcicpO1xuICAgICAgICB0aGlzLiR2aWRlb1BsYXllckl0ZW0gPSB0aGlzLiR2aWRlb01vZGFsLnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fcGxheWVyIHZpZGVvJyk7XG4gICAgICAgIHRoaXMuJHZpZGVvQ2xvc2VyID0gdGhpcy4kdmlkZW9Nb2RhbC5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX2Nsb3NlcicpO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJiZWZvcmVFbnRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBiZWZvcmVFbnRlcigpIHsvLyBpZih0aGlzLmFwcFN0b3JlLmlzRGVza3RvcClcbiAgICAgIC8vICAgICBnc2FwLnNldCh0aGlzLiRoZXJvLnF1ZXJ5U2VsZWN0b3IoJy5sb2dvJyksIHsgb3BhY2l0eTogMC4wMDAxIH0pO1xuICAgICAgLy8gZ3NhcC5zZXQodGhpcy4kaGVyby5xdWVyeVNlbGVjdG9yKCcudGl0bGUnKSwgeyBvcGFjaXR5OiAwLjAwMDEgfSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImV2ZW50c1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBldmVudHMoKSB7XG4gICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICBpZiAodGhpcy4kdmlkZW9QbGF5ZXIgJiYgdGhpcy4kdmlkZW9UcmlnZ2VyKSB7XG4gICAgICAgIHRoaXMuZG9tRXZlbnRzLmFkZCh0aGlzLiR2aWRlb1RyaWdnZXIsICdjbGljaycsIGZ1bmN0aW9uIChlLCBhLCBlbCkge1xuICAgICAgICAgIGlmIChfdGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHtcbiAgICAgICAgICAgIF90aGlzLmxhc3RTY3JvbGwgPSBfdGhpcy5zdXBlclNjcm9sbGVyLl9zY3JvbGwubGl2ZVBvc2l0aW9uLnk7XG5cbiAgICAgICAgICAgIHZhciBfb2Zmc2V0ID0gX3RoaXMuJHZpZGVvTG9vcC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgLSB3aW5kb3cuaW5uZXJXaWR0aCAqIDAuMDU7XG5cbiAgICAgICAgICAgIF90aGlzLnN1cGVyU2Nyb2xsZXIuc2Nyb2xsQW5pbWF0ZShfb2Zmc2V0IC0gX3RoaXMubGFzdFNjcm9sbCwgMSwgJ2V4cG8uaW5PdXQnLCB0cnVlKTtcblxuICAgICAgICAgICAgZ3NhcC5kZWxheWVkQ2FsbCgxLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIF90aGlzLnZpZGVvT3BlbihlLCBhLCBlbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgX3RoaXMudmlkZW9PcGVuKGUsIGEsIGVsKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmRvbUV2ZW50cy5hZGQodGhpcy4kdmlkZW9DbG9zZXIsICdjbGljaycsIGZ1bmN0aW9uIChlLCBhLCBlbCkge1xuICAgICAgICAgIF90aGlzLnZpZGVvQ2xvc2UoZSwgYSwgZWwpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5kb21FdmVudHMuYWRkKHRoaXMuJHZpZGVvTWFzaywgJ2NsaWNrJywgZnVuY3Rpb24gKGUsIGEsIGVsKSB7XG4gICAgICAgICAgX3RoaXMudmlkZW9DbG9zZShlLCBhLCBlbCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmRvbUV2ZW50cy5hZGQodGhpcy4kdmlkZW9QbGF5ZXJJdGVtLCAnZW5kZWQnLCBmdW5jdGlvbiAoZSwgYSwgZWwpIHtcbiAgICAgICAgICBfdGhpcy52aWRlb0Nsb3NlKGUsIGEsIGVsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKSB7XG4gICAgICAgICAgdGhpcy5kb21FdmVudHMuYWRkKHRoaXMuJHZpZGVvVHJpZ2dlciwgJ21vdXNlZW50ZXInLCBmdW5jdGlvbiAoZSwgYSwgZWwpIHtcbiAgICAgICAgICAgIF90aGlzLmVudGVySWNvbihlLCBhLCBlbCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdGhpcy5kb21FdmVudHMuYWRkKHRoaXMuJHZpZGVvVHJpZ2dlciwgJ21vdXNlbGVhdmUnLCBmdW5jdGlvbiAoZSwgYSwgZWwpIHtcbiAgICAgICAgICAgIF90aGlzLmxlYXZlSWNvbihlLCBhLCBlbCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdGhpcy5kb21FdmVudHMuYWRkKHRoaXMuJHZpZGVvQ2xvc2VyLCAnbW91c2VlbnRlcicsIGZ1bmN0aW9uIChlLCBhLCBlbCkge1xuICAgICAgICAgICAgX3RoaXMuZW50ZXJJY29uKGUsIGEsIGVsKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0aGlzLmRvbUV2ZW50cy5hZGQodGhpcy4kdmlkZW9DbG9zZXIsICdtb3VzZWxlYXZlJywgZnVuY3Rpb24gKGUsIGEsIGVsKSB7XG4gICAgICAgICAgICBfdGhpcy5sZWF2ZUljb24oZSwgYSwgZWwpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImVudGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGVudGVyKCkge1xuICAgICAgLy8gaWYodGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApXG4gICAgICAvLyAgICAgZ3NhcC50byh0aGlzLiRoZXJvLnF1ZXJ5U2VsZWN0b3IoJy5sb2dvJyksIHsgb3BhY2l0eTogMSwgZHVyYXRpb246IDEsIGVhc2U6ICdwb3dlcjIub3V0JyB9KTtcbiAgICAgIC8vIGdzYXAudG8odGhpcy4kaGVyby5xdWVyeVNlbGVjdG9yKCcudGl0bGUnKSwgeyBvcGFjaXR5OiAxLCBkdXJhdGlvbjogMSwgZWFzZTogJ3Bvd2VyMi5vdXQnIH0pO1xuICAgICAgaWYgKHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKSBnc2FwLnRvKHRoaXMuYXBwVWkuJGhlYWRlclN1Ym1lbnUsIHtcbiAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgZHVyYXRpb246IDEsXG4gICAgICAgIGVhc2U6ICdwb3dlcjIub3V0J1xuICAgICAgfSk7XG4gICAgICBpZiAodGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHRoaXMuaW5pdEhlcm8oKTtcbiAgICAgIHRoaXMuaW5pdFNjcm9sbHRpdGxlKCk7XG4gICAgICB0aGlzLmluaXRQYXJhbGxheFBvc3RlcigpO1xuICAgICAgdGhpcy5pbml0TWFzdGVyd29ya3MoKTtcbiAgICAgIHRoaXMuaW5pdFJlbGF0ZWQoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiaW5pdEhlcm9cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdEhlcm8oKSB7XG4gICAgICBpZiAodGhpcy4kaGVybykge1xuICAgICAgICB0aGlzLiRoZXJvT3V0ZXJzID0gdGhpcy4kaGVyby5xdWVyeVNlbGVjdG9yQWxsKCcub3V0ZXInKTtcbiAgICAgICAgdmFyIGhlcm9UaW1lbGluZSA9IGdzYXAudGltZWxpbmUoe1xuICAgICAgICAgIGRlZmF1bHRzOiB7XG4gICAgICAgICAgICBlYXNlOiAnbm9uZSdcbiAgICAgICAgICB9LFxuICAgICAgICAgIHNjcm9sbFRyaWdnZXI6IHtcbiAgICAgICAgICAgIHRyaWdnZXI6IHRoaXMuJGhlcm8sXG4gICAgICAgICAgICBzY3J1YjogdHJ1ZSxcbiAgICAgICAgICAgIHN0YXJ0OiAndG9wIHRvcCcsXG4gICAgICAgICAgICBlbmQ6IHdpbmRvdy5pbm5lckhlaWdodCAqIDIgKyAncHggdG9wJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLiRoZXJvT3V0ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgaGVyb1RpbWVsaW5lLnRvKHRoaXMuJGhlcm9PdXRlcnNbaV0sIHtcbiAgICAgICAgICAgIHk6IGkgKiAxNSArICd2dydcbiAgICAgICAgICB9LCAwKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJ2aWRlb09wZW5cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gdmlkZW9PcGVuKCkge1xuICAgICAgdGhpcy4kdmlkZW9Mb29wSXRlbS5wYXVzZSgpO1xuICAgICAgZ3NhcC5zZXQodGhpcy4kdmlkZW9Nb2RhbCwge1xuICAgICAgICBkaXNwbGF5OiAnYmxvY2snLFxuICAgICAgICB6SW5kZXg6IDEwMDBcbiAgICAgIH0pO1xuICAgICAgaWYgKHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKSB0aGlzLnN1cGVyU2Nyb2xsZXIuX3Njcm9sbC5lbmFibGUgPSBmYWxzZTtlbHNlIHRoaXMuJHZpZGVvTW9kYWwuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfSk7XG4gICAgICB0aGlzLm9wZW5lZCA9IHRydWU7XG4gICAgICB0aGlzLiR2aWRlb1BsYXllckl0ZW0ucGxheSgpO1xuICAgICAgdGhpcy4kdmlkZW9QbGF5ZXJJdGVtLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7XG4gICAgICBnc2FwLnRvKHRoaXMuJHZpZGVvTWFzaywge1xuICAgICAgICBvcGFjaXR5OiAwLjgsXG4gICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgIGR1cmF0aW9uOiAwLjVcbiAgICAgIH0pO1xuICAgICAgZ3NhcC50byh0aGlzLiR2aWRlb1BsYXllciwge1xuICAgICAgICB5OiAnLTUwJScsXG4gICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgIGR1cmF0aW9uOiAwLjgsXG4gICAgICAgIGRlbGF5OiAwLjVcbiAgICAgIH0pO1xuICAgICAgZ3NhcC50byh0aGlzLiR2aWRlb0Nsb3Nlciwge1xuICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICBkdXJhdGlvbjogMC44LFxuICAgICAgICBkZWxheTogMS4zXG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwidmlkZW9DbG9zZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiB2aWRlb0Nsb3NlKCkge1xuICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgIHRoaXMub3BlbmVkID0gZmFsc2U7XG4gICAgICBnc2FwLnRvKHRoaXMuJHZpZGVvQ2xvc2VyLCB7XG4gICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgZHVyYXRpb246IDAuOFxuICAgICAgfSk7XG4gICAgICBnc2FwLnRvKHRoaXMuJHZpZGVvUGxheWVyLCB7XG4gICAgICAgIHk6IHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wID8gJy0yMDAlJyA6ICctMzAwJScsXG4gICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgIGR1cmF0aW9uOiAwLjgsXG4gICAgICAgIGRlbGF5OiAwLjVcbiAgICAgIH0pO1xuICAgICAgZ3NhcC50byh0aGlzLiR2aWRlb01hc2ssIHtcbiAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICBkdXJhdGlvbjogMC41LFxuICAgICAgICBkZWxheTogMS4zLFxuICAgICAgICBvbkNvbXBsZXRlOiBmdW5jdGlvbiBvbkNvbXBsZXRlKCkge1xuICAgICAgICAgIF90aGlzMi4kdmlkZW9Mb29wSXRlbS5wbGF5KCk7XG5cbiAgICAgICAgICBfdGhpczIuJHZpZGVvUGxheWVySXRlbS5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG5cbiAgICAgICAgICBfdGhpczIuJHZpZGVvUGxheWVySXRlbS5wYXVzZSgpO1xuXG4gICAgICAgICAgX3RoaXMyLiR2aWRlb1BsYXllckl0ZW0uY3VycmVudFRpbWUgPSAwO1xuICAgICAgICAgIGdzYXAuc2V0KF90aGlzMi4kdmlkZW9Nb2RhbCwge1xuICAgICAgICAgICAgZGlzcGxheTogJ25vbmUnLFxuICAgICAgICAgICAgekluZGV4OiAnaW5pdGlhbCdcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAoX3RoaXMyLmFwcFN0b3JlLmlzRGVza3RvcCkgX3RoaXMyLnN1cGVyU2Nyb2xsZXIuX3Njcm9sbC5lbmFibGUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiZW50ZXJJY29uXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGVudGVySWNvbihlLCBhLCBlbCkge1xuICAgICAgZ3NhcC50byhlbCwge1xuICAgICAgICBzY2FsZTogMC45LFxuICAgICAgICBkdXJhdGlvbjogMS41LFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwibGVhdmVJY29uXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGxlYXZlSWNvbihlLCBhLCBlbCkge1xuICAgICAgZ3NhcC50byhlbCwge1xuICAgICAgICBzY2FsZTogMSxcbiAgICAgICAgZHVyYXRpb246IDEuNSxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0J1xuICAgICAgfSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImluaXRTY3JvbGx0aXRsZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0U2Nyb2xsdGl0bGUoKSB7XG4gICAgICB2YXIgX3RoaXMzID0gdGhpcztcblxuICAgICAgdGhpcy5zY3JvbGx0aXRsZXMgPSBbXTtcbiAgICAgIHRoaXMuJHNjcm9sbHRpdGxlcyA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zY3JvbGx0aXRsZScpO1xuXG4gICAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcChpKSB7XG4gICAgICAgIHZhciBzcGVlZCA9IF90aGlzMy4kc2Nyb2xsdGl0bGVzW2ldLmRhdGFzZXQuc3BlZWQ7XG4gICAgICAgIHZhciBzY3JvbGx0aXRsZSA9IHt9O1xuICAgICAgICBzY3JvbGx0aXRsZS4kc2Nyb2xsdGl0bGVzSXRlbXMgPSBfdGhpczMuJHNjcm9sbHRpdGxlc1tpXS5jaGlsZHJlbjtcbiAgICAgICAgX3RoaXMzLiRzY3JvbGx0aXRsZXNbaV0uc3R5bGUud2lkdGggPSBzY3JvbGx0aXRsZS4kc2Nyb2xsdGl0bGVzSXRlbXNbMF0ub2Zmc2V0V2lkdGggKyAncHgnO1xuICAgICAgICBzY3JvbGx0aXRsZS5zY3JvbGxUaXRsZUlubmVyTGVmdCA9IGdzYXAudGltZWxpbmUoe1xuICAgICAgICAgIHBhdXNlZDogZmFsc2UsXG4gICAgICAgICAgZGVmYXVsdHM6IHtcbiAgICAgICAgICAgIGVhc2U6ICdub25lJyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiBfdGhpczMuYXBwU3RvcmUuaXNEZXNrdG9wID8gc2Nyb2xsdGl0bGUuJHNjcm9sbHRpdGxlc0l0ZW1zWzBdLm9mZnNldFdpZHRoIC8gMzAwIDogc2Nyb2xsdGl0bGUuJHNjcm9sbHRpdGxlc0l0ZW1zWzBdLm9mZnNldFdpZHRoIC8gMTAwLFxuICAgICAgICAgICAgcmVwZWF0OiAnLTEnLFxuICAgICAgICAgICAgb25SZXZlcnNlQ29tcGxldGU6IGZ1bmN0aW9uIG9uUmV2ZXJzZUNvbXBsZXRlKCkge1xuICAgICAgICAgICAgICBzY3JvbGx0aXRsZS5zY3JvbGxUaXRsZUlubmVyTGVmdC5wYXVzZSgpO1xuICAgICAgICAgICAgICBzY3JvbGx0aXRsZS5zY3JvbGxUaXRsZUlubmVyUmlnaHQucGxheSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzY3JvbGx0aXRsZS4kc2Nyb2xsdGl0bGVzSXRlbXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICBzY3JvbGx0aXRsZS5zY3JvbGxUaXRsZUlubmVyTGVmdC50byhzY3JvbGx0aXRsZS4kc2Nyb2xsdGl0bGVzSXRlbXNbal0sIHtcbiAgICAgICAgICAgIHg6IC0xMDAgKiBzcGVlZCArICclJ1xuICAgICAgICAgIH0sIDApO1xuICAgICAgICB9XG5cbiAgICAgICAgc2Nyb2xsdGl0bGUuc2Nyb2xsVGl0bGVJbm5lclJpZ2h0ID0gZ3NhcC50aW1lbGluZSh7XG4gICAgICAgICAgcGF1c2VkOiB0cnVlLFxuICAgICAgICAgIGRlZmF1bHRzOiB7XG4gICAgICAgICAgICBlYXNlOiAnbm9uZScsXG4gICAgICAgICAgICBkdXJhdGlvbjogX3RoaXMzLmFwcFN0b3JlLmlzRGVza3RvcCA/IHNjcm9sbHRpdGxlLiRzY3JvbGx0aXRsZXNJdGVtc1swXS5vZmZzZXRXaWR0aCAvIDMwMCA6IHNjcm9sbHRpdGxlLiRzY3JvbGx0aXRsZXNJdGVtc1swXS5vZmZzZXRXaWR0aCAvIDEwMCxcbiAgICAgICAgICAgIHJlcGVhdDogJy0xJyxcbiAgICAgICAgICAgIG9uUmV2ZXJzZUNvbXBsZXRlOiBmdW5jdGlvbiBvblJldmVyc2VDb21wbGV0ZSgpIHtcbiAgICAgICAgICAgICAgc2Nyb2xsdGl0bGUuc2Nyb2xsVGl0bGVJbm5lclJpZ2h0LnBhdXNlKCk7XG4gICAgICAgICAgICAgIHNjcm9sbHRpdGxlLnNjcm9sbFRpdGxlSW5uZXJMZWZ0LnBsYXkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZvciAodmFyIF9qID0gMDsgX2ogPCBzY3JvbGx0aXRsZS4kc2Nyb2xsdGl0bGVzSXRlbXMubGVuZ3RoOyBfaisrKSB7XG4gICAgICAgICAgc2Nyb2xsdGl0bGUuc2Nyb2xsVGl0bGVJbm5lclJpZ2h0LnRvKHNjcm9sbHRpdGxlLiRzY3JvbGx0aXRsZXNJdGVtc1tfal0sIHtcbiAgICAgICAgICAgIHg6IDEwMCAqIHNwZWVkICsgJyUnXG4gICAgICAgICAgfSwgMCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoX3RoaXMzLmFwcFN0b3JlLmlzRGVza3RvcCkge1xuICAgICAgICAgIHNjcm9sbHRpdGxlLnNjcm9sbFRpdGxlT3V0ZXIgPSBnc2FwLnRpbWVsaW5lKHtcbiAgICAgICAgICAgIGRlZmF1bHRzOiB7XG4gICAgICAgICAgICAgIGVhc2U6ICdub25lJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNjcm9sbFRyaWdnZXI6IHtcbiAgICAgICAgICAgICAgdHJpZ2dlcjogX3RoaXMzLiRzY3JvbGx0aXRsZXNbaV0sXG4gICAgICAgICAgICAgIHNjcnViOiB0cnVlLFxuICAgICAgICAgICAgICBzdGFydDogJ3RvcCBib3R0b20nLFxuICAgICAgICAgICAgICBlbmQ6ICdib3R0b20gdG9wJyxcbiAgICAgICAgICAgICAgb25VcGRhdGU6IGZ1bmN0aW9uIG9uVXBkYXRlKHNlbGYpIHtcbiAgICAgICAgICAgICAgICAvLyB0aGlzLnNjcm9sbFRpdGxlSW5uZXIudGltZVNjYWxlKHNlbGYuZGlyZWN0aW9uKTtcbiAgICAgICAgICAgICAgICBpZiAoIXNjcm9sbHRpdGxlLnNjcm9sbFRpdGxlSW5uZXJMZWZ0LnBhdXNlZCgpKSBzY3JvbGx0aXRsZS5zY3JvbGxUaXRsZUlubmVyTGVmdC5yZXZlcnNlZChzZWxmLmRpcmVjdGlvbiAhPT0gMSk7XG4gICAgICAgICAgICAgICAgaWYgKCFzY3JvbGx0aXRsZS5zY3JvbGxUaXRsZUlubmVyUmlnaHQucGF1c2VkKCkpIHNjcm9sbHRpdGxlLnNjcm9sbFRpdGxlSW5uZXJSaWdodC5yZXZlcnNlZChzZWxmLmRpcmVjdGlvbiA9PT0gMSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBzY3JvbGx0aXRsZS5zY3JvbGxUaXRsZU91dGVyLmZyb21UbyhfdGhpczMuJHNjcm9sbHRpdGxlc1tpXSwge1xuICAgICAgICAgICAgeDogd2luZG93LmlubmVyV2lkdGggKiAwLjIgKiBzcGVlZFxuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIHg6IC13aW5kb3cuaW5uZXJXaWR0aCAqIDAuMiAqIHNwZWVkXG4gICAgICAgICAgfSwgMCk7XG4gICAgICAgIH1cblxuICAgICAgICBfdGhpczMuc2Nyb2xsdGl0bGVzLnB1c2goc2Nyb2xsdGl0bGUpO1xuICAgICAgfTtcblxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLiRzY3JvbGx0aXRsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgX2xvb3AoaSk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInJlc2l6ZVNjcm9sbHRpdGxlc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZXNpemVTY3JvbGx0aXRsZXMoKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuJHNjcm9sbHRpdGxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLiRzY3JvbGx0aXRsZXNbaV0uc3R5bGUud2lkdGggPSAnJztcbiAgICAgIH1cblxuICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IHRoaXMuc2Nyb2xsdGl0bGVzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBpZiAodGhpcy5zY3JvbGx0aXRsZXNbX2ldLnNjcm9sbFRpdGxlSW5uZXJMZWZ0KSB0aGlzLnNjcm9sbHRpdGxlc1tfaV0uc2Nyb2xsVGl0bGVJbm5lckxlZnQucGF1c2UoMCkua2lsbCh0cnVlKTtcbiAgICAgICAgaWYgKHRoaXMuc2Nyb2xsdGl0bGVzW19pXS5zY3JvbGxUaXRsZUlubmVyUmlnaHQpIHRoaXMuc2Nyb2xsdGl0bGVzW19pXS5zY3JvbGxUaXRsZUlubmVyUmlnaHQucGF1c2UoMCkua2lsbCh0cnVlKTtcbiAgICAgICAgaWYgKHRoaXMuc2Nyb2xsdGl0bGVzW19pXS5zY3JvbGxUaXRsZU91dGVyKSB0aGlzLnNjcm9sbHRpdGxlc1tfaV0uc2Nyb2xsVGl0bGVPdXRlci5wYXVzZSgwKS5raWxsKHRydWUpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmluaXRTY3JvbGx0aXRsZSgpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJpbml0UGFyYWxsYXhQb3N0ZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdFBhcmFsbGF4UG9zdGVyKCkge1xuICAgICAgaWYgKHRoaXMuJHBvc3Rlcikge1xuICAgICAgICB0aGlzLiRwb3N0ZXJJbWFnZSA9IHRoaXMuJHBvc3Rlci5xdWVyeVNlbGVjdG9yKCcuaW1hZ2UnKTtcbiAgICAgICAgdGhpcy4kcG9zdGVyVGl0bGUgPSB0aGlzLiRwb3N0ZXIucXVlcnlTZWxlY3RvcignLnN1cGVydGl0bGUnKTtcbiAgICAgICAgdGhpcy50aW1lbGluZVBhcmFsbGF4UG9zdGVyID0gZ3NhcC50aW1lbGluZSh7XG4gICAgICAgICAgZGVmYXVsdHM6IHtcbiAgICAgICAgICAgIGVhc2U6ICdub25lJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgc2Nyb2xsVHJpZ2dlcjoge1xuICAgICAgICAgICAgdHJpZ2dlcjogdGhpcy4kcG9zdGVySW1hZ2UsXG4gICAgICAgICAgICBzY3J1YjogdHJ1ZSxcbiAgICAgICAgICAgIHN0YXJ0OiAnLT0nICsgd2luZG93LmlubmVyV2lkdGggKiAwLjA1ICsgJyBib3R0b20nLFxuICAgICAgICAgICAgZW5kOiB0aGlzLiRwb3N0ZXJJbWFnZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQgLSB3aW5kb3cuaW5uZXJXaWR0aCAqIDAuMDUgKyAnIHRvcCdcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgdG9wID0gdGhpcy4kcG9zdGVySW1hZ2UuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0IC8gMiAtIHRoaXMuJHBvc3RlclRpdGxlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCAvIDI7XG4gICAgICAgIHZhciBvZmZzZXQgPSB0aGlzLiRwb3N0ZXJJbWFnZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQgLyAyIC0gdGhpcy4kcG9zdGVyVGl0bGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0IC8gMiAtIHdpbmRvdy5pbm5lcldpZHRoICogMC4wNTtcbiAgICAgICAgdGhpcy4kcG9zdGVyVGl0bGUuc3R5bGUudG9wID0gdG9wICsgJ3B4JztcbiAgICAgICAgdGhpcy50aW1lbGluZVBhcmFsbGF4UG9zdGVyLnNldCh0aGlzLiRwb3N0ZXJUaXRsZSwge1xuICAgICAgICAgIHk6IC1vZmZzZXRcbiAgICAgICAgfSwgMCk7XG4gICAgICAgIHRoaXMudGltZWxpbmVQYXJhbGxheFBvc3Rlci50byh0aGlzLiRwb3N0ZXJUaXRsZSwge1xuICAgICAgICAgIHk6IG9mZnNldFxuICAgICAgICB9LCAwKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiaW5pdE1hc3RlcndvcmtzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRNYXN0ZXJ3b3JrcygpIHtcbiAgICAgIGlmICh0aGlzLiRtYXN0ZXJ3b3Jrcykge1xuICAgICAgICBnc2FwLnNldCh0aGlzLiRtYXN0ZXJ3b3Jrcy5xdWVyeVNlbGVjdG9yKCcuYmFja2dyb3VuZF9fYmcnKSwge1xuICAgICAgICAgIHk6ICctMTB2dycsXG4gICAgICAgICAgc2NhbGU6IDEuMlxuICAgICAgICB9KTtcbiAgICAgICAgdmFyIGJhY2tncm91bmRUaW1lbGluZSA9IGdzYXAudGltZWxpbmUoe1xuICAgICAgICAgIHNjcm9sbFRyaWdnZXI6IHtcbiAgICAgICAgICAgIHRyaWdnZXI6IHRoaXMuJG1hc3RlcndvcmtzLnF1ZXJ5U2VsZWN0b3IoJy5iYWNrZ3JvdW5kJyksXG4gICAgICAgICAgICBzdGFydDogJ3RvcCBib3R0b20nLFxuICAgICAgICAgICAgZW5kOiAnYm90dG9tIHRvcCcsXG4gICAgICAgICAgICBzY3J1YjogdHJ1ZSAvLyBvblRvZ2dsZTogKGlzQWN0aXZlKSA9PlxuICAgICAgICAgICAgLy8ge1xuICAgICAgICAgICAgLy8gICAgIGlzQWN0aXZlID8gdGhpcy4kdmlkZW9Db3Zlci5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX3BsYXllciB2aWRlbycpLnBsYXkoKSA6IHRoaXMuJHZpZGVvQ292ZXIucXVlcnlTZWxlY3RvcignLnZpZGVvX19wbGF5ZXIgdmlkZW8nKS5wYXVzZSgpO1xuICAgICAgICAgICAgLy8gfVxuXG4gICAgICAgICAgfSxcbiAgICAgICAgICBkZWZhdWx0czoge1xuICAgICAgICAgICAgZHVyYXRpb246IDEsXG4gICAgICAgICAgICBlYXNlOiAnbm9uZSdcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBiYWNrZ3JvdW5kVGltZWxpbmUudG8odGhpcy4kbWFzdGVyd29ya3MucXVlcnlTZWxlY3RvcignLmJhY2tncm91bmRfX2JnJyksIHtcbiAgICAgICAgICB5OiAnMTB2dycsXG4gICAgICAgICAgc2NhbGU6IDEsXG4gICAgICAgICAgZHVyYXRpb246IDFcbiAgICAgICAgfSwgMCk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImluaXRSZWxhdGVkXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRSZWxhdGVkKCkge1xuICAgICAgdmFyIF90aGlzNCA9IHRoaXM7XG5cbiAgICAgIC8vIFNlbGVjdG9yc1xuICAgICAgdGhpcy4kcmVsYXRlZFNsaWRlciA9IHRoaXMuJHJlbGF0ZWQucXVlcnlTZWxlY3RvcignLnNsaWRlcicpO1xuICAgICAgdGhpcy4kcmVsYXRlZFNsaWRlcklubmVyID0gdGhpcy4kcmVsYXRlZC5xdWVyeVNlbGVjdG9yKCcuc2xpZGVyX19pbm5lcicpO1xuICAgICAgdGhpcy4kcmVsYXRlZFNsaWRlckl0ZW1zID0gdGhpcy4kcmVsYXRlZC5xdWVyeVNlbGVjdG9yQWxsKCcuc2xpZGVyX19pdGVtJyk7XG4gICAgICB0aGlzLiRyZWxhdGVkUHJvbW90aW9ucyA9IHRoaXMuJHJlbGF0ZWQucXVlcnlTZWxlY3RvckFsbCgnLnByb21vdGlvbicpO1xuXG4gICAgICBpZiAodGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLiRyZWxhdGVkUHJvbW90aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHRoaXMuZG9tRXZlbnRzLmFkZCh0aGlzLiRyZWxhdGVkUHJvbW90aW9uc1tpXSwgJ21vdXNlZW50ZXInLCBmdW5jdGlvbiAoZSwgYSwgZWwpIHtcbiAgICAgICAgICAgIF90aGlzNC5wcm9tb3Rpb25FbnRlcihlbCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdGhpcy5kb21FdmVudHMuYWRkKHRoaXMuJHJlbGF0ZWRQcm9tb3Rpb25zW2ldLCAnbW91c2VsZWF2ZScsIGZ1bmN0aW9uIChlLCBhLCBlbCkge1xuICAgICAgICAgICAgX3RoaXM0LnByb21vdGlvbkxlYXZlKGVsKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLiRyZWxhdGVkU2xpZGVySXRlbXMubGVuZ3RoID4gNCkge1xuICAgICAgICAgIHRoaXMuJHJlbGF0ZWRTbGlkZXJJbm5lci5zdHlsZS5qdXN0aWZ5Q29udGVudCA9ICdmbGV4LXN0YXJ0JztcbiAgICAgICAgICB0aGlzLiRyZWxhdGVkU2xpZGVySW5uZXIuc3R5bGUubWluV2lkdGggPSAnYXV0byc7XG4gICAgICAgICAgdGhpcy5kb21FdmVudHMuYWRkKHRoaXMuJHJlbGF0ZWRTbGlkZXJJbm5lciwgJ21vdXNlZW50ZXInLCBmdW5jdGlvbiAoZSwgYSwgZWwpIHtcbiAgICAgICAgICAgIF90aGlzNC5hcHBVaS5lbnRlckRyYWdDdXJzb3IoKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0aGlzLmRvbUV2ZW50cy5hZGQodGhpcy4kcmVsYXRlZFNsaWRlcklubmVyLCAnbW91c2VsZWF2ZScsIGZ1bmN0aW9uIChlLCBhLCBlbCkge1xuICAgICAgICAgICAgX3RoaXM0LmFwcFVpLmxlYXZlRHJhZ0N1cnNvcigpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHRoaXMucmVsYXRlZERyYWdnYWJsZSA9IG5ldyBTdXBlckRyYWdnZXIoe1xuICAgICAgICAgICAgZWw6IHRoaXMuJHJlbGF0ZWRTbGlkZXIsXG4gICAgICAgICAgICBlbENsaWNrYWJsZXM6IHRoaXMuJHJlbGF0ZWRQcm9tb3Rpb25zLFxuICAgICAgICAgICAgaW5uZXI6IHRoaXMuJHJlbGF0ZWRTbGlkZXJJbm5lcixcbiAgICAgICAgICAgIG9uRHJhZ1N0YXJ0OiBmdW5jdGlvbiBvbkRyYWdTdGFydCgpIHtcbiAgICAgICAgICAgICAgX3RoaXM0LnN1cGVyU2Nyb2xsZXIuX3Njcm9sbC5lbmFibGUgPSBmYWxzZTtcblxuICAgICAgICAgICAgICBmb3IgKHZhciBfaTIgPSAwOyBfaTIgPCBfdGhpczQuJHJlbGF0ZWRQcm9tb3Rpb25zLmxlbmd0aDsgX2kyKyspIHtcbiAgICAgICAgICAgICAgICBnc2FwLnRvKF90aGlzNC4kcmVsYXRlZFByb21vdGlvbnNbX2kyXSwge1xuICAgICAgICAgICAgICAgICAgc2NhbGU6IDAuOTQsXG4gICAgICAgICAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgICAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAwLjZcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBnc2FwLnRvKF90aGlzNC4kcmVsYXRlZFByb21vdGlvbnNbX2kyXS5xdWVyeVNlbGVjdG9yKCcuaW5uZXIgLmJhY2tncm91bmRfX2JnJyksIHtcbiAgICAgICAgICAgICAgICAgIHNjYWxlOiAxLFxuICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMC42XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvbkRyYWdFbmQ6IGZ1bmN0aW9uIG9uRHJhZ0VuZCgpIHtcbiAgICAgICAgICAgICAgX3RoaXM0LnN1cGVyU2Nyb2xsZXIuX3Njcm9sbC5lbmFibGUgPSB0cnVlO1xuXG4gICAgICAgICAgICAgIGZvciAodmFyIF9pMyA9IDA7IF9pMyA8IF90aGlzNC4kcmVsYXRlZFByb21vdGlvbnMubGVuZ3RoOyBfaTMrKykge1xuICAgICAgICAgICAgICAgIGdzYXAudG8oX3RoaXM0LiRyZWxhdGVkUHJvbW90aW9uc1tfaTNdLCB7XG4gICAgICAgICAgICAgICAgICBzY2FsZTogMSxcbiAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDAuNlxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGdzYXAudG8oX3RoaXM0LiRyZWxhdGVkUHJvbW90aW9uc1tfaTNdLnF1ZXJ5U2VsZWN0b3IoJy5pbm5lciAuYmFja2dyb3VuZF9fYmcnKSwge1xuICAgICAgICAgICAgICAgICAgc2NhbGU6IDEuMSxcbiAgICAgICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMC42XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy4kcmVsYXRlZFNsaWRlcklubmVyLnN0eWxlLmp1c3RpZnlDb250ZW50ID0gJ2ZsZXgtc3RhcnQnO1xuICAgICAgICB0aGlzLiRyZWxhdGVkU2xpZGVySW5uZXIuc3R5bGUubWluV2lkdGggPSAnYXV0byc7XG4gICAgICAgIHRoaXMucmVsYXRlZERyYWdnYWJsZSA9IG5ldyBEcmFnZ2FibGUoe1xuICAgICAgICAgIHRhcmdldDogdGhpcy4kcmVsYXRlZFNsaWRlcixcbiAgICAgICAgICB0YXJnZXRJbm5lcjogdGhpcy4kcmVsYXRlZFNsaWRlcklubmVyLFxuICAgICAgICAgIHNuYXA6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInByb21vdGlvbkVudGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHByb21vdGlvbkVudGVyKGVsKSB7XG4gICAgICBnc2FwLnRvKGVsLnF1ZXJ5U2VsZWN0b3IoJy5pbm5lciAuYmFja2dyb3VuZF9fYmcnKSwge1xuICAgICAgICBzY2FsZTogMSxcbiAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgZHVyYXRpb246IDAuNlxuICAgICAgfSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInByb21vdGlvbkxlYXZlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHByb21vdGlvbkxlYXZlKGVsKSB7XG4gICAgICBpZiAodGhpcy5yZWxhdGVkRHJhZ2dhYmxlICYmIHRoaXMucmVsYXRlZERyYWdnYWJsZS5fZHJhZy5kcmFnZ2luZykgcmV0dXJuO1xuICAgICAgZ3NhcC50byhlbC5xdWVyeVNlbGVjdG9yKCcuaW5uZXIgLmJhY2tncm91bmRfX2JnJyksIHtcbiAgICAgICAgc2NhbGU6IDEuMSxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgZHVyYXRpb246IDAuNlxuICAgICAgfSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInJhZlwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByYWYoKSB7fSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG5cbiAgfSwge1xuICAgIGtleTogXCJyZXNpemVPcmllbnRhdGlvblwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZXNpemVPcmllbnRhdGlvbigpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5zcGxpdFRleHRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMuc3BsaXRUZXh0c1tpXS5yZXZlcnQoKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5yZXNpemVTY3JvbGx0aXRsZXMoKTtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gUmVuZGVyZXJIb21lO1xufShSZW5kZXJlcik7IC8vIERvbmB0IGZvcmdldCB0byBleHBvcnQgeW91ciByZW5kZXJlclxuXG5cbmV4cG9ydCBkZWZhdWx0IFJlbmRlcmVySG9tZTsiLCJmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyBcIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mXCI7IGlmICh0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uXCIpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7IH1cblxuZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH1cblxuZnVuY3Rpb24gX2NyZWF0ZVN1cGVyKERlcml2ZWQpIHsgdmFyIGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QgPSBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCk7IHJldHVybiBmdW5jdGlvbiBfY3JlYXRlU3VwZXJJbnRlcm5hbCgpIHsgdmFyIFN1cGVyID0gX2dldFByb3RvdHlwZU9mKERlcml2ZWQpLCByZXN1bHQ7IGlmIChoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KSB7IHZhciBOZXdUYXJnZXQgPSBfZ2V0UHJvdG90eXBlT2YodGhpcykuY29uc3RydWN0b3I7IHJlc3VsdCA9IFJlZmxlY3QuY29uc3RydWN0KFN1cGVyLCBhcmd1bWVudHMsIE5ld1RhcmdldCk7IH0gZWxzZSB7IHJlc3VsdCA9IFN1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IH0gcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIHJlc3VsdCk7IH07IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSkgeyByZXR1cm4gY2FsbDsgfSBlbHNlIGlmIChjYWxsICE9PSB2b2lkIDApIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkRlcml2ZWQgY29uc3RydWN0b3JzIG1heSBvbmx5IHJldHVybiBvYmplY3Qgb3IgdW5kZWZpbmVkXCIpOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9XG5cbmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gc2VsZjsgfVxuXG5mdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkgeyBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwidW5kZWZpbmVkXCIgfHwgIVJlZmxlY3QuY29uc3RydWN0KSByZXR1cm4gZmFsc2U7IGlmIChSZWZsZWN0LmNvbnN0cnVjdC5zaGFtKSByZXR1cm4gZmFsc2U7IGlmICh0eXBlb2YgUHJveHkgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIHRydWU7IHRyeSB7IEJvb2xlYW4ucHJvdG90eXBlLnZhbHVlT2YuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChCb29sZWFuLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgcmV0dXJuIHRydWU7IH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlOyB9IH1cblxuZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfVxuXG4vLyBHc2FwXG5pbXBvcnQgZ3NhcCBmcm9tICdnc2FwJztcbmltcG9ydCBTY3JvbGxUcmlnZ2VyIGZyb20gJ2dzYXAvU2Nyb2xsVHJpZ2dlcic7XG5nc2FwLnJlZ2lzdGVyUGx1Z2luKFNjcm9sbFRyaWdnZXIpOyAvLyBJbXBvcnQgUmVuZGVyZXJcblxuaW1wb3J0IFJlbmRlcmVyIGZyb20gJy4vcmVuZGVyZXIuanMnOyAvLyBpbXBvcnQgc3R5bGVzRGVmYXVsdCBmcm9tICcuL3N0eWxlc0RlZmF1bHQuY3NzJzsgLy9lc2xpbnQtZGlzYWJsZS1saW5lXG4vLyBVdGlsaXRpZXNcblxuaW1wb3J0IERvbUV2ZW50cyBmcm9tICcuLi9jbGFzc2VzL2RvbUV2ZW50cyc7XG5pbXBvcnQgU3VwZXJTY3JvbGxlciBmcm9tICcuLi9jbGFzc2VzL3N1cGVyU2Nyb2xsZXInO1xuaW1wb3J0IFN1cGVyT2JzZXJ2ZXIgZnJvbSAnLi4vY2xhc3Nlcy9zdXBlck9ic2VydmVyJzsgLy8gT3RoZXJcbi8vIGltcG9ydCBTbGlkZXIgZnJvbSAnLi4vY2xhc3Nlcy9zbGlkZXInO1xuXG5pbXBvcnQgU3BsaXRUZXh0IGZyb20gJy4uL2NsYXNzZXMvc3BsaXRUZXh0JztcblxudmFyIFJlbmRlcmVyQWJvdXQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9SZW5kZXJlcikge1xuICBfaW5oZXJpdHMoUmVuZGVyZXJBYm91dCwgX1JlbmRlcmVyKTtcblxuICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKFJlbmRlcmVyQWJvdXQpO1xuXG4gIGZ1bmN0aW9uIFJlbmRlcmVyQWJvdXQoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJlbmRlcmVyQWJvdXQpO1xuXG4gICAgcmV0dXJuIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKFJlbmRlcmVyQWJvdXQsIFt7XG4gICAga2V5OiBcInNlbGVjdG9yc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzZWxlY3RvcnMoKSB7XG4gICAgICB0aGlzLiRoZXJvID0gdGhpcy4kZWwucXVlcnlTZWxlY3RvcignLmFib3V0X19oZXJvJyk7XG4gICAgICBpZiAodGhpcy4kaGVybykgdGhpcy4kaGVyb0ltYWdlcyA9IHRoaXMuJGhlcm8ucXVlcnlTZWxlY3RvckFsbCgnLmltYWdlJyk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImV2ZW50c1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBldmVudHMoKSB7fSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG5cbiAgfSwge1xuICAgIGtleTogXCJiZWZvcmVFbnRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBiZWZvcmVFbnRlcigpIHtcbiAgICAgIGlmICh0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCkgdGhpcy5zZXRDdGEoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiZW50ZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZW50ZXIoKSB7XG4gICAgICBpZiAodGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHRoaXMuaW5pdEN0YSgpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzZXRDdGFcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0Q3RhKCkge1xuICAgICAgdGhpcy4kY3RhID0gdGhpcy4kZWwucXVlcnlTZWxlY3RvcignLmN0YScpO1xuXG4gICAgICBpZiAodGhpcy4kY3RhKSB7XG4gICAgICAgIGdzYXAuc2V0KHRoaXMuJGN0YS5xdWVyeVNlbGVjdG9yKCcubWFzaycpLCB7XG4gICAgICAgICAgc2NhbGVZOiAwXG4gICAgICAgIH0pO1xuICAgICAgICBnc2FwLnNldCh0aGlzLiRjdGEucXVlcnlTZWxlY3RvcignLmJ1dHRvbicpLCB7XG4gICAgICAgICAgeTogJzV2dydcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImluaXRDdGFcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdEN0YSgpIHtcbiAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgIGlmICh0aGlzLiRjdGEpIHtcbiAgICAgICAgU2Nyb2xsVHJpZ2dlci5jcmVhdGUoe1xuICAgICAgICAgIHRyaWdnZXI6IHRoaXMuJGN0YSxcbiAgICAgICAgICBzdGFydDogJ3RvcCBib3R0b20nLFxuICAgICAgICAgIG9uY2U6IHRydWUsXG4gICAgICAgICAgb25FbnRlcjogZnVuY3Rpb24gb25FbnRlcigpIHtcbiAgICAgICAgICAgIGdzYXAudG8oX3RoaXMuJGN0YS5xdWVyeVNlbGVjdG9yKCcubWFzaycpLCB7XG4gICAgICAgICAgICAgIHNjYWxlWTogMSxcbiAgICAgICAgICAgICAgZHVyYXRpb246IDIsXG4gICAgICAgICAgICAgIGVhc2U6ICdleHBvLmluT3V0J1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBnc2FwLnRvKF90aGlzLiRjdGEucXVlcnlTZWxlY3RvcignLmJ1dHRvbicpLCB7XG4gICAgICAgICAgICAgIHk6IDAsXG4gICAgICAgICAgICAgIGR1cmF0aW9uOiAyLFxuICAgICAgICAgICAgICBlYXNlOiAnZXhwby5pbk91dCdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInJhZlwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByYWYoKSB7fSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG5cbiAgfV0pO1xuXG4gIHJldHVybiBSZW5kZXJlckFib3V0O1xufShSZW5kZXJlcik7IC8vIERvbmB0IGZvcmdldCB0byBleHBvcnQgeW91ciByZW5kZXJlclxuXG5cbmV4cG9ydCBkZWZhdWx0IFJlbmRlcmVyQWJvdXQ7IiwiZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgXCJAYmFiZWwvaGVscGVycyAtIHR5cGVvZlwiOyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2Yob2JqKTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvblwiKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9XG5cbmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVTdXBlcihEZXJpdmVkKSB7IHZhciBoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0ID0gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpOyByZXR1cm4gZnVuY3Rpb24gX2NyZWF0ZVN1cGVySW50ZXJuYWwoKSB7IHZhciBTdXBlciA9IF9nZXRQcm90b3R5cGVPZihEZXJpdmVkKSwgcmVzdWx0OyBpZiAoaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCkgeyB2YXIgTmV3VGFyZ2V0ID0gX2dldFByb3RvdHlwZU9mKHRoaXMpLmNvbnN0cnVjdG9yOyByZXN1bHQgPSBSZWZsZWN0LmNvbnN0cnVjdChTdXBlciwgYXJndW1lbnRzLCBOZXdUYXJnZXQpOyB9IGVsc2UgeyByZXN1bHQgPSBTdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9IHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCByZXN1bHQpOyB9OyB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikpIHsgcmV0dXJuIGNhbGw7IH0gZWxzZSBpZiAoY2FsbCAhPT0gdm9pZCAwKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJEZXJpdmVkIGNvbnN0cnVjdG9ycyBtYXkgb25seSByZXR1cm4gb2JqZWN0IG9yIHVuZGVmaW5lZFwiKTsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfVxuXG5mdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIHNlbGY7IH1cblxuZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcInVuZGVmaW5lZFwiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiB0cnVlOyB0cnkgeyBCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoQm9vbGVhbiwgW10sIGZ1bmN0aW9uICgpIHt9KSk7IHJldHVybiB0cnVlOyB9IGNhdGNoIChlKSB7IHJldHVybiBmYWxzZTsgfSB9XG5cbmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH1cblxuLy8gR3NhcFxuaW1wb3J0IGdzYXAgZnJvbSAnZ3NhcCc7XG5pbXBvcnQgU2Nyb2xsVHJpZ2dlciBmcm9tICdnc2FwL1Njcm9sbFRyaWdnZXInO1xuZ3NhcC5yZWdpc3RlclBsdWdpbihTY3JvbGxUcmlnZ2VyKTsgLy8gSW1wb3J0IFJlbmRlcmVyXG5cbmltcG9ydCBSZW5kZXJlciBmcm9tICcuL3JlbmRlcmVyLmpzJzsgLy8gaW1wb3J0IHN0eWxlc0RlZmF1bHQgZnJvbSAnLi9zdHlsZXNEZWZhdWx0LmNzcyc7IC8vZXNsaW50LWRpc2FibGUtbGluZVxuLy8gVXRpbGl0aWVzXG5cbmltcG9ydCBEb21FdmVudHMgZnJvbSAnLi4vY2xhc3Nlcy9kb21FdmVudHMnO1xuaW1wb3J0IFN1cGVyU2Nyb2xsZXIgZnJvbSAnLi4vY2xhc3Nlcy9zdXBlclNjcm9sbGVyJztcbmltcG9ydCBTdXBlck9ic2VydmVyIGZyb20gJy4uL2NsYXNzZXMvc3VwZXJPYnNlcnZlcic7IC8vIE90aGVyXG4vLyBpbXBvcnQgU2xpZGVyIGZyb20gJy4uL2NsYXNzZXMvc2xpZGVyJztcblxuaW1wb3J0IFNwbGl0VGV4dCBmcm9tICcuLi9jbGFzc2VzL3NwbGl0VGV4dCc7XG5cbnZhciBSZW5kZXJlclBoaWxvc29waHkgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9SZW5kZXJlcikge1xuICBfaW5oZXJpdHMoUmVuZGVyZXJQaGlsb3NvcGh5LCBfUmVuZGVyZXIpO1xuXG4gIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoUmVuZGVyZXJQaGlsb3NvcGh5KTtcblxuICBmdW5jdGlvbiBSZW5kZXJlclBoaWxvc29waHkoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJlbmRlcmVyUGhpbG9zb3BoeSk7XG5cbiAgICByZXR1cm4gX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoUmVuZGVyZXJQaGlsb3NvcGh5LCBbe1xuICAgIGtleTogXCJzZWxlY3RvcnNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2VsZWN0b3JzKCkge1xuICAgICAgdGhpcy4kbWlzaW9uID0gdGhpcy4kZWwucXVlcnlTZWxlY3RvcignLnBoaWxvc29waHlfX21pc2lvbicpO1xuXG4gICAgICBpZiAodGhpcy4kbWlzaW9uKSB7XG4gICAgICAgIHRoaXMuJG1pc2lvblRpdGxlcyA9IHRoaXMuJG1pc2lvbi5xdWVyeVNlbGVjdG9yQWxsKCcuc3VwZXJ0aXRsZScpO1xuICAgICAgICB0aGlzLiRtaXNpb25JbWFnZSA9IHRoaXMuJG1pc2lvbi5xdWVyeVNlbGVjdG9yKCcuaW1hZ2UnKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy4kdmlzaW9uID0gdGhpcy4kZWwucXVlcnlTZWxlY3RvcignLnBoaWxvc29waHlfX3Zpc2lvbicpO1xuXG4gICAgICBpZiAodGhpcy4kdmlzaW9uKSB7XG4gICAgICAgIHRoaXMuJHZpc2lvblRpdGxlcyA9IHRoaXMuJHZpc2lvbi5xdWVyeVNlbGVjdG9yQWxsKCcuc3VwZXJ0aXRsZScpO1xuICAgICAgICB0aGlzLiR2aXNpb25JbWFnZSA9IHRoaXMuJHZpc2lvbi5xdWVyeVNlbGVjdG9yKCcuaW1hZ2UnKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy4kcXVvdGUgPSB0aGlzLiRlbC5xdWVyeVNlbGVjdG9yKCcucGhpbG9zb3BoeV9fcXVvdGUnKTtcblxuICAgICAgaWYgKHRoaXMuJHF1b3RlKSB7XG4gICAgICAgIHRoaXMuJHF1b3RlSWNvbiA9IHRoaXMuJHF1b3RlLnF1ZXJ5U2VsZWN0b3IoJy5xdW90ZV9faWNvbicpO1xuICAgICAgICB0aGlzLiRxdW90ZVRleHQgPSB0aGlzLiRxdW90ZS5xdWVyeVNlbGVjdG9yKCdxdW90ZV9fdGV4dCcpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLiRhc3NldHMgPSB0aGlzLiRlbC5xdWVyeVNlbGVjdG9yKCcucGhpbG9zb3BoeV9fYXNzZXRzJyk7XG5cbiAgICAgIGlmICh0aGlzLiRhc3NldHMpIHtcbiAgICAgICAgaWYgKHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKSB0aGlzLiRhc3NldHNUaXRsZXMgPSB0aGlzLiRhc3NldHMucXVlcnlTZWxlY3RvckFsbCgnLnN1cGVydGl0bGUnKTtlbHNlIHRoaXMuJGFzc2V0c1RpdGxlID0gdGhpcy4kYXNzZXRzLnF1ZXJ5U2VsZWN0b3IoJy5zdXBlcnRpdGxlJyk7XG4gICAgICAgIHRoaXMuJGFzc2V0c0ltYWdlcyA9IHRoaXMuJGFzc2V0cy5xdWVyeVNlbGVjdG9yQWxsKCcuaW1hZ2UnKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy4kcHJpbmNpcGxlcyA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3IoJy5waGlsb3NvcGh5X19wcmluY2lwbGVzJyk7XG5cbiAgICAgIGlmICh0aGlzLiRwcmluY2lwbGVzKSB7XG4gICAgICAgIHRoaXMuJHByaW5jaXBsZXNUaXRsZSA9IHRoaXMuJHByaW5jaXBsZXMucXVlcnlTZWxlY3RvcignLnN1cGVydGl0bGUnKTtcbiAgICAgICAgdGhpcy4kcHJpbmNpcGxlc0l0ZW1zID0gdGhpcy4kcHJpbmNpcGxlcy5xdWVyeVNlbGVjdG9yQWxsKCcucHJpbmNpcGxlc19faXRlbScpO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJldmVudHNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZXZlbnRzKCkge30gLy8gZXNsaW50LWRpc2FibGUtbGluZVxuXG4gIH0sIHtcbiAgICBrZXk6IFwiYmVmb3JlRW50ZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gYmVmb3JlRW50ZXIoKSB7XG4gICAgICBpZiAodGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHRoaXMuc2V0U3VwZXJ0aXRsZXMoKTtlbHNlIHRoaXMuc2V0U3VwZXJ0aXRsZXNNb2JpbGUoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiZW50ZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZW50ZXIoKSB7XG4gICAgICBpZiAodGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHRoaXMuaW5pdFN1cGVydGl0bGVzKCk7ZWxzZSB0aGlzLmluaXRTdXBlcnRpdGxlc01vYmlsZSgpO1xuICAgICAgdGhpcy5pbml0UXVvdGUoKTtcbiAgICAgIHRoaXMuaW5pdFByaW5jaXBsZXMoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwic2V0U3VwZXJ0aXRsZXNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0U3VwZXJ0aXRsZXMoKSB7XG4gICAgICBnc2FwLnNldCh0aGlzLiRtaXNpb25JbWFnZS5jaGlsZHJlblswXSwge1xuICAgICAgICBzY2FsZTogMS4yXG4gICAgICB9LCAwKTtcbiAgICAgIHRoaXMuJHN1cGVydGl0bGVzID0gdGhpcy4kZWwucXVlcnlTZWxlY3RvckFsbCgnLnN1cGVydGl0bGUnKTtcblxuICAgICAgaWYgKHRoaXMuJHN1cGVydGl0bGVzKSB7XG4gICAgICAgIGZvciAodmFyICRpID0gMDsgJGkgPCB0aGlzLiRzdXBlcnRpdGxlcy5sZW5ndGg7ICRpKyspIHtcbiAgICAgICAgICBuZXcgU3BsaXRUZXh0KHRoaXMuJHN1cGVydGl0bGVzWyRpXSwge1xuICAgICAgICAgICAgdHlwZTogJ2NoYXJzJyxcbiAgICAgICAgICAgIGxpbmVzQ2xhc3M6ICdsaW5lIGxpbmUtLSsrJyxcbiAgICAgICAgICAgIHdvcmRzQ2xhc3M6ICd3b3JkIHdvcmQtLSsrJyxcbiAgICAgICAgICAgIGNoYXJzQ2xhc3M6ICdjaGFyIGNoYXItLSsrJ1xuICAgICAgICAgIH0pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG5cbiAgICAgICAgICB0aGlzLiRzdXBlcnRpdGxlc1skaV0uY2xhc3NMaXN0LmFkZCgnc3BsaXQnLCAnc3BsaXQtLWNoYXJzJyk7IC8vIGZvcihsZXQgaiA9IDA7IGogPCB0aGlzLiRzdXBlcnRpdGxlc1skaV0ucXVlcnlTZWxlY3RvckFsbCgnLnN1cGVydGl0bGUgLmxpbmUnKS5sZW5ndGg7IGorKylcbiAgICAgICAgICAvLyB7XG4gICAgICAgICAgLy8gICAgIHRoaXMuJHN1cGVydGl0bGVzWyRpXS5xdWVyeVNlbGVjdG9yQWxsKCcuc3VwZXJ0aXRsZSAubGluZScpW2pdLmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJywgJzxzcGFuIGNsYXNzPVwidW5kZXJsaW5lXCI+PC9zcGFuPicpO1xuICAgICAgICAgIC8vICAgICB0aGlzLiRzdXBlcnRpdGxlc1skaV0ucXVlcnlTZWxlY3RvckFsbCgnLnN1cGVydGl0bGUgLmxpbmUnKVtqXS5pbnNlcnRBZGphY2VudEhUTUwoJ2FmdGVyZW5kJywgJzxzcGFuIGNsYXNzPVwiYnJlYWtcIj48L3NwYW4+Jyk7XG4gICAgICAgICAgLy8gfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRoaXMuJG1pc2lvbi5zdHlsZS5wYWRkaW5nVG9wID0gd2luZG93LmlubmVySGVpZ2h0IC8gMiAtIHRoaXMuJG1pc2lvblRpdGxlc1swXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQgLyAyICsgJ3B4JztcbiAgICAgIHRoaXMuJGFzc2V0cy5xdWVyeVNlbGVjdG9yKCcuY29sdW1ucy0taW5uZXItMicpLnN0eWxlLnBhZGRpbmdUb3AgPSB0aGlzLiRhc3NldHNJbWFnZXNbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0ICsgJ3B4JztcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiaW5pdFF1b3RlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRRdW90ZSgpIHtcbiAgICAgIGlmICh0aGlzLiRxdW90ZSkge1xuICAgICAgICBnc2FwLnNldCh0aGlzLiRxdW90ZUljb24sIHtcbiAgICAgICAgICB5OiAnMi41dncnXG4gICAgICAgIH0sIDApO1xuICAgICAgICB2YXIgcXVvdGVUaW1lbGluZSA9IGdzYXAudGltZWxpbmUoe1xuICAgICAgICAgIGRlZmF1bHRzOiB7XG4gICAgICAgICAgICBlYXNlOiAnbm9uZSdcbiAgICAgICAgICB9LFxuICAgICAgICAgIHNjcm9sbFRyaWdnZXI6IHtcbiAgICAgICAgICAgIHRyaWdnZXI6IHRoaXMuJHF1b3RlLFxuICAgICAgICAgICAgc2NydWI6IHRydWUsXG4gICAgICAgICAgICBzdGFydDogJ3RvcCBib3R0b20nLFxuICAgICAgICAgICAgZW5kOiAnYm90dG9tIHRvcCdcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBxdW90ZVRpbWVsaW5lLnRvKHRoaXMuJHF1b3RlSWNvbiwge1xuICAgICAgICAgIHk6ICctMi41dncnXG4gICAgICAgIH0sIDApO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJpbml0U3VwZXJ0aXRsZXNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdFN1cGVydGl0bGVzKCkge1xuICAgICAgLy8gTWlzaW9uXG4gICAgICB2YXIgbWlzaW9uU3RhcnQgPSB3aW5kb3cuaW5uZXJIZWlnaHQgLyAyIC0gdGhpcy4kbWlzaW9uVGl0bGVzWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCAvIDI7XG4gICAgICB2YXIgbWlzaW9uRW5kID0gd2luZG93LmlubmVySGVpZ2h0IC8gMiArIHRoaXMuJG1pc2lvblRpdGxlc1swXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQgLyAyO1xuICAgICAgdmFyIG1pc2lvbk9mZnNldCA9IHRoaXMuJG1pc2lvbkltYWdlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnkgKyB0aGlzLiRtaXNpb25JbWFnZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQgLSB0aGlzLiRtaXNpb25UaXRsZXNbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xuICAgICAgdmFyIG1pc2lvblRpbWVsaW5lID0gZ3NhcC50aW1lbGluZSh7XG4gICAgICAgIGRlZmF1bHRzOiB7XG4gICAgICAgICAgZWFzZTogJ25vbmUnXG4gICAgICAgIH0sXG4gICAgICAgIHNjcm9sbFRyaWdnZXI6IHtcbiAgICAgICAgICB0cmlnZ2VyOiB0aGlzLiRtaXNpb25UaXRsZXNbMF0sXG4gICAgICAgICAgc2NydWI6IHRydWUsXG4gICAgICAgICAgc3RhcnQ6ICd0b3AgJyArIG1pc2lvblN0YXJ0ICsgJ3B4JyxcbiAgICAgICAgICBlbmQ6IG1pc2lvbk9mZnNldCArICdweCAnICsgbWlzaW9uRW5kICsgJ3B4J1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIG1pc2lvblRpbWVsaW5lLnRvKHRoaXMuJG1pc2lvblRpdGxlc1swXSwge1xuICAgICAgICB5OiAobWlzaW9uT2Zmc2V0IC0gdGhpcy4kbWlzaW9uVGl0bGVzWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCkgLyAyLFxuICAgICAgICBkdXJhdGlvbjogMC41XG4gICAgICB9LCAwKTtcbiAgICAgIG1pc2lvblRpbWVsaW5lLnRvKHRoaXMuJG1pc2lvblRpdGxlc1sxXSwge1xuICAgICAgICB5OiBtaXNpb25PZmZzZXQgLSB0aGlzLiRtaXNpb25UaXRsZXNbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0LFxuICAgICAgICBkdXJhdGlvbjogMVxuICAgICAgfSwgMCk7XG4gICAgICBtaXNpb25UaW1lbGluZS50byh0aGlzLiRtaXNpb25JbWFnZS5jaGlsZHJlblswXSwge1xuICAgICAgICBzY2FsZTogMSxcbiAgICAgICAgZHVyYXRpb246IDFcbiAgICAgIH0sIDApOyAvLyBWaXNpb25cblxuICAgICAgdmFyIHZpc2lvblN0YXJ0ID0gd2luZG93LmlubmVySGVpZ2h0IC8gMiAtIHRoaXMuJHZpc2lvblRpdGxlc1swXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQgLyAyO1xuICAgICAgdmFyIHZpc2lvbkVuZCA9IHdpbmRvdy5pbm5lckhlaWdodCAvIDIgKyB0aGlzLiR2aXNpb25UaXRsZXNbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0IC8gMjtcbiAgICAgIHZhciB2aXNpb25PZmZzZXQgPSB0aGlzLiR2aXNpb25JbWFnZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgKyB0aGlzLiR2aXNpb25JbWFnZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQgLSB0aGlzLiR2aXNpb25UaXRsZXNbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xuICAgICAgZ3NhcC5zZXQodGhpcy4kdmlzaW9uSW1hZ2UuY2hpbGRyZW5bMF0sIHtcbiAgICAgICAgc2NhbGU6IDEuMlxuICAgICAgfSwgMCk7XG4gICAgICB2YXIgdmlzaW9uVGltZWxpbmUgPSBnc2FwLnRpbWVsaW5lKHtcbiAgICAgICAgZGVmYXVsdHM6IHtcbiAgICAgICAgICBlYXNlOiAnbm9uZSdcbiAgICAgICAgfSxcbiAgICAgICAgc2Nyb2xsVHJpZ2dlcjoge1xuICAgICAgICAgIHRyaWdnZXI6IHRoaXMuJHZpc2lvblRpdGxlc1swXSxcbiAgICAgICAgICBzY3J1YjogdHJ1ZSxcbiAgICAgICAgICBzdGFydDogJ3RvcCAnICsgdmlzaW9uU3RhcnQgKyAncHgnLFxuICAgICAgICAgIGVuZDogdmlzaW9uT2Zmc2V0ICsgJ3B4ICcgKyB2aXNpb25FbmQgKyAncHgnXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgdmlzaW9uVGltZWxpbmUudG8odGhpcy4kdmlzaW9uVGl0bGVzWzBdLCB7XG4gICAgICAgIHk6ICh2aXNpb25PZmZzZXQgLSB0aGlzLiR2aXNpb25UaXRsZXNbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0KSAvIDIsXG4gICAgICAgIGR1cmF0aW9uOiAwLjVcbiAgICAgIH0sIDApO1xuICAgICAgdmlzaW9uVGltZWxpbmUudG8odGhpcy4kdmlzaW9uVGl0bGVzWzFdLCB7XG4gICAgICAgIHk6IHZpc2lvbk9mZnNldCAtIHRoaXMuJHZpc2lvblRpdGxlc1swXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQsXG4gICAgICAgIGR1cmF0aW9uOiAxXG4gICAgICB9LCAwKTtcbiAgICAgIHZpc2lvblRpbWVsaW5lLnRvKHRoaXMuJHZpc2lvbkltYWdlLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgIHNjYWxlOiAxLFxuICAgICAgICBkdXJhdGlvbjogMVxuICAgICAgfSwgMCk7IC8vIGdzYXAuc2V0KHRoaXMuJHZpc2lvbkltYWdlLmNoaWxkcmVuWzBdLCB7IHNjYWxlOiAxLjIgfSwgMCk7XG4gICAgICAvLyBjb25zdCB2aXNpb25UaW1lbGluZTIgPSBnc2FwLnRpbWVsaW5lKHtcbiAgICAgIC8vICAgICBkZWZhdWx0czogeyBlYXNlOiAnbm9uZScgfSxcbiAgICAgIC8vICAgICBzY3JvbGxUcmlnZ2VyOiB7XG4gICAgICAvLyAgICAgICAgIHRyaWdnZXI6IHRoaXMuJHZpc2lvblRpdGxlc1swXSxcbiAgICAgIC8vICAgICAgICAgc2NydWI6IHRydWUsXG4gICAgICAvLyAgICAgICAgIHN0YXJ0OiAndG9wIGJvdHRvbScsXG4gICAgICAvLyAgICAgICAgIGVuZDogdmlzaW9uT2Zmc2V0ICsgJ3B4ICcgKyB2aXNpb25FbmQgKyAncHgnLFxuICAgICAgLy8gICAgIH1cbiAgICAgIC8vIH0pO1xuICAgICAgLy8gdmlzaW9uVGltZWxpbmUyLnRvKHRoaXMuJHZpc2lvbkltYWdlLmNoaWxkcmVuWzBdLCB7IHNjYWxlOiAxLCBkdXJhdGlvbjogMSB9LCAwKTtcbiAgICAgIC8vIEFzc2V0c1xuXG4gICAgICB2YXIgYXNzZXRzU3RhcnQgPSB3aW5kb3cuaW5uZXJIZWlnaHQgLyAyIC0gdGhpcy4kYXNzZXRzVGl0bGVzWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCAvIDI7XG4gICAgICB2YXIgYXNzZXRzRW5kID0gd2luZG93LmlubmVySGVpZ2h0IC8gMiArIHRoaXMuJGFzc2V0c1RpdGxlc1swXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQgLyAyO1xuICAgICAgdmFyIGFzc2V0c0FjdGlPZmZzZXQgPSB0aGlzLiRhc3NldHNUaXRsZXNbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0ICsgd2luZG93LmlubmVyV2lkdGggKiAwLjEyNTtcbiAgICAgIHZhciBhc3NldHNWb3NPZmZzZXQgPSB0aGlzLiRhc3NldHNUaXRsZXNbMV0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0ICsgdGhpcy4kYXNzZXRzSW1hZ2VzWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCArIHdpbmRvdy5pbm5lcldpZHRoICogMC4xMjU7XG4gICAgICB2YXIgYXNzZXRzQWN0aVRpbWVsaW5lID0gZ3NhcC50aW1lbGluZSh7XG4gICAgICAgIGRlZmF1bHRzOiB7XG4gICAgICAgICAgZWFzZTogJ25vbmUnXG4gICAgICAgIH0sXG4gICAgICAgIHNjcm9sbFRyaWdnZXI6IHtcbiAgICAgICAgICB0cmlnZ2VyOiB0aGlzLiRhc3NldHNUaXRsZXNbMF0sXG4gICAgICAgICAgc2NydWI6IHRydWUsXG4gICAgICAgICAgc3RhcnQ6ICd0b3AgJyArIGFzc2V0c1N0YXJ0ICsgJ3B4JyxcbiAgICAgICAgICBlbmQ6IGFzc2V0c0FjdGlPZmZzZXQgKyAncHggJyArIGFzc2V0c0VuZCArICdweCdcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBhc3NldHNBY3RpVGltZWxpbmUudG8odGhpcy4kYXNzZXRzVGl0bGVzWzBdLCB7XG4gICAgICAgIHk6IGFzc2V0c0FjdGlPZmZzZXQgLSB0aGlzLiRhc3NldHNUaXRsZXNbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0LFxuICAgICAgICBkdXJhdGlvbjogMC41XG4gICAgICB9LCAwKTtcbiAgICAgIHZhciBhc3NldHNWb3NUaW1lbGluZSA9IGdzYXAudGltZWxpbmUoe1xuICAgICAgICBkZWZhdWx0czoge1xuICAgICAgICAgIGVhc2U6ICdub25lJ1xuICAgICAgICB9LFxuICAgICAgICBzY3JvbGxUcmlnZ2VyOiB7XG4gICAgICAgICAgdHJpZ2dlcjogdGhpcy4kYXNzZXRzVGl0bGVzWzFdLFxuICAgICAgICAgIHNjcnViOiB0cnVlLFxuICAgICAgICAgIHN0YXJ0OiAndG9wICcgKyBhc3NldHNTdGFydCArICdweCcsXG4gICAgICAgICAgZW5kOiBhc3NldHNWb3NPZmZzZXQgKyAncHggJyArIGFzc2V0c0VuZCArICdweCdcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBhc3NldHNWb3NUaW1lbGluZS50byh0aGlzLiRhc3NldHNUaXRsZXNbMV0sIHtcbiAgICAgICAgeTogYXNzZXRzVm9zT2Zmc2V0IC0gdGhpcy4kYXNzZXRzVGl0bGVzWzFdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCxcbiAgICAgICAgZHVyYXRpb246IDAuNVxuICAgICAgfSwgMCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInNldFN1cGVydGl0bGVzTW9iaWxlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNldFN1cGVydGl0bGVzTW9iaWxlKCkge1xuICAgICAgdGhpcy4kZml4ZWRUaXRsZXMgPSB0aGlzLiRlbC5xdWVyeVNlbGVjdG9yQWxsKCcuZml4ZWQgLnN1cGVydGl0bGUnKTtcbiAgICAgIG5ldyBTcGxpdFRleHQodGhpcy4kZml4ZWRUaXRsZXNbMF0sIHtcbiAgICAgICAgdHlwZTogJ3dvcmRzJyxcbiAgICAgICAgd29yZHNDbGFzczogJ3dvcmQgd29yZC0tKysnXG4gICAgICB9KTtcbiAgICAgIGdzYXAuc2V0KHRoaXMuJGZpeGVkVGl0bGVzWzBdLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgIG9wYWNpdHk6IDAuMDAwMVxuICAgICAgfSk7XG4gICAgICBuZXcgU3BsaXRUZXh0KHRoaXMuJGZpeGVkVGl0bGVzWzFdLCB7XG4gICAgICAgIHR5cGU6ICd3b3JkcycsXG4gICAgICAgIHdvcmRzQ2xhc3M6ICd3b3JkIHdvcmQtLSsrJ1xuICAgICAgfSk7XG4gICAgICBnc2FwLnNldCh0aGlzLiRmaXhlZFRpdGxlc1sxXS5jaGlsZHJlblswXSwge1xuICAgICAgICBvcGFjaXR5OiAwLjAwMDFcbiAgICAgIH0pO1xuICAgICAgbmV3IFNwbGl0VGV4dCh0aGlzLiRmaXhlZFRpdGxlc1syXSwge1xuICAgICAgICB0eXBlOiAnd29yZHMnLFxuICAgICAgICB3b3Jkc0NsYXNzOiAnd29yZCB3b3JkLS0rKydcbiAgICAgIH0pO1xuICAgICAgZ3NhcC5zZXQodGhpcy4kZml4ZWRUaXRsZXNbMl0uY2hpbGRyZW5bMF0sIHtcbiAgICAgICAgb3BhY2l0eTogMC4wMDAxXG4gICAgICB9KTtcbiAgICAgIG5ldyBTcGxpdFRleHQodGhpcy4kZml4ZWRUaXRsZXNbM10sIHtcbiAgICAgICAgdHlwZTogJ3dvcmRzJyxcbiAgICAgICAgd29yZHNDbGFzczogJ3dvcmQgd29yZC0tKysnXG4gICAgICB9KTtcbiAgICAgIGdzYXAuc2V0KHRoaXMuJGZpeGVkVGl0bGVzWzNdLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgIG9wYWNpdHk6IDAuMDAwMVxuICAgICAgfSk7XG4gICAgICBnc2FwLnRvKHRoaXMuJGZpeGVkVGl0bGVzWzBdLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgIGVhc2U6ICdwb3dlcjIub3V0JyxcbiAgICAgICAgZHVyYXRpb246IDAuMVxuICAgICAgfSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImluaXRTdXBlcnRpdGxlc01vYmlsZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0U3VwZXJ0aXRsZXNNb2JpbGUoKSB7XG4gICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICAvLyBNaXNpb25cbiAgICAgIHRoaXMuc3VwZXJUcmlnZ2VyLmNyZWF0ZSh7XG4gICAgICAgIHRyaWdnZXI6IHRoaXMuJG1pc2lvbixcbiAgICAgICAgc2NydWI6IHRydWUsXG4gICAgICAgIHN0YXJ0OiAndG9wIHRvcCs9MTAwJyxcbiAgICAgICAgZW5kOiAnYm90dG9tIDExMCUnLFxuICAgICAgICBvbkVudGVyOiBmdW5jdGlvbiBvbkVudGVyKCkge1xuICAgICAgICAgIGdzYXAudG8oX3RoaXMuJGZpeGVkVGl0bGVzWzBdLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgICAgZWFzZTogJ3Bvd2VyMi5vdXQnLFxuICAgICAgICAgICAgZHVyYXRpb246IDAuMlxuICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBvbkxlYXZlOiBmdW5jdGlvbiBvbkxlYXZlKCkge1xuICAgICAgICAgIGdzYXAudG8oX3RoaXMuJGZpeGVkVGl0bGVzWzBdLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgICAgICBvcGFjaXR5OiAwLjAwMDEsXG4gICAgICAgICAgICBlYXNlOiAncG93ZXIyLm91dCcsXG4gICAgICAgICAgICBkdXJhdGlvbjogMC4yXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uRW50ZXJCYWNrOiBmdW5jdGlvbiBvbkVudGVyQmFjaygpIHtcbiAgICAgICAgICBnc2FwLnRvKF90aGlzLiRmaXhlZFRpdGxlc1swXS5jaGlsZHJlblswXSwge1xuICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgIGVhc2U6ICdwb3dlcjIub3V0JyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgb25MZWF2ZUJhY2s6IGZ1bmN0aW9uIG9uTGVhdmVCYWNrKCkge1xuICAgICAgICAgIGdzYXAudG8oX3RoaXMuJGZpeGVkVGl0bGVzWzBdLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgICAgICBvcGFjaXR5OiAwLjAwMDEsXG4gICAgICAgICAgICBlYXNlOiAncG93ZXIyLm91dCcsXG4gICAgICAgICAgICBkdXJhdGlvbjogMC4yXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pOyAvLyBWaXNpb25cblxuICAgICAgdGhpcy5zdXBlclRyaWdnZXIuY3JlYXRlKHtcbiAgICAgICAgdHJpZ2dlcjogdGhpcy4kdmlzaW9uLFxuICAgICAgICBzY3J1YjogdHJ1ZSxcbiAgICAgICAgc3RhcnQ6ICd0b3AgNTAlJyxcbiAgICAgICAgZW5kOiAnYm90dG9tIDExMCUnLFxuICAgICAgICBvbkVudGVyOiBmdW5jdGlvbiBvbkVudGVyKCkge1xuICAgICAgICAgIGdzYXAudG8oX3RoaXMuJGZpeGVkVGl0bGVzWzFdLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgICAgZWFzZTogJ3Bvd2VyMi5vdXQnLFxuICAgICAgICAgICAgZHVyYXRpb246IDAuMlxuICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBvbkxlYXZlOiBmdW5jdGlvbiBvbkxlYXZlKCkge1xuICAgICAgICAgIGdzYXAudG8oX3RoaXMuJGZpeGVkVGl0bGVzWzFdLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgICAgICBvcGFjaXR5OiAwLjAwMDEsXG4gICAgICAgICAgICBlYXNlOiAncG93ZXIyLm91dCcsXG4gICAgICAgICAgICBkdXJhdGlvbjogMC4yXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uRW50ZXJCYWNrOiBmdW5jdGlvbiBvbkVudGVyQmFjaygpIHtcbiAgICAgICAgICBnc2FwLnRvKF90aGlzLiRmaXhlZFRpdGxlc1sxXS5jaGlsZHJlblswXSwge1xuICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgIGVhc2U6ICdwb3dlcjIub3V0JyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgb25MZWF2ZUJhY2s6IGZ1bmN0aW9uIG9uTGVhdmVCYWNrKCkge1xuICAgICAgICAgIGdzYXAudG8oX3RoaXMuJGZpeGVkVGl0bGVzWzFdLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgICAgICBvcGFjaXR5OiAwLjAwMDEsXG4gICAgICAgICAgICBlYXNlOiAncG93ZXIyLm91dCcsXG4gICAgICAgICAgICBkdXJhdGlvbjogMC4yXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pOyAvLyBBc3NldHNcblxuICAgICAgdGhpcy5zdXBlclRyaWdnZXIuY3JlYXRlKHtcbiAgICAgICAgdHJpZ2dlcjogdGhpcy4kYXNzZXRzLFxuICAgICAgICBzY3J1YjogdHJ1ZSxcbiAgICAgICAgc3RhcnQ6ICd0b3AgNTAlJyxcbiAgICAgICAgZW5kOiAnYm90dG9tIDExMCUnLFxuICAgICAgICBvbkVudGVyOiBmdW5jdGlvbiBvbkVudGVyKCkge1xuICAgICAgICAgIGdzYXAudG8oX3RoaXMuJGZpeGVkVGl0bGVzWzJdLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgICAgZWFzZTogJ3Bvd2VyMi5vdXQnLFxuICAgICAgICAgICAgZHVyYXRpb246IDAuMlxuICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBvbkxlYXZlOiBmdW5jdGlvbiBvbkxlYXZlKCkge1xuICAgICAgICAgIGdzYXAudG8oX3RoaXMuJGZpeGVkVGl0bGVzWzJdLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgICAgICBvcGFjaXR5OiAwLjAwMDEsXG4gICAgICAgICAgICBlYXNlOiAncG93ZXIyLm91dCcsXG4gICAgICAgICAgICBkdXJhdGlvbjogMC4yXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uRW50ZXJCYWNrOiBmdW5jdGlvbiBvbkVudGVyQmFjaygpIHtcbiAgICAgICAgICBnc2FwLnRvKF90aGlzLiRmaXhlZFRpdGxlc1syXS5jaGlsZHJlblswXSwge1xuICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgIGVhc2U6ICdwb3dlcjIub3V0JyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgb25MZWF2ZUJhY2s6IGZ1bmN0aW9uIG9uTGVhdmVCYWNrKCkge1xuICAgICAgICAgIGdzYXAudG8oX3RoaXMuJGZpeGVkVGl0bGVzWzJdLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgICAgICBvcGFjaXR5OiAwLjAwMDEsXG4gICAgICAgICAgICBlYXNlOiAncG93ZXIyLm91dCcsXG4gICAgICAgICAgICBkdXJhdGlvbjogMC4yXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pOyAvLyBQcmluY2lwbGVzXG5cbiAgICAgIHRoaXMuc3VwZXJUcmlnZ2VyLmNyZWF0ZSh7XG4gICAgICAgIHRyaWdnZXI6IHRoaXMuJHByaW5jaXBsZXMsXG4gICAgICAgIHNjcnViOiB0cnVlLFxuICAgICAgICBzdGFydDogJ3RvcCAzNSUnLFxuICAgICAgICBlbmQ6ICdib3R0b20gMTEwJScsXG4gICAgICAgIG9uRW50ZXI6IGZ1bmN0aW9uIG9uRW50ZXIoKSB7XG4gICAgICAgICAgZ3NhcC50byhfdGhpcy4kZml4ZWRUaXRsZXNbM10uY2hpbGRyZW5bMF0sIHtcbiAgICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgICBlYXNlOiAncG93ZXIyLm91dCcsXG4gICAgICAgICAgICBkdXJhdGlvbjogMC4yXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uTGVhdmU6IGZ1bmN0aW9uIG9uTGVhdmUoKSB7XG4gICAgICAgICAgZ3NhcC50byhfdGhpcy4kZml4ZWRUaXRsZXNbM10uY2hpbGRyZW5bMF0sIHtcbiAgICAgICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgICAgIGVhc2U6ICdwb3dlcjIub3V0JyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgb25FbnRlckJhY2s6IGZ1bmN0aW9uIG9uRW50ZXJCYWNrKCkge1xuICAgICAgICAgIGdzYXAudG8oX3RoaXMuJGZpeGVkVGl0bGVzWzNdLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgICAgZWFzZTogJ3Bvd2VyMi5vdXQnLFxuICAgICAgICAgICAgZHVyYXRpb246IDAuMlxuICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBvbkxlYXZlQmFjazogZnVuY3Rpb24gb25MZWF2ZUJhY2soKSB7XG4gICAgICAgICAgZ3NhcC50byhfdGhpcy4kZml4ZWRUaXRsZXNbM10uY2hpbGRyZW5bMF0sIHtcbiAgICAgICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgICAgIGVhc2U6ICdwb3dlcjIub3V0JyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImluaXRQcmluY2lwbGVzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRQcmluY2lwbGVzKCkge1xuICAgICAgdGhpcy5wcmluY2lwbGVzVGltZWxpbmVzID0gW107XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy4kcHJpbmNpcGxlc0l0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGdzYXAuc2V0KHRoaXMuJHByaW5jaXBsZXNJdGVtc1tpXS5xdWVyeVNlbGVjdG9yKCcuYmFja2dyb3VuZF9fYmcnKSwge1xuICAgICAgICAgIHk6IHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wID8gLXdpbmRvdy5pbm5lckhlaWdodCArIDIwMCA6IC0od2luZG93LmlubmVySGVpZ2h0ICogMC41KSArIDIwMCxcbiAgICAgICAgICBzY2FsZTogMS4yXG4gICAgICAgIH0sIDApO1xuICAgICAgICBnc2FwLnNldCh0aGlzLiRwcmluY2lwbGVzSXRlbXNbaV0ucXVlcnlTZWxlY3RvcignLmJhY2tncm91bmRfX21hc2snKSwge1xuICAgICAgICAgIG9wYWNpdHk6IDFcbiAgICAgICAgfSwgMCk7XG4gICAgICAgIHZhciBwcmluY2lwbGVUaW1lbGluZSA9IGdzYXAudGltZWxpbmUoe1xuICAgICAgICAgIGRlZmF1bHRzOiB7XG4gICAgICAgICAgICBlYXNlOiAnbm9uZSdcbiAgICAgICAgICB9LFxuICAgICAgICAgIHNjcm9sbFRyaWdnZXI6IHtcbiAgICAgICAgICAgIHRyaWdnZXI6IHRoaXMuJHByaW5jaXBsZXNJdGVtc1tpXS5xdWVyeVNlbGVjdG9yKCcuYmFja2dyb3VuZCcpLFxuICAgICAgICAgICAgc2NydWI6IHRydWUsXG4gICAgICAgICAgICBzdGFydDogJ3RvcCBib3R0b20nLFxuICAgICAgICAgICAgZW5kOiAnYm90dG9tIGJvdHRvbScgLy9lbmQ6ICd0b3ArPScgKyB3aW5kb3cuaW5uZXJIZWlnaHQgKyAnIGJvdHRvbSdcblxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHByaW5jaXBsZVRpbWVsaW5lLnRvKHRoaXMuJHByaW5jaXBsZXNJdGVtc1tpXS5xdWVyeVNlbGVjdG9yKCcuYmFja2dyb3VuZF9fYmcnKSwge1xuICAgICAgICAgIHk6IDAsXG4gICAgICAgICAgc2NhbGU6IDFcbiAgICAgICAgfSwgMCk7XG4gICAgICAgIHByaW5jaXBsZVRpbWVsaW5lLnRvKHRoaXMuJHByaW5jaXBsZXNJdGVtc1tpXS5xdWVyeVNlbGVjdG9yKCcuYmFja2dyb3VuZF9fbWFzaycpLCB7XG4gICAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICAgIGR1cmF0aW9uOiAwLjVcbiAgICAgICAgfSwgMCk7XG4gICAgICAgIHRoaXMucHJpbmNpcGxlc1RpbWVsaW5lcy5wdXNoKHByaW5jaXBsZVRpbWVsaW5lKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmFmXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJhZigpIHt9IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcblxuICB9XSk7XG5cbiAgcmV0dXJuIFJlbmRlcmVyUGhpbG9zb3BoeTtcbn0oUmVuZGVyZXIpOyAvLyBEb25gdCBmb3JnZXQgdG8gZXhwb3J0IHlvdXIgcmVuZGVyZXJcblxuXG5leHBvcnQgZGVmYXVsdCBSZW5kZXJlclBoaWxvc29waHk7IiwiZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgXCJAYmFiZWwvaGVscGVycyAtIHR5cGVvZlwiOyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2Yob2JqKTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvblwiKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9XG5cbmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVTdXBlcihEZXJpdmVkKSB7IHZhciBoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0ID0gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpOyByZXR1cm4gZnVuY3Rpb24gX2NyZWF0ZVN1cGVySW50ZXJuYWwoKSB7IHZhciBTdXBlciA9IF9nZXRQcm90b3R5cGVPZihEZXJpdmVkKSwgcmVzdWx0OyBpZiAoaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCkgeyB2YXIgTmV3VGFyZ2V0ID0gX2dldFByb3RvdHlwZU9mKHRoaXMpLmNvbnN0cnVjdG9yOyByZXN1bHQgPSBSZWZsZWN0LmNvbnN0cnVjdChTdXBlciwgYXJndW1lbnRzLCBOZXdUYXJnZXQpOyB9IGVsc2UgeyByZXN1bHQgPSBTdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9IHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCByZXN1bHQpOyB9OyB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikpIHsgcmV0dXJuIGNhbGw7IH0gZWxzZSBpZiAoY2FsbCAhPT0gdm9pZCAwKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJEZXJpdmVkIGNvbnN0cnVjdG9ycyBtYXkgb25seSByZXR1cm4gb2JqZWN0IG9yIHVuZGVmaW5lZFwiKTsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfVxuXG5mdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIHNlbGY7IH1cblxuZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcInVuZGVmaW5lZFwiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiB0cnVlOyB0cnkgeyBCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoQm9vbGVhbiwgW10sIGZ1bmN0aW9uICgpIHt9KSk7IHJldHVybiB0cnVlOyB9IGNhdGNoIChlKSB7IHJldHVybiBmYWxzZTsgfSB9XG5cbmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH1cblxuLy8gR3NhcFxuaW1wb3J0IGdzYXAgZnJvbSAnZ3NhcCc7XG5pbXBvcnQgU2Nyb2xsVHJpZ2dlciBmcm9tICdnc2FwL1Njcm9sbFRyaWdnZXInO1xuZ3NhcC5yZWdpc3RlclBsdWdpbihTY3JvbGxUcmlnZ2VyKTsgLy8gSW1wb3J0IFJlbmRlcmVyXG5cbmltcG9ydCBSZW5kZXJlciBmcm9tICcuL3JlbmRlcmVyLmpzJzsgLy8gaW1wb3J0IHN0eWxlc0RlZmF1bHQgZnJvbSAnLi9zdHlsZXNEZWZhdWx0LmNzcyc7IC8vZXNsaW50LWRpc2FibGUtbGluZVxuLy8gVXRpbGl0aWVzXG5cbmltcG9ydCBEb21FdmVudHMgZnJvbSAnLi4vY2xhc3Nlcy9kb21FdmVudHMnO1xuaW1wb3J0IFN1cGVyU2Nyb2xsZXIgZnJvbSAnLi4vY2xhc3Nlcy9zdXBlclNjcm9sbGVyJztcbmltcG9ydCBTdXBlck9ic2VydmVyIGZyb20gJy4uL2NsYXNzZXMvc3VwZXJPYnNlcnZlcic7XG5pbXBvcnQgRHJhZ2dhYmxlIGZyb20gJy4uL2NsYXNzZXMvRHJhZ2dhYmxlJzsgLy8gT3RoZXJcbi8vIGltcG9ydCBTbGlkZXIgZnJvbSAnLi4vY2xhc3Nlcy9zbGlkZXInO1xuXG5pbXBvcnQgU3BsaXRUZXh0IGZyb20gJy4uL2NsYXNzZXMvc3BsaXRUZXh0JztcblxudmFyIFJlbmRlcmVyUHJvbW90aW9ucyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1JlbmRlcmVyKSB7XG4gIF9pbmhlcml0cyhSZW5kZXJlclByb21vdGlvbnMsIF9SZW5kZXJlcik7XG5cbiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihSZW5kZXJlclByb21vdGlvbnMpO1xuXG4gIGZ1bmN0aW9uIFJlbmRlcmVyUHJvbW90aW9ucygpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUmVuZGVyZXJQcm9tb3Rpb25zKTtcblxuICAgIHJldHVybiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuXG4gIF9jcmVhdGVDbGFzcyhSZW5kZXJlclByb21vdGlvbnMsIFt7XG4gICAga2V5OiBcInNlbGVjdG9yc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzZWxlY3RvcnMoKSB7XG4gICAgICB0aGlzLiRwcm9tb3Rpb25zID0gdGhpcy4kZWwucXVlcnlTZWxlY3RvckFsbCgnLnByb21vdGlvbicpO1xuICAgICAgdGhpcy4kc2xpZGVyID0gdGhpcy4kZWwucXVlcnlTZWxlY3RvcignLnNsaWRlcicpO1xuICAgICAgdGhpcy4kc2xpZGVySW5uZXIgPSB0aGlzLiRzbGlkZXIucXVlcnlTZWxlY3RvcignLnNsaWRlcl9faW5uZXInKTtcbiAgICAgIHRoaXMuJHNsaWRlclNjcm9sbGJhciA9IHRoaXMuJHNsaWRlci5xdWVyeVNlbGVjdG9yKCcuc2xpZGVyX19zY3JvbGxiYXInKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiZXZlbnRzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGV2ZW50cygpIHtcbiAgICAgIHRoaXMuc3BsaXRUZXh0cyA9IFtdO1xuICAgICAgdGhpcy5zY3JvbGxUcmlnZ2VycyA9IFtdO1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuJHByb21vdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdGhpcy5wcm9tb3Rpb25Jbml0KHRoaXMuJHByb21vdGlvbnNbaV0pO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzY3JvbGxcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2Nyb2xsKCkge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgaWYgKHRoaXMuJHNsaWRlcklubmVyKSB7XG4gICAgICAgIGlmICh0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCkge1xuICAgICAgICAgIC8vIFN1cGVyc2Nyb2xsZXJcbiAgICAgICAgICB0aGlzLnNsaWRlclNjcm9sbGVyID0gbmV3IFN1cGVyU2Nyb2xsZXIoe1xuICAgICAgICAgICAgbW9kZTogJ2hvcml6b250YWwnLFxuICAgICAgICAgICAgc2Nyb2xsOiB0cnVlLFxuICAgICAgICAgICAgc2Nyb2xsVGFyZ2V0OiB0aGlzLiRzbGlkZXJJbm5lcixcbiAgICAgICAgICAgIGJhcjogZmFsc2VcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAodGhpcy5hcHBVaS4kaGVhZGVyTG9nbykgZ3NhcC50byh0aGlzLmFwcFVpLiRoZWFkZXJMb2dvLCB7XG4gICAgICAgICAgICB5OiAwLFxuICAgICAgICAgICAgZWFzZTogJ2V4cG8ub3V0J1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIHRoaXMuc3VwZXJUcmlnZ2VyID0gU2Nyb2xsVHJpZ2dlcjtcbiAgICAgICAgICB0aGlzLnN1cGVyVHJpZ2dlciA9IFNjcm9sbFRyaWdnZXI7XG4gICAgICAgICAgdGhpcy5zdXBlclRyaWdnZXIucmVmcmVzaCgpO1xuICAgICAgICAgIGdzYXAudGlja2VyLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpcy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0aGlzLnN1cGVyVHJpZ2dlclRsID0gZ3NhcC50aW1lbGluZSh7XG4gICAgICAgICAgICBkZWZhdWx0czoge1xuICAgICAgICAgICAgICBlYXNlOiAnbm9uZSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzY3JvbGxUcmlnZ2VyOiB7XG4gICAgICAgICAgICAgIHRyaWdnZXI6IHRoaXMuJGFwcCxcbiAgICAgICAgICAgICAgc2NydWI6IHRydWUsXG4gICAgICAgICAgICAgIHN0YXJ0OiAndG9wIHRvcCcsXG4gICAgICAgICAgICAgIGVuZDogJ2JvdHRvbSBib3R0b20nLFxuICAgICAgICAgICAgICBvblVwZGF0ZTogZnVuY3Rpb24gb25VcGRhdGUoc2VsZikge1xuICAgICAgICAgICAgICAgIF90aGlzLnN1cGVyU2Nyb2xsZXJNb2JpbGUgPSBzZWxmLnByb2dyZXNzICogc2VsZi5lbmQ7IC8vIGlmKHRoaXMuYXBwVWkuJGhlYWRlcilcbiAgICAgICAgICAgICAgICAvLyAgICAgZ3NhcC50byh0aGlzLmFwcFVpLiRoZWFkZXIsIHsgeTogLShzZWxmLnByb2dyZXNzICogdGhpcy4kZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0KSB9KTtcbiAgICAgICAgICAgICAgICAvLyBpZih0aGlzLmFwcFVpLiRsb2dvKVxuICAgICAgICAgICAgICAgIC8vICAgICBnc2FwLnRvKHRoaXMuYXBwVWkuJGxvZ28sIHsgeTogLShzZWxmLnByb2dyZXNzICogdGhpcy4kZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0KSAvIDIgfSk7XG4gICAgICAgICAgICAgICAgLy8gaWYodGhpcy5hcHBVaS4kaGVhZGVyVHJpZ2dlclRleHQgJiYgIXRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKVxuICAgICAgICAgICAgICAgIC8vICAgICBnc2FwLnRvKHRoaXMuYXBwVWkuJGhlYWRlclRyaWdnZXJUZXh0LCB7IHk6IC0oc2VsZi5wcm9ncmVzcyAqIHRoaXMuJGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCkgLyAyIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IC8vIGJlZm9yZUVudGVyKClcbiAgICAvLyB7XG4gICAgLy8gICAgIGlmKHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKVxuICAgIC8vICAgICB7XG4gICAgLy8gICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy4kcHJvbW90aW9ucy5sZW5ndGg7IGkrKylcbiAgICAvLyAgICAgICAgICAgICBnc2FwLnNldCh0aGlzLiRwcm9tb3Rpb25zW2ldLCB7IHg6ICcyMHZ3Jywgb3BhY2l0eTogMC4wMDAxIH0pO1xuICAgIC8vICAgICB9XG4gICAgLy8gfVxuICAgIC8vIGVudGVyKClcbiAgICAvLyB7XG4gICAgLy8gICAgIGlmKHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKVxuICAgIC8vICAgICB7XG4gICAgLy8gICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy4kcHJvbW90aW9ucy5sZW5ndGg7IGkrKylcbiAgICAvLyAgICAgICAgICAgICBnc2FwLnRvKHRoaXMuJHByb21vdGlvbnNbaV0sIHsgeDogJzB2dycsIG9wYWNpdHk6IDEsIGR1cmF0aW9uOiAyLCBlYXNlOiAnZXhwby5vdXQnLCBkZWxheTogaSAqIDAuMiB9KTtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgICBlbHNlXG4gICAgLy8gICAgIHtcbiAgICAvLyAgICAgICAgIC8vIEFuaW1hdGUgZmlyc3QgcHJvbW90aW9uIG51bWJlcnMgaW4gbW9iaWxlXG4gICAgLy8gICAgICAgICBjb25zdCBwZW5kaW5nID0gdGhpcy4kcHJvbW90aW9uc1swXS5xdWVyeVNlbGVjdG9yKCcucGVuZGluZycpLmRhdGFzZXQudmFsdWU7XG4gICAgLy8gICAgICAgICBjb25zdCBwZW5kaW5nU3BsaXQgPSBwZW5kaW5nLnNwbGl0KCcnKTtcbiAgICAvLyAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBwZW5kaW5nU3BsaXQubGVuZ3RoOyBpKyspXG4gICAgLy8gICAgICAgICAgICAgZ3NhcC50byh0aGlzLiRwcm9tb3Rpb25zWzBdLnF1ZXJ5U2VsZWN0b3IoJy5wZW5kaW5nJykucXVlcnlTZWxlY3RvckFsbCgnLm51bWJlcicpW2ldLCB7IHk6IC0oKHBlbmRpbmdTcGxpdFtpXSAqIDEwMCkpICsgJyUnLCBvcGFjaXR5OiAxLCBlYXNlOiAnZXhwby5vdXQnLCBkdXJhdGlvbjogMiwgZGVsYXk6IDEgKyAoaSAqIDAuMDEpIH0pO1xuICAgIC8vICAgICB9XG4gICAgLy8gICAgIGlmKCF0aGlzLmFwcFN0b3JlLmlzRGVza3RvcClcbiAgICAvLyAgICAgICAgIHRoaXMuaW5pdFByb21vdGlvbk1vYmlsZSgpO1xuICAgIC8vIH1cblxuICB9LCB7XG4gICAga2V5OiBcImJlZm9yZUVudGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGJlZm9yZUVudGVyKCkge1xuICAgICAgaWYgKHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKSB7XG4gICAgICAgIC8vIFNldCBwcm9tb3Rpb25zXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy4kcHJvbW90aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGdzYXAuc2V0KHRoaXMuJHByb21vdGlvbnNbaV0sIHtcbiAgICAgICAgICAgIHk6ICctMi41dncnLFxuICAgICAgICAgICAgd2lsbENoYW5nZTogJ3RyYW5zZm9ybSdcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJwcmVlbnRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBwcmVlbnRlcigpIHtcbiAgICAgIGlmICh0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCkge1xuICAgICAgICAvLyBJbml0IHByb21vdGlvbnNcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLiRwcm9tb3Rpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgZ3NhcC50byh0aGlzLiRwcm9tb3Rpb25zW2ldLCB7XG4gICAgICAgICAgICB5OiAnMHZ3JyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAxLFxuICAgICAgICAgICAgZGVsYXk6IGkgKiAwLjA1LFxuICAgICAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgICAgIGNsZWFyUHJvcHM6ICd3aWxsQ2hhbmdlJ1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImVudGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGVudGVyKCkge1xuICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgIGlmICghdGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHtcbiAgICAgICAgZ3NhcC50byh0aGlzLiRwcm9tb3Rpb25zWzBdLnF1ZXJ5U2VsZWN0b3IoJy5wZW5kaW5nJyksIHtcbiAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgICAgZHVyYXRpb246IDJcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBwZW5kaW5nID0gdGhpcy4kcHJvbW90aW9uc1swXS5xdWVyeVNlbGVjdG9yKCcucGVuZGluZycpLmRhdGFzZXQudmFsdWU7XG4gICAgICAgIHZhciBwZW5kaW5nU3BsaXQgPSBwZW5kaW5nLnNwbGl0KCcnKTtcblxuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHBlbmRpbmdTcGxpdC5sZW5ndGg7IGorKykge1xuICAgICAgICAgIGdzYXAudG8odGhpcy4kcHJvbW90aW9uc1swXS5xdWVyeVNlbGVjdG9yKCcucGVuZGluZycpLnF1ZXJ5U2VsZWN0b3JBbGwoJy5udW1iZXInKVtqXSwge1xuICAgICAgICAgICAgeTogKDkgLSBwZW5kaW5nU3BsaXRbal0pICogMTAwICsgMTAwICsgJyUnLFxuICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgICAgICBkdXJhdGlvbjogMixcbiAgICAgICAgICAgIGRlbGF5OiBqICogMC4xXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy4kcHJvbW90aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHRoaXMuZG9tRXZlbnRzLmFkZCh0aGlzLiRwcm9tb3Rpb25zW2ldLCAnbW91c2VlbnRlcicsIGZ1bmN0aW9uIChlLCBhLCBlbCkge1xuICAgICAgICAgICAgX3RoaXMyLnByb21vdGlvbkVudGVyKGVsKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0aGlzLmRvbUV2ZW50cy5hZGQodGhpcy4kcHJvbW90aW9uc1tpXSwgJ21vdXNlbGVhdmUnLCBmdW5jdGlvbiAoZSwgYSwgZWwpIHtcbiAgICAgICAgICAgIF90aGlzMi5wcm9tb3Rpb25MZWF2ZShlbCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicHJvbW90aW9uSW5pdFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBwcm9tb3Rpb25Jbml0KGVsKSB7XG4gICAgICBpZiAodGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHtcbiAgICAgICAgdmFyIGZpcnN0TGFiZWwgPSBlbC5xdWVyeVNlbGVjdG9yKCcubGFiZWwtLTEnKTtcbiAgICAgICAgdmFyIGZpcnN0TGFiZWxTcGxpdCA9IG5ldyBTcGxpdFRleHQoZmlyc3RMYWJlbCwge1xuICAgICAgICAgIHR5cGU6ICdsaW5lcywgd29yZHMnLFxuICAgICAgICAgIGxpbmVzQ2xhc3M6ICdsaW5lIGxpbmUtLSsrJyxcbiAgICAgICAgICB3b3Jkc0NsYXNzOiAnd29yZCB3b3JkLS0rKycsXG4gICAgICAgICAgY2hhcnNDbGFzczogJ2NoYXIgY2hhci0tKysnXG4gICAgICAgIH0pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG5cbiAgICAgICAgdGhpcy5zcGxpdFRleHRzLnB1c2goZmlyc3RMYWJlbFNwbGl0KTtcbiAgICAgICAgZmlyc3RMYWJlbC5jbGFzc0xpc3QuYWRkKCdzcGxpdCcpO1xuICAgICAgICB2YXIgZmlyc3RMYWJlbFdvcmRzID0gZWwucXVlcnlTZWxlY3RvckFsbCgnLmxhYmVsLS0xIC53b3JkJyk7XG5cbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBmaXJzdExhYmVsV29yZHMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICBnc2FwLnNldChmaXJzdExhYmVsV29yZHNbal0sIHtcbiAgICAgICAgICAgIHk6ICcwJSdcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzZWNvbmRMYWJlbCA9IGVsLnF1ZXJ5U2VsZWN0b3IoJy5sYWJlbC0tMicpO1xuICAgICAgICB2YXIgc2Vjb25kTGFiZWxTcGxpdCA9IG5ldyBTcGxpdFRleHQoc2Vjb25kTGFiZWwsIHtcbiAgICAgICAgICB0eXBlOiAnbGluZXMsIHdvcmRzJyxcbiAgICAgICAgICBsaW5lc0NsYXNzOiAnbGluZSBsaW5lLS0rKycsXG4gICAgICAgICAgd29yZHNDbGFzczogJ3dvcmQgd29yZC0tKysnLFxuICAgICAgICAgIGNoYXJzQ2xhc3M6ICdjaGFyIGNoYXItLSsrJ1xuICAgICAgICB9KTsgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuXG4gICAgICAgIHRoaXMuc3BsaXRUZXh0cy5wdXNoKHNlY29uZExhYmVsU3BsaXQpO1xuICAgICAgICBzZWNvbmRMYWJlbC5jbGFzc0xpc3QuYWRkKCdzcGxpdCcpO1xuICAgICAgICB2YXIgc2Vjb25kTGFiZWxXb3JkcyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5sYWJlbC0tMiAud29yZCcpO1xuXG4gICAgICAgIGZvciAodmFyIF9qID0gMDsgX2ogPCBzZWNvbmRMYWJlbFdvcmRzLmxlbmd0aDsgX2orKykge1xuICAgICAgICAgIGdzYXAuc2V0KHNlY29uZExhYmVsV29yZHNbX2pdLCB7XG4gICAgICAgICAgICB5OiAnMTAwJSdcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHByb21vdGlvblRyaWdnZXIgPSBTY3JvbGxUcmlnZ2VyLmNyZWF0ZSh7XG4gICAgICAgICAgZGVmYXVsdHM6IHtcbiAgICAgICAgICAgIGVhc2U6ICdub25lJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgdHJpZ2dlcjogZWwucXVlcnlTZWxlY3RvcignLnBlbmRpbmcnKSxcbiAgICAgICAgICBzdGFydDogJ3RvcCBib3R0b20nLFxuICAgICAgICAgIG9uY2U6IHRydWUsXG4gICAgICAgICAgb25FbnRlcjogZnVuY3Rpb24gb25FbnRlcigpIHtcbiAgICAgICAgICAgIGdzYXAuc2V0KGVsLnF1ZXJ5U2VsZWN0b3IoJy5wZW5kaW5nJyksIHtcbiAgICAgICAgICAgICAgZGlzcGxheTogJ2ZsZXgnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciBwZW5kaW5nID0gZWwucXVlcnlTZWxlY3RvcignLnBlbmRpbmcnKS5kYXRhc2V0LnZhbHVlO1xuICAgICAgICAgICAgdmFyIHBlbmRpbmdTcGxpdCA9IHBlbmRpbmcuc3BsaXQoJycpO1xuICAgICAgICAgICAgZ3NhcC50byhlbC5xdWVyeVNlbGVjdG9yKCcucGVuZGluZycpLCB7XG4gICAgICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgICAgICAgIGR1cmF0aW9uOiAyXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwZW5kaW5nU3BsaXQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgZ3NhcC50byhlbC5xdWVyeVNlbGVjdG9yKCcucGVuZGluZycpLnF1ZXJ5U2VsZWN0b3JBbGwoJy5udW1iZXInKVtpXSwge1xuICAgICAgICAgICAgICAgIHk6ICg5IC0gcGVuZGluZ1NwbGl0W2ldKSAqIDEwMCArIDEwMCArICclJyxcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDIsXG4gICAgICAgICAgICAgICAgZGVsYXk6IGkgKiAwLjFcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IC8vIGdzYXAudG8oZWwucXVlcnlTZWxlY3RvcignLnBlbmRpbmcnKSwgeyBvcGFjaXR5OiAxLCBlYXNlOiAnZXhwby5vdXQnLCBkdXJhdGlvbjogMiB9KTtcbiAgICAgICAgICAgIC8vIGNvbnN0IHBlbmRpbmcgPSBlbC5xdWVyeVNlbGVjdG9yKCcucGVuZGluZycpLmRhdGFzZXQudmFsdWU7XG4gICAgICAgICAgICAvLyBjb25zdCBwZW5kaW5nU3BsaXQgPSBwZW5kaW5nLnNwbGl0KCcnKTtcbiAgICAgICAgICAgIC8vIGZvcihsZXQgaiA9IDA7IGogPCBwZW5kaW5nU3BsaXQubGVuZ3RoOyBqKyspXG4gICAgICAgICAgICAvLyAgICAgZ3NhcC50byhlbC5xdWVyeVNlbGVjdG9yKCcucGVuZGluZycpLnF1ZXJ5U2VsZWN0b3JBbGwoJy5udW1iZXInKVtqXSwgeyB5OiAoKCg5IC0gcGVuZGluZ1NwbGl0W2pdKSAqIDEwMCkgKyAxMDApICsgJyUnLCBvcGFjaXR5OiAxLCBlYXNlOiAnZXhwby5vdXQnLCBkdXJhdGlvbjogMiwgZGVsYXk6IGogKiAwLjEgfSk7XG5cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnNjcm9sbFRyaWdnZXJzLnB1c2gocHJvbW90aW9uVHJpZ2dlcik7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInByb21vdGlvbkVudGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHByb21vdGlvbkVudGVyKGVsKSB7XG4gICAgICBnc2FwLmtpbGxUd2VlbnNPZihbZWwucXVlcnlTZWxlY3RvcignLm91dGVyJyksIGVsLnF1ZXJ5U2VsZWN0b3IoJy5wZW5kaW5nJyldKTtcbiAgICAgIGdzYXAuc2V0KGVsLnF1ZXJ5U2VsZWN0b3IoJy5wZW5kaW5nJyksIHtcbiAgICAgICAgZGlzcGxheTogJ2ZsZXgnXG4gICAgICB9KTtcbiAgICAgIGdzYXAuc2V0KGVsLnF1ZXJ5U2VsZWN0b3IoJy5vdXRlcicpLCB7XG4gICAgICAgIGRpc3BsYXk6ICdibG9jaydcbiAgICAgIH0pO1xuICAgICAgdmFyIHBlbmRpbmcgPSBlbC5xdWVyeVNlbGVjdG9yKCcucGVuZGluZycpLmRhdGFzZXQudmFsdWU7XG4gICAgICB2YXIgcGVuZGluZ1NwbGl0ID0gcGVuZGluZy5zcGxpdCgnJyk7XG4gICAgICBnc2FwLnRvKGVsLnF1ZXJ5U2VsZWN0b3IoJy5wZW5kaW5nJyksIHtcbiAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgZHVyYXRpb246IDJcbiAgICAgIH0pO1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBlbmRpbmdTcGxpdC5sZW5ndGg7IGkrKykge1xuICAgICAgICBnc2FwLnRvKGVsLnF1ZXJ5U2VsZWN0b3IoJy5wZW5kaW5nJykucXVlcnlTZWxlY3RvckFsbCgnLm51bWJlcicpW2ldLCB7XG4gICAgICAgICAgeTogKDkgLSBwZW5kaW5nU3BsaXRbaV0pICogMTAwICsgMTAwICsgJyUnLFxuICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgICBkdXJhdGlvbjogMixcbiAgICAgICAgICBkZWxheTogaSAqIDAuMVxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgZ3NhcC50byhlbC5xdWVyeVNlbGVjdG9yKCcub3V0ZXIgLmJhY2tncm91bmRfX2JnJyksIHtcbiAgICAgICAgc2NhbGU6IDEsXG4gICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgIGR1cmF0aW9uOiAwLjZcbiAgICAgIH0pO1xuICAgICAgZ3NhcC50byhlbC5xdWVyeVNlbGVjdG9yKCcub3V0ZXIgLmJhY2tncm91bmRfX292ZXJsYXknKSwge1xuICAgICAgICBvcGFjaXR5OiAwLjUsXG4gICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgIGR1cmF0aW9uOiAwLjZcbiAgICAgIH0pO1xuICAgICAgZ3NhcC50byhlbC5xdWVyeVNlbGVjdG9yKCcuaW5uZXIgLmJhY2tncm91bmRfX2JnJyksIHtcbiAgICAgICAgc2NhbGU6IDEsXG4gICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgIGR1cmF0aW9uOiAwLjZcbiAgICAgIH0pO1xuICAgICAgZ3NhcC50byhlbC5xdWVyeVNlbGVjdG9yKCcuaW5uZXIgLm1hc2snKSwge1xuICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICBkdXJhdGlvbjogMC42XG4gICAgICB9KTtcbiAgICAgIGdzYXAudG8oZWwucXVlcnlTZWxlY3RvcignLmlubmVyIC5pbmZvJyksIHtcbiAgICAgICAgY29sb3I6ICcjZmZmJyxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgZHVyYXRpb246IDAuNlxuICAgICAgfSk7XG5cbiAgICAgIGlmICh0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCkge1xuICAgICAgICB2YXIgZmlyc3RMYWJlbFdvcmRzID0gZWwucXVlcnlTZWxlY3RvckFsbCgnLmxhYmVsLS0xIC53b3JkJyk7XG5cbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGZpcnN0TGFiZWxXb3Jkcy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICBnc2FwLnRvKGZpcnN0TGFiZWxXb3Jkc1tfaV0sIHtcbiAgICAgICAgICAgIHk6ICctMTAwJScsXG4gICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICAgICAgZHVyYXRpb246IDAuNlxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHNlY29uZExhYmVsV29yZHMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKCcubGFiZWwtLTIgLndvcmQnKTtcblxuICAgICAgICBmb3IgKHZhciBfaTIgPSAwOyBfaTIgPCBzZWNvbmRMYWJlbFdvcmRzLmxlbmd0aDsgX2kyKyspIHtcbiAgICAgICAgICBnc2FwLnRvKHNlY29uZExhYmVsV29yZHNbX2kyXSwge1xuICAgICAgICAgICAgeTogJzAlJyxcbiAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgICAgICBkdXJhdGlvbjogMC42XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicHJvbW90aW9uTGVhdmVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcHJvbW90aW9uTGVhdmUoZWwpIHtcbiAgICAgIHZhciBwZW5kaW5nID0gZWwucXVlcnlTZWxlY3RvcignLnBlbmRpbmcnKS5kYXRhc2V0LnZhbHVlO1xuICAgICAgdmFyIHBlbmRpbmdTcGxpdCA9IHBlbmRpbmcuc3BsaXQoJycpO1xuICAgICAgZ3NhcC50byhlbC5xdWVyeVNlbGVjdG9yKCcucGVuZGluZycpLCB7XG4gICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgZHVyYXRpb246IDAuNCxcbiAgICAgICAgb25Db21wbGV0ZTogZnVuY3Rpb24gb25Db21wbGV0ZSgpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBlbmRpbmdTcGxpdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgZ3NhcC5raWxsVHdlZW5zT2YoZWwucXVlcnlTZWxlY3RvcignLnBlbmRpbmcnKS5xdWVyeVNlbGVjdG9yQWxsKCcubnVtYmVyJylbaV0pO1xuICAgICAgICAgICAgZ3NhcC5zZXQoZWwucXVlcnlTZWxlY3RvcignLnBlbmRpbmcnKS5xdWVyeVNlbGVjdG9yQWxsKCcubnVtYmVyJylbaV0sIHtcbiAgICAgICAgICAgICAgeTogJzAlJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGdzYXAudG8oZWwucXVlcnlTZWxlY3RvcignLm91dGVyIC5iYWNrZ3JvdW5kX19iZycpLCB7XG4gICAgICAgIHNjYWxlOiAxLjEsXG4gICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgZHVyYXRpb246IDAuNlxuICAgICAgfSk7XG4gICAgICBnc2FwLnRvKGVsLnF1ZXJ5U2VsZWN0b3IoJy5vdXRlciAuYmFja2dyb3VuZF9fb3ZlcmxheScpLCB7XG4gICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgZHVyYXRpb246IDAuNlxuICAgICAgfSk7XG4gICAgICBnc2FwLnRvKGVsLnF1ZXJ5U2VsZWN0b3IoJy5pbm5lciAuYmFja2dyb3VuZF9fYmcnKSwge1xuICAgICAgICBzY2FsZTogMS4xLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICBkdXJhdGlvbjogMC42XG4gICAgICB9KTtcbiAgICAgIGdzYXAudG8oZWwucXVlcnlTZWxlY3RvcignLmlubmVyIC5tYXNrJyksIHtcbiAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICBkdXJhdGlvbjogMC42XG4gICAgICB9KTtcbiAgICAgIGdzYXAudG8oZWwucXVlcnlTZWxlY3RvcignLmlubmVyIC5pbmZvJyksIHtcbiAgICAgICAgY29sb3I6ICcjMDAwJyxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgZHVyYXRpb246IDAuNlxuICAgICAgfSk7XG4gICAgICBnc2FwLnNldChlbC5xdWVyeVNlbGVjdG9yKCcub3V0ZXInKSwge1xuICAgICAgICBkaXNwbGF5OiAnYmxvY2snLFxuICAgICAgICBkZWxheTogMC42XG4gICAgICB9KTtcbiAgICAgIGdzYXAuc2V0KGVsLnF1ZXJ5U2VsZWN0b3IoJy5wZW5kaW5nJyksIHtcbiAgICAgICAgZGlzcGxheTogJ25vbmUnLFxuICAgICAgICBkZWxheTogMC42XG4gICAgICB9KTtcblxuICAgICAgaWYgKHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKSB7XG4gICAgICAgIHZhciBmaXJzdExhYmVsV29yZHMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKCcubGFiZWwtLTEgLndvcmQnKTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZpcnN0TGFiZWxXb3Jkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGdzYXAudG8oZmlyc3RMYWJlbFdvcmRzW2ldLCB7XG4gICAgICAgICAgICB5OiAnMCUnLFxuICAgICAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjZcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzZWNvbmRMYWJlbFdvcmRzID0gZWwucXVlcnlTZWxlY3RvckFsbCgnLmxhYmVsLS0yIC53b3JkJyk7XG5cbiAgICAgICAgZm9yICh2YXIgX2kzID0gMDsgX2kzIDwgc2Vjb25kTGFiZWxXb3Jkcy5sZW5ndGg7IF9pMysrKSB7XG4gICAgICAgICAgZ3NhcC50byhzZWNvbmRMYWJlbFdvcmRzW19pM10sIHtcbiAgICAgICAgICAgIHk6ICcxMDAlJyxcbiAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgICAgICBkdXJhdGlvbjogMC42XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IC8vIHByb21vdGlvbkNsaWNrKGUsIGVsLCBjbGlja2VkKVxuICAgIC8vIHtcbiAgICAvLyAgICAgaWYoZS5zaGlmdEtleSB8fCBlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KVxuICAgIC8vICAgICAgICAgcmV0dXJuO1xuICAgIC8vICAgICB0aGlzLmNsaWNrZWREb25lID0gdHJ1ZTtcbiAgICAvLyAgICAgdGhpcy5jbGlja2VkID0gY2xpY2tlZDtcbiAgICAvLyAgICAgZm9yKGxldCBpID0gMDsgaSA8IHRoaXMuJHByb21vdGlvbnMubGVuZ3RoOyBpKyspXG4gICAgLy8gICAgIHtcbiAgICAvLyAgICAgICAgIC8vIGlmKGkgIT09IGNsaWNrZWQpXG4gICAgLy8gICAgICAgICAvLyB7XG4gICAgLy8gICAgICAgICAgICAgZ3NhcC50byh0aGlzLiRwcm9tb3Rpb25zW2ldLnF1ZXJ5U2VsZWN0b3IoJy5pbm5lciAubWFzaycpLCB7IG9wYWNpdHk6IDAuMDAwMSwgZHVyYXRpb246IDAuMiB9KTtcbiAgICAvLyAgICAgICAgICAgICBnc2FwLnRvKHRoaXMuJHByb21vdGlvbnNbaV0ucXVlcnlTZWxlY3RvcignLmlubmVyIC5pbmZvJyksIHsgb3BhY2l0eTogMC4wMDAxLCBlYXNlOiAnZXhwby5vdXQnLCBkdXJhdGlvbjogMSB9KTtcbiAgICAvLyAgICAgICAgICAgICBnc2FwLnRvKHRoaXMuJHByb21vdGlvbnNbaV0ucXVlcnlTZWxlY3RvcignLm91dGVyIC5iYWNrZ3JvdW5kJyksIHsgeTogJzEwMCUnLCBlYXNlOiAnZXhwby5pbk91dCcsIGR1cmF0aW9uOiAxIH0pO1xuICAgIC8vICAgICAgICAgICAgIGdzYXAudG8odGhpcy4kcHJvbW90aW9uc1tpXS5xdWVyeVNlbGVjdG9yKCcub3V0ZXIgLmJhY2tncm91bmQgLmJhY2tncm91bmRfX2JnJyksIHsgeTogJy0xMDAlJywgc2NhbGU6IDEsIGVhc2U6ICdleHBvLmluT3V0JywgZHVyYXRpb246IDEgfSk7XG4gICAgLy8gICAgICAgICAgICAgZ3NhcC50byh0aGlzLiRwcm9tb3Rpb25zW2ldLnF1ZXJ5U2VsZWN0b3IoJy5pbm5lciAuYmFja2dyb3VuZCcpLCB7IHk6ICcxMDAlJywgZWFzZTogJ2V4cG8uaW5PdXQnLCBkdXJhdGlvbjogMSB9KTtcbiAgICAvLyAgICAgICAgICAgICBnc2FwLnRvKHRoaXMuJHByb21vdGlvbnNbaV0ucXVlcnlTZWxlY3RvcignLmlubmVyIC5iYWNrZ3JvdW5kIC5iYWNrZ3JvdW5kX19iZycpLCB7IHk6ICctMTAwJScsIHNjYWxlOiAxLCBlYXNlOiAnZXhwby5pbk91dCcsIGR1cmF0aW9uOiAxIH0pO1xuICAgIC8vICAgICAgICAgICAgIGdzYXAuZGVsYXllZENhbGwoMSwgKCkgPT5cbiAgICAvLyAgICAgICAgICAgICB7XG4gICAgLy8gICAgICAgICAgICAgICAgIGdzYXAudG8odGhpcy4kcHJvbW90aW9uc1tpXSwgeyBvcGFjaXR5OiAwLjAwMDEgfSk7XG4gICAgLy8gICAgICAgICAgICAgfSk7XG4gICAgLy8gICAgICAgICAvLyB9XG4gICAgLy8gICAgIH1cbiAgICAvLyB9XG5cbiAgfSwge1xuICAgIGtleTogXCJyZXNpemVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVzaXplKCkge1xuICAgICAgaWYgKHRoaXMuc2xpZGVyU2Nyb2xsZXIpIHRoaXMuc2xpZGVyU2Nyb2xsZXIucmVzaXplKCk7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIFJlbmRlcmVyUHJvbW90aW9ucztcbn0oUmVuZGVyZXIpOyAvLyBEb25gdCBmb3JnZXQgdG8gZXhwb3J0IHlvdXIgcmVuZGVyZXJcblxuXG5leHBvcnQgZGVmYXVsdCBSZW5kZXJlclByb21vdGlvbnM7IiwiZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfVxuXG5mdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfVxuXG4vL3V0aWxpdGllc1xuaW1wb3J0IGdzYXAgZnJvbSAnZ3NhcCc7XG5pbXBvcnQgU3BsaXRUZXh0IGZyb20gJy4uL2NsYXNzZXMvc3BsaXRUZXh0JzsgLy9pbXBvcnQgV2hlZWxJbmRpY2F0b3IgZnJvbSAnd2hlZWwtaW5kaWNhdG9yJztcbi8vdXRpbGl0aWVzXG5cbmltcG9ydCBEb21FdmVudHMgZnJvbSAnLi4vY2xhc3Nlcy9kb21FdmVudHMnO1xuXG52YXIgbm9vcCA9IGZ1bmN0aW9uIG5vb3AoKSB7fTsgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuXG5cbnZhciBfZGVmYXVsdCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIF9kZWZhdWx0KG9wdGlvbnMpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgX2RlZmF1bHQpO1xuXG4gICAgLy8gaG9vayBmdW5jdGlvbnNcbiAgICB0aGlzLl9vblNldCA9IG9wdGlvbnMub25TZXQgfHwgbm9vcDtcbiAgICB0aGlzLl9vblVuc2V0ID0gb3B0aW9ucy5vblVuc2V0IHx8IG5vb3A7XG4gICAgdGhpcy5fb25DaGFuZ2UgPSBvcHRpb25zLm9uQ2hhbmdlIHx8IG5vb3A7XG4gICAgdGhpcy5kb21FdmVudHMgPSBuZXcgRG9tRXZlbnRzKCk7XG4gICAgdGhpcy5saWdodGJveCA9IHtcbiAgICAgIHRhcmdldDogb3B0aW9ucy50YXJnZXQsXG4gICAgICBjdXJyZW50OiAwLFxuICAgICAgdG90YWw6IDAsXG4gICAgICBkaXJlY3Rpb246ICduZXh0JyxcbiAgICAgIGRpcmVjdGlvblZhbHVlOiAxMDAsXG4gICAgICBkaXJlY3Rpb25WYWx1ZTI6IDcwLFxuICAgICAgZGlyZWN0aW9uVGV4dDogMTAwLFxuICAgICAgZGlyOiAxLFxuICAgICAgcHJvZ3Jlc3M6IDAsXG4gICAgICBwcmV2OiAwLFxuICAgICAgbmV4dDogMCxcbiAgICAgIGR1cmF0aW9uOiB0eXBlb2Ygb3B0aW9ucy5kdXJhdGlvbiAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmR1cmF0aW9uIDogMSxcbiAgICAgIHRvdGFsRHVyYXRpb246IDEsXG4gICAgICBlYXNlOiAnZXhwby5pbk91dCcsXG4gICAgICBhbmltYXRpbmc6IGZhbHNlLFxuICAgICAgdGxBbmltYXRpb246IG51bGxcbiAgICB9OyAvL2FzaWduYW1vcyBlbCBzZWxlY3RvclxuXG4gICAgdGhpcy4kZWwgPSBvcHRpb25zLmVsO1xuICAgIHRoaXMuJG15U3BsaXRUZXh0ID0gbnVsbDtcbiAgICB0aGlzLnNlbGVjdG9ycygpO1xuICAgIHRoaXMuZXZlbnRzKCk7XG4gICAgdGhpcy5pbml0KCk7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoX2RlZmF1bHQsIFt7XG4gICAga2V5OiBcInNlbGVjdG9yc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzZWxlY3RvcnMoKSB7XG4gICAgICB0aGlzLiRsaWdodGJveCA9IHRoaXMubGlnaHRib3gudGFyZ2V0O1xuICAgICAgdGhpcy4kbGlnaHRib3hNYXNrID0gdGhpcy4kbGlnaHRib3gucXVlcnlTZWxlY3RvcignLmxpZ2h0Ym94X19tYXNrJyk7XG4gICAgICB0aGlzLiRsaWdodGJveElubmVyID0gdGhpcy4kbGlnaHRib3gucXVlcnlTZWxlY3RvcignLmxpZ2h0Ym94X19pbm5lcicpO1xuICAgICAgdGhpcy4kbGlnaHRib3hJbm5lckl0ZW1zID0gdGhpcy4kbGlnaHRib3hJbm5lci5xdWVyeVNlbGVjdG9yQWxsKCcubGlnaHRib3hfX2l0ZW0nKTtcbiAgICAgIHRoaXMuJGxpZ2h0Ym94UHJldiA9IHRoaXMuJGxpZ2h0Ym94LnF1ZXJ5U2VsZWN0b3IoJy5saWdodGJveF9fcHJldicpO1xuICAgICAgdGhpcy4kbGlnaHRib3hOZXh0ID0gdGhpcy4kbGlnaHRib3gucXVlcnlTZWxlY3RvcignLmxpZ2h0Ym94X19uZXh0Jyk7XG4gICAgICB0aGlzLiRsaWdodGJveENsb3NlID0gdGhpcy4kbGlnaHRib3gucXVlcnlTZWxlY3RvcignLmxpZ2h0Ym94X19jbG9zZScpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJldmVudHNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZXZlbnRzKCkge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgdGhpcy5kb21FdmVudHMuYWRkKHRoaXMuJGxpZ2h0Ym94UHJldiwgJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpcy5jaGFuZ2UoJ3ByZXYnKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5kb21FdmVudHMuYWRkKHRoaXMuJGxpZ2h0Ym94TmV4dCwgJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpcy5jaGFuZ2UoJ25leHQnKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5kb21FdmVudHMuYWRkKHRoaXMuJGxpZ2h0Ym94Q2xvc2UsICdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3RoaXMudW5zZXQoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJpbml0XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAvL1NldCB0b3RhbCBjb3VudFxuICAgICAgdGhpcy5saWdodGJveC50b3RhbCA9IHRoaXMuJGxpZ2h0Ym94SW5uZXJJdGVtcy5sZW5ndGg7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy4kbGlnaHRib3hJbm5lckl0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGdzYXAuc2V0KHRoaXMuJGxpZ2h0Ym94SW5uZXJJdGVtc1tpXSwge1xuICAgICAgICAgIGRpc3BsYXk6ICdub25lJ1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgZ3NhcC5zZXQodGhpcy4kbGlnaHRib3hJbm5lckl0ZW1zWzBdLCB7XG4gICAgICAgIGRpc3BsYXk6ICdibG9jaydcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzZXRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0KGluZGV4KSB7XG4gICAgICB0aGlzLl9vblNldChpbmRleCk7XG5cbiAgICAgIGdzYXAuc2V0KHRoaXMuJGxpZ2h0Ym94SW5uZXJJdGVtc1t0aGlzLmxpZ2h0Ym94LnByZXZdLCB7XG4gICAgICAgIGRpc3BsYXk6ICdub25lJ1xuICAgICAgfSk7XG4gICAgICBnc2FwLnNldCh0aGlzLiRsaWdodGJveCwge1xuICAgICAgICBkaXNwbGF5OiAnYmxvY2snXG4gICAgICB9KTtcbiAgICAgIGdzYXAudG8odGhpcy4kbGlnaHRib3hNYXNrLCB7XG4gICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgIGR1cmF0aW9uOiAxXG4gICAgICB9KTtcbiAgICAgIGdzYXAudG8odGhpcy4kbGlnaHRib3hJbm5lciwge1xuICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICBkdXJhdGlvbjogMSxcbiAgICAgICAgZGVsYXk6IDAuNVxuICAgICAgfSk7XG4gICAgICBnc2FwLnNldCh0aGlzLiRsaWdodGJveElubmVySXRlbXNbaW5kZXhdLCB7XG4gICAgICAgIGRpc3BsYXk6ICdibG9jaydcbiAgICAgIH0pOyAvLyBnc2FwLnNldCh0aGlzLiRsaWdodGJveElubmVySXRlbXNbaW5kZXhdLnF1ZXJ5U2VsZWN0b3IoJy5iYWNrZ3JvdW5kJyksIHsgeDogJzAlJywgeTogJy0xMDAlJyB9KTtcbiAgICAgIC8vIGdzYXAuc2V0KHRoaXMuJGxpZ2h0Ym94SW5uZXJJdGVtc1tpbmRleF0ucXVlcnlTZWxlY3RvcignLmJhY2tncm91bmQgLmJhY2tncm91bmRfX2JnJyksIHsgeTogJzEwMCUnIH0pO1xuICAgICAgLy8gZ3NhcC50byh0aGlzLiRsaWdodGJveElubmVySXRlbXNbaW5kZXhdLnF1ZXJ5U2VsZWN0b3IoJy5iYWNrZ3JvdW5kJyksIHsgeTogJzAlJywgZHVyYXRpb246IDEsIGVhc2U6ICdleHBvLm91dCcsIGRlbGF5OiAwLjUgfSk7XG4gICAgICAvLyBnc2FwLnRvKHRoaXMuJGxpZ2h0Ym94SW5uZXJJdGVtc1tpbmRleF0ucXVlcnlTZWxlY3RvcignLmJhY2tncm91bmQgLmJhY2tncm91bmRfX2JnJyksIHsgeTogJzAlJywgZHVyYXRpb246IDEsIGVhc2U6ICdleHBvLm91dCcsIGRlbGF5OiAwLjUgfSk7XG5cbiAgICAgIGdzYXAudG8oW3RoaXMuJGxpZ2h0Ym94UHJldiwgdGhpcy4kbGlnaHRib3hOZXh0LCB0aGlzLiRsaWdodGJveENsb3NlXSwge1xuICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICBkdXJhdGlvbjogMSxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgZGVsYXk6IDAuNVxuICAgICAgfSk7XG4gICAgICB0aGlzLmxpZ2h0Ym94LmN1cnJlbnQgPSBpbmRleDtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwidW5zZXRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gdW5zZXQoKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgdGhpcy5fb25VbnNldCh0aGlzLmxpZ2h0Ym94LmN1cnJlbnQpOyAvLyBnc2FwLnRvKHRoaXMuJGxpZ2h0Ym94SW5uZXJJdGVtc1t0aGlzLmxpZ2h0Ym94LmN1cnJlbnRdLnF1ZXJ5U2VsZWN0b3IoJy5iYWNrZ3JvdW5kJyksIHsgeTogJzEwMCUnLCBkdXJhdGlvbjogMSwgZWFzZTogJ2V4cG8ub3V0JywgZGVsYXk6IDAgfSk7XG4gICAgICAvLyBnc2FwLnRvKHRoaXMuJGxpZ2h0Ym94SW5uZXJJdGVtc1t0aGlzLmxpZ2h0Ym94LmN1cnJlbnRdLnF1ZXJ5U2VsZWN0b3IoJy5iYWNrZ3JvdW5kIC5iYWNrZ3JvdW5kX19iZycpLCB7IHk6ICctMTAwJScsIGR1cmF0aW9uOiAxLCBlYXNlOiAnZXhwby5vdXQnLCBkZWxheTogMCB9KTtcblxuXG4gICAgICBnc2FwLnRvKFt0aGlzLiRsaWdodGJveFByZXYsIHRoaXMuJGxpZ2h0Ym94TmV4dCwgdGhpcy4kbGlnaHRib3hDbG9zZV0sIHtcbiAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICBkdXJhdGlvbjogMSxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgZGVsYXk6IDBcbiAgICAgIH0pO1xuICAgICAgZ3NhcC50byh0aGlzLiRsaWdodGJveE1hc2ssIHtcbiAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICBkdXJhdGlvbjogMSxcbiAgICAgICAgZGVsYXk6IDAuNVxuICAgICAgfSk7XG4gICAgICBnc2FwLnRvKHRoaXMuJGxpZ2h0Ym94SW5uZXIsIHtcbiAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICBkdXJhdGlvbjogMVxuICAgICAgfSk7XG4gICAgICBnc2FwLmRlbGF5ZWRDYWxsKDEuNSwgZnVuY3Rpb24gKCkge1xuICAgICAgICBnc2FwLnNldChfdGhpczIuJGxpZ2h0Ym94LCB7XG4gICAgICAgICAgZGlzcGxheTogJ25vbmUnXG4gICAgICAgIH0pO1xuICAgICAgICBnc2FwLnNldChfdGhpczIuJGxpZ2h0Ym94SW5uZXJJdGVtc1tfdGhpczIubGlnaHRib3guY3VycmVudF0sIHtcbiAgICAgICAgICBkaXNwbGF5OiAnbm9uZSdcbiAgICAgICAgfSk7XG4gICAgICAgIGdzYXAuc2V0KF90aGlzMi4kbGlnaHRib3hJbm5lckl0ZW1zW190aGlzMi5saWdodGJveC5jdXJyZW50XS5xdWVyeVNlbGVjdG9yKCcuYmFja2dyb3VuZCcpLCB7XG4gICAgICAgICAgeTogJzAlJ1xuICAgICAgICB9KTtcbiAgICAgICAgZ3NhcC5zZXQoX3RoaXMyLiRsaWdodGJveElubmVySXRlbXNbX3RoaXMyLmxpZ2h0Ym94LmN1cnJlbnRdLnF1ZXJ5U2VsZWN0b3IoJy5iYWNrZ3JvdW5kIC5iYWNrZ3JvdW5kX19iZycpLCB7XG4gICAgICAgICAgeTogJzAlJ1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJjaGFuZ2VcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gY2hhbmdlKGRpcmVjdGlvbikge1xuICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgIGlmICh0aGlzLmxpZ2h0Ym94LmFuaW1hdGluZykgcmV0dXJuO1xuXG4gICAgICB0aGlzLl9vbkNoYW5nZSgpO1xuXG4gICAgICB0aGlzLmxpZ2h0Ym94LmFuaW1hdGluZyA9IHRydWU7XG4gICAgICB0aGlzLmxpZ2h0Ym94LmRpcmVjdGlvbiA9IGRpcmVjdGlvbjtcblxuICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gJ25leHQnKSB7XG4gICAgICAgIHRoaXMubGlnaHRib3gubmV4dCA9ICh0aGlzLmxpZ2h0Ym94LmN1cnJlbnQgKyAxKSAlIHRoaXMubGlnaHRib3gudG90YWw7XG4gICAgICAgIHRoaXMubGlnaHRib3gucHJldiA9IHRoaXMubGlnaHRib3guY3VycmVudCA9PT0gLTEgPyB0aGlzLmxpZ2h0Ym94LnRvdGFsIC0gMSA6IHRoaXMubGlnaHRib3guY3VycmVudDtcbiAgICAgICAgdGhpcy5saWdodGJveC5kaXIgPSB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5saWdodGJveC5uZXh0ID0gdGhpcy5saWdodGJveC5jdXJyZW50ID09PSAwID8gdGhpcy5saWdodGJveC50b3RhbCAtIDEgOiB0aGlzLmxpZ2h0Ym94LmN1cnJlbnQgLSAxO1xuICAgICAgICB0aGlzLmxpZ2h0Ym94LnByZXYgPSB0aGlzLmxpZ2h0Ym94LmN1cnJlbnQgPT09IC0xID8gdGhpcy5saWdodGJveC50b3RhbCAtIDEgOiB0aGlzLmxpZ2h0Ym94LmN1cnJlbnQ7XG4gICAgICAgIHRoaXMubGlnaHRib3guZGlyID0gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIHRoaXMubGlnaHRib3guY3VycmVudCA9IHRoaXMubGlnaHRib3gubmV4dDsgLy9TZXQgbmV4dCBzbGlkZVxuXG4gICAgICBnc2FwLnNldCh0aGlzLiRsaWdodGJveElubmVySXRlbXNbdGhpcy5saWdodGJveC5uZXh0XS5xdWVyeVNlbGVjdG9yKCcuYmFja2dyb3VuZCcpLCB7XG4gICAgICAgIHg6IHRoaXMubGlnaHRib3guZGlyID8gJzEwMCUnIDogJy0xMDAlJ1xuICAgICAgfSk7XG4gICAgICBnc2FwLnNldCh0aGlzLiRsaWdodGJveElubmVySXRlbXNbdGhpcy5saWdodGJveC5uZXh0XSwge1xuICAgICAgICBkaXNwbGF5OiAnYmxvY2snXG4gICAgICB9KTsgLy9BbmltYXRlIG91dCBjdXJyZW50IHNsaWRlXG5cbiAgICAgIGdzYXAudG8odGhpcy4kbGlnaHRib3hJbm5lckl0ZW1zW3RoaXMubGlnaHRib3gucHJldl0ucXVlcnlTZWxlY3RvcignLmJhY2tncm91bmQnKSwge1xuICAgICAgICB4OiB0aGlzLmxpZ2h0Ym94LmRpciA/ICctMTAwJScgOiAnMTAwJScsXG4gICAgICAgIGVhc2U6ICdleHBvLmluT3V0JyxcbiAgICAgICAgZHVyYXRpb246IDFcbiAgICAgIH0pO1xuICAgICAgZ3NhcC50byh0aGlzLiRsaWdodGJveElubmVySXRlbXNbdGhpcy5saWdodGJveC5uZXh0XS5xdWVyeVNlbGVjdG9yKCcuYmFja2dyb3VuZCcpLCB7XG4gICAgICAgIHg6ICcwJScsXG4gICAgICAgIGVhc2U6ICdleHBvLmluT3V0JyxcbiAgICAgICAgZHVyYXRpb246IDFcbiAgICAgIH0pO1xuICAgICAgZ3NhcC5kZWxheWVkQ2FsbCh0aGlzLmxpZ2h0Ym94LmR1cmF0aW9uLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGdzYXAuc2V0KF90aGlzMy4kbGlnaHRib3hJbm5lckl0ZW1zW190aGlzMy5saWdodGJveC5wcmV2XSwge1xuICAgICAgICAgIGRpc3BsYXk6ICdub25lJ1xuICAgICAgICB9KTtcbiAgICAgICAgX3RoaXMzLmxpZ2h0Ym94LmFuaW1hdGluZyA9IGZhbHNlO1xuICAgICAgfSk7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIF9kZWZhdWx0O1xufSgpO1xuXG5leHBvcnQgeyBfZGVmYXVsdCBhcyBkZWZhdWx0IH07IiwiZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgXCJAYmFiZWwvaGVscGVycyAtIHR5cGVvZlwiOyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2Yob2JqKTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvblwiKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9XG5cbmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVTdXBlcihEZXJpdmVkKSB7IHZhciBoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0ID0gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpOyByZXR1cm4gZnVuY3Rpb24gX2NyZWF0ZVN1cGVySW50ZXJuYWwoKSB7IHZhciBTdXBlciA9IF9nZXRQcm90b3R5cGVPZihEZXJpdmVkKSwgcmVzdWx0OyBpZiAoaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCkgeyB2YXIgTmV3VGFyZ2V0ID0gX2dldFByb3RvdHlwZU9mKHRoaXMpLmNvbnN0cnVjdG9yOyByZXN1bHQgPSBSZWZsZWN0LmNvbnN0cnVjdChTdXBlciwgYXJndW1lbnRzLCBOZXdUYXJnZXQpOyB9IGVsc2UgeyByZXN1bHQgPSBTdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9IHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCByZXN1bHQpOyB9OyB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikpIHsgcmV0dXJuIGNhbGw7IH0gZWxzZSBpZiAoY2FsbCAhPT0gdm9pZCAwKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJEZXJpdmVkIGNvbnN0cnVjdG9ycyBtYXkgb25seSByZXR1cm4gb2JqZWN0IG9yIHVuZGVmaW5lZFwiKTsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfVxuXG5mdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIHNlbGY7IH1cblxuZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcInVuZGVmaW5lZFwiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiB0cnVlOyB0cnkgeyBCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoQm9vbGVhbiwgW10sIGZ1bmN0aW9uICgpIHt9KSk7IHJldHVybiB0cnVlOyB9IGNhdGNoIChlKSB7IHJldHVybiBmYWxzZTsgfSB9XG5cbmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH1cblxuLy8gR3NhcFxuaW1wb3J0IGdzYXAgZnJvbSAnZ3NhcCc7XG5pbXBvcnQgU2Nyb2xsVHJpZ2dlciBmcm9tICdnc2FwL1Njcm9sbFRyaWdnZXInOyAvLyBpbXBvcnQgTWFzb25yeSBmcm9tICdtYXNvbnJ5LWxheW91dCc7XG5cbmdzYXAucmVnaXN0ZXJQbHVnaW4oU2Nyb2xsVHJpZ2dlcik7IC8vIEltcG9ydCBSZW5kZXJlclxuXG5pbXBvcnQgUmVuZGVyZXIgZnJvbSAnLi9yZW5kZXJlci5qcyc7IC8vIGltcG9ydCBzdHlsZXNEZWZhdWx0IGZyb20gJy4vc3R5bGVzRGVmYXVsdC5jc3MnOyAvL2VzbGludC1kaXNhYmxlLWxpbmVcbi8vIFV0aWxpdGllc1xuXG5pbXBvcnQgU3VwZXJEcmFnZ2VyIGZyb20gJy4uL2NsYXNzZXMvc3VwZXJEcmFnZ2VyJztcbmltcG9ydCBEcmFnZ2FibGUgZnJvbSAnLi4vY2xhc3Nlcy9EcmFnZ2FibGUnO1xuaW1wb3J0IFNsaWRlciBmcm9tICcuLi9jb21wb25lbnRzL3NsaWRlcic7IC8vIE90aGVyXG4vLyBpbXBvcnQgU2xpZGVyIGZyb20gJy4uL2NsYXNzZXMvc2xpZGVyJztcbi8vIGltcG9ydCBTcGxpdFRleHQgZnJvbSAnLi4vY2xhc3Nlcy9zcGxpdFRleHQnO1xuXG52YXIgUmVuZGVyZXJQcm9tb3Rpb25zU2luZ2xlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfUmVuZGVyZXIpIHtcbiAgX2luaGVyaXRzKFJlbmRlcmVyUHJvbW90aW9uc1NpbmdsZSwgX1JlbmRlcmVyKTtcblxuICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKFJlbmRlcmVyUHJvbW90aW9uc1NpbmdsZSk7XG5cbiAgZnVuY3Rpb24gUmVuZGVyZXJQcm9tb3Rpb25zU2luZ2xlKCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBSZW5kZXJlclByb21vdGlvbnNTaW5nbGUpO1xuXG4gICAgcmV0dXJuIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKFJlbmRlcmVyUHJvbW90aW9uc1NpbmdsZSwgW3tcbiAgICBrZXk6IFwic2VsZWN0b3JzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNlbGVjdG9ycygpIHtcbiAgICAgIHRoaXMuJGhlcm8gPSB0aGlzLiRlbC5xdWVyeVNlbGVjdG9yKCcucHJvbW90aW9uc3NpbmdsZV9faGVybycpO1xuICAgICAgdGhpcy4kYmFja2dyb3VuZCA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3IoJy5wcm9tb3Rpb25zc2luZ2xlX19iYWNrZ3JvdW5kJyk7XG4gICAgICB0aGlzLiRjb250ZW50ID0gdGhpcy4kZWwucXVlcnlTZWxlY3RvcignLnByb21vdGlvbnNzaW5nbGVfX2NvbnRlbnQnKTtcbiAgICAgIHRoaXMuJGZlYXR1cmVkID0gdGhpcy4kZWwucXVlcnlTZWxlY3RvcignLnByb21vdGlvbnNzaW5nbGVfX2ZlYXR1cmVkJyk7XG4gICAgICB0aGlzLiRnYWxsZXJ5ID0gdGhpcy4kZWwucXVlcnlTZWxlY3RvcignLnByb21vdGlvbnNzaW5nbGVfX2dhbGxlcnknKTtcbiAgICAgIHRoaXMuJGZyb20gPSB0aGlzLiRlbC5xdWVyeVNlbGVjdG9yKCcucHJvbW90aW9uc3NpbmdsZV9fZnJvbScpO1xuICAgICAgdGhpcy4kcmVsYXRlZCA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3IoJy5wcm9tb3Rpb25zc2luZ2xlX19yZWxhdGVkJyk7XG4gICAgICB0aGlzLiRmb3JtID0gdGhpcy4kZWwucXVlcnlTZWxlY3RvcignLnByb21vdGlvbnNzaW5nbGVfX2Zvcm0nKTtcbiAgICAgIHRoaXMuJGZvb3RlciA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3IoJy5wcm9tb3Rpb25zc2luZ2xlX19mb290ZXInKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicHJlbG9hZFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBwcmVsb2FkKCkge1xuICAgICAgLy8gUHJlbG9hZGVyXG4gICAgICB2YXIgX21haW4gPSBbXTtcbiAgICAgIGlmICh0aGlzLiRoZXJvLnF1ZXJ5U2VsZWN0b3IoJy5pbWFnZSBpbWcnKSkgX21haW4ucHVzaCh0aGlzLiRoZXJvLnF1ZXJ5U2VsZWN0b3IoJy5pbWFnZSBpbWcnKS5zcmMpO1xuICAgICAgdmFyIF9zZWNvbmRhcnkgPSBbXTtcbiAgICAgIGlmICh0aGlzLiRiYWNrZ3JvdW5kLnF1ZXJ5U2VsZWN0b3IoJy5iYWNrZ3JvdW5kX19iZycpKSBfbWFpbi5wdXNoKHRoaXMuJGJhY2tncm91bmQucXVlcnlTZWxlY3RvcignLmJhY2tncm91bmRfX2JnJykuc3R5bGUuYmFja2dyb3VuZEltYWdlLnN1YnN0cmluZyg1LCB0aGlzLiRiYWNrZ3JvdW5kLnF1ZXJ5U2VsZWN0b3IoJy5iYWNrZ3JvdW5kX19iZycpLnN0eWxlLmJhY2tncm91bmRJbWFnZS5sZW5ndGggLSAyKSk7XG4gICAgICBpZiAodGhpcy4kZmVhdHVyZWQucXVlcnlTZWxlY3RvcignLmJhY2tncm91bmRfX2JnJykpIF9tYWluLnB1c2godGhpcy4kZmVhdHVyZWQucXVlcnlTZWxlY3RvcignLmJhY2tncm91bmRfX2JnJykuc3R5bGUuYmFja2dyb3VuZEltYWdlLnN1YnN0cmluZyg1LCB0aGlzLiRmZWF0dXJlZC5xdWVyeVNlbGVjdG9yKCcuYmFja2dyb3VuZF9fYmcnKS5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UubGVuZ3RoIC0gMikpO1xuICAgICAgdGhpcy5wcmVsb2FkSXRlbXMgPSB7XG4gICAgICAgIG1haW46IF9tYWluLFxuICAgICAgICBzZWNvbmRhcnk6IF9zZWNvbmRhcnlcbiAgICAgIH07XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImJlZm9yZUVudGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGJlZm9yZUVudGVyKCkge1xuICAgICAgLy8gSGlkZSBkcmFnIGFmdGVyIGNsaWNrXG4gICAgICB0aGlzLmFwcFVpLmxlYXZlRHJhZ0N1cnNvcigpO1xuXG4gICAgICBpZiAodGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHtcbiAgICAgICAgZ3NhcC5zZXQodGhpcy4kaGVyby5xdWVyeVNlbGVjdG9yKCcuaW1hZ2UnKSwge1xuICAgICAgICAgIHk6ICctMTAwJSdcbiAgICAgICAgfSk7XG4gICAgICAgIGdzYXAuc2V0KHRoaXMuJGhlcm8ucXVlcnlTZWxlY3RvcignLmltYWdlIGltZycpLCB7XG4gICAgICAgICAgeTogJzEwMCUnXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBnc2FwLnNldCh0aGlzLiRoZXJvLnF1ZXJ5U2VsZWN0b3IoJy5tYXNrIC5iZycpLCB7XG4gICAgICAgIHNjYWxlWTogdGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3AgPyAwIDogMVxuICAgICAgfSk7XG4gICAgICBnc2FwLnNldCh0aGlzLiRoZXJvLnF1ZXJ5U2VsZWN0b3IoJy5tYXNrIC5jZW50ZXInKSwge1xuICAgICAgICBvcGFjaXR5OiAwLjAwMDFcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJwcmVlbnRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBwcmVlbnRlcigpIHtcbiAgICAgIGlmICh0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCkge1xuICAgICAgICBnc2FwLnRvKHRoaXMuJGhlcm8ucXVlcnlTZWxlY3RvcignLmltYWdlJyksIHtcbiAgICAgICAgICB5OiAnMCUnLFxuICAgICAgICAgIGR1cmF0aW9uOiB0aGlzLmFwcFN0b3JlLmZpcnN0TmF2aWdhdGlvbiA/IDEuOCA6IDEuOCxcbiAgICAgICAgICBlYXNlOiB0aGlzLmFwcFN0b3JlLmZpcnN0TmF2aWdhdGlvbiA/ICdleHBvLmluT3V0JyA6ICdleHBvLm91dCcsXG4gICAgICAgICAgZGVsYXk6IDBcbiAgICAgICAgfSk7XG4gICAgICAgIGdzYXAudG8odGhpcy4kaGVyby5xdWVyeVNlbGVjdG9yKCcuaW1hZ2UgaW1nJyksIHtcbiAgICAgICAgICB5OiAnMCUnLFxuICAgICAgICAgIGR1cmF0aW9uOiB0aGlzLmFwcFN0b3JlLmZpcnN0TmF2aWdhdGlvbiA/IDEuOCA6IDEuOCxcbiAgICAgICAgICBlYXNlOiB0aGlzLmFwcFN0b3JlLmZpcnN0TmF2aWdhdGlvbiA/ICdleHBvLmluT3V0JyA6ICdleHBvLm91dCcsXG4gICAgICAgICAgZGVsYXk6IDBcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGdzYXAudG8odGhpcy4kaGVyby5xdWVyeVNlbGVjdG9yKCcubWFzayAuYmcnKSwge1xuICAgICAgICBzY2FsZVk6IDEsXG4gICAgICAgIGR1cmF0aW9uOiB0aGlzLmFwcFN0b3JlLmZpcnN0TmF2aWdhdGlvbiA/IDEuNiA6IDEuNixcbiAgICAgICAgZWFzZTogdGhpcy5hcHBTdG9yZS5maXJzdE5hdmlnYXRpb24gPyAnZXhwby5pbk91dCcgOiAnZXhwby5vdXQnLFxuICAgICAgICBkZWxheTogdGhpcy5hcHBTdG9yZS5maXJzdE5hdmlnYXRpb24gPyAwLjIgOiAwLjJcbiAgICAgIH0pO1xuICAgICAgZ3NhcC50byh0aGlzLiRoZXJvLnF1ZXJ5U2VsZWN0b3IoJy5tYXNrIC5jZW50ZXInKSwge1xuICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICBlYXNlOiAncG93ZXIyLm91dCcsXG4gICAgICAgIGR1cmF0aW9uOiAwLjgsXG4gICAgICAgIGRlbGF5OiAxXG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiZW50ZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZW50ZXIoKSB7XG4gICAgICB0aGlzLmFwcFVpLiRpbmZvQ29udGVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwiaW5mby1zdWJqZWN0XCJdJykudmFsdWUgPSAnSW5mb3JtYWNpw7NuIHNvYnJlICcgKyB0aGlzLiRoZXJvLnF1ZXJ5U2VsZWN0b3IoJy5tYXNrIC5jZW50ZXIgLnRpdGxlJykuZ2V0QXR0cmlidXRlKCdkYXRhLXRpdGxlJyk7XG4gICAgICBpZiAodGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHRoaXMuaW5pdFNjcm9sbHRpdGxlKCk7ZWxzZSB0aGlzLmluaXRTY3JvbGx0aXRsZU1vYmlsZSgpO1xuICAgICAgdGhpcy5pbml0QmFja2dyb3VuZCgpO1xuICAgICAgdGhpcy5pbml0UGFyYWxsYXgoKTtcbiAgICAgIHRoaXMuaW5pdExpZ2h0Ym94KCk7XG4gICAgICB0aGlzLmluaXRHYWxsZXJ5KCk7XG4gICAgICB0aGlzLmluaXRSZWxhdGVkKCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImluaXRTY3JvbGx0aXRsZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0U2Nyb2xsdGl0bGUoKSB7XG4gICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICB0aGlzLiRzY3JvbGx0aXRsZSA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3IoJy5zY3JvbGx0aXRsZScpO1xuXG4gICAgICBpZiAodGhpcy4kc2Nyb2xsdGl0bGUpIHtcbiAgICAgICAgdGhpcy4kc2Nyb2xsdGl0bGVJdGVtcyA9IHRoaXMuJHNjcm9sbHRpdGxlLmNoaWxkcmVuO1xuICAgICAgICB0aGlzLiRzY3JvbGx0aXRsZS5zdHlsZS53aWR0aCA9IHRoaXMuJHNjcm9sbHRpdGxlSXRlbXNbMF0ub2Zmc2V0V2lkdGggKyAncHgnO1xuICAgICAgICB0aGlzLnNjcm9sbFRpdGxlSW5uZXJMZWZ0ID0gZ3NhcC50aW1lbGluZSh7XG4gICAgICAgICAgcGF1c2VkOiBmYWxzZSxcbiAgICAgICAgICBkZWZhdWx0czoge1xuICAgICAgICAgICAgZWFzZTogJ25vbmUnLFxuICAgICAgICAgICAgZHVyYXRpb246IHRoaXMuJHNjcm9sbHRpdGxlSXRlbXNbMF0ub2Zmc2V0V2lkdGggLyAzMDAsXG4gICAgICAgICAgICByZXBlYXQ6ICctMScsXG4gICAgICAgICAgICBvblJldmVyc2VDb21wbGV0ZTogZnVuY3Rpb24gb25SZXZlcnNlQ29tcGxldGUoKSB7XG4gICAgICAgICAgICAgIF90aGlzLnNjcm9sbFRpdGxlSW5uZXJMZWZ0LnBhdXNlKCk7XG5cbiAgICAgICAgICAgICAgX3RoaXMuc2Nyb2xsVGl0bGVJbm5lclJpZ2h0LnBsYXkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy4kc2Nyb2xsdGl0bGVJdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHRoaXMuc2Nyb2xsVGl0bGVJbm5lckxlZnQudG8odGhpcy4kc2Nyb2xsdGl0bGVJdGVtc1tpXSwge1xuICAgICAgICAgICAgeDogJy0xMDAlJ1xuICAgICAgICAgIH0sIDApO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zY3JvbGxUaXRsZUlubmVyUmlnaHQgPSBnc2FwLnRpbWVsaW5lKHtcbiAgICAgICAgICBwYXVzZWQ6IHRydWUsXG4gICAgICAgICAgZGVmYXVsdHM6IHtcbiAgICAgICAgICAgIGVhc2U6ICdub25lJyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiB0aGlzLiRzY3JvbGx0aXRsZUl0ZW1zWzBdLm9mZnNldFdpZHRoIC8gMzAwLFxuICAgICAgICAgICAgcmVwZWF0OiAnLTEnLFxuICAgICAgICAgICAgb25SZXZlcnNlQ29tcGxldGU6IGZ1bmN0aW9uIG9uUmV2ZXJzZUNvbXBsZXRlKCkge1xuICAgICAgICAgICAgICBfdGhpcy5zY3JvbGxUaXRsZUlubmVyUmlnaHQucGF1c2UoKTtcblxuICAgICAgICAgICAgICBfdGhpcy5zY3JvbGxUaXRsZUlubmVyTGVmdC5wbGF5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgdGhpcy4kc2Nyb2xsdGl0bGVJdGVtcy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICB0aGlzLnNjcm9sbFRpdGxlSW5uZXJSaWdodC50byh0aGlzLiRzY3JvbGx0aXRsZUl0ZW1zW19pXSwge1xuICAgICAgICAgICAgeDogJzEwMCUnXG4gICAgICAgICAgfSwgMCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNjcm9sbFRpdGxlT3V0ZXIgPSBnc2FwLnRpbWVsaW5lKHtcbiAgICAgICAgICBkZWZhdWx0czoge1xuICAgICAgICAgICAgZWFzZTogJ25vbmUnXG4gICAgICAgICAgfSxcbiAgICAgICAgICBzY3JvbGxUcmlnZ2VyOiB7XG4gICAgICAgICAgICB0cmlnZ2VyOiB0aGlzLiRzY3JvbGx0aXRsZSxcbiAgICAgICAgICAgIHNjcnViOiB0cnVlLFxuICAgICAgICAgICAgc3RhcnQ6ICd0b3AgYm90dG9tJyxcbiAgICAgICAgICAgIGVuZDogJ2JvdHRvbSB0b3AnLFxuICAgICAgICAgICAgb25VcGRhdGU6IGZ1bmN0aW9uIG9uVXBkYXRlKHNlbGYpIHtcbiAgICAgICAgICAgICAgLy8gdGhpcy5zY3JvbGxUaXRsZUlubmVyLnRpbWVTY2FsZShzZWxmLmRpcmVjdGlvbik7XG4gICAgICAgICAgICAgIGlmICghX3RoaXMuc2Nyb2xsVGl0bGVJbm5lckxlZnQucGF1c2VkKCkpIF90aGlzLnNjcm9sbFRpdGxlSW5uZXJMZWZ0LnJldmVyc2VkKHNlbGYuZGlyZWN0aW9uICE9PSAxKTtcbiAgICAgICAgICAgICAgaWYgKCFfdGhpcy5zY3JvbGxUaXRsZUlubmVyUmlnaHQucGF1c2VkKCkpIF90aGlzLnNjcm9sbFRpdGxlSW5uZXJSaWdodC5yZXZlcnNlZChzZWxmLmRpcmVjdGlvbiA9PT0gMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zY3JvbGxUaXRsZU91dGVyLmZyb21Ubyh0aGlzLiRzY3JvbGx0aXRsZSwge1xuICAgICAgICAgIHg6IHdpbmRvdy5pbm5lcldpZHRoICogMC4yXG4gICAgICAgIH0sIHtcbiAgICAgICAgICB4OiAtd2luZG93LmlubmVyV2lkdGggKiAwLjJcbiAgICAgICAgfSwgMCk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImluaXRTY3JvbGx0aXRsZU1vYmlsZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0U2Nyb2xsdGl0bGVNb2JpbGUoKSB7XG4gICAgICB0aGlzLiRzY3JvbGx0aXRsZXMgPSB0aGlzLiRlbC5xdWVyeVNlbGVjdG9yQWxsKCcuc2Nyb2xsdGl0bGUnKTtcblxuICAgICAgaWYgKHRoaXMuJHNjcm9sbHRpdGxlcykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuJHNjcm9sbHRpdGxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHRoaXMuJHNjcm9sbHRpdGxlc0l0ZW1zID0gdGhpcy4kc2Nyb2xsdGl0bGVzW2ldLmNoaWxkcmVuWzBdLmNoaWxkcmVuO1xuICAgICAgICAgIHRoaXMuc2Nyb2xsVGl0bGVUaW1lbGluZSA9IGdzYXAudGltZWxpbmUoe1xuICAgICAgICAgICAgcGF1c2VkOiBmYWxzZSxcbiAgICAgICAgICAgIGRlZmF1bHRzOiB7XG4gICAgICAgICAgICAgIGVhc2U6ICdub25lJyxcbiAgICAgICAgICAgICAgZHVyYXRpb246IHRoaXMuJHNjcm9sbHRpdGxlc0l0ZW1zLmxlbmd0aCAqIDggKyBpICogMTAsXG4gICAgICAgICAgICAgIHJlcGVhdDogJy0xJ1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHRoaXMuc2Nyb2xsVGl0bGVUaW1lbGluZS50byh0aGlzLiRzY3JvbGx0aXRsZXNbaV0uY2hpbGRyZW4sIHtcbiAgICAgICAgICAgIHg6IC0xMDAgKyAnJSdcbiAgICAgICAgICB9LCAwKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJpbml0QmFja2dyb3VuZFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0QmFja2dyb3VuZCgpIHtcbiAgICAgIGlmICh0aGlzLiRiYWNrZ3JvdW5kKSB7XG4gICAgICAgIGdzYXAuc2V0KHRoaXMuJGJhY2tncm91bmQucXVlcnlTZWxlY3RvcignLmJhY2tncm91bmQgLmJhY2tncm91bmRfX292ZXJsYXknKSwge1xuICAgICAgICAgIG9wYWNpdHk6IDFcbiAgICAgICAgfSk7XG4gICAgICAgIGdzYXAuc2V0KHRoaXMuJGJhY2tncm91bmQucXVlcnlTZWxlY3RvcignLmJhY2tncm91bmQgLmJhY2tncm91bmRfX2JnJyksIHtcbiAgICAgICAgICB5OiAnLTgwJScsXG4gICAgICAgICAgc2NhbGU6IDEuMlxuICAgICAgICB9KTtcbiAgICAgICAgdmFyIGJhY2tncm91bmRUaW1lbGluZSA9IGdzYXAudGltZWxpbmUoe1xuICAgICAgICAgIHNjcm9sbFRyaWdnZXI6IHtcbiAgICAgICAgICAgIHRyaWdnZXI6IHRoaXMuJGJhY2tncm91bmQsXG4gICAgICAgICAgICBzdGFydDogJ3RvcCBib3R0b20nLFxuICAgICAgICAgICAgZW5kOiAnYm90dG9tIHRvcCcsXG4gICAgICAgICAgICBzY3J1YjogdHJ1ZSAvLyBvblRvZ2dsZTogKGlzQWN0aXZlKSA9PlxuICAgICAgICAgICAgLy8ge1xuICAgICAgICAgICAgLy8gICAgIGlzQWN0aXZlID8gdGhpcy4kdmlkZW9Db3Zlci5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX3BsYXllciB2aWRlbycpLnBsYXkoKSA6IHRoaXMuJHZpZGVvQ292ZXIucXVlcnlTZWxlY3RvcignLnZpZGVvX19wbGF5ZXIgdmlkZW8nKS5wYXVzZSgpO1xuICAgICAgICAgICAgLy8gfVxuXG4gICAgICAgICAgfSxcbiAgICAgICAgICBkZWZhdWx0czoge1xuICAgICAgICAgICAgZHVyYXRpb246IDEsXG4gICAgICAgICAgICBlYXNlOiAnbm9uZSdcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBiYWNrZ3JvdW5kVGltZWxpbmUudG8odGhpcy4kYmFja2dyb3VuZC5xdWVyeVNlbGVjdG9yKCcuYmFja2dyb3VuZCAuYmFja2dyb3VuZF9fb3ZlcmxheScpLCB7XG4gICAgICAgICAgb3BhY2l0eTogMC41LFxuICAgICAgICAgIGR1cmF0aW9uOiAwLjVcbiAgICAgICAgfSwgMCk7XG4gICAgICAgIGJhY2tncm91bmRUaW1lbGluZS50byh0aGlzLiRiYWNrZ3JvdW5kLnF1ZXJ5U2VsZWN0b3IoJy5iYWNrZ3JvdW5kIC5iYWNrZ3JvdW5kX19iZycpLCB7XG4gICAgICAgICAgeTogJzgwJScsXG4gICAgICAgICAgc2NhbGU6IDEsXG4gICAgICAgICAgZHVyYXRpb246IDFcbiAgICAgICAgfSwgMCk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImluaXRQYXJhbGxheFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0UGFyYWxsYXgoKSB7XG4gICAgICBpZiAodGhpcy4kY29udGVudCkge1xuICAgICAgICBnc2FwLnNldCh0aGlzLiRjb250ZW50LnF1ZXJ5U2VsZWN0b3IoJy5pbWFnZS0tMicpLCB7XG4gICAgICAgICAgeTogJy01dncnXG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgY29udGVudFRpbWVsaW5lID0gZ3NhcC50aW1lbGluZSh7XG4gICAgICAgICAgc2Nyb2xsVHJpZ2dlcjoge1xuICAgICAgICAgICAgdHJpZ2dlcjogdGhpcy4kY29udGVudCxcbiAgICAgICAgICAgIHN0YXJ0OiAndG9wIGJvdHRvbScsXG4gICAgICAgICAgICBlbmQ6ICdib3R0b20gdG9wJyxcbiAgICAgICAgICAgIHNjcnViOiB0cnVlIC8vIG9uVG9nZ2xlOiAoaXNBY3RpdmUpID0+XG4gICAgICAgICAgICAvLyB7XG4gICAgICAgICAgICAvLyAgICAgaXNBY3RpdmUgPyB0aGlzLiR2aWRlb0NvdmVyLnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fcGxheWVyIHZpZGVvJykucGxheSgpIDogdGhpcy4kdmlkZW9Db3Zlci5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX3BsYXllciB2aWRlbycpLnBhdXNlKCk7XG4gICAgICAgICAgICAvLyB9XG5cbiAgICAgICAgICB9LFxuICAgICAgICAgIGRlZmF1bHRzOiB7XG4gICAgICAgICAgICBkdXJhdGlvbjogMSxcbiAgICAgICAgICAgIGVhc2U6ICdub25lJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnRlbnRUaW1lbGluZS50byh0aGlzLiRjb250ZW50LnF1ZXJ5U2VsZWN0b3IoJy5pbWFnZS0tMicpLCB7XG4gICAgICAgICAgeTogJzV2dycsXG4gICAgICAgICAgZHVyYXRpb246IDFcbiAgICAgICAgfSwgMCk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLiRmZWF0dXJlZCkge1xuICAgICAgICBnc2FwLnNldCh0aGlzLiRmZWF0dXJlZC5xdWVyeVNlbGVjdG9yKCcuaW1hZ2UnKSwge1xuICAgICAgICAgIHk6ICcxMHZ3J1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIGZlYXR1cmVkVGltZWxpbmUgPSBnc2FwLnRpbWVsaW5lKHtcbiAgICAgICAgICBzY3JvbGxUcmlnZ2VyOiB7XG4gICAgICAgICAgICB0cmlnZ2VyOiB0aGlzLiRmZWF0dXJlZCxcbiAgICAgICAgICAgIHN0YXJ0OiAndG9wIGJvdHRvbScsXG4gICAgICAgICAgICBlbmQ6ICdib3R0b20gdG9wJyxcbiAgICAgICAgICAgIHNjcnViOiB0cnVlIC8vIG9uVG9nZ2xlOiAoaXNBY3RpdmUpID0+XG4gICAgICAgICAgICAvLyB7XG4gICAgICAgICAgICAvLyAgICAgaXNBY3RpdmUgPyB0aGlzLiR2aWRlb0NvdmVyLnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fcGxheWVyIHZpZGVvJykucGxheSgpIDogdGhpcy4kdmlkZW9Db3Zlci5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX3BsYXllciB2aWRlbycpLnBhdXNlKCk7XG4gICAgICAgICAgICAvLyB9XG5cbiAgICAgICAgICB9LFxuICAgICAgICAgIGRlZmF1bHRzOiB7XG4gICAgICAgICAgICBkdXJhdGlvbjogMSxcbiAgICAgICAgICAgIGVhc2U6ICdub25lJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGZlYXR1cmVkVGltZWxpbmUudG8odGhpcy4kZmVhdHVyZWQucXVlcnlTZWxlY3RvcignLmltYWdlJyksIHtcbiAgICAgICAgICB5OiAnLTEwdncnLFxuICAgICAgICAgIGR1cmF0aW9uOiAxXG4gICAgICAgIH0sIDApO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJpbml0TGlnaHRib3hcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdExpZ2h0Ym94KCkge1xuICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgIHRoaXMuJGxpZ2h0Ym94ID0gdGhpcy4kZWwucXVlcnlTZWxlY3RvcignLmxpZ2h0Ym94Jyk7XG4gICAgICB0aGlzLmxpZ2h0Ym94ID0gbmV3IFNsaWRlcih7XG4gICAgICAgIHRhcmdldDogdGhpcy4kbGlnaHRib3gsXG4gICAgICAgIG9uVW5zZXQ6IGZ1bmN0aW9uIG9uVW5zZXQoaW5kZXgpIHtcbiAgICAgICAgICBfdGhpczIuY2xvc2VMaWdodGJveChpbmRleCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJpbml0R2FsbGVyeVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0R2FsbGVyeSgpIHtcbiAgICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgICBpZiAodGhpcy4kZ2FsbGVyeSkge1xuICAgICAgICAvLyBTZWxlY3RvcnNcbiAgICAgICAgdGhpcy4kZ2FsbGVyeUdyaWQgPSB0aGlzLiRnYWxsZXJ5LnF1ZXJ5U2VsZWN0b3IoJy5ncmlkJyk7XG4gICAgICAgIHRoaXMuJGdhbGxlcnlHcmlkSW5uZXIgPSB0aGlzLiRnYWxsZXJ5LnF1ZXJ5U2VsZWN0b3IoJy5ncmlkX19pbm5lcicpO1xuICAgICAgICB0aGlzLiRnYWxsZXJ5R3JpZEl0ZW1zID0gdGhpcy4kZ2FsbGVyeS5xdWVyeVNlbGVjdG9yQWxsKCcuZ3JpZF9faXRlbScpO1xuICAgICAgICB0aGlzLiRnYWxsZXJ5QnV0dG9uID0gdGhpcy4kZ2FsbGVyeS5xdWVyeVNlbGVjdG9yKCcuYnV0dG9uJyk7XG4gICAgICAgIGdzYXAuc2V0KHRoaXMuJGdhbGxlcnlHcmlkLCB7XG4gICAgICAgICAgZGlzcGxheTogJ2Jsb2NrJ1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5kb21FdmVudHMuYWRkKHRoaXMuJGdhbGxlcnlHcmlkLCAnbW91c2VlbnRlcicsIGZ1bmN0aW9uIChlLCBhLCBlbCkge1xuICAgICAgICAgIF90aGlzMy5hcHBVaS5lbnRlckRyYWdDdXJzb3IoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZG9tRXZlbnRzLmFkZCh0aGlzLiRnYWxsZXJ5R3JpZCwgJ21vdXNlbGVhdmUnLCBmdW5jdGlvbiAoZSwgYSwgZWwpIHtcbiAgICAgICAgICBfdGhpczMuYXBwVWkubGVhdmVEcmFnQ3Vyc29yKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmdhbGxlcnkgPSB7XG4gICAgICAgICAgaXNab29tZWQ6IGZhbHNlLFxuICAgICAgICAgIGlzRXhwYW5kZWQ6IGZhbHNlLFxuICAgICAgICAgIGlzQW5pbWF0aW5nOiBmYWxzZSxcbiAgICAgICAgICBjb3VudDogMCxcbiAgICAgICAgICBtYXJnaW46IHdpbmRvdy5pbm5lcldpZHRoICogMC4wNSxcbiAgICAgICAgICByZWZlcmVuY2VzOiB7XG4gICAgICAgICAgICAwOiBbMTUsIDE1LCAwLCA1XSxcbiAgICAgICAgICAgIDE6IFsyMCwgMTUsIDAsIDI1XSxcbiAgICAgICAgICAgIDI6IFsyMCwgMTUsIDIwLCA1XSxcbiAgICAgICAgICAgIDM6IFsxNSwgMTAsIDI1LCAyNV0sXG4gICAgICAgICAgICA0OiBbMzAsIDIwLCA0NSwgNV0sXG4gICAgICAgICAgICA1OiBbMTAsIDE1LCA0NSwgMzBdLFxuICAgICAgICAgICAgNjogWzE1LCAxMCwgNjAsIDMwXSxcbiAgICAgICAgICAgIDc6IFsxNSwgMTAsIDgwLCA1XSxcbiAgICAgICAgICAgIDg6IFsyMCwgMTUsIDgwLCAyMF0sXG4gICAgICAgICAgICA5OiBbMjUsIDQwLCAxMDUsIDVdLFxuICAgICAgICAgICAgMTA6IFsxNSwgMTUsIDEzNSwgNV0sXG4gICAgICAgICAgICAxMTogWzIwLCAxNSwgMTM1LCAyNV0sXG4gICAgICAgICAgICAxMjogWzIwLCAxNSwgMTU1LCA1XSxcbiAgICAgICAgICAgIDEzOiBbMTUsIDEwLCAxNjAsIDI1XSxcbiAgICAgICAgICAgIDE0OiBbMzAsIDIwLCAxODAsIDVdLFxuICAgICAgICAgICAgMTU6IFsxMCwgMTUsIDE4MCwgMzBdLFxuICAgICAgICAgICAgMTY6IFsxNSwgMTAsIDE5NSwgMzBdLFxuICAgICAgICAgICAgMTc6IFsxNSwgMTAsIDIxNSwgNV0sXG4gICAgICAgICAgICAxODogWzIwLCAxNSwgMjE1LCAyMF1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlbGF0aXZlV2lkdGg6IDAsXG4gICAgICAgICAgcmVsYXRpdmVQb3NpdGlvbnM6IHt9LFxuICAgICAgICAgIGFic29sdXRlV2lkdGg6IDAsXG4gICAgICAgICAgYWJzb2x1dGVQb3NpdGlvbnM6IHt9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZ2FsbGVyeS5jb3VudCA9IHRoaXMuJGdhbGxlcnlHcmlkSXRlbXMubGVuZ3RoOyAvLyBHZXQgYWJzb2x1dGUgcG9zaXRpb25zXG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLiRnYWxsZXJ5R3JpZEl0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgdmFyIF93aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoICogdGhpcy5nYWxsZXJ5LnJlZmVyZW5jZXNbaV1bMF0gLyAodGhpcy5hcHBTdG9yZS5pc0Rlc2tvcCB8fCB0aGlzLmFwcFN0b3JlLmNsaWVudC5vcmllbnRhdGlvbiA9PT0gJ2hvcml6b250YWwnID8gMTAwIDogNTApO1xuXG4gICAgICAgICAgdmFyIF9oZWlnaHQgPSB3aW5kb3cuaW5uZXJXaWR0aCAqIHRoaXMuZ2FsbGVyeS5yZWZlcmVuY2VzW2ldWzFdIC8gKHRoaXMuYXBwU3RvcmUuaXNEZXNrb3AgfHwgdGhpcy5hcHBTdG9yZS5jbGllbnQub3JpZW50YXRpb24gPT09ICdob3Jpem9udGFsJyA/IDEwMCA6IDUwKTtcblxuICAgICAgICAgIHZhciBfbGVmdCA9IHdpbmRvdy5pbm5lcldpZHRoICogdGhpcy5nYWxsZXJ5LnJlZmVyZW5jZXNbaV1bMl0gLyAodGhpcy5hcHBTdG9yZS5pc0Rlc2tvcCB8fCB0aGlzLmFwcFN0b3JlLmNsaWVudC5vcmllbnRhdGlvbiA9PT0gJ2hvcml6b250YWwnID8gMTAwIDogNTApO1xuXG4gICAgICAgICAgdmFyIF90b3AgPSB3aW5kb3cuaW5uZXJXaWR0aCAqIHRoaXMuZ2FsbGVyeS5yZWZlcmVuY2VzW2ldWzNdIC8gKHRoaXMuYXBwU3RvcmUuaXNEZXNrb3AgfHwgdGhpcy5hcHBTdG9yZS5jbGllbnQub3JpZW50YXRpb24gPT09ICdob3Jpem9udGFsJyA/IDEwMCA6IDUwKTtcblxuICAgICAgICAgIHZhciBfcmF0aW8gPSAxIC8gKCh3aW5kb3cuaW5uZXJIZWlnaHQgLSB3aW5kb3cuaW5uZXJXaWR0aCAqIDAuMSkgLyBfaGVpZ2h0KTtcblxuICAgICAgICAgIHZhciBfbXVsdGlwbGllciA9ICh3aW5kb3cuaW5uZXJIZWlnaHQgLSB3aW5kb3cuaW5uZXJXaWR0aCAqIDAuMSkgLyBfaGVpZ2h0O1xuXG4gICAgICAgICAgdGhpcy5nYWxsZXJ5LmFic29sdXRlUG9zaXRpb25zW2ldID0gW193aWR0aCwgX2hlaWdodCwgX2xlZnQsIF90b3AsIF9yYXRpbywgX211bHRpcGxpZXJdO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5nYWxsZXJ5LmFic29sdXRlV2lkdGggPSB0aGlzLmdhbGxlcnkuYWJzb2x1dGVQb3NpdGlvbnNbdGhpcy5nYWxsZXJ5LmNvdW50IC0gMV1bMF0gKyB0aGlzLmdhbGxlcnkuYWJzb2x1dGVQb3NpdGlvbnNbdGhpcy5nYWxsZXJ5LmNvdW50IC0gMV1bMl07IC8vIEdldCByZWxhdGl2ZSBwb3NpdGlvbnNcblxuICAgICAgICBmb3IgKHZhciBfaTIgPSAwOyBfaTIgPCB0aGlzLiRnYWxsZXJ5R3JpZEl0ZW1zLmxlbmd0aDsgX2kyKyspIHtcbiAgICAgICAgICB2YXIgX211bHRpcGxpZXIyID0gdGhpcy5nYWxsZXJ5LmFic29sdXRlUG9zaXRpb25zW19pMl1bNV07XG5cbiAgICAgICAgICB2YXIgX3dpZHRoMiA9IF9tdWx0aXBsaWVyMiAqIHRoaXMuZ2FsbGVyeS5hYnNvbHV0ZVBvc2l0aW9uc1tfaTJdWzBdO1xuXG4gICAgICAgICAgdmFyIF9oZWlnaHQyID0gX211bHRpcGxpZXIyICogdGhpcy5nYWxsZXJ5LmFic29sdXRlUG9zaXRpb25zW19pMl1bMV07XG5cbiAgICAgICAgICB2YXIgX2xlZnQyID0gX2kyID09PSAwID8gMCA6IHRoaXMuZ2FsbGVyeS5yZWxhdGl2ZVBvc2l0aW9uc1tfaTIgLSAxXVsyXSArIHRoaXMuZ2FsbGVyeS5yZWxhdGl2ZVBvc2l0aW9uc1tfaTIgLSAxXVswXSArIHRoaXMuZ2FsbGVyeS5tYXJnaW47XG5cbiAgICAgICAgICB2YXIgX3RvcDIgPSB3aW5kb3cuaW5uZXJXaWR0aCAqIDAuMDU7XG5cbiAgICAgICAgICB0aGlzLmdhbGxlcnkucmVsYXRpdmVQb3NpdGlvbnNbX2kyXSA9IFtfd2lkdGgyLCBfaGVpZ2h0MiwgX2xlZnQyLCBfdG9wMl07XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmdhbGxlcnkucmVsYXRpdmVXaWR0aCA9IHRoaXMuZ2FsbGVyeS5yZWxhdGl2ZVBvc2l0aW9uc1t0aGlzLmdhbGxlcnkuY291bnQgLSAxXVswXSArIHRoaXMuZ2FsbGVyeS5yZWxhdGl2ZVBvc2l0aW9uc1t0aGlzLmdhbGxlcnkuY291bnQgLSAxXVsyXTsgLy8gU2V0IGluaXRpYWwgcG9zaXRpb25zXG5cbiAgICAgICAgdmFyIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoX2kzKSB7XG4gICAgICAgICAgaWYgKF90aGlzMy5nYWxsZXJ5LmlzWm9vbWVkKSB7XG4gICAgICAgICAgICBfdGhpczMuJGdhbGxlcnlHcmlkSXRlbXNbX2kzXS5zdHlsZS53aWR0aCA9IF90aGlzMy5nYWxsZXJ5LnJlbGF0aXZlUG9zaXRpb25zW19pM11bMF0gKyAncHgnO1xuICAgICAgICAgICAgX3RoaXMzLiRnYWxsZXJ5R3JpZEl0ZW1zW19pM10uc3R5bGUuaGVpZ2h0ID0gX3RoaXMzLmdhbGxlcnkucmVsYXRpdmVQb3NpdGlvbnNbX2kzXVsxXSArICdweCc7XG4gICAgICAgICAgICBfdGhpczMuJGdhbGxlcnlHcmlkSXRlbXNbX2kzXS5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlWCgnICsgX3RoaXMzLmdhbGxlcnkucmVsYXRpdmVQb3NpdGlvbnNbX2kzXVsyXSArICdweCkgdHJhbnNsYXRlWSgnICsgX3RoaXMzLmdhbGxlcnkucmVsYXRpdmVQb3NpdGlvbnNbX2kzXVszXSArICdweCknO1xuICAgICAgICAgICAgX3RoaXMzLiRnYWxsZXJ5R3JpZEl0ZW1zW19pM10uY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0uc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlKDEpJztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgX3RoaXMzLiRnYWxsZXJ5R3JpZEl0ZW1zW19pM10uc3R5bGUud2lkdGggPSBfdGhpczMuZ2FsbGVyeS5yZWxhdGl2ZVBvc2l0aW9uc1tfaTNdWzBdICsgJ3B4JztcbiAgICAgICAgICAgIF90aGlzMy4kZ2FsbGVyeUdyaWRJdGVtc1tfaTNdLnN0eWxlLmhlaWdodCA9IF90aGlzMy5nYWxsZXJ5LnJlbGF0aXZlUG9zaXRpb25zW19pM11bMV0gKyAncHgnO1xuICAgICAgICAgICAgX3RoaXMzLiRnYWxsZXJ5R3JpZEl0ZW1zW19pM10uc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVgoJyArIF90aGlzMy5nYWxsZXJ5LmFic29sdXRlUG9zaXRpb25zW19pM11bMl0gKyAncHgpIHRyYW5zbGF0ZVkoJyArIF90aGlzMy5nYWxsZXJ5LmFic29sdXRlUG9zaXRpb25zW19pM11bM10gKyAncHgpIHNjYWxlKCcgKyBfdGhpczMuZ2FsbGVyeS5hYnNvbHV0ZVBvc2l0aW9uc1tfaTNdWzRdICsgJyknO1xuICAgICAgICAgICAgX3RoaXMzLiRnYWxsZXJ5R3JpZEl0ZW1zW19pM10uY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0uc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlKDEuMSknO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChfdGhpczMuYXBwU3RvcmUuaXNEZXNrdG9wKSB7XG4gICAgICAgICAgICBfdGhpczMuZG9tRXZlbnRzLmFkZChfdGhpczMuJGdhbGxlcnlHcmlkSXRlbXNbX2kzXSwgJ21vdXNlZW50ZXInLCBmdW5jdGlvbiAoZSwgYSwgZWwpIHtcbiAgICAgICAgICAgICAgX3RoaXMzLmVudGVySW1hZ2UoZWwpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIF90aGlzMy5kb21FdmVudHMuYWRkKF90aGlzMy4kZ2FsbGVyeUdyaWRJdGVtc1tfaTNdLCAnbW91c2VsZWF2ZScsIGZ1bmN0aW9uIChlLCBhLCBlbCkge1xuICAgICAgICAgICAgICBfdGhpczMubGVhdmVJbWFnZShlbCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgX3RoaXMzLmRvbUV2ZW50cy5hZGQoX3RoaXMzLiRnYWxsZXJ5R3JpZEl0ZW1zW19pM10ucXVlcnlTZWxlY3RvcignLmV4cGFuZCcpLCAnbW91c2VlbnRlcicsIGZ1bmN0aW9uIChlLCBhLCBlbCkge1xuICAgICAgICAgICAgICBfdGhpczMuZW50ZXJFeHBhbmQoZWwpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIF90aGlzMy5kb21FdmVudHMuYWRkKF90aGlzMy4kZ2FsbGVyeUdyaWRJdGVtc1tfaTNdLnF1ZXJ5U2VsZWN0b3IoJy5leHBhbmQnKSwgJ21vdXNlbGVhdmUnLCBmdW5jdGlvbiAoZSwgYSwgZWwpIHtcbiAgICAgICAgICAgICAgX3RoaXMzLmxlYXZlRXhwYW5kKGVsKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBfdGhpczMuZG9tRXZlbnRzLmFkZChfdGhpczMuJGdhbGxlcnlHcmlkSXRlbXNbX2kzXS5xdWVyeVNlbGVjdG9yKCcuZXhwYW5kJyksICdjbGljaycsIGZ1bmN0aW9uIChlLCBhLCBlbCkge1xuICAgICAgICAgICAgICBfdGhpczMuY2xpY2tFeHBhbmQoZSwgYSwgZWwsIF9pMyk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgX3RoaXMzLmRvbUV2ZW50cy5hZGQoX3RoaXMzLiRnYWxsZXJ5R3JpZEl0ZW1zW19pM10sICdjbGljaycsIGZ1bmN0aW9uIChlLCBhLCBlbCkge1xuICAgICAgICAgICAgICBpZiAoX3RoaXMzLmdhbGxlcnkuaXNab29tZWQpIF90aGlzMy5jb21wcmVzc0dhbGxlcnkoX2kzKTtlbHNlIF90aGlzMy5leHBhbmRHYWxsZXJ5KF9pMyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgX3RoaXMzLmRvbUV2ZW50cy5hZGQoX3RoaXMzLiRnYWxsZXJ5R3JpZEl0ZW1zW19pM10sICdjbGljaycsIGZ1bmN0aW9uIChlLCBhLCBlbCkge1xuICAgICAgICAgICAgICBfdGhpczMuY2xpY2tFeHBhbmQoZSwgYSwgZWwsIF9pMyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgZm9yICh2YXIgX2kzID0gMDsgX2kzIDwgdGhpcy4kZ2FsbGVyeUdyaWRJdGVtcy5sZW5ndGg7IF9pMysrKSB7XG4gICAgICAgICAgX2xvb3AoX2kzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHRoaXMuZG9tRXZlbnRzLmFkZCh0aGlzLiRnYWxsZXJ5QnV0dG9uLCAnY2xpY2snLCBmdW5jdGlvbiAoZSwgYSwgZWwpIHtcbiAgICAgICAgICBfdGhpczMub3BlbkxpZ2h0Ym94KDApO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHRoaXMuZ2FsbGVyeS5pc1pvb21lZCkgdGhpcy4kZ2FsbGVyeUdyaWRJbm5lci5zdHlsZS5taW5XaWR0aCA9IHRoaXMuZ2FsbGVyeS5yZWxhdGl2ZVdpZHRoICsgJ3B4JztlbHNlIHRoaXMuJGdhbGxlcnlHcmlkSW5uZXIuc3R5bGUubWluV2lkdGggPSB0aGlzLmdhbGxlcnkuYWJzb2x1dGVXaWR0aCArICdweCc7XG5cbiAgICAgICAgaWYgKHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKSB7XG4gICAgICAgICAgdGhpcy5nYWxsZXJ5RHJhZ2dhYmxlID0gbmV3IFN1cGVyRHJhZ2dlcih7XG4gICAgICAgICAgICBlbDogdGhpcy4kZ2FsbGVyeUdyaWQsXG4gICAgICAgICAgICBlbENsaWNrYWJsZXM6IHRoaXMuJGdhbGxlcnlHcmlkSXRlbXMsXG4gICAgICAgICAgICBpbm5lcjogdGhpcy4kZ2FsbGVyeUdyaWRJbm5lcixcbiAgICAgICAgICAgIG9uRHJhZ1N0YXJ0OiBmdW5jdGlvbiBvbkRyYWdTdGFydCgpIHtcbiAgICAgICAgICAgICAgaWYgKCFfdGhpczMuZ2FsbGVyeS5pc1pvb21lZCAmJiBfdGhpczMuYXBwU3RvcmUuaXNEZXNrdG9wKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2k0ID0gMDsgX2k0IDwgX3RoaXMzLiRnYWxsZXJ5R3JpZEl0ZW1zLmxlbmd0aDsgX2k0KyspIHtcbiAgICAgICAgICAgICAgICAgIGdzYXAudG8oX3RoaXMzLiRnYWxsZXJ5R3JpZEl0ZW1zW19pNF0uY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0sIHtcbiAgICAgICAgICAgICAgICAgICAgc2NhbGU6IDEsXG4gICAgICAgICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAxXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoX3RoaXMzLmFwcFN0b3JlLmlzRGVza3RvcCkge1xuICAgICAgICAgICAgICAgIGdzYXAudG8oX3RoaXMzLmFwcFVpLiRjdXJzb3JEb3QsIHtcbiAgICAgICAgICAgICAgICAgIHNjYWxlOiAwLjYsXG4gICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMC4zLFxuICAgICAgICAgICAgICAgICAgZWFzZTogJ2V4cG8ub3V0J1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGdzYXAudG8oX3RoaXMzLmFwcFVpLiRjdXJzb3JEcmFnLCB7XG4gICAgICAgICAgICAgICAgICBzY2FsZTogMC42LFxuICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDAuMyxcbiAgICAgICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBnc2FwLnRvKF90aGlzMy5hcHBVaS4kY3Vyc29yRHJhZy5jaGlsZHJlblswXSwge1xuICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDAuMyxcbiAgICAgICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIF90aGlzMy5nYWxsZXJ5LmRyYWdnaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvbkRyYWdFbmQ6IGZ1bmN0aW9uIG9uRHJhZ0VuZCgpIHtcbiAgICAgICAgICAgICAgaWYgKCFfdGhpczMuZ2FsbGVyeS5pc1pvb21lZCAmJiBfdGhpczMuYXBwU3RvcmUuaXNEZXNrdG9wKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2k1ID0gMDsgX2k1IDwgX3RoaXMzLiRnYWxsZXJ5R3JpZEl0ZW1zLmxlbmd0aDsgX2k1KyspIHtcbiAgICAgICAgICAgICAgICAgIGdzYXAudG8oX3RoaXMzLiRnYWxsZXJ5R3JpZEl0ZW1zW19pNV0uY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0sIHtcbiAgICAgICAgICAgICAgICAgICAgc2NhbGU6IDEuMSxcbiAgICAgICAgICAgICAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDFcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChfdGhpczMuYXBwU3RvcmUuaXNEZXNrdG9wKSB7XG4gICAgICAgICAgICAgICAgZ3NhcC50byhfdGhpczMuYXBwVWkuJGN1cnNvckRvdCwge1xuICAgICAgICAgICAgICAgICAgc2NhbGU6IDEsXG4gICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMC4zLFxuICAgICAgICAgICAgICAgICAgZWFzZTogJ2V4cG8ub3V0J1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGdzYXAudG8oX3RoaXMzLmFwcFVpLiRjdXJzb3JEcmFnLCB7XG4gICAgICAgICAgICAgICAgICBzY2FsZTogMSxcbiAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAwLjMsXG4gICAgICAgICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZ3NhcC50byhfdGhpczMuYXBwVWkuJGN1cnNvckRyYWcuY2hpbGRyZW5bMF0sIHtcbiAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMC4zLFxuICAgICAgICAgICAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgICAgICAgICAgIGRlbGF5OiAwLjFcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIF90aGlzMy5nYWxsZXJ5LmRyYWdnaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5nYWxsZXJ5RHJhZ2dhYmxlID0gbmV3IERyYWdnYWJsZSh7XG4gICAgICAgICAgICB0YXJnZXQ6IHRoaXMuJGdhbGxlcnlHcmlkLFxuICAgICAgICAgICAgdGFyZ2V0SW5uZXI6IHRoaXMuJGdhbGxlcnlHcmlkSW5uZXIsXG4gICAgICAgICAgICBvblByZXNzOiBmdW5jdGlvbiBvblByZXNzKCkge1xuICAgICAgICAgICAgICBpZiAoX3RoaXMzLmFwcFN0b3JlLmlzRGVza3RvcCkge1xuICAgICAgICAgICAgICAgIGdzYXAudG8oX3RoaXMzLmFwcFVpLiRjdXJzb3JEb3QsIHtcbiAgICAgICAgICAgICAgICAgIHNjYWxlOiAwLjYsXG4gICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMC4zLFxuICAgICAgICAgICAgICAgICAgZWFzZTogJ2V4cG8ub3V0J1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGdzYXAudG8oX3RoaXMzLmFwcFVpLiRjdXJzb3JEcmFnLCB7XG4gICAgICAgICAgICAgICAgICBzY2FsZTogMC42LFxuICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDAuMyxcbiAgICAgICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBnc2FwLnRvKF90aGlzMy5hcHBVaS4kY3Vyc29yRHJhZy5jaGlsZHJlblswXSwge1xuICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDAuMyxcbiAgICAgICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIF90aGlzMy5nYWxsZXJ5LmRyYWdnaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvblJlbGVhc2U6IGZ1bmN0aW9uIG9uUmVsZWFzZSgpIHtcbiAgICAgICAgICAgICAgaWYgKF90aGlzMy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHtcbiAgICAgICAgICAgICAgICBnc2FwLnRvKF90aGlzMy5hcHBVaS4kY3Vyc29yRG90LCB7XG4gICAgICAgICAgICAgICAgICBzY2FsZTogMSxcbiAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAwLjMsXG4gICAgICAgICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZ3NhcC50byhfdGhpczMuYXBwVWkuJGN1cnNvckRyYWcsIHtcbiAgICAgICAgICAgICAgICAgIHNjYWxlOiAxLFxuICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDAuMyxcbiAgICAgICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBnc2FwLnRvKF90aGlzMy5hcHBVaS4kY3Vyc29yRHJhZy5jaGlsZHJlblswXSwge1xuICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAwLjMsXG4gICAgICAgICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICAgICAgICAgICAgZGVsYXk6IDAuMVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgX3RoaXMzLmdhbGxlcnkuZHJhZ2dpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvbkRyYWdTdGFydDogZnVuY3Rpb24gb25EcmFnU3RhcnQoZHJhZykge1xuICAgICAgICAgICAgICBpZiAoIV90aGlzMy5nYWxsZXJ5LmlzWm9vbWVkICYmIF90aGlzMy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaTYgPSAwOyBfaTYgPCBfdGhpczMuJGdhbGxlcnlHcmlkSXRlbXMubGVuZ3RoOyBfaTYrKykge1xuICAgICAgICAgICAgICAgICAgZ3NhcC50byhfdGhpczMuJGdhbGxlcnlHcmlkSXRlbXNbX2k2XS5jaGlsZHJlblswXS5jaGlsZHJlblswXSwge1xuICAgICAgICAgICAgICAgICAgICBzY2FsZTogMSxcbiAgICAgICAgICAgICAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDFcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9uRHJhZ0VuZDogZnVuY3Rpb24gb25EcmFnRW5kKCkge1xuICAgICAgICAgICAgICBpZiAoIV90aGlzMy5nYWxsZXJ5LmlzWm9vbWVkICYmIF90aGlzMy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaTcgPSAwOyBfaTcgPCBfdGhpczMuJGdhbGxlcnlHcmlkSXRlbXMubGVuZ3RoOyBfaTcrKykge1xuICAgICAgICAgICAgICAgICAgZ3NhcC50byhfdGhpczMuJGdhbGxlcnlHcmlkSXRlbXNbX2k3XS5jaGlsZHJlblswXS5jaGlsZHJlblswXSwge1xuICAgICAgICAgICAgICAgICAgICBzY2FsZTogMS4xLFxuICAgICAgICAgICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMVxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmdhbGxlcnlUaW1lbGluZSA9IGdzYXAudGltZWxpbmUoe1xuICAgICAgICAgIGRlZmF1bHRzOiB7XG4gICAgICAgICAgICBlYXNlOiAnbm9uZSdcbiAgICAgICAgICB9LFxuICAgICAgICAgIHNjcm9sbFRyaWdnZXI6IHtcbiAgICAgICAgICAgIHRyaWdnZXI6IHRoaXMuJGdhbGxlcnksXG4gICAgICAgICAgICBzY3J1YjogdHJ1ZSxcbiAgICAgICAgICAgIHN0YXJ0OiAndG9wIGJvdHRvbScsXG4gICAgICAgICAgICBlbmQ6ICdib3R0b20gdG9wJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZ2FsbGVyeVRpbWVsaW5lLmZyb21Ubyh0aGlzLiRnYWxsZXJ5R3JpZCwge1xuICAgICAgICAgIHg6IHdpbmRvdy5pbm5lcldpZHRoICogMC4xXG4gICAgICAgIH0sIHtcbiAgICAgICAgICB4OiAtd2luZG93LmlubmVyV2lkdGggKiAwLjFcbiAgICAgICAgfSwgMCk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImNvbXByZXNzR2FsbGVyeVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wcmVzc0dhbGxlcnkoaW5kZXgpIHtcbiAgICAgIHZhciBfdGhpczQgPSB0aGlzO1xuXG4gICAgICBpZiAodGhpcy5nYWxsZXJ5LmlzRXhwYW5kZWQpIHJldHVybjtcbiAgICAgIGdzYXAudG8odGhpcy5hcHBVaS4kY3Vyc29yUGx1cywge1xuICAgICAgICBzY2FsZTogMC43LFxuICAgICAgICByb3RhdGlvbjogJzBkZWcnLFxuICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICBkdXJhdGlvbjogMC4zLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICB9KTtcbiAgICAgIGdzYXAudG8odGhpcy5hcHBVaS4kY3Vyc29yTWludXMsIHtcbiAgICAgICAgc2NhbGU6IDAuNyxcbiAgICAgICAgcm90YXRpb246ICcwZGVnJyxcbiAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICBkdXJhdGlvbjogMC4zLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICB9KTtcblxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLiRnYWxsZXJ5R3JpZEl0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGdzYXAua2lsbFR3ZWVuc09mKHRoaXMuJGdhbGxlcnlHcmlkSXRlbXNbaV0sIHRoaXMuJGdhbGxlcnlHcmlkSXRlbXNbaV0ucXVlcnlTZWxlY3RvcignLmJhY2tncm91bmQgLmV4cGFuZCcpKTtcbiAgICAgICAgdmFyIHBvc2l0aW9ucyA9IHRoaXMuZ2FsbGVyeS5hYnNvbHV0ZVBvc2l0aW9uc1tpXTtcbiAgICAgICAgdmFyIHJlbGF0aXZlUG9zaXRpb25zID0gdGhpcy5nYWxsZXJ5LnJlbGF0aXZlUG9zaXRpb25zW2ldO1xuICAgICAgICBnc2FwLnRvKHRoaXMuJGdhbGxlcnlHcmlkSXRlbXNbaV0sIHtcbiAgICAgICAgICB4OiBwb3NpdGlvbnNbMl0sXG4gICAgICAgICAgeTogcG9zaXRpb25zWzNdLFxuICAgICAgICAgIHNjYWxlOiBwb3NpdGlvbnNbNF0sXG4gICAgICAgICAgZHVyYXRpb246IDEuNCxcbiAgICAgICAgICBlYXNlOiAnZXhwby5pbk91dCdcbiAgICAgICAgfSk7XG4gICAgICAgIGdzYXAudG8odGhpcy4kZ2FsbGVyeUdyaWRJdGVtc1tpXS5jaGlsZHJlblswXS5jaGlsZHJlblswXSwge1xuICAgICAgICAgIHNjYWxlOiAxLjEsXG4gICAgICAgICAgZHVyYXRpb246IDEuNCxcbiAgICAgICAgICBlYXNlOiAnZXhwby5pbk91dCdcbiAgICAgICAgfSk7XG4gICAgICAgIGdzYXAudG8odGhpcy4kZ2FsbGVyeUdyaWRJdGVtc1tpXS5xdWVyeVNlbGVjdG9yKCcuYmFja2dyb3VuZCAuZXhwYW5kJyksIHtcbiAgICAgICAgICBvcGFjaXR5OiAwLjAwMDEsXG4gICAgICAgICAgZHVyYXRpb246IDAuMixcbiAgICAgICAgICBlYXNlOiAncG93ZXIyLm91dCdcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuJGdhbGxlcnlHcmlkSW5uZXIuc3R5bGUubWluV2lkdGggPSB0aGlzLmdhbGxlcnkuYWJzb2x1dGVXaWR0aCArICdweCc7XG4gICAgICB2YXIgJGVsID0gdGhpcy5nYWxsZXJ5LmFic29sdXRlUG9zaXRpb25zW2luZGV4XTtcbiAgICAgIHZhciBjZW50ZXIgPSAkZWxbMl0gLSB3aW5kb3cuaW5uZXJXaWR0aCAvIDIgKyAkZWxbMF0gLyAyO1xuICAgICAgdmFyIF9tYXhYID0gMDtcblxuICAgICAgdmFyIF9taW5YID0gLSh0aGlzLmdhbGxlcnkuYWJzb2x1dGVXaWR0aCAtIHdpbmRvdy5pbm5lcldpZHRoKTtcblxuICAgICAgdmFyIF9jZW50ZXIgPSBNYXRoLm1pbihfbWF4WCwgTWF0aC5tYXgoX21pblgsIC1jZW50ZXIpKTtcblxuICAgICAgaWYgKHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKSBnc2FwLnRvKFt0aGlzLmdhbGxlcnlEcmFnZ2FibGUuX2RyYWcubGl2ZVBvc2l0aW9uLCB0aGlzLmdhbGxlcnlEcmFnZ2FibGUuX2RyYWcucG9zaXRpb24sIHRoaXMuZ2FsbGVyeURyYWdnYWJsZS5fZHJhZy5sYXN0UG9zaXRpb25dLCB7XG4gICAgICAgIHg6IF9jZW50ZXIsXG4gICAgICAgIGR1cmF0aW9uOiAxLjQsXG4gICAgICAgIGVhc2U6ICdleHBvLmluT3V0J1xuICAgICAgfSk7XG4gICAgICBnc2FwLnRvKHRoaXMuJGdhbGxlcnlHcmlkSW5uZXIsIHtcbiAgICAgICAgeDogX2NlbnRlcixcbiAgICAgICAgZHVyYXRpb246IDEuNCxcbiAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnLFxuICAgICAgICBvbkNvbXBsZXRlOiBmdW5jdGlvbiBvbkNvbXBsZXRlKCkge1xuICAgICAgICAgIGlmIChfdGhpczQuYXBwU3RvcmUuaXNEZXNrdG9wKSBfdGhpczQuZ2FsbGVyeURyYWdnYWJsZS5yZXNpemUoKTtlbHNlIF90aGlzNC5nYWxsZXJ5RHJhZ2dhYmxlLmRyYWdnYWJsZVswXS5hcHBseUJvdW5kcygpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHRoaXMuZ2FsbGVyeS5pc1pvb21lZCA9IGZhbHNlO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJleHBhbmRHYWxsZXJ5XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGV4cGFuZEdhbGxlcnkoaW5kZXgpIHtcbiAgICAgIHZhciBfdGhpczUgPSB0aGlzO1xuXG4gICAgICBnc2FwLnRvKHRoaXMuYXBwVWkuJGN1cnNvck1pbnVzLCB7XG4gICAgICAgIHNjYWxlOiAwLjcsXG4gICAgICAgIHJvdGF0aW9uOiAnOTBkZWcnLFxuICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICBkdXJhdGlvbjogMC4zLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICB9KTtcbiAgICAgIGdzYXAudG8odGhpcy5hcHBVaS4kY3Vyc29yUGx1cywge1xuICAgICAgICBzY2FsZTogMC43LFxuICAgICAgICByb3RhdGlvbjogJzkwZGVnJyxcbiAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICBkdXJhdGlvbjogMC4zLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICB9KTtcblxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLiRnYWxsZXJ5R3JpZEl0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGdzYXAua2lsbFR3ZWVuc09mKHRoaXMuJGdhbGxlcnlHcmlkSXRlbXNbaV0pO1xuICAgICAgICB2YXIgcG9zaXRpb25zID0gdGhpcy5nYWxsZXJ5LnJlbGF0aXZlUG9zaXRpb25zW2ldO1xuICAgICAgICBnc2FwLnRvKHRoaXMuJGdhbGxlcnlHcmlkSXRlbXNbaV0sIHtcbiAgICAgICAgICB4OiBwb3NpdGlvbnNbMl0sXG4gICAgICAgICAgeTogcG9zaXRpb25zWzNdLFxuICAgICAgICAgIHNjYWxlOiAxLFxuICAgICAgICAgIGR1cmF0aW9uOiAxLjQsXG4gICAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnXG4gICAgICAgIH0pO1xuICAgICAgICBnc2FwLnRvKHRoaXMuJGdhbGxlcnlHcmlkSXRlbXNbaV0uY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0sIHtcbiAgICAgICAgICBzY2FsZTogMSxcbiAgICAgICAgICBkdXJhdGlvbjogMS40LFxuICAgICAgICAgIGVhc2U6ICdleHBvLmluT3V0J1xuICAgICAgICB9KTtcbiAgICAgICAgZ3NhcC50byh0aGlzLiRnYWxsZXJ5R3JpZEl0ZW1zW2ldLnF1ZXJ5U2VsZWN0b3IoJy5iYWNrZ3JvdW5kIC5iYWNrZ3JvdW5kX19vdmVybGF5MicpLCB7XG4gICAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICAgIGR1cmF0aW9uOiAwLjIsXG4gICAgICAgICAgZWFzZTogJ3Bvd2VyMi5vdXQnXG4gICAgICAgIH0pO1xuICAgICAgICBnc2FwLnRvKHRoaXMuJGdhbGxlcnlHcmlkSXRlbXNbaV0ucXVlcnlTZWxlY3RvcignLmJhY2tncm91bmQgLmV4cGFuZCcpLCB7XG4gICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICBkdXJhdGlvbjogMC4yLFxuICAgICAgICAgIGVhc2U6ICdwb3dlcjIub3V0JyxcbiAgICAgICAgICBkZWxheTogMS40XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICB0aGlzLiRnYWxsZXJ5R3JpZElubmVyLnN0eWxlLm1pbldpZHRoID0gdGhpcy5nYWxsZXJ5LnJlbGF0aXZlV2lkdGggKyAncHgnO1xuICAgICAgdmFyICRlbCA9IHRoaXMuZ2FsbGVyeS5yZWxhdGl2ZVBvc2l0aW9uc1tpbmRleF07XG4gICAgICB2YXIgY2VudGVyID0gJGVsWzJdIC0gd2luZG93LmlubmVyV2lkdGggLyAyICsgJGVsWzBdIC8gMjsgLy8gQ2VudGVyIGdhbGxlcnlcblxuICAgICAgdmFyIG9mZnNldCA9IHRoaXMuJGdhbGxlcnkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xuICAgICAgaWYgKHRoaXMuc3VwZXJTY3JvbGxlcikgdGhpcy5zdXBlclNjcm9sbGVyLnNjcm9sbEFuaW1hdGUoLXRoaXMuc3VwZXJTY3JvbGxlci5fc2Nyb2xsLmxpdmVQb3NpdGlvbi55ICsgb2Zmc2V0LCAxLjQsICdleHBvLmluT3V0Jyk7XG4gICAgICB2YXIgX21heFggPSAwO1xuXG4gICAgICB2YXIgX21pblggPSAtKHRoaXMuZ2FsbGVyeS5yZWxhdGl2ZVdpZHRoIC0gd2luZG93LmlubmVyV2lkdGgpO1xuXG4gICAgICB2YXIgX2NlbnRlciA9IE1hdGgubWluKF9tYXhYLCBNYXRoLm1heChfbWluWCwgLWNlbnRlcikpO1xuXG4gICAgICBpZiAodGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIGdzYXAudG8oW3RoaXMuZ2FsbGVyeURyYWdnYWJsZS5fZHJhZy5saXZlUG9zaXRpb24sIHRoaXMuZ2FsbGVyeURyYWdnYWJsZS5fZHJhZy5wb3NpdGlvbiwgdGhpcy5nYWxsZXJ5RHJhZ2dhYmxlLl9kcmFnLmxhc3RQb3NpdGlvbl0sIHtcbiAgICAgICAgeDogX2NlbnRlcixcbiAgICAgICAgZHVyYXRpb246IDEuNCxcbiAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnXG4gICAgICB9KTtcbiAgICAgIGdzYXAudG8odGhpcy4kZ2FsbGVyeUdyaWRJbm5lciwge1xuICAgICAgICB4OiBfY2VudGVyLFxuICAgICAgICBkdXJhdGlvbjogMS40LFxuICAgICAgICBlYXNlOiAnZXhwby5pbk91dCcsXG4gICAgICAgIG9uQ29tcGxldGU6IGZ1bmN0aW9uIG9uQ29tcGxldGUoKSB7XG4gICAgICAgICAgaWYgKF90aGlzNS5hcHBTdG9yZS5pc0Rlc2t0b3ApIF90aGlzNS5nYWxsZXJ5RHJhZ2dhYmxlLnJlc2l6ZSgpO2Vsc2UgX3RoaXM1LmdhbGxlcnlEcmFnZ2FibGUuZHJhZ2dhYmxlWzBdLmFwcGx5Qm91bmRzKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgdGhpcy5nYWxsZXJ5LmlzWm9vbWVkID0gdHJ1ZTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwib3BlbkxpZ2h0Ym94XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW5MaWdodGJveChpbmRleCkge1xuICAgICAgdmFyIF90aGlzNiA9IHRoaXM7XG5cbiAgICAgIGdzYXAudG8odGhpcy5hcHBVaS4kaGVhZGVyVHJpZ2dlciwge1xuICAgICAgICBvcGFjaXR5OiAwLjAwMDEsXG4gICAgICAgIHBvaW50ZXJFdmVudHM6ICdub25lJyxcbiAgICAgICAgZHVyYXRpb246IDAuOCxcbiAgICAgICAgZWFzZTogJ3Bvd2VyMi5vdXQnXG4gICAgICB9KTtcbiAgICAgIGlmICh0aGlzLiRpbmZvVHJpZ2dlcikgZ3NhcC50byh0aGlzLiRpbmZvVHJpZ2dlciwge1xuICAgICAgICBvcGFjaXR5OiAwLjAwMDEsXG4gICAgICAgIHBvaW50ZXJFdmVudHM6ICdub25lJyxcbiAgICAgICAgZHVyYXRpb246IDAuOCxcbiAgICAgICAgZWFzZTogJ3Bvd2VyMi5vdXQnXG4gICAgICB9KTtcblxuICAgICAgaWYgKHRoaXMuc3VwZXJTY3JvbGxlcikge1xuICAgICAgICB2YXIgb2Zmc2V0ID0gdGhpcy4kZ2FsbGVyeS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3A7XG4gICAgICAgIHRoaXMuc3VwZXJTY3JvbGxlci5zY3JvbGxBbmltYXRlKC10aGlzLnN1cGVyU2Nyb2xsZXIuX3Njcm9sbC5saXZlUG9zaXRpb24ueSArIG9mZnNldCwgMS40LCAnZXhwby5pbk91dCcpO1xuICAgICAgICBnc2FwLmRlbGF5ZWRDYWxsKDEuNCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIF90aGlzNi5zdXBlclNjcm9sbGVyLl9zY3JvbGwuZW5hYmxlID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuJGdhbGxlcnlHcmlkSXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZ3NhcC50byh0aGlzLiRnYWxsZXJ5R3JpZEl0ZW1zW2ldLnF1ZXJ5U2VsZWN0b3IoJy5leHBhbmQnKSwge1xuICAgICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgICBkdXJhdGlvbjogMC4yLFxuICAgICAgICAgIGVhc2U6ICdwb3dlcjIub3V0J1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5saWdodGJveC5zZXQoaW5kZXgpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJjbG9zZUxpZ2h0Ym94XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNsb3NlTGlnaHRib3goaW5kZXgpIHtcbiAgICAgIHZhciAkZWwgPSB0aGlzLmdhbGxlcnkucmVsYXRpdmVQb3NpdGlvbnNbaW5kZXhdO1xuICAgICAgdmFyIGNlbnRlciA9ICRlbFsyXSAtIHdpbmRvdy5pbm5lcldpZHRoIC8gMiArICRlbFswXSAvIDI7IC8vIENlbnRlciBnYWxsZXJ5XG5cbiAgICAgIGlmICh0aGlzLnN1cGVyU2Nyb2xsZXIpIHtcbiAgICAgICAgdGhpcy5zdXBlclNjcm9sbGVyLl9zY3JvbGwuZW5hYmxlID0gdHJ1ZTtcbiAgICAgICAgdmFyIG9mZnNldCA9IHRoaXMuJGdhbGxlcnkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xuICAgICAgICBpZiAodGhpcy5zdXBlclNjcm9sbGVyKSB0aGlzLnN1cGVyU2Nyb2xsZXIuc2Nyb2xsQW5pbWF0ZSgtdGhpcy5zdXBlclNjcm9sbGVyLl9zY3JvbGwubGl2ZVBvc2l0aW9uLnkgKyBvZmZzZXQsIDEuNCwgJ2V4cG8uaW5PdXQnKTtcbiAgICAgIH1cblxuICAgICAgdmFyIF9tYXhYID0gMDtcblxuICAgICAgdmFyIF9taW5YID0gLSh0aGlzLmdhbGxlcnkucmVsYXRpdmVXaWR0aCAtIHdpbmRvdy5pbm5lcldpZHRoKTtcblxuICAgICAgdmFyIF9jZW50ZXIgPSBNYXRoLm1pbihfbWF4WCwgTWF0aC5tYXgoX21pblgsIC1jZW50ZXIpKTtcblxuICAgICAgaWYgKHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKSBnc2FwLnNldChbdGhpcy5nYWxsZXJ5RHJhZ2dhYmxlLl9kcmFnLmxpdmVQb3NpdGlvbiwgdGhpcy5nYWxsZXJ5RHJhZ2dhYmxlLl9kcmFnLnBvc2l0aW9uLCB0aGlzLmdhbGxlcnlEcmFnZ2FibGUuX2RyYWcubGFzdFBvc2l0aW9uXSwge1xuICAgICAgICB4OiBfY2VudGVyXG4gICAgICB9KTtcbiAgICAgIGdzYXAuc2V0KHRoaXMuJGdhbGxlcnlHcmlkSW5uZXIsIHtcbiAgICAgICAgeDogX2NlbnRlclxuICAgICAgfSk7XG4gICAgICBpZiAodGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHRoaXMuZ2FsbGVyeURyYWdnYWJsZS5yZXNpemUoKTtlbHNlIHRoaXMuZ2FsbGVyeURyYWdnYWJsZS5kcmFnZ2FibGVbMF0uYXBwbHlCb3VuZHMoKTtcbiAgICAgIGdzYXAudG8odGhpcy5hcHBVaS4kaGVhZGVyVHJpZ2dlciwge1xuICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICBwb2ludGVyRXZlbnRzOiAnYWxsJyxcbiAgICAgICAgZHVyYXRpb246IDAuOCxcbiAgICAgICAgZWFzZTogJ3Bvd2VyMi5vdXQnLFxuICAgICAgICBkZWxheTogMVxuICAgICAgfSk7XG4gICAgICBpZiAodGhpcy4kaW5mb1RyaWdnZXIpIGdzYXAudG8odGhpcy4kaW5mb1RyaWdnZXIsIHtcbiAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgcG9pbnRlckV2ZW50czogJ2FsbCcsXG4gICAgICAgIGR1cmF0aW9uOiAwLjgsXG4gICAgICAgIGVhc2U6ICdwb3dlcjIub3V0JyxcbiAgICAgICAgZGVsYXk6IDFcbiAgICAgIH0pO1xuXG4gICAgICBpZiAodGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLiRnYWxsZXJ5R3JpZEl0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgZ3NhcC50byh0aGlzLiRnYWxsZXJ5R3JpZEl0ZW1zW2ldLnF1ZXJ5U2VsZWN0b3IoJy5leHBhbmQnKSwge1xuICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjIsXG4gICAgICAgICAgICBlYXNlOiAncG93ZXIyLm91dCcsXG4gICAgICAgICAgICBkZWxheTogMFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRoaXMuZ2FsbGVyeS5pc0V4cGFuZGVkID0gZmFsc2U7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImVudGVySW1hZ2VcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZW50ZXJJbWFnZShlbCkge1xuICAgICAgaWYgKCF0aGlzLmdhbGxlcnkuZHJhZ2dpbmcpIHtcbiAgICAgICAgaWYgKCF0aGlzLmdhbGxlcnkuaXNab29tZWQpIHtcbiAgICAgICAgICBnc2FwLnRvKGVsLnF1ZXJ5U2VsZWN0b3IoJy5iYWNrZ3JvdW5kIC5iYWNrZ3JvdW5kX19vdmVybGF5MicpLCB7XG4gICAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgICAgZHVyYXRpb246IDAuMixcbiAgICAgICAgICAgIGVhc2U6ICdwb3dlcjIub3V0J1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGdzYXAudG8oZWwuY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0sIHtcbiAgICAgICAgICAgIHNjYWxlOiAxLFxuICAgICAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAxXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZ3NhcC5raWxsVHdlZW5zT2YoW3RoaXMuYXBwVWkuJGN1cnNvckRyYWcsIHRoaXMuYXBwVWkuJGN1cnNvckRyYWcuY2hpbGRyZW5bMF0sIHRoaXMuYXBwVWkuJGN1cnNvclBsdXMsIHRoaXMuYXBwVWkuJGN1cnNvclBsdXMuY2hpbGRyZW5bMF1dKTtcbiAgICAgICAgICBnc2FwLnRvKHRoaXMuYXBwVWkuJGN1cnNvckRvdCwge1xuICAgICAgICAgICAgc2NhbGU6IDAuNyxcbiAgICAgICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjMsXG4gICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZ3NhcC50byh0aGlzLmFwcFVpLiRjdXJzb3JNaW51cywge1xuICAgICAgICAgICAgc2NhbGU6IDAuNyxcbiAgICAgICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjMsXG4gICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZ3NhcC50byh0aGlzLmFwcFVpLiRjdXJzb3JQbHVzLCB7XG4gICAgICAgICAgICBzY2FsZTogMC43LFxuICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjMsXG4gICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICAgICAgfSk7IC8vZ3NhcC50byh0aGlzLmFwcFVpLiRjdXJzb3JQbHVzLmNoaWxkcmVuWzBdLCB7IG9wYWNpdHk6IDEsIGR1cmF0aW9uOiAwLjMsIGVhc2U6ICdleHBvLm91dCcgfSk7XG5cbiAgICAgICAgICBnc2FwLnRvKHRoaXMuYXBwVWkuJGN1cnNvckRyYWcsIHtcbiAgICAgICAgICAgIHNjYWxlOiAwLjcsXG4gICAgICAgICAgICBvcGFjaXR5OiAwLjAwMDEsXG4gICAgICAgICAgICBkdXJhdGlvbjogMC4zLFxuICAgICAgICAgICAgZWFzZTogJ2V4cG8ub3V0J1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGdzYXAudG8odGhpcy5hcHBVaS4kY3Vyc29yRHJhZy5jaGlsZHJlblswXSwge1xuICAgICAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICAgICAgZHVyYXRpb246IDAuMyxcbiAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCdcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBnc2FwLnRvKHRoaXMuYXBwVWkuJGN1cnNvckRvdCwge1xuICAgICAgICAgICAgc2NhbGU6IDAuNyxcbiAgICAgICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjMsXG4gICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZ3NhcC50byh0aGlzLmFwcFVpLiRjdXJzb3JNaW51cywge1xuICAgICAgICAgICAgc2NhbGU6IDAuNyxcbiAgICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgICBkdXJhdGlvbjogMC4zLFxuICAgICAgICAgICAgZWFzZTogJ2V4cG8ub3V0J1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGdzYXAudG8odGhpcy5hcHBVaS4kY3Vyc29yUGx1cywge1xuICAgICAgICAgICAgc2NhbGU6IDAuNyxcbiAgICAgICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjMsXG4gICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICAgICAgfSk7IC8vZ3NhcC50byh0aGlzLmFwcFVpLiRjdXJzb3JNaW51cy5jaGlsZHJlblswXSwgeyBvcGFjaXR5OiAxLCBkdXJhdGlvbjogMC4zLCBlYXNlOiAnZXhwby5vdXQnIH0pO1xuXG4gICAgICAgICAgZ3NhcC50byh0aGlzLmFwcFVpLiRjdXJzb3JEcmFnLCB7XG4gICAgICAgICAgICBzY2FsZTogMC43LFxuICAgICAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICAgICAgZHVyYXRpb246IDAuMyxcbiAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCdcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBnc2FwLnRvKHRoaXMuYXBwVWkuJGN1cnNvckRyYWcuY2hpbGRyZW5bMF0sIHtcbiAgICAgICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjMsXG4gICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwibGVhdmVJbWFnZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBsZWF2ZUltYWdlKGVsKSB7XG4gICAgICBpZiAoIXRoaXMuZ2FsbGVyeS5kcmFnZ2luZykge1xuICAgICAgICBpZiAoIXRoaXMuZ2FsbGVyeS5pc1pvb21lZCkge1xuICAgICAgICAgIGdzYXAudG8oZWwucXVlcnlTZWxlY3RvcignLmJhY2tncm91bmQgLmJhY2tncm91bmRfX292ZXJsYXkyJyksIHtcbiAgICAgICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjIsXG4gICAgICAgICAgICBlYXNlOiAncG93ZXIyLm91dCdcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBnc2FwLnRvKGVsLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgICAgICBzY2FsZTogMS4xLFxuICAgICAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAxXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZ3NhcC50byh0aGlzLmFwcFVpLiRjdXJzb3JEb3QsIHtcbiAgICAgICAgICAgIHNjYWxlOiAxLFxuICAgICAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICAgICAgZHVyYXRpb246IDAuMyxcbiAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCdcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBnc2FwLnRvKHRoaXMuYXBwVWkuJGN1cnNvckRyYWcsIHtcbiAgICAgICAgICAgIHNjYWxlOiAxLFxuICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjMsXG4gICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZ3NhcC50byh0aGlzLmFwcFVpLiRjdXJzb3JEcmFnLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgICAgZHVyYXRpb246IDAuMyxcbiAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCdcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBnc2FwLnRvKHRoaXMuYXBwVWkuJGN1cnNvck1pbnVzLCB7XG4gICAgICAgICAgICBzY2FsZTogMSxcbiAgICAgICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjMsXG4gICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZ3NhcC50byh0aGlzLmFwcFVpLiRjdXJzb3JQbHVzLCB7XG4gICAgICAgICAgICBzY2FsZTogMSxcbiAgICAgICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjMsXG4gICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICAgICAgfSk7IC8vZ3NhcC50byh0aGlzLmFwcFVpLiRjdXJzb3JQbHVzLmNoaWxkcmVuWzBdLCB7IHNjYWxlOiAxLCBvcGFjaXR5OiAwLjAwMDEsIGR1cmF0aW9uOiAwLjMsIGVhc2U6ICdleHBvLm91dCcgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZ3NhcC50byh0aGlzLmFwcFVpLiRjdXJzb3JEb3QsIHtcbiAgICAgICAgICAgIHNjYWxlOiAxLFxuICAgICAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICAgICAgZHVyYXRpb246IDAuMyxcbiAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCdcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBnc2FwLnRvKHRoaXMuYXBwVWkuJGN1cnNvckRyYWcsIHtcbiAgICAgICAgICAgIHNjYWxlOiAxLFxuICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjMsXG4gICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZ3NhcC50byh0aGlzLmFwcFVpLiRjdXJzb3JEcmFnLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgICAgZHVyYXRpb246IDAuMyxcbiAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCdcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBnc2FwLnRvKHRoaXMuYXBwVWkuJGN1cnNvck1pbnVzLCB7XG4gICAgICAgICAgICBzY2FsZTogMSxcbiAgICAgICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjMsXG4gICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZ3NhcC50byh0aGlzLmFwcFVpLiRjdXJzb3JQbHVzLCB7XG4gICAgICAgICAgICBzY2FsZTogMSxcbiAgICAgICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLjMsXG4gICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICAgICAgfSk7IC8vZ3NhcC50byh0aGlzLmFwcFVpLiRjdXJzb3JNaW51cy5jaGlsZHJlblswXSwgeyBzY2FsZTogMSwgb3BhY2l0eTogMC4wMDAxLCBkdXJhdGlvbjogMC4zLCBlYXNlOiAnZXhwby5vdXQnIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImVudGVyRXhwYW5kXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGVudGVyRXhwYW5kKCkge1xuICAgICAgZ3NhcC50byh0aGlzLmFwcFVpLiRjdXJzb3JEb3QsIHtcbiAgICAgICAgc2NhbGU6IDAuMzUsXG4gICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgIGR1cmF0aW9uOiAwLjMsXG4gICAgICAgIGVhc2U6ICdleHBvLm91dCdcbiAgICAgIH0pO1xuICAgICAgZ3NhcC50byh0aGlzLmFwcFVpLiRjdXJzb3JNaW51cywge1xuICAgICAgICBzY2FsZTogMC4zNSxcbiAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICBkdXJhdGlvbjogMC4zLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICB9KTsgLy9nc2FwLnRvKHRoaXMuYXBwVWkuJGN1cnNvck1pbnVzLmNoaWxkcmVuWzBdLCB7IHNjYWxlOiAxLCBvcGFjaXR5OiAwLjAwMDEsIGR1cmF0aW9uOiAwLjMsIGVhc2U6ICdleHBvLm91dCcgfSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImxlYXZlRXhwYW5kXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGxlYXZlRXhwYW5kKCkge1xuICAgICAgZ3NhcC50byh0aGlzLmFwcFVpLiRjdXJzb3JEb3QsIHtcbiAgICAgICAgc2NhbGU6IDAuNyxcbiAgICAgICAgb3BhY2l0eTogMC4wMDAxLFxuICAgICAgICBkdXJhdGlvbjogMC4zLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICB9KTtcbiAgICAgIGdzYXAudG8odGhpcy5hcHBVaS4kY3Vyc29yTWludXMsIHtcbiAgICAgICAgc2NhbGU6IDAuNyxcbiAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgZHVyYXRpb246IDAuMyxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0J1xuICAgICAgfSk7IC8vZ3NhcC50byh0aGlzLmFwcFVpLiRjdXJzb3JNaW51cy5jaGlsZHJlblswXSwgeyBvcGFjaXR5OiAxLCBkdXJhdGlvbjogMC4zLCBlYXNlOiAnZXhwby5vdXQnIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJjbGlja0V4cGFuZFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjbGlja0V4cGFuZChlLCBhLCBlbCwgaW5kZXgpIHtcbiAgICAgIHRoaXMuZ2FsbGVyeS5pc0V4cGFuZGVkID0gdHJ1ZTtcbiAgICAgIHRoaXMub3BlbkxpZ2h0Ym94KGluZGV4KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmVzaXplR2FsbGVyeVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZXNpemVHYWxsZXJ5KCkge1xuICAgICAgLy8gR2V0IGFic29sdXRlIHBvc2l0aW9uc1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLiRnYWxsZXJ5R3JpZEl0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBfd2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aCAqIHRoaXMuZ2FsbGVyeS5yZWZlcmVuY2VzW2ldWzBdIC8gMTAwO1xuXG4gICAgICAgIHZhciBfaGVpZ2h0ID0gd2luZG93LmlubmVyV2lkdGggKiB0aGlzLmdhbGxlcnkucmVmZXJlbmNlc1tpXVsxXSAvIDEwMDtcblxuICAgICAgICB2YXIgX2xlZnQgPSB3aW5kb3cuaW5uZXJXaWR0aCAqIHRoaXMuZ2FsbGVyeS5yZWZlcmVuY2VzW2ldWzJdIC8gMTAwO1xuXG4gICAgICAgIHZhciBfdG9wID0gd2luZG93LmlubmVyV2lkdGggKiB0aGlzLmdhbGxlcnkucmVmZXJlbmNlc1tpXVszXSAvIDEwMDtcblxuICAgICAgICB2YXIgX3JhdGlvID0gMSAvICgod2luZG93LmlubmVySGVpZ2h0IC0gd2luZG93LmlubmVyV2lkdGggKiAwLjEpIC8gX2hlaWdodCk7XG5cbiAgICAgICAgdmFyIF9tdWx0aXBsaWVyID0gKHdpbmRvdy5pbm5lckhlaWdodCAtIHdpbmRvdy5pbm5lcldpZHRoICogMC4xKSAvIF9oZWlnaHQ7XG5cbiAgICAgICAgdGhpcy5nYWxsZXJ5LmFic29sdXRlUG9zaXRpb25zW2ldID0gW193aWR0aCwgX2hlaWdodCwgX2xlZnQsIF90b3AsIF9yYXRpbywgX211bHRpcGxpZXJdO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmdhbGxlcnkuYWJzb2x1dGVXaWR0aCA9IHRoaXMuZ2FsbGVyeS5hYnNvbHV0ZVBvc2l0aW9uc1t0aGlzLmdhbGxlcnkuY291bnQgLSAxXVswXSArIHRoaXMuZ2FsbGVyeS5hYnNvbHV0ZVBvc2l0aW9uc1t0aGlzLmdhbGxlcnkuY291bnQgLSAxXVsyXTsgLy8gR2V0IHJlbGF0aXZlIHBvc2l0aW9uc1xuXG4gICAgICBmb3IgKHZhciBfaTggPSAwOyBfaTggPCB0aGlzLiRnYWxsZXJ5R3JpZEl0ZW1zLmxlbmd0aDsgX2k4KyspIHtcbiAgICAgICAgdmFyIF9tdWx0aXBsaWVyMyA9IHRoaXMuZ2FsbGVyeS5hYnNvbHV0ZVBvc2l0aW9uc1tfaThdWzVdO1xuXG4gICAgICAgIHZhciBfd2lkdGgzID0gX211bHRpcGxpZXIzICogdGhpcy5nYWxsZXJ5LmFic29sdXRlUG9zaXRpb25zW19pOF1bMF07XG5cbiAgICAgICAgdmFyIF9oZWlnaHQzID0gX211bHRpcGxpZXIzICogdGhpcy5nYWxsZXJ5LmFic29sdXRlUG9zaXRpb25zW19pOF1bMV07XG5cbiAgICAgICAgdmFyIF9sZWZ0MyA9IF9pOCA9PT0gMCA/IDAgOiB0aGlzLmdhbGxlcnkucmVsYXRpdmVQb3NpdGlvbnNbX2k4IC0gMV1bMl0gKyB0aGlzLmdhbGxlcnkucmVsYXRpdmVQb3NpdGlvbnNbX2k4IC0gMV1bMF0gKyB0aGlzLmdhbGxlcnkubWFyZ2luO1xuXG4gICAgICAgIHZhciBfdG9wMyA9IHdpbmRvdy5pbm5lcldpZHRoICogMC4wNTtcblxuICAgICAgICB0aGlzLmdhbGxlcnkucmVsYXRpdmVQb3NpdGlvbnNbX2k4XSA9IFtfd2lkdGgzLCBfaGVpZ2h0MywgX2xlZnQzLCBfdG9wM107XG4gICAgICB9XG5cbiAgICAgIHRoaXMuZ2FsbGVyeS5yZWxhdGl2ZVdpZHRoID0gdGhpcy5nYWxsZXJ5LnJlbGF0aXZlUG9zaXRpb25zW3RoaXMuZ2FsbGVyeS5jb3VudCAtIDFdWzBdICsgdGhpcy5nYWxsZXJ5LnJlbGF0aXZlUG9zaXRpb25zW3RoaXMuZ2FsbGVyeS5jb3VudCAtIDFdWzJdO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJpbml0UmVsYXRlZFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0UmVsYXRlZCgpIHtcbiAgICAgIHZhciBfdGhpczcgPSB0aGlzO1xuXG4gICAgICAvLyBTZWxlY3RvcnNcbiAgICAgIHRoaXMuJHJlbGF0ZWRTbGlkZXIgPSB0aGlzLiRyZWxhdGVkLnF1ZXJ5U2VsZWN0b3IoJy5zbGlkZXInKTtcbiAgICAgIHRoaXMuJHJlbGF0ZWRTbGlkZXJJbm5lciA9IHRoaXMuJHJlbGF0ZWQucXVlcnlTZWxlY3RvcignLnNsaWRlcl9faW5uZXInKTtcbiAgICAgIHRoaXMuJHJlbGF0ZWRTbGlkZXJJdGVtcyA9IHRoaXMuJHJlbGF0ZWQucXVlcnlTZWxlY3RvckFsbCgnLnNsaWRlcl9faXRlbScpO1xuICAgICAgdGhpcy4kcmVsYXRlZFByb21vdGlvbnMgPSB0aGlzLiRyZWxhdGVkLnF1ZXJ5U2VsZWN0b3JBbGwoJy5wcm9tb3Rpb24nKTtcblxuICAgICAgaWYgKHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy4kcmVsYXRlZFByb21vdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB0aGlzLmRvbUV2ZW50cy5hZGQodGhpcy4kcmVsYXRlZFByb21vdGlvbnNbaV0sICdtb3VzZWVudGVyJywgZnVuY3Rpb24gKGUsIGEsIGVsKSB7XG4gICAgICAgICAgICBfdGhpczcucHJvbW90aW9uRW50ZXIoZWwpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHRoaXMuZG9tRXZlbnRzLmFkZCh0aGlzLiRyZWxhdGVkUHJvbW90aW9uc1tpXSwgJ21vdXNlbGVhdmUnLCBmdW5jdGlvbiAoZSwgYSwgZWwpIHtcbiAgICAgICAgICAgIF90aGlzNy5wcm9tb3Rpb25MZWF2ZShlbCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmRvbUV2ZW50cy5hZGQodGhpcy4kcmVsYXRlZFNsaWRlcklubmVyLCAnbW91c2VlbnRlcicsIGZ1bmN0aW9uIChlLCBhLCBlbCkge1xuICAgICAgICAgIF90aGlzNy5hcHBVaS5lbnRlckRyYWdDdXJzb3IoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZG9tRXZlbnRzLmFkZCh0aGlzLiRyZWxhdGVkU2xpZGVySW5uZXIsICdtb3VzZWxlYXZlJywgZnVuY3Rpb24gKGUsIGEsIGVsKSB7XG4gICAgICAgICAgX3RoaXM3LmFwcFVpLmxlYXZlRHJhZ0N1cnNvcigpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5yZWxhdGVkRHJhZ2dhYmxlID0gbmV3IFN1cGVyRHJhZ2dlcih7XG4gICAgICAgICAgZWw6IHRoaXMuJHJlbGF0ZWRTbGlkZXIsXG4gICAgICAgICAgZWxDbGlja2FibGVzOiB0aGlzLiRyZWxhdGVkUHJvbW90aW9ucyxcbiAgICAgICAgICBpbm5lcjogdGhpcy4kcmVsYXRlZFNsaWRlcklubmVyLFxuICAgICAgICAgIG9uRHJhZ1N0YXJ0OiBmdW5jdGlvbiBvbkRyYWdTdGFydCgpIHtcbiAgICAgICAgICAgIF90aGlzNy5zdXBlclNjcm9sbGVyLl9zY3JvbGwuZW5hYmxlID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGZvciAodmFyIF9pOSA9IDA7IF9pOSA8IF90aGlzNy4kcmVsYXRlZFByb21vdGlvbnMubGVuZ3RoOyBfaTkrKykge1xuICAgICAgICAgICAgICBnc2FwLnRvKF90aGlzNy4kcmVsYXRlZFByb21vdGlvbnNbX2k5XSwge1xuICAgICAgICAgICAgICAgIHNjYWxlOiAwLjk0LFxuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogMC42XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBnc2FwLnRvKF90aGlzNy4kcmVsYXRlZFByb21vdGlvbnNbX2k5XS5xdWVyeVNlbGVjdG9yKCcuaW5uZXIgLmJhY2tncm91bmRfX2JnJyksIHtcbiAgICAgICAgICAgICAgICBzY2FsZTogMSxcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDAuNlxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIG9uRHJhZ0VuZDogZnVuY3Rpb24gb25EcmFnRW5kKCkge1xuICAgICAgICAgICAgX3RoaXM3LnN1cGVyU2Nyb2xsZXIuX3Njcm9sbC5lbmFibGUgPSB0cnVlO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBfaTEwID0gMDsgX2kxMCA8IF90aGlzNy4kcmVsYXRlZFByb21vdGlvbnMubGVuZ3RoOyBfaTEwKyspIHtcbiAgICAgICAgICAgICAgZ3NhcC50byhfdGhpczcuJHJlbGF0ZWRQcm9tb3Rpb25zW19pMTBdLCB7XG4gICAgICAgICAgICAgICAgc2NhbGU6IDEsXG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAwLjZcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGdzYXAudG8oX3RoaXM3LiRyZWxhdGVkUHJvbW90aW9uc1tfaTEwXS5xdWVyeVNlbGVjdG9yKCcuaW5uZXIgLmJhY2tncm91bmRfX2JnJyksIHtcbiAgICAgICAgICAgICAgICBzY2FsZTogMS4xLFxuICAgICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDAuNlxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5yZWxhdGVkRHJhZ2dhYmxlID0gbmV3IERyYWdnYWJsZSh7XG4gICAgICAgICAgdGFyZ2V0OiB0aGlzLiRyZWxhdGVkU2xpZGVyLFxuICAgICAgICAgIHRhcmdldElubmVyOiB0aGlzLiRyZWxhdGVkU2xpZGVySW5uZXIsXG4gICAgICAgICAgc25hcDogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicHJvbW90aW9uRW50ZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcHJvbW90aW9uRW50ZXIoZWwpIHtcbiAgICAgIGdzYXAudG8oZWwucXVlcnlTZWxlY3RvcignLmlubmVyIC5iYWNrZ3JvdW5kX19iZycpLCB7XG4gICAgICAgIHNjYWxlOiAxLFxuICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICBkdXJhdGlvbjogMC42XG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicHJvbW90aW9uTGVhdmVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcHJvbW90aW9uTGVhdmUoZWwpIHtcbiAgICAgIGlmICh0aGlzLnJlbGF0ZWREcmFnZ2FibGUgJiYgdGhpcy5yZWxhdGVkRHJhZ2dhYmxlLl9kcmFnLmRyYWdnaW5nKSByZXR1cm47XG4gICAgICBnc2FwLnRvKGVsLnF1ZXJ5U2VsZWN0b3IoJy5pbm5lciAuYmFja2dyb3VuZF9fYmcnKSwge1xuICAgICAgICBzY2FsZTogMS4xLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICBkdXJhdGlvbjogMC42XG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmFmXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJhZigpIHt9IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcblxuICB9LCB7XG4gICAga2V5OiBcInJlc2l6ZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZXNpemUoKSB7Ly8gaWYodGhpcy5saWdodGJveERyYWdnYWJsZSlcbiAgICAgIC8vICAgICB0aGlzLmxpZ2h0Ym94RHJhZ2dhYmxlLnJlc2l6ZSgpO1xuICAgICAgLy8gdGhpcy5yZXNpemVHYWxsZXJ5KCk7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIFJlbmRlcmVyUHJvbW90aW9uc1NpbmdsZTtcbn0oUmVuZGVyZXIpOyAvLyBEb25gdCBmb3JnZXQgdG8gZXhwb3J0IHlvdXIgcmVuZGVyZXJcblxuXG5leHBvcnQgZGVmYXVsdCBSZW5kZXJlclByb21vdGlvbnNTaW5nbGU7IiwiZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgXCJAYmFiZWwvaGVscGVycyAtIHR5cGVvZlwiOyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2Yob2JqKTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvblwiKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9XG5cbmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVTdXBlcihEZXJpdmVkKSB7IHZhciBoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0ID0gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpOyByZXR1cm4gZnVuY3Rpb24gX2NyZWF0ZVN1cGVySW50ZXJuYWwoKSB7IHZhciBTdXBlciA9IF9nZXRQcm90b3R5cGVPZihEZXJpdmVkKSwgcmVzdWx0OyBpZiAoaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCkgeyB2YXIgTmV3VGFyZ2V0ID0gX2dldFByb3RvdHlwZU9mKHRoaXMpLmNvbnN0cnVjdG9yOyByZXN1bHQgPSBSZWZsZWN0LmNvbnN0cnVjdChTdXBlciwgYXJndW1lbnRzLCBOZXdUYXJnZXQpOyB9IGVsc2UgeyByZXN1bHQgPSBTdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9IHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCByZXN1bHQpOyB9OyB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikpIHsgcmV0dXJuIGNhbGw7IH0gZWxzZSBpZiAoY2FsbCAhPT0gdm9pZCAwKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJEZXJpdmVkIGNvbnN0cnVjdG9ycyBtYXkgb25seSByZXR1cm4gb2JqZWN0IG9yIHVuZGVmaW5lZFwiKTsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfVxuXG5mdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIHNlbGY7IH1cblxuZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcInVuZGVmaW5lZFwiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiB0cnVlOyB0cnkgeyBCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoQm9vbGVhbiwgW10sIGZ1bmN0aW9uICgpIHt9KSk7IHJldHVybiB0cnVlOyB9IGNhdGNoIChlKSB7IHJldHVybiBmYWxzZTsgfSB9XG5cbmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH1cblxuLy8gR3NhcFxuaW1wb3J0IGdzYXAgZnJvbSAnZ3NhcCc7XG5pbXBvcnQgU2Nyb2xsVHJpZ2dlciBmcm9tICdnc2FwL1Njcm9sbFRyaWdnZXInO1xuZ3NhcC5yZWdpc3RlclBsdWdpbihTY3JvbGxUcmlnZ2VyKTsgLy8gSW1wb3J0IFJlbmRlcmVyXG5cbmltcG9ydCBSZW5kZXJlciBmcm9tICcuL3JlbmRlcmVyLmpzJzsgLy8gaW1wb3J0IHN0eWxlc0RlZmF1bHQgZnJvbSAnLi9zdHlsZXNEZWZhdWx0LmNzcyc7IC8vZXNsaW50LWRpc2FibGUtbGluZVxuLy8gVXRpbGl0aWVzXG5cbmltcG9ydCBEb21FdmVudHMgZnJvbSAnLi4vY2xhc3Nlcy9kb21FdmVudHMnO1xuaW1wb3J0IFN1cGVyU2Nyb2xsZXIgZnJvbSAnLi4vY2xhc3Nlcy9zdXBlclNjcm9sbGVyJzsgLy8gT3RoZXJcbi8vIGltcG9ydCBTbGlkZXIgZnJvbSAnLi4vY2xhc3Nlcy9zbGlkZXInO1xuLy8gaW1wb3J0IFNwbGl0VGV4dCBmcm9tICcuLi9jbGFzc2VzL3NwbGl0VGV4dCc7XG5cbnZhciBSZW5kZXJlck1hc3RlcndvcmtzID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfUmVuZGVyZXIpIHtcbiAgX2luaGVyaXRzKFJlbmRlcmVyTWFzdGVyd29ya3MsIF9SZW5kZXJlcik7XG5cbiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihSZW5kZXJlck1hc3RlcndvcmtzKTtcblxuICBmdW5jdGlvbiBSZW5kZXJlck1hc3RlcndvcmtzKCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBSZW5kZXJlck1hc3RlcndvcmtzKTtcblxuICAgIHJldHVybiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuXG4gIF9jcmVhdGVDbGFzcyhSZW5kZXJlck1hc3RlcndvcmtzLCBbe1xuICAgIGtleTogXCJzZWxlY3RvcnNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2VsZWN0b3JzKCkge1xuICAgICAgdGhpcy4kaGVybyA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3IoJy5tYXN0ZXJ3b3Jrc19faGVybycpO1xuICAgICAgdGhpcy4kaW50cm8gPSB0aGlzLiRlbC5xdWVyeVNlbGVjdG9yKCcubWFzdGVyd29ya3NfX2ludHJvJyk7XG4gICAgICB0aGlzLiRmZWF0dXJlcyA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3IoJy5tYXN0ZXJ3b3Jrc19fZmVhdHVyZXMnKTtcbiAgICAgIGlmICh0aGlzLiRmZWF0dXJlcykgdGhpcy4kZmVhdHVyZXNJdGVtcyA9IHRoaXMuJGZlYXR1cmVzLnF1ZXJ5U2VsZWN0b3JBbGwoJy5mZWF0dXJlc19faXRlbScpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJldmVudHNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZXZlbnRzKCkge30gLy8gZXNsaW50LWRpc2FibGUtbGluZVxuXG4gIH0sIHtcbiAgICBrZXk6IFwiYmVmb3JlRW50ZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gYmVmb3JlRW50ZXIoKSB7XG4gICAgICBpZiAodGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHtcbiAgICAgICAgZ3NhcC5zZXQodGhpcy4kaGVyby5xdWVyeVNlbGVjdG9yKCcuaW1hZ2UnKSwge1xuICAgICAgICAgIHk6ICctMTAwJSdcbiAgICAgICAgfSk7XG4gICAgICAgIGdzYXAuc2V0KHRoaXMuJGhlcm8ucXVlcnlTZWxlY3RvcignLmltYWdlIGltZycpLCB7XG4gICAgICAgICAgeTogJzEwMCUnXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBnc2FwLnNldCh0aGlzLiRoZXJvLnF1ZXJ5U2VsZWN0b3IoJy5tYXNrIC5iZycpLCB7XG4gICAgICAgIHNjYWxlWTogdGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3AgPyAwIDogMVxuICAgICAgfSk7XG4gICAgICBnc2FwLnNldCh0aGlzLiRoZXJvLnF1ZXJ5U2VsZWN0b3IoJy5tYXNrIC5jZW50ZXInKSwge1xuICAgICAgICBvcGFjaXR5OiAwLjAwMDFcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJwcmVlbnRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBwcmVlbnRlcigpIHtcbiAgICAgIGlmICh0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCkge1xuICAgICAgICBnc2FwLnRvKHRoaXMuJGhlcm8ucXVlcnlTZWxlY3RvcignLmltYWdlJyksIHtcbiAgICAgICAgICB5OiAnMCUnLFxuICAgICAgICAgIGR1cmF0aW9uOiAxLjgsXG4gICAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnLFxuICAgICAgICAgIGRlbGF5OiAwXG4gICAgICAgIH0pO1xuICAgICAgICBnc2FwLnRvKHRoaXMuJGhlcm8ucXVlcnlTZWxlY3RvcignLmltYWdlIGltZycpLCB7XG4gICAgICAgICAgeTogJzAlJyxcbiAgICAgICAgICBkdXJhdGlvbjogMS44LFxuICAgICAgICAgIGVhc2U6ICdleHBvLmluT3V0JyxcbiAgICAgICAgICBkZWxheTogMFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgZ3NhcC50byh0aGlzLiRoZXJvLnF1ZXJ5U2VsZWN0b3IoJy5tYXNrIC5iZycpLCB7XG4gICAgICAgIHNjYWxlWTogMSxcbiAgICAgICAgZHVyYXRpb246IDEuNixcbiAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnLFxuICAgICAgICBkZWxheTogMC4yXG4gICAgICB9KTtcbiAgICAgIGdzYXAudG8odGhpcy4kaGVyby5xdWVyeVNlbGVjdG9yKCcubWFzayAuY2VudGVyJyksIHtcbiAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgZWFzZTogJ3Bvd2VyMi5vdXQnLFxuICAgICAgICBkdXJhdGlvbjogMC44LFxuICAgICAgICBkZWxheTogMVxuICAgICAgfSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImVudGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGVudGVyKCkge1xuICAgICAgdGhpcy5hcHBVaS4kaW5mb0NvbnRlbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cImluZm8tc3ViamVjdFwiXScpLnZhbHVlID0gJ0luZm9ybWFjacOzbiBzb2JyZSBNYXN0ZXJ3b3Jrcyc7XG4gICAgICBpZiAodGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHRoaXMucGFyYWxsYXhIZXJvKCk7XG4gICAgICB0aGlzLmluaXRGZWF0dXJlcygpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJwYXJhbGxheEhlcm9cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcGFyYWxsYXhIZXJvKCkge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgaWYgKHRoaXMuJGhlcm8pIHtcbiAgICAgICAgdmFyIG9mZnNldCA9IC0od2luZG93LmlubmVyV2lkdGggKiAwLjA1KTtcbiAgICAgICAgdGhpcy5zdXBlclRyaWdnZXIuY3JlYXRlKHtcbiAgICAgICAgICB0cmlnZ2VyOiB0aGlzLiRoZXJvLFxuICAgICAgICAgIHN0YXJ0OiAndG9wIHRvcCcsXG4gICAgICAgICAgZW5kOiAnYm90dG9tIHRvcCcsXG4gICAgICAgICAgc2NydWI6IHRydWUsXG4gICAgICAgICAgb25VcGRhdGU6IGZ1bmN0aW9uIG9uVXBkYXRlKHNlbGYpIHtcbiAgICAgICAgICAgIGdzYXAudG8oX3RoaXMuJGhlcm8ucXVlcnlTZWxlY3RvcignLmltYWdlIGltZycpLCB7XG4gICAgICAgICAgICAgIHNjYWxlOiAxICsgMC4xICogc2VsZi5wcm9ncmVzc1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBnc2FwLnRvKF90aGlzLiRoZXJvLnF1ZXJ5U2VsZWN0b3IoJy5tYXNrIC5iZycpLCB7XG4gICAgICAgICAgICAgIHk6IG9mZnNldCAqIHNlbGYucHJvZ3Jlc3NcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImluaXRGZWF0dXJlc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0RmVhdHVyZXMoKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgdGhpcy5mZWF0dXJlc1RpbWVsaW5lcyA9IFtdO1xuXG4gICAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcChpKSB7XG4gICAgICAgIGlmICghX3RoaXMyLmFwcFN0b3JlLmlzRGVza3RvcCkge1xuICAgICAgICAgIF90aGlzMi5kb21FdmVudHMuYWRkKF90aGlzMi4kZmVhdHVyZXNJdGVtc1tpXS5xdWVyeVNlbGVjdG9yKCcudHJpZ2dlcicpLCAnY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyBDbG9zZSBtZW51XG4gICAgICAgICAgICBnc2FwLnRvKF90aGlzMi5hcHBVaS4kaGVhZGVyLCB7XG4gICAgICAgICAgICAgIHk6ICctMTAwJScsXG4gICAgICAgICAgICAgIGR1cmF0aW9uOiAxLjQsXG4gICAgICAgICAgICAgIGVhc2U6ICdleHBvLmluT3V0J1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBfdGhpczIuYXBwVWkuaGVhZGVyLmlzTG9ja2VkID0gdHJ1ZTtcblxuICAgICAgICAgICAgdmFyIG9mZnNldCA9IF90aGlzMi4kZmVhdHVyZXNJdGVtc1tpXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3A7XG5cbiAgICAgICAgICAgIF90aGlzMi5hcHBVaS5wcmV2aW91c1Njcm9sbCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgKyBvZmZzZXQgLSAxO1xuICAgICAgICAgICAgZ3NhcC50byhkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsIHtcbiAgICAgICAgICAgICAgc2Nyb2xsVG9wOiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wICsgb2Zmc2V0LFxuICAgICAgICAgICAgICBkdXJhdGlvbjogMS40LFxuICAgICAgICAgICAgICBlYXNlOiAnZXhwby5pbk91dCcsXG4gICAgICAgICAgICAgIG9uQ29tcGxldGU6IGZ1bmN0aW9uIG9uQ29tcGxldGUoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMyLmFwcFVpLmhlYWRlci5pc0xvY2tlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKF90aGlzMi4kZmVhdHVyZXNJdGVtc1tpXS5jbGFzc0xpc3QuY29udGFpbnMoJ29wZW4nKSkge1xuICAgICAgICAgICAgICBnc2FwLnRvKF90aGlzMi4kZmVhdHVyZXNJdGVtc1tpXS5xdWVyeVNlbGVjdG9yKCcuaW5mbycpLCB7XG4gICAgICAgICAgICAgICAgeTogJzUwJScsXG4gICAgICAgICAgICAgICAgZWFzZTogJ2V4cG8uaW5PdXQnLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAxLjRcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGdzYXAudG8oX3RoaXMyLiRmZWF0dXJlc0l0ZW1zW2ldLnF1ZXJ5U2VsZWN0b3IoJy5pbmZvIC53eXNpd3lnJyksIHtcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiAwLjAwMDEsXG4gICAgICAgICAgICAgICAgZWFzZTogJ3Bvd2VyMi5vdXQnLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAwLjQsXG4gICAgICAgICAgICAgICAgZGVsYXk6IDBcbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgX3RoaXMyLiRmZWF0dXJlc0l0ZW1zW2ldLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW4nKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGdzYXAudG8oX3RoaXMyLiRmZWF0dXJlc0l0ZW1zW2ldLnF1ZXJ5U2VsZWN0b3IoJy5pbmZvJyksIHtcbiAgICAgICAgICAgICAgICB5OiAnMCUnLFxuICAgICAgICAgICAgICAgIGVhc2U6ICdleHBvLmluT3V0JyxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogMS40XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBnc2FwLnRvKF90aGlzMi4kZmVhdHVyZXNJdGVtc1tpXS5xdWVyeVNlbGVjdG9yKCcuaW5mbyAud3lzaXd5ZycpLCB7XG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgICAgICBlYXNlOiAncG93ZXIyLm91dCcsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDAuNCxcbiAgICAgICAgICAgICAgICBkZWxheTogMVxuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICBfdGhpczIuJGZlYXR1cmVzSXRlbXNbaV0uY2xhc3NMaXN0LmFkZCgnb3BlbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZ3NhcC5zZXQoX3RoaXMyLiRmZWF0dXJlc0l0ZW1zW2ldLnF1ZXJ5U2VsZWN0b3IoJy5iYWNrZ3JvdW5kX19iZycpLCB7XG4gICAgICAgICAgeTogX3RoaXMyLmFwcFN0b3JlLmlzRGVza3RvcCA/IC13aW5kb3cuaW5uZXJIZWlnaHQgKyAyMDAgOiAtKHdpbmRvdy5pbm5lckhlaWdodCAqIDAuNSkgKyAyMDAsXG4gICAgICAgICAgc2NhbGU6IDEuMlxuICAgICAgICB9LCAwKTtcbiAgICAgICAgZ3NhcC5zZXQoX3RoaXMyLiRmZWF0dXJlc0l0ZW1zW2ldLnF1ZXJ5U2VsZWN0b3IoJy5iYWNrZ3JvdW5kX19tYXNrJyksIHtcbiAgICAgICAgICBvcGFjaXR5OiAxXG4gICAgICAgIH0sIDApO1xuICAgICAgICB2YXIgZmVhdHVyZVRpbWVsaW5lID0gZ3NhcC50aW1lbGluZSh7XG4gICAgICAgICAgZGVmYXVsdHM6IHtcbiAgICAgICAgICAgIGVhc2U6ICdub25lJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgc2Nyb2xsVHJpZ2dlcjoge1xuICAgICAgICAgICAgdHJpZ2dlcjogX3RoaXMyLiRmZWF0dXJlc0l0ZW1zW2ldLnF1ZXJ5U2VsZWN0b3IoJy5iYWNrZ3JvdW5kJyksXG4gICAgICAgICAgICBzY3J1YjogdHJ1ZSxcbiAgICAgICAgICAgIHN0YXJ0OiAndG9wIGJvdHRvbScsXG4gICAgICAgICAgICBlbmQ6ICdib3R0b20gYm90dG9tJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGZlYXR1cmVUaW1lbGluZS50byhfdGhpczIuJGZlYXR1cmVzSXRlbXNbaV0ucXVlcnlTZWxlY3RvcignLmJhY2tncm91bmRfX2JnJyksIHtcbiAgICAgICAgICB5OiAwLFxuICAgICAgICAgIHNjYWxlOiAxXG4gICAgICAgIH0sIDApO1xuICAgICAgICBmZWF0dXJlVGltZWxpbmUudG8oX3RoaXMyLiRmZWF0dXJlc0l0ZW1zW2ldLnF1ZXJ5U2VsZWN0b3IoJy5iYWNrZ3JvdW5kX19tYXNrJyksIHtcbiAgICAgICAgICBvcGFjaXR5OiAwLjAwMDEsXG4gICAgICAgICAgZHVyYXRpb246IDAuNVxuICAgICAgICB9LCAwKTtcblxuICAgICAgICBfdGhpczIuZmVhdHVyZXNUaW1lbGluZXMucHVzaChmZWF0dXJlVGltZWxpbmUpO1xuICAgICAgfTtcblxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLiRmZWF0dXJlc0l0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIF9sb29wKGkpO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJyYWZcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmFmKCkge30gLy8gZXNsaW50LWRpc2FibGUtbGluZVxuXG4gIH1dKTtcblxuICByZXR1cm4gUmVuZGVyZXJNYXN0ZXJ3b3Jrcztcbn0oUmVuZGVyZXIpOyAvLyBEb25gdCBmb3JnZXQgdG8gZXhwb3J0IHlvdXIgcmVuZGVyZXJcblxuXG5leHBvcnQgZGVmYXVsdCBSZW5kZXJlck1hc3RlcndvcmtzOyIsImZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IFwiQGJhYmVsL2hlbHBlcnMgLSB0eXBlb2ZcIjsgaWYgKHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiKSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfTsgfSBlbHNlIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfVxuXG5mdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb25cIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfVxuXG5mdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfVxuXG5mdW5jdGlvbiBfY3JlYXRlU3VwZXIoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKTsgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkgeyB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksIHJlc3VsdDsgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHsgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjsgcmVzdWx0ID0gUmVmbGVjdC5jb25zdHJ1Y3QoU3VwZXIsIGFyZ3VtZW50cywgTmV3VGFyZ2V0KTsgfSBlbHNlIHsgcmVzdWx0ID0gU3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfSByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTsgfTsgfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpKSB7IHJldHVybiBjYWxsOyB9IGVsc2UgaWYgKGNhbGwgIT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRGVyaXZlZCBjb25zdHJ1Y3RvcnMgbWF5IG9ubHkgcmV0dXJuIG9iamVjdCBvciB1bmRlZmluZWRcIik7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH1cblxuZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSB7IGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJ1bmRlZmluZWRcIiB8fCAhUmVmbGVjdC5jb25zdHJ1Y3QpIHJldHVybiBmYWxzZTsgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTsgaWYgKHR5cGVvZiBQcm94eSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gdHJ1ZTsgdHJ5IHsgQm9vbGVhbi5wcm90b3R5cGUudmFsdWVPZi5jYWxsKFJlZmxlY3QuY29uc3RydWN0KEJvb2xlYW4sIFtdLCBmdW5jdGlvbiAoKSB7fSkpOyByZXR1cm4gdHJ1ZTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2U7IH0gfVxuXG5mdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9XG5cbi8vIEdzYXBcbmltcG9ydCBnc2FwIGZyb20gJ2dzYXAnO1xuaW1wb3J0IFNjcm9sbFRyaWdnZXIgZnJvbSAnZ3NhcC9TY3JvbGxUcmlnZ2VyJztcbmdzYXAucmVnaXN0ZXJQbHVnaW4oU2Nyb2xsVHJpZ2dlcik7IC8vIEltcG9ydCBSZW5kZXJlclxuXG5pbXBvcnQgUmVuZGVyZXIgZnJvbSAnLi9yZW5kZXJlci5qcyc7IC8vIGltcG9ydCBzdHlsZXNEZWZhdWx0IGZyb20gJy4vc3R5bGVzRGVmYXVsdC5jc3MnOyAvL2VzbGludC1kaXNhYmxlLWxpbmVcbi8vIFV0aWxpdGllc1xuXG5pbXBvcnQgRG9tRXZlbnRzIGZyb20gJy4uL2NsYXNzZXMvZG9tRXZlbnRzJztcbmltcG9ydCBTdXBlclNjcm9sbGVyIGZyb20gJy4uL2NsYXNzZXMvc3VwZXJTY3JvbGxlcic7IC8vIE90aGVyXG4vLyBpbXBvcnQgU2xpZGVyIGZyb20gJy4uL2NsYXNzZXMvc2xpZGVyJztcblxuaW1wb3J0IFNwbGl0VGV4dCBmcm9tICcuLi9jbGFzc2VzL3NwbGl0VGV4dCc7XG5cbnZhciBSZW5kZXJlckJsb2cgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9SZW5kZXJlcikge1xuICBfaW5oZXJpdHMoUmVuZGVyZXJCbG9nLCBfUmVuZGVyZXIpO1xuXG4gIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoUmVuZGVyZXJCbG9nKTtcblxuICBmdW5jdGlvbiBSZW5kZXJlckJsb2coKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJlbmRlcmVyQmxvZyk7XG5cbiAgICByZXR1cm4gX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoUmVuZGVyZXJCbG9nLCBbe1xuICAgIGtleTogXCJzZWxlY3RvcnNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2VsZWN0b3JzKCkge1xuICAgICAgdGhpcy4kbGlzdCA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3IoJy5ibG9nX19saXN0Jyk7XG5cbiAgICAgIGlmICh0aGlzLiRsaXN0KSB7XG4gICAgICAgIHRoaXMuJGxpc3RGaWx0ZXIgPSB0aGlzLiRsaXN0LnF1ZXJ5U2VsZWN0b3IoJy5maWx0ZXInKTtcbiAgICAgICAgdGhpcy4kbGlzdEZpbHRlclRyaWdnZXIgPSB0aGlzLiRsaXN0LnF1ZXJ5U2VsZWN0b3IoJy5maWx0ZXJfX3RyaWdnZXInKTtcbiAgICAgICAgdGhpcy4kbGlzdEZpbHRlcklubmVyID0gdGhpcy4kbGlzdC5xdWVyeVNlbGVjdG9yKCcuZmlsdGVyX19pbm5lcicpO1xuICAgICAgICB0aGlzLiRsaXN0RmlsdGVySXRlbXMgPSB0aGlzLiRsaXN0LnF1ZXJ5U2VsZWN0b3JBbGwoJy5maWx0ZXJfX2l0ZW0nKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiYmVmb3JlRW50ZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gYmVmb3JlRW50ZXIoKSB7XG4gICAgICB0aGlzLnNldFBvc3RzKCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImVudGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGVudGVyKCkge1xuICAgICAgdGhpcy5pbml0UG9zdHMoKTtcbiAgICAgIGlmICh0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCkgdGhpcy5waW5GaWx0ZXIoKTtlbHNlIHRoaXMuaW5pdEZpbHRlcigpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJpbml0RmlsdGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRGaWx0ZXIoKSB7XG4gICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICB0aGlzLmZpbHRlciA9IHtcbiAgICAgICAgaXNPcGVuOiBmYWxzZVxuICAgICAgfTtcbiAgICAgIGdzYXAuc2V0KHRoaXMuJGxpc3RGaWx0ZXJJbm5lciwge1xuICAgICAgICBvcGFjaXR5OiAwLjAwMDFcbiAgICAgIH0pO1xuXG4gICAgICBpZiAodGhpcy4kbGlzdEZpbHRlclRyaWdnZXIpIHtcbiAgICAgICAgdGhpcy5kb21FdmVudHMuYWRkKHRoaXMuJGxpc3RGaWx0ZXJUcmlnZ2VyLCAnY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKF90aGlzLmZpbHRlci5pc09wZW4pIF90aGlzLmhpZGVGaWx0ZXIoKTtlbHNlIF90aGlzLnNob3dGaWx0ZXIoKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInNob3dGaWx0ZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2hvd0ZpbHRlcigpIHtcbiAgICAgIGdzYXAudG8odGhpcy4kbGlzdEZpbHRlcklubmVyLCB7XG4gICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgIGVhc2U6ICdwb3dlMi5vdXQnLFxuICAgICAgICBkdXJhdGlvbjogMC4yXG4gICAgICB9KTtcbiAgICAgIHRoaXMuZmlsdGVyLmlzT3BlbiA9IHRydWU7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImhpZGVGaWx0ZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaGlkZUZpbHRlcigpIHtcbiAgICAgIGdzYXAudG8odGhpcy4kbGlzdEZpbHRlcklubmVyLCB7XG4gICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgZWFzZTogJ3Bvd2UyLm91dCcsXG4gICAgICAgIGR1cmF0aW9uOiAwLjJcbiAgICAgIH0pO1xuICAgICAgdGhpcy5maWx0ZXIuaXNPcGVuID0gZmFsc2U7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInBpbkZpbHRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBwaW5GaWx0ZXIoKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgaWYgKHRoaXMuJGxpc3RGaWx0ZXIpIHtcbiAgICAgICAgdmFyIG9mZnNldCA9IHRoaXMuJGxpc3QuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0IC0gKHRoaXMuJGxpc3RGaWx0ZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0ICsgd2luZG93LmlubmVyV2lkdGggKiAwLjIwKTtcbiAgICAgICAgdGhpcy5zdXBlclRyaWdnZXIuY3JlYXRlKHtcbiAgICAgICAgICB0cmlnZ2VyOiB0aGlzLiRsaXN0LFxuICAgICAgICAgIHN0YXJ0OiAndG9wIHRvcCcsXG4gICAgICAgICAgZW5kOiAnYm90dG9tICcgKyAodGhpcy4kbGlzdEZpbHRlci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQgKyB3aW5kb3cuaW5uZXJXaWR0aCAqIDAuMjApICsgJ3B4JyxcbiAgICAgICAgICBzY3J1YjogdHJ1ZSxcbiAgICAgICAgICBvblVwZGF0ZTogZnVuY3Rpb24gb25VcGRhdGUoc2VsZikge1xuICAgICAgICAgICAgZ3NhcC5zZXQoX3RoaXMyLiRsaXN0RmlsdGVyLCB7XG4gICAgICAgICAgICAgIHk6IG9mZnNldCAqIHNlbGYucHJvZ3Jlc3NcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInNldFBvc3RzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNldFBvc3RzKCkge1xuICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgIHRoaXMuJHBvc3RzID0gdGhpcy4kZWwucXVlcnlTZWxlY3RvckFsbCgnLnBvc3QnKTtcblxuICAgICAgaWYgKHRoaXMuJHBvc3RzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy4kcG9zdHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAvLyBTZXQgZWxcbiAgICAgICAgICBpZiAodGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHtcbiAgICAgICAgICAgIGdzYXAuc2V0KHRoaXMuJHBvc3RzW2ldLnF1ZXJ5U2VsZWN0b3IoJy5pbWFnZSBpbWcnKSwge1xuICAgICAgICAgICAgICBzY2FsZTogMS4xXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuZG9tRXZlbnRzLmFkZCh0aGlzLiRwb3N0c1tpXSwgJ21vdXNlZW50ZXInLCBmdW5jdGlvbiAoZSwgYSwgZWwpIHtcbiAgICAgICAgICAgICAgX3RoaXMzLmVudGVyUG9zdChlLCBhLCBlbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuZG9tRXZlbnRzLmFkZCh0aGlzLiRwb3N0c1tpXSwgJ21vdXNlbGVhdmUnLCBmdW5jdGlvbiAoZSwgYSwgZWwpIHtcbiAgICAgICAgICAgICAgX3RoaXMzLmxlYXZlUG9zdChlLCBhLCBlbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IC8vIFNldCB0aXRsZXNcblxuXG4gICAgICAgICAgdmFyICR0aXRsZSA9IHRoaXMuJHBvc3RzW2ldLnF1ZXJ5U2VsZWN0b3IoJy50aXRsZScpO1xuICAgICAgICAgIHZhciBzcGxpdCA9IG5ldyBTcGxpdFRleHQoJHRpdGxlLCB7XG4gICAgICAgICAgICB0eXBlOiAnbGluZXMsIHdvcmRzJyxcbiAgICAgICAgICAgIGxpbmVzQ2xhc3M6ICdsaW5lIGxpbmUtLSsrJyxcbiAgICAgICAgICAgIHdvcmRzQ2xhc3M6ICd3b3JkIHdvcmQtLSsrJyxcbiAgICAgICAgICAgIGNoYXJzQ2xhc3M6ICdjaGFyIGNoYXItLSsrJ1xuICAgICAgICAgIH0pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG5cbiAgICAgICAgICAkdGl0bGUuY2xhc3NMaXN0LmFkZCgnc3BsaXQnKTtcbiAgICAgICAgICB0aGlzLnNwbGl0VGV4dHMucHVzaChzcGxpdCk7XG4gICAgICAgICAgdmFyIGxpbmVzID0gJHRpdGxlLnF1ZXJ5U2VsZWN0b3JBbGwoJy5saW5lJyk7XG5cbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGxpbmVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICBnc2FwLnNldChsaW5lc1tqXSwge1xuICAgICAgICAgICAgICBvcGFjaXR5OiAwLjAwMDEsXG4gICAgICAgICAgICAgIHk6ICcxMDAlJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSAvLyBTZXQgbGlua1xuXG5cbiAgICAgICAgICB2YXIgJGxpbmsgPSB0aGlzLiRwb3N0c1tpXS5xdWVyeVNlbGVjdG9yKCcubGluaycpO1xuICAgICAgICAgIGdzYXAuc2V0KCRsaW5rLCB7XG4gICAgICAgICAgICB5OiAnMTAwJScsXG4gICAgICAgICAgICBvcGFjaXR5OiAwLjAwMDFcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBnc2FwLnNldCgkbGluay5jaGlsZHJlblswXSwge1xuICAgICAgICAgICAgb3BhY2l0eTogMC4wMDAxXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZ3NhcC5zZXQoJGxpbmsucXVlcnlTZWxlY3Rvcignc3ZnJyksIHtcbiAgICAgICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgICAgIHJvdGF0aW9uOiAnNDUwZGVnJ1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGdzYXAuc2V0KCRsaW5rLnF1ZXJ5U2VsZWN0b3IoJ3N2ZyBjaXJjbGUnKSwge1xuICAgICAgICAgICAgc3Ryb2tlRGFzaG9mZnNldDogJzExODEuMjRweCdcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJpbml0UG9zdHNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdFBvc3RzKCkge1xuICAgICAgdmFyIF90aGlzNCA9IHRoaXM7XG5cbiAgICAgIGlmICh0aGlzLiRwb3N0cykge1xuICAgICAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcChpKSB7XG4gICAgICAgICAgdmFyIF9kZWxheSA9IGkgJSAyID8gMCA6IDAuMTtcblxuICAgICAgICAgIHZhciBzY3JvbGx0cmlnZ2VyID0gU2Nyb2xsVHJpZ2dlci5jcmVhdGUoe1xuICAgICAgICAgICAgdHJpZ2dlcjogX3RoaXM0LiRwb3N0c1tpXSxcbiAgICAgICAgICAgIHN0YXJ0OiAnY2VudGVyIGJvdHRvbScsXG4gICAgICAgICAgICBvbmNlOiB0cnVlLFxuICAgICAgICAgICAgb25FbnRlcjogZnVuY3Rpb24gb25FbnRlcigpIHtcbiAgICAgICAgICAgICAgLy8gVHJpZ2dlciBlbFxuICAgICAgICAgICAgICAvL2dzYXAudG8odGhpcy4kcG9zdHNbaV0sIHsgb3BhY2l0eTogMSwgeTogJzAlJywgZWFzZTogJ2V4cG8ub3V0JywgZHVyYXRpb246IDIsIGRlbGF5OiBfZGVsYXkgfSk7XG4gICAgICAgICAgICAgIC8vIFRyaWdnZXIgdGl0bGVzXG4gICAgICAgICAgICAgIHZhciAkdGl0bGUgPSBfdGhpczQuJHBvc3RzW2ldLnF1ZXJ5U2VsZWN0b3IoJy50aXRsZScpO1xuXG4gICAgICAgICAgICAgIHZhciBsaW5lcyA9ICR0aXRsZS5xdWVyeVNlbGVjdG9yQWxsKCcubGluZScpO1xuXG4gICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbGluZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBnc2FwLnRvKGxpbmVzW2pdLCB7XG4gICAgICAgICAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgICAgICAgICAgeTogJzAlJyxcbiAgICAgICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMixcbiAgICAgICAgICAgICAgICAgIGRlbGF5OiBqICogMC4xICsgX2RlbGF5XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0gLy8gVHJpZ2dlciBsaW5rc1xuXG5cbiAgICAgICAgICAgICAgdmFyICRsaW5rID0gX3RoaXM0LiRwb3N0c1tpXS5xdWVyeVNlbGVjdG9yKCcubGluaycpO1xuXG4gICAgICAgICAgICAgIGdzYXAudG8oJGxpbmssIHtcbiAgICAgICAgICAgICAgICB5OiAwLFxuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDIsXG4gICAgICAgICAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgICAgICAgICBkZWxheTogX2RlbGF5XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBnc2FwLnRvKCRsaW5rLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogMixcbiAgICAgICAgICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICAgICAgICAgIGRlbGF5OiBfZGVsYXlcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGdzYXAudG8oJGxpbmsucXVlcnlTZWxlY3Rvcignc3ZnJyksIHtcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgICAgICAgIHJvdGF0aW9uOiAnMCcsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDIsXG4gICAgICAgICAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgICAgICAgICBkZWxheTogX2RlbGF5XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBnc2FwLnRvKCRsaW5rLnF1ZXJ5U2VsZWN0b3IoJ3N2ZyBjaXJjbGUnKSwge1xuICAgICAgICAgICAgICAgIHN0cm9rZURhc2hvZmZzZXQ6ICcwcHgnLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAyLFxuICAgICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgICAgICAgICAgZGVsYXk6IF9kZWxheVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuJHBvc3RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgX2xvb3AoaSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiZW50ZXJQb3N0XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGVudGVyUG9zdChlLCBhLCBlbCkge1xuICAgICAgZ3NhcC50byhlbC5xdWVyeVNlbGVjdG9yKCcuaW1hZ2UgaW1nJyksIHtcbiAgICAgICAgc2NhbGU6IDEsXG4gICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgIGR1cmF0aW9uOiAwLjZcbiAgICAgIH0pO1xuICAgICAgZ3NhcC5raWxsVHdlZW5zT2YoW2VsLnF1ZXJ5U2VsZWN0b3IoJ3N2ZycpLCBlbC5xdWVyeVNlbGVjdG9yKCdzdmcgY2lyY2xlJyldKTtcbiAgICAgIGdzYXAudG8oZWwucXVlcnlTZWxlY3Rvcignc3ZnJyksIHtcbiAgICAgICAgcm90YXRpb246ICc0NTBkZWcnLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICBkdXJhdGlvbjogMC44XG4gICAgICB9KTtcbiAgICAgIGdzYXAudG8oZWwucXVlcnlTZWxlY3Rvcignc3ZnIGNpcmNsZScpLCB7XG4gICAgICAgIHN0cm9rZURhc2hvZmZzZXQ6ICcxMTgxLjI0cHgnLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICBkdXJhdGlvbjogMC44XG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwibGVhdmVQb3N0XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGxlYXZlUG9zdChlLCBhLCBlbCkge1xuICAgICAgZ3NhcC50byhlbC5xdWVyeVNlbGVjdG9yKCcuaW1hZ2UgaW1nJyksIHtcbiAgICAgICAgc2NhbGU6IDEuMSxcbiAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgZHVyYXRpb246IDAuNlxuICAgICAgfSk7XG4gICAgICBnc2FwLmtpbGxUd2VlbnNPZihbZWwucXVlcnlTZWxlY3Rvcignc3ZnJyksIGVsLnF1ZXJ5U2VsZWN0b3IoJ3N2ZyBjaXJjbGUnKV0pO1xuICAgICAgZ3NhcC50byhlbC5xdWVyeVNlbGVjdG9yKCdzdmcnKSwge1xuICAgICAgICByb3RhdGlvbjogJzBkZWcnLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICBkdXJhdGlvbjogMC44XG4gICAgICB9KTtcbiAgICAgIGdzYXAudG8oZWwucXVlcnlTZWxlY3Rvcignc3ZnIGNpcmNsZScpLCB7XG4gICAgICAgIHN0cm9rZURhc2hvZmZzZXQ6ICcwcHgnLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnLFxuICAgICAgICBkdXJhdGlvbjogMC44XG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmFmXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJhZigpIHt9IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcblxuICB9XSk7XG5cbiAgcmV0dXJuIFJlbmRlcmVyQmxvZztcbn0oUmVuZGVyZXIpOyAvLyBEb25gdCBmb3JnZXQgdG8gZXhwb3J0IHlvdXIgcmVuZGVyZXJcblxuXG5leHBvcnQgZGVmYXVsdCBSZW5kZXJlckJsb2c7IiwiZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgXCJAYmFiZWwvaGVscGVycyAtIHR5cGVvZlwiOyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2Yob2JqKTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvblwiKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9XG5cbmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVTdXBlcihEZXJpdmVkKSB7IHZhciBoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0ID0gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpOyByZXR1cm4gZnVuY3Rpb24gX2NyZWF0ZVN1cGVySW50ZXJuYWwoKSB7IHZhciBTdXBlciA9IF9nZXRQcm90b3R5cGVPZihEZXJpdmVkKSwgcmVzdWx0OyBpZiAoaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCkgeyB2YXIgTmV3VGFyZ2V0ID0gX2dldFByb3RvdHlwZU9mKHRoaXMpLmNvbnN0cnVjdG9yOyByZXN1bHQgPSBSZWZsZWN0LmNvbnN0cnVjdChTdXBlciwgYXJndW1lbnRzLCBOZXdUYXJnZXQpOyB9IGVsc2UgeyByZXN1bHQgPSBTdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9IHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCByZXN1bHQpOyB9OyB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikpIHsgcmV0dXJuIGNhbGw7IH0gZWxzZSBpZiAoY2FsbCAhPT0gdm9pZCAwKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJEZXJpdmVkIGNvbnN0cnVjdG9ycyBtYXkgb25seSByZXR1cm4gb2JqZWN0IG9yIHVuZGVmaW5lZFwiKTsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfVxuXG5mdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIHNlbGY7IH1cblxuZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcInVuZGVmaW5lZFwiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiB0cnVlOyB0cnkgeyBCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoQm9vbGVhbiwgW10sIGZ1bmN0aW9uICgpIHt9KSk7IHJldHVybiB0cnVlOyB9IGNhdGNoIChlKSB7IHJldHVybiBmYWxzZTsgfSB9XG5cbmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH1cblxuLy8gR3NhcFxuaW1wb3J0IGdzYXAgZnJvbSAnZ3NhcCc7XG5pbXBvcnQgU2Nyb2xsVHJpZ2dlciBmcm9tICdnc2FwL1Njcm9sbFRyaWdnZXInO1xuZ3NhcC5yZWdpc3RlclBsdWdpbihTY3JvbGxUcmlnZ2VyKTsgLy8gSW1wb3J0IFJlbmRlcmVyXG5cbmltcG9ydCBSZW5kZXJlciBmcm9tICcuL3JlbmRlcmVyLmpzJzsgLy8gaW1wb3J0IHN0eWxlc0RlZmF1bHQgZnJvbSAnLi9zdHlsZXNEZWZhdWx0LmNzcyc7IC8vZXNsaW50LWRpc2FibGUtbGluZVxuLy8gVXRpbGl0aWVzXG5cbmltcG9ydCBEb21FdmVudHMgZnJvbSAnLi4vY2xhc3Nlcy9kb21FdmVudHMnO1xuaW1wb3J0IFN1cGVyU2Nyb2xsZXIgZnJvbSAnLi4vY2xhc3Nlcy9zdXBlclNjcm9sbGVyJztcbmltcG9ydCBEcmFnZ2FibGUgZnJvbSAnLi4vY2xhc3Nlcy9EcmFnZ2FibGUnOyAvLyBPdGhlclxuLy8gaW1wb3J0IFNsaWRlciBmcm9tICcuLi9jbGFzc2VzL3NsaWRlcic7XG4vLyBpbXBvcnQgU3BsaXRUZXh0IGZyb20gJy4uL2NsYXNzZXMvc3BsaXRUZXh0JztcblxudmFyIFJlbmRlcmVyQmxvZ1NpbmdsZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1JlbmRlcmVyKSB7XG4gIF9pbmhlcml0cyhSZW5kZXJlckJsb2dTaW5nbGUsIF9SZW5kZXJlcik7XG5cbiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihSZW5kZXJlckJsb2dTaW5nbGUpO1xuXG4gIGZ1bmN0aW9uIFJlbmRlcmVyQmxvZ1NpbmdsZSgpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUmVuZGVyZXJCbG9nU2luZ2xlKTtcblxuICAgIHJldHVybiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuXG4gIF9jcmVhdGVDbGFzcyhSZW5kZXJlckJsb2dTaW5nbGUsIFt7XG4gICAga2V5OiBcInNlbGVjdG9yc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzZWxlY3RvcnMoKSB7XG4gICAgICB0aGlzLiRmbGV4ID0gdGhpcy4kZWwucXVlcnlTZWxlY3RvcignLmJsb2dzaW5nbGVfX2ZsZXgnKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiZXZlbnRzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGV2ZW50cygpIHt9IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcblxuICB9LCB7XG4gICAga2V5OiBcImJlZm9yZUVudGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGJlZm9yZUVudGVyKCkge30gLy8gZXNsaW50LWRpc2FibGUtbGluZVxuXG4gIH0sIHtcbiAgICBrZXk6IFwiZW50ZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZW50ZXIoKSB7XG4gICAgICB0aGlzLmluaXRHYWxsZXJpZXMoKTtcbiAgICAgIHRoaXMuaW5pdFZpZGVvcygpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJpbml0R2FsbGVyaWVzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRHYWxsZXJpZXMoKSB7XG4gICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICB0aGlzLmdhbGxlcmllcyA9IFtdO1xuICAgICAgdGhpcy4kZ2FsbGVyaWVzID0gdGhpcy4kZmxleC5xdWVyeVNlbGVjdG9yQWxsKCcuZ2FsbGVyeScpO1xuXG4gICAgICBpZiAodGhpcy4kZ2FsbGVyaWVzKSB7XG4gICAgICAgIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKGkpIHtcbiAgICAgICAgICB2YXIgaW1hZ2VzID0gX3RoaXMuJGdhbGxlcmllc1swXS5xdWVyeVNlbGVjdG9yQWxsKCcuaW1hZ2UnKTtcblxuICAgICAgICAgIHZhciByYXRpbyA9IGltYWdlc1swXS5zdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCctLWFzcGVjdHJhdGlvJyk7XG4gICAgICAgICAgaWYgKF90aGlzLmFwcFN0b3JlLmlzRGVza3RvcCkgZ3NhcC5zZXQoX3RoaXMuJGdhbGxlcmllc1tpXSwge1xuICAgICAgICAgICAgd2lkdGg6IDMwICogcmF0aW8gKyAndncnXG4gICAgICAgICAgfSk7ZWxzZSBnc2FwLnNldChfdGhpcy4kZ2FsbGVyaWVzW2ldLCB7XG4gICAgICAgICAgICB3aWR0aDogNzAgKiByYXRpbyArICd2dydcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB2YXIgZ2FsbGVyeSA9IG5ldyBEcmFnZ2FibGUoe1xuICAgICAgICAgICAgdGFyZ2V0OiBfdGhpcy4kZ2FsbGVyaWVzW2ldLFxuICAgICAgICAgICAgdGFyZ2V0SW5uZXI6IF90aGlzLiRnYWxsZXJpZXNbaV0uY2hpbGRyZW5bMF0sXG4gICAgICAgICAgICBvbkRyYWc6IGZ1bmN0aW9uIG9uRHJhZygpIHtcbiAgICAgICAgICAgICAgZ3NhcC50byhfdGhpcy4kZ2FsbGVyaWVzW2ldLmNoaWxkcmVuWzFdLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgICAgICAgICAgc2NhbGVYOiBfdGhpcy5nYWxsZXJpZXNbaV0uZHJhZ2dhYmxlWzBdLnggLyBfdGhpcy5nYWxsZXJpZXNbaV0uZHJhZ2dhYmxlWzBdLm1pblhcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBfdGhpcy5nYWxsZXJpZXMucHVzaChnYWxsZXJ5KTtcbiAgICAgICAgfTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuJGdhbGxlcmllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIF9sb29wKGkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImluaXRWaWRlb3NcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdFZpZGVvcygpIHtcbiAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICB0aGlzLnZpZGVvcyA9IFtdO1xuICAgICAgdGhpcy4kdmlkZW9zID0gdGhpcy4kZmxleC5xdWVyeVNlbGVjdG9yQWxsKCcudmlkZW8nKTtcblxuICAgICAgaWYgKHRoaXMuJHZpZGVvcykge1xuICAgICAgICB2YXIgX2xvb3AyID0gZnVuY3Rpb24gX2xvb3AyKGkpIHtcbiAgICAgICAgICBfdGhpczIuZG9tRXZlbnRzLmFkZChfdGhpczIuJHZpZGVvc1tpXS5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX3RyaWdnZXInKSwgJ2NsaWNrJywgZnVuY3Rpb24gKGUsIGEsIGVsKSB7XG4gICAgICAgICAgICBnc2FwLnRvKF90aGlzMi4kdmlkZW9zW2ldLnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fb3ZlcmxheScpLCB7XG4gICAgICAgICAgICAgIG9wYWNpdHk6IDAuMDAwMSxcbiAgICAgICAgICAgICAgZWFzZTogJ2V4cG8ub3V0JyxcbiAgICAgICAgICAgICAgZHVyYXRpb246IDAuOFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBnc2FwLnRvKF90aGlzMi4kdmlkZW9zW2ldLnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fdHJpZ2dlcicpLCB7XG4gICAgICAgICAgICAgIHNjYWxlOiAwLFxuICAgICAgICAgICAgICBvcGFjaXR5OiAwLjAwMDEsXG4gICAgICAgICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgICAgICAgIGR1cmF0aW9uOiAwLjhcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgX3RoaXMyLiR2aWRlb3NbaV0ucXVlcnlTZWxlY3RvcignLnZpZGVvX19wbGF5ZXInKS5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ2FsbCc7XG5cbiAgICAgICAgICAgIF90aGlzMi4kdmlkZW9zW2ldLnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fcGxheWVyIHZpZGVvJykuc2V0QXR0cmlidXRlKCdjb250cm9scycsICdjb250cm9scycpO1xuXG4gICAgICAgICAgICBfdGhpczIuJHZpZGVvc1tpXS5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX3BsYXllciB2aWRlbycpLnBsYXkoKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuJHZpZGVvcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIF9sb29wMihpKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJyYWZcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmFmKCkge30gLy8gZXNsaW50LWRpc2FibGUtbGluZVxuXG4gIH1dKTtcblxuICByZXR1cm4gUmVuZGVyZXJCbG9nU2luZ2xlO1xufShSZW5kZXJlcik7IC8vIERvbmB0IGZvcmdldCB0byBleHBvcnQgeW91ciByZW5kZXJlclxuXG5cbmV4cG9ydCBkZWZhdWx0IFJlbmRlcmVyQmxvZ1NpbmdsZTsiLCJmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyBcIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mXCI7IGlmICh0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uXCIpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7IH1cblxuZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH1cblxuZnVuY3Rpb24gX2NyZWF0ZVN1cGVyKERlcml2ZWQpIHsgdmFyIGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QgPSBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCk7IHJldHVybiBmdW5jdGlvbiBfY3JlYXRlU3VwZXJJbnRlcm5hbCgpIHsgdmFyIFN1cGVyID0gX2dldFByb3RvdHlwZU9mKERlcml2ZWQpLCByZXN1bHQ7IGlmIChoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KSB7IHZhciBOZXdUYXJnZXQgPSBfZ2V0UHJvdG90eXBlT2YodGhpcykuY29uc3RydWN0b3I7IHJlc3VsdCA9IFJlZmxlY3QuY29uc3RydWN0KFN1cGVyLCBhcmd1bWVudHMsIE5ld1RhcmdldCk7IH0gZWxzZSB7IHJlc3VsdCA9IFN1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IH0gcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIHJlc3VsdCk7IH07IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSkgeyByZXR1cm4gY2FsbDsgfSBlbHNlIGlmIChjYWxsICE9PSB2b2lkIDApIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkRlcml2ZWQgY29uc3RydWN0b3JzIG1heSBvbmx5IHJldHVybiBvYmplY3Qgb3IgdW5kZWZpbmVkXCIpOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9XG5cbmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gc2VsZjsgfVxuXG5mdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkgeyBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwidW5kZWZpbmVkXCIgfHwgIVJlZmxlY3QuY29uc3RydWN0KSByZXR1cm4gZmFsc2U7IGlmIChSZWZsZWN0LmNvbnN0cnVjdC5zaGFtKSByZXR1cm4gZmFsc2U7IGlmICh0eXBlb2YgUHJveHkgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIHRydWU7IHRyeSB7IEJvb2xlYW4ucHJvdG90eXBlLnZhbHVlT2YuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChCb29sZWFuLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgcmV0dXJuIHRydWU7IH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlOyB9IH1cblxuZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfVxuXG4vLyBHc2FwXG5pbXBvcnQgZ3NhcCBmcm9tICdnc2FwJztcbmltcG9ydCBTY3JvbGxUcmlnZ2VyIGZyb20gJ2dzYXAvU2Nyb2xsVHJpZ2dlcic7XG5nc2FwLnJlZ2lzdGVyUGx1Z2luKFNjcm9sbFRyaWdnZXIpOyAvLyBJbXBvcnQgUmVuZGVyZXJcblxuaW1wb3J0IFJlbmRlcmVyIGZyb20gJy4vcmVuZGVyZXIuanMnOyAvLyBpbXBvcnQgc3R5bGVzRGVmYXVsdCBmcm9tICcuL3N0eWxlc0RlZmF1bHQuY3NzJzsgLy9lc2xpbnQtZGlzYWJsZS1saW5lXG4vLyBVdGlsaXRpZXNcblxuaW1wb3J0IERvbUV2ZW50cyBmcm9tICcuLi9jbGFzc2VzL2RvbUV2ZW50cyc7XG5pbXBvcnQgU3VwZXJTY3JvbGxlciBmcm9tICcuLi9jbGFzc2VzL3N1cGVyU2Nyb2xsZXInOyAvLyBPdGhlclxuLy8gaW1wb3J0IFNsaWRlciBmcm9tICcuLi9jbGFzc2VzL3NsaWRlcic7XG4vLyBpbXBvcnQgU3BsaXRUZXh0IGZyb20gJy4uL2NsYXNzZXMvc3BsaXRUZXh0JztcblxudmFyIFJlbmRlcmVyQ29udGFjdCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1JlbmRlcmVyKSB7XG4gIF9pbmhlcml0cyhSZW5kZXJlckNvbnRhY3QsIF9SZW5kZXJlcik7XG5cbiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihSZW5kZXJlckNvbnRhY3QpO1xuXG4gIGZ1bmN0aW9uIFJlbmRlcmVyQ29udGFjdCgpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUmVuZGVyZXJDb250YWN0KTtcblxuICAgIHJldHVybiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuXG4gIF9jcmVhdGVDbGFzcyhSZW5kZXJlckNvbnRhY3QsIFt7XG4gICAga2V5OiBcInNlbGVjdG9yc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzZWxlY3RvcnMoKSB7XG4gICAgICB0aGlzLiRoZXJvID0gdGhpcy4kZWwucXVlcnlTZWxlY3RvcignLmNvbnRhY3RfX2hlcm8nKTtcblxuICAgICAgaWYgKHRoaXMuJGhlcm8pIHtcbiAgICAgICAgdGhpcy4kaGVyb1BpbiA9IHRoaXMuJGhlcm8ucXVlcnlTZWxlY3RvcignLnN1YmNvbHVtbnNfX2l0ZW0tLXBpbicpO1xuICAgICAgICB0aGlzLiRoZXJvRml4ID0gdGhpcy4kaGVyby5xdWVyeVNlbGVjdG9yKCcuc3ViY29sdW1uc19faXRlbS0tZml4Jyk7XG4gICAgICAgIHRoaXMuJGhlcm9QYXJhbGxheCA9IHRoaXMuJGhlcm8ucXVlcnlTZWxlY3RvcignLnN1YmNvbHVtbnNfX2l0ZW0tLXBhcmFsbGF4Jyk7XG4gICAgICB9XG4gICAgfSAvLyBwcmVsb2FkKClcbiAgICAvLyB7XG4gICAgLy8gICAgIC8vIFByZWxvYWRlclxuICAgIC8vICAgICBjb25zdCBfbWFpbiA9IFtdO1xuICAgIC8vICAgICBjb25zdCBfc2Vjb25kYXJ5ID0gW107XG4gICAgLy8gICAgIHRoaXMucHJlbG9hZEl0ZW1zID0ge1xuICAgIC8vICAgICAgICAgbWFpbjogX21haW4sXG4gICAgLy8gICAgICAgICBzZWNvbmRhcnk6IF9zZWNvbmRhcnlcbiAgICAvLyAgICAgfTtcbiAgICAvLyB9XG5cbiAgfSwge1xuICAgIGtleTogXCJldmVudHNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZXZlbnRzKCkge30gLy8gZXNsaW50LWRpc2FibGUtbGluZVxuXG4gIH0sIHtcbiAgICBrZXk6IFwiYmVmb3JlRW50ZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gYmVmb3JlRW50ZXIoKSB7fSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG5cbiAgfSwge1xuICAgIGtleTogXCJlbnRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBlbnRlcigpIHtcbiAgICAgIHRoaXMuYXBwVWkuJGluZm9Db250ZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJpbmZvLXN1YmplY3RcIl0nKS52YWx1ZSA9ICdJbmZvcm1hY2nDs24gZ2VuZXJhbCc7XG5cbiAgICAgIGlmICh0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCkge1xuICAgICAgICB0aGlzLnBpblNpZGViYXIoKTtcbiAgICAgICAgdGhpcy5wYXJhbGxheFNpZGViYXIoKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicGluU2lkZWJhclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBwaW5TaWRlYmFyKCkge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgaWYgKHRoaXMuJGhlcm9QaW4pIHtcbiAgICAgICAgdmFyIG9mZnNldCA9IHRoaXMuJGhlcm8uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0IC0gdGhpcy4kaGVyb1Bpbi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQgLSB0aGlzLiRoZXJvRml4LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCAtIHdpbmRvdy5pbm5lcldpZHRoICogMC4yNTtcbiAgICAgICAgdGhpcy5zdXBlclRyaWdnZXIuY3JlYXRlKHtcbiAgICAgICAgICB0cmlnZ2VyOiB0aGlzLiRoZXJvLFxuICAgICAgICAgIHN0YXJ0OiAndG9wIHRvcCcsXG4gICAgICAgICAgZW5kOiBvZmZzZXQgKyAncHggdG9wJyxcbiAgICAgICAgICBzY3J1YjogdHJ1ZSxcbiAgICAgICAgICBvblVwZGF0ZTogZnVuY3Rpb24gb25VcGRhdGUoc2VsZikge1xuICAgICAgICAgICAgZ3NhcC5zZXQoX3RoaXMuJGhlcm9QaW4sIHtcbiAgICAgICAgICAgICAgeTogb2Zmc2V0ICogc2VsZi5wcm9ncmVzc1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicGFyYWxsYXhTaWRlYmFyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHBhcmFsbGF4U2lkZWJhcigpIHtcbiAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICBpZiAodGhpcy4kaGVyb1BhcmFsbGF4KSB7XG4gICAgICAgIHZhciBvZmZzZXQgPSAtKHdpbmRvdy5pbm5lcldpZHRoICogMC4wNSk7XG4gICAgICAgIHRoaXMuc3VwZXJUcmlnZ2VyLmNyZWF0ZSh7XG4gICAgICAgICAgdHJpZ2dlcjogdGhpcy4kaGVybyxcbiAgICAgICAgICBzdGFydDogJ3RvcCB0b3AnLFxuICAgICAgICAgIGVuZDogJ2JvdHRvbSBib3R0b20nLFxuICAgICAgICAgIHNjcnViOiB0cnVlLFxuICAgICAgICAgIG9uVXBkYXRlOiBmdW5jdGlvbiBvblVwZGF0ZShzZWxmKSB7XG4gICAgICAgICAgICBnc2FwLnNldChfdGhpczIuJGhlcm9QYXJhbGxheCwge1xuICAgICAgICAgICAgICB5OiBvZmZzZXQgKiBzZWxmLnByb2dyZXNzXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJyYWZcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmFmKCkge30gLy8gZXNsaW50LWRpc2FibGUtbGluZVxuXG4gIH1dKTtcblxuICByZXR1cm4gUmVuZGVyZXJDb250YWN0O1xufShSZW5kZXJlcik7IC8vIERvbmB0IGZvcmdldCB0byBleHBvcnQgeW91ciByZW5kZXJlclxuXG5cbmV4cG9ydCBkZWZhdWx0IFJlbmRlcmVyQ29udGFjdDsiLCJmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyBcIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mXCI7IGlmICh0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uXCIpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7IH1cblxuZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH1cblxuZnVuY3Rpb24gX2NyZWF0ZVN1cGVyKERlcml2ZWQpIHsgdmFyIGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QgPSBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCk7IHJldHVybiBmdW5jdGlvbiBfY3JlYXRlU3VwZXJJbnRlcm5hbCgpIHsgdmFyIFN1cGVyID0gX2dldFByb3RvdHlwZU9mKERlcml2ZWQpLCByZXN1bHQ7IGlmIChoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KSB7IHZhciBOZXdUYXJnZXQgPSBfZ2V0UHJvdG90eXBlT2YodGhpcykuY29uc3RydWN0b3I7IHJlc3VsdCA9IFJlZmxlY3QuY29uc3RydWN0KFN1cGVyLCBhcmd1bWVudHMsIE5ld1RhcmdldCk7IH0gZWxzZSB7IHJlc3VsdCA9IFN1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IH0gcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIHJlc3VsdCk7IH07IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSkgeyByZXR1cm4gY2FsbDsgfSBlbHNlIGlmIChjYWxsICE9PSB2b2lkIDApIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkRlcml2ZWQgY29uc3RydWN0b3JzIG1heSBvbmx5IHJldHVybiBvYmplY3Qgb3IgdW5kZWZpbmVkXCIpOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9XG5cbmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gc2VsZjsgfVxuXG5mdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkgeyBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwidW5kZWZpbmVkXCIgfHwgIVJlZmxlY3QuY29uc3RydWN0KSByZXR1cm4gZmFsc2U7IGlmIChSZWZsZWN0LmNvbnN0cnVjdC5zaGFtKSByZXR1cm4gZmFsc2U7IGlmICh0eXBlb2YgUHJveHkgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIHRydWU7IHRyeSB7IEJvb2xlYW4ucHJvdG90eXBlLnZhbHVlT2YuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChCb29sZWFuLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgcmV0dXJuIHRydWU7IH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlOyB9IH1cblxuZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfVxuXG4vLyBBcHBcbmltcG9ydCBhcHBDb3JlIGZyb20gJy4uL2FwcC9hcHBDb3JlJztcbmltcG9ydCBhcHBTdG9yZSBmcm9tICcuLi9hcHAvYXBwU3RvcmUnO1xuaW1wb3J0IGFwcFVpIGZyb20gJy4uL2FwcC9hcHBVaSc7IC8vIEhpZ2h3YXlcblxuaW1wb3J0IEhpZ2h3YXkgZnJvbSAnQGRvZ3N0dWRpby9oaWdod2F5JzsgLy8gUHJlbG9hZFxuXG5pbXBvcnQgUHJlbG9hZCBmcm9tICdwcmVsb2FkLWl0JzsgLy8gR1NBUCBMaWJyYXJ5XG5cbmltcG9ydCBnc2FwIGZyb20gJ2dzYXAnO1xuaW1wb3J0IGdzYXBDb3JlIGZyb20gJ2dzYXAvZ3NhcC1jb3JlJzsgLy8gVHJhbnNpdGlvblxuXG52YXIgVHJhbnNpdGlvbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0hpZ2h3YXkkVHJhbnNpdGlvbikge1xuICBfaW5oZXJpdHMoVHJhbnNpdGlvbiwgX0hpZ2h3YXkkVHJhbnNpdGlvbik7XG5cbiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihUcmFuc2l0aW9uKTtcblxuICBmdW5jdGlvbiBUcmFuc2l0aW9uKCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUcmFuc2l0aW9uKTtcblxuICAgIHJldHVybiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuXG4gIF9jcmVhdGVDbGFzcyhUcmFuc2l0aW9uLCBbe1xuICAgIGtleTogXCJvdXRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gb3V0KF9yZWYpIHtcbiAgICAgIHZhciBmcm9tID0gX3JlZi5mcm9tLFxuICAgICAgICAgIGRvbmUgPSBfcmVmLmRvbmU7XG4gICAgICAvLyBTdG9yZVxuICAgICAgdGhpcy5hcHBTdG9yZSA9IGFwcFN0b3JlOyAvLyBBcHAgcmVmZXJlbmNlc1xuXG4gICAgICB0aGlzLmFwcENvcmUgPSBuZXcgYXBwQ29yZSgpO1xuICAgICAgdGhpcy5hcHBVaSA9IG5ldyBhcHBVaSgpO1xuICAgICAgaWYgKHRoaXMucHJlbG9hZE1haW4pIHRoaXMucHJlbG9hZE1haW4uY2FuY2VsKCk7XG4gICAgICBpZiAodGhpcy5wcmVsb2FkU2Vjb25kYXJ5KSB0aGlzLnByZWxvYWRTZWNvbmRhcnkuY2FuY2VsKCk7IC8vIE91dCBhbmltYXRpb25cblxuICAgICAgdGhpcy5vdXRBbmltYXRpb24oZnJvbSwgZG9uZSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIm91dEFuaW1hdGlvblwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvdXRBbmltYXRpb24oZnJvbSwgZG9uZSkge1xuICAgICAgZnJvbS5yZW1vdmUoKTtcbiAgICAgIGRvbmUoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiaW5cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2luKF9yZWYyKSB7XG4gICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICB2YXIgZnJvbSA9IF9yZWYyLmZyb20sXG4gICAgICAgICAgdG8gPSBfcmVmMi50byxcbiAgICAgICAgICBkb25lID0gX3JlZjIuZG9uZTtcbiAgICAgIC8vIFN0b3JlXG4gICAgICB0aGlzLmFwcFN0b3JlID0gYXBwU3RvcmU7IC8vIEFwcCByZWZlcmVuY2VzXG5cbiAgICAgIHRoaXMuYXBwQ29yZSA9IG5ldyBhcHBDb3JlKCk7XG4gICAgICB0aGlzLmFwcFVpID0gbmV3IGFwcFVpKCk7IC8vIFByZWxvYWRlclxuXG4gICAgICB0aGlzLnByZWxvYWRNYWluID0gbnVsbDtcbiAgICAgIHRoaXMucHJlbG9hZFNlY29uZGFyeSA9IG51bGw7XG4gICAgICB0aGlzLnByZWxvYWREZWxheSA9IDA7IC8vIExhenkgbG9hZFxuXG4gICAgICB0aGlzLmxhenlMb2FkID0gbnVsbDsgLy8gU2V0IGFuaW1hdGlvblxuXG4gICAgICB0aGlzLnNldEFuaW1hdGlvbihmcm9tLCB0byk7XG4gICAgICB0aGlzLnByZWxvYWRJdGVtcyA9IHRoaXMuYXBwQ29yZS5oaWdod2F5LlRvLnByZWxvYWRJdGVtcztcblxuICAgICAgaWYgKHRoaXMucHJlbG9hZEl0ZW1zLm1haW4ubGVuZ3RoID4gMCkge1xuICAgICAgICB2YXIgX3ByZWxvYWRPbiA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuXG4gICAgICAgIHRoaXMucHJlbG9hZE1haW4gPSBQcmVsb2FkKCk7XG4gICAgICAgIHRoaXMucHJlbG9hZE1haW4uZmV0Y2godGhpcy5wcmVsb2FkSXRlbXMubWFpbik7IC8vIHRoaXMucHJlbG9hZE1haW4ub25wcm9ncmVzcyA9IChldmVudCkgPT4geyBjb25zb2xlLmxvZygnUHJpbWFyeTogJyArIGV2ZW50LnByb2dyZXNzICsgJyUnKTsgfTtcblxuICAgICAgICB0aGlzLnByZWxvYWRNYWluLm9uY29tcGxldGUgPSBmdW5jdGlvbiAoaXRlbXMpIHtcbiAgICAgICAgICB2YXIgX3ByZWxvYWRPZmYgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcblxuICAgICAgICAgIHZhciBfcHJlbG9hZERpZmZlcmVuY2UgPSAoX3ByZWxvYWRPZmYgLSBfcHJlbG9hZE9uKSAvIDEwMDA7XG5cbiAgICAgICAgICB2YXIgX3ByZWxvYWREZWxheSA9IE1hdGgubWF4KDAsIF90aGlzLnByZWxvYWREZWxheSAtIF9wcmVsb2FkRGlmZmVyZW5jZSk7XG5cbiAgICAgICAgICBnc2FwLmRlbGF5ZWRDYWxsKF9wcmVsb2FkRGVsYXksIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIEluIGFuaW1hdGlvblxuICAgICAgICAgICAgX3RoaXMuaW5BbmltYXRpb24oZnJvbSwgdG8sIGRvbmUpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmICh0aGlzLnByZWxvYWRJdGVtcy5zZWNvbmRhcnkubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHRoaXMucHJlbG9hZFNlY29uZGFyeSA9IFByZWxvYWQoKTtcbiAgICAgICAgICB0aGlzLnByZWxvYWRTZWNvbmRhcnkuZmV0Y2godGhpcy5wcmVsb2FkSXRlbXMuc2Vjb25kYXJ5KTsgLy8gdGhpcy5wcmVsb2FkU2Vjb25kYXJ5Lm9ucHJvZ3Jlc3MgPSAoZXZlbnQpID0+IHsgY29uc29sZS5sb2coJ1NlY29uZGFyeTogJyArIGV2ZW50LnByb2dyZXNzICsgJyUnKTsgfTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZ3NhcC5kZWxheWVkQ2FsbCh0aGlzLnByZWxvYWREZWxheSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIC8vIEluIGFuaW1hdGlvblxuICAgICAgICAgIF90aGlzLmluQW5pbWF0aW9uKGZyb20sIHRvLCBkb25lKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInNldEFuaW1hdGlvblwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRBbmltYXRpb24oZnJvbSwgdG8pIHt9IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcblxuICB9LCB7XG4gICAga2V5OiBcImluQW5pbWF0aW9uXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGluQW5pbWF0aW9uKGZyb20sIHRvLCBkb25lKSB7XG4gICAgICBkb25lKCk7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIFRyYW5zaXRpb247XG59KEhpZ2h3YXkuVHJhbnNpdGlvbik7XG5cbmV4cG9ydCBkZWZhdWx0IFRyYW5zaXRpb247IiwiZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgXCJAYmFiZWwvaGVscGVycyAtIHR5cGVvZlwiOyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2Yob2JqKTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvblwiKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9XG5cbmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVTdXBlcihEZXJpdmVkKSB7IHZhciBoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0ID0gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpOyByZXR1cm4gZnVuY3Rpb24gX2NyZWF0ZVN1cGVySW50ZXJuYWwoKSB7IHZhciBTdXBlciA9IF9nZXRQcm90b3R5cGVPZihEZXJpdmVkKSwgcmVzdWx0OyBpZiAoaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCkgeyB2YXIgTmV3VGFyZ2V0ID0gX2dldFByb3RvdHlwZU9mKHRoaXMpLmNvbnN0cnVjdG9yOyByZXN1bHQgPSBSZWZsZWN0LmNvbnN0cnVjdChTdXBlciwgYXJndW1lbnRzLCBOZXdUYXJnZXQpOyB9IGVsc2UgeyByZXN1bHQgPSBTdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9IHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCByZXN1bHQpOyB9OyB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikpIHsgcmV0dXJuIGNhbGw7IH0gZWxzZSBpZiAoY2FsbCAhPT0gdm9pZCAwKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJEZXJpdmVkIGNvbnN0cnVjdG9ycyBtYXkgb25seSByZXR1cm4gb2JqZWN0IG9yIHVuZGVmaW5lZFwiKTsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfVxuXG5mdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIHNlbGY7IH1cblxuZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcInVuZGVmaW5lZFwiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiB0cnVlOyB0cnkgeyBCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoQm9vbGVhbiwgW10sIGZ1bmN0aW9uICgpIHt9KSk7IHJldHVybiB0cnVlOyB9IGNhdGNoIChlKSB7IHJldHVybiBmYWxzZTsgfSB9XG5cbmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH1cblxuLy8gSW1wb3J0IFRyYW5zaXRpb25cbmltcG9ydCBUcmFuc2l0aW9uIGZyb20gJy4vdHJhbnNpdGlvbi5qcyc7IC8vIEdTQVAgTGlicmFyeVxuXG5pbXBvcnQgZ3NhcCBmcm9tICdnc2FwJzsgLy8gRmFkZVxuXG52YXIgVHJhbnNpdGlvbkZhZGUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9UcmFuc2l0aW9uKSB7XG4gIF9pbmhlcml0cyhUcmFuc2l0aW9uRmFkZSwgX1RyYW5zaXRpb24pO1xuXG4gIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoVHJhbnNpdGlvbkZhZGUpO1xuXG4gIGZ1bmN0aW9uIFRyYW5zaXRpb25GYWRlKCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUcmFuc2l0aW9uRmFkZSk7XG5cbiAgICByZXR1cm4gX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoVHJhbnNpdGlvbkZhZGUsIFt7XG4gICAga2V5OiBcIm91dEFuaW1hdGlvblwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvdXRBbmltYXRpb24oZnJvbSwgZG9uZSkge1xuICAgICAgZ3NhcC5mcm9tVG8oZnJvbSwge1xuICAgICAgICBvcGFjaXR5OiAxXG4gICAgICB9LCB7XG4gICAgICAgIG9wYWNpdHk6IDAsXG4gICAgICAgIGR1cmF0aW9uOiAwLjgsXG4gICAgICAgIG9uQ29tcGxldGU6IGZ1bmN0aW9uIG9uQ29tcGxldGUoKSB7XG4gICAgICAgICAgZnJvbS5yZW1vdmUoKTtcbiAgICAgICAgICBkb25lKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJpbkFuaW1hdGlvblwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpbkFuaW1hdGlvbihmcm9tLCB0bywgZG9uZSkge1xuICAgICAgd2luZG93LnNjcm9sbFRvKDAsIDApO1xuICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCA9IDA7XG4gICAgICBkb25lKCk7XG4gICAgICBnc2FwLnRvKHRvLCB7XG4gICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgIGR1cmF0aW9uOiAwLjhcbiAgICAgIH0pO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBUcmFuc2l0aW9uRmFkZTtcbn0oVHJhbnNpdGlvbik7XG5cbmV4cG9ydCBkZWZhdWx0IFRyYW5zaXRpb25GYWRlOyIsImZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IFwiQGJhYmVsL2hlbHBlcnMgLSB0eXBlb2ZcIjsgaWYgKHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiKSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfTsgfSBlbHNlIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfVxuXG5mdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb25cIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfVxuXG5mdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfVxuXG5mdW5jdGlvbiBfY3JlYXRlU3VwZXIoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKTsgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkgeyB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksIHJlc3VsdDsgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHsgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjsgcmVzdWx0ID0gUmVmbGVjdC5jb25zdHJ1Y3QoU3VwZXIsIGFyZ3VtZW50cywgTmV3VGFyZ2V0KTsgfSBlbHNlIHsgcmVzdWx0ID0gU3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfSByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTsgfTsgfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpKSB7IHJldHVybiBjYWxsOyB9IGVsc2UgaWYgKGNhbGwgIT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRGVyaXZlZCBjb25zdHJ1Y3RvcnMgbWF5IG9ubHkgcmV0dXJuIG9iamVjdCBvciB1bmRlZmluZWRcIik7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH1cblxuZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSB7IGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJ1bmRlZmluZWRcIiB8fCAhUmVmbGVjdC5jb25zdHJ1Y3QpIHJldHVybiBmYWxzZTsgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTsgaWYgKHR5cGVvZiBQcm94eSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gdHJ1ZTsgdHJ5IHsgQm9vbGVhbi5wcm90b3R5cGUudmFsdWVPZi5jYWxsKFJlZmxlY3QuY29uc3RydWN0KEJvb2xlYW4sIFtdLCBmdW5jdGlvbiAoKSB7fSkpOyByZXR1cm4gdHJ1ZTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2U7IH0gfVxuXG5mdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9XG5cbi8vIEltcG9ydCBUcmFuc2l0aW9uXG5pbXBvcnQgVHJhbnNpdGlvbiBmcm9tICcuL3RyYW5zaXRpb24uanMnOyAvLyBHU0FQIExpYnJhcnlcblxuaW1wb3J0IGdzYXAgZnJvbSAnZ3NhcCc7IC8vIE1hc2tcblxudmFyIFRyYW5zaXRpb25NYXNrID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfVHJhbnNpdGlvbikge1xuICBfaW5oZXJpdHMoVHJhbnNpdGlvbk1hc2ssIF9UcmFuc2l0aW9uKTtcblxuICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKFRyYW5zaXRpb25NYXNrKTtcblxuICBmdW5jdGlvbiBUcmFuc2l0aW9uTWFzaygpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVHJhbnNpdGlvbk1hc2spO1xuXG4gICAgcmV0dXJuIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKFRyYW5zaXRpb25NYXNrLCBbe1xuICAgIGtleTogXCJvdXRBbmltYXRpb25cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gb3V0QW5pbWF0aW9uKGZyb20sIGRvbmUpIHtcbiAgICAgIGdzYXAuc2V0KHRoaXMuYXBwVWkuJG1hc2ssIHtcbiAgICAgICAgZGlzcGxheTogJ2Jsb2NrJ1xuICAgICAgfSk7XG4gICAgICBnc2FwLmZyb21Ubyh0aGlzLmFwcFVpLiRtYXNrLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgIHk6ICctMTAwJSdcbiAgICAgIH0sIHtcbiAgICAgICAgeTogJzAlJyxcbiAgICAgICAgZHVyYXRpb246IDEsXG4gICAgICAgIGVhc2U6ICdleHBvLmluJyxcbiAgICAgICAgZGVsYXk6IHRoaXMuYXBwVWkuaGVhZGVyLmlzT3BlbiA/IDAuOCA6IDAsXG4gICAgICAgIG9uU3RhcnQ6IGZ1bmN0aW9uIG9uU3RhcnQoKSB7XG4gICAgICAgICAgZ3NhcC50byhmcm9tLCB7XG4gICAgICAgICAgICB5OiAnNXZ3JyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAxLFxuICAgICAgICAgICAgZWFzZTogJ2V4cG8uaW4nXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uQ29tcGxldGU6IGZ1bmN0aW9uIG9uQ29tcGxldGUoKSB7XG4gICAgICAgICAgZnJvbS5yZW1vdmUoKTtcbiAgICAgICAgICBkb25lKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJpbkFuaW1hdGlvblwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpbkFuaW1hdGlvbihmcm9tLCB0bywgZG9uZSkge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgZ3NhcC5zZXQodGhpcy5hcHBVaS4kbG9nbywge1xuICAgICAgICB5OiAwXG4gICAgICB9KTtcbiAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCAwKTtcbiAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgPSAwO1xuICAgICAgZG9uZSgpO1xuICAgICAgZ3NhcC50byh0aGlzLmFwcFVpLiRtYXNrLmNoaWxkcmVuWzBdLCB7XG4gICAgICAgIHk6ICcxMDAlJyxcbiAgICAgICAgZHVyYXRpb246IDEsXG4gICAgICAgIGVhc2U6ICdleHBvLm91dCcsXG4gICAgICAgIG9uQ29tcGxldGU6IGZ1bmN0aW9uIG9uQ29tcGxldGUoKSB7XG4gICAgICAgICAgZ3NhcC5zZXQoX3RoaXMuYXBwVWkuJG1hc2ssIHtcbiAgICAgICAgICAgIGRpc3BsYXk6ICdub25lJ1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gVHJhbnNpdGlvbk1hc2s7XG59KFRyYW5zaXRpb24pO1xuXG5leHBvcnQgZGVmYXVsdCBUcmFuc2l0aW9uTWFzazsiLCJmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG5cbi8vIGFwcFxuaW1wb3J0IGFwcFN0b3JlIGZyb20gJy4vYXBwU3RvcmUnO1xuaW1wb3J0IGFwcFVpIGZyb20gJy4vYXBwVWknOyAvLyBjbGFzc2VzXG5cbmltcG9ydCBkb21FdmVudHMgZnJvbSAnLi4vY2xhc3Nlcy9kb21FdmVudHMnOyAvLyBIaWdod2F5XG5cbmltcG9ydCBIaWdod2F5IGZyb20gJ0Bkb2dzdHVkaW8vaGlnaHdheSc7IC8vIGdzYXBcblxuaW1wb3J0IGdzYXAgZnJvbSAnZ3NhcCc7IC8vIEltcG9ydCBSZW5kZXJlcnNcbi8vIGltcG9ydCBSZW5kZXJlciBmcm9tICcuLi9yZW5kZXJlcnMvcmVuZGVyZXInO1xuXG5pbXBvcnQgUmVuZGVyZXJEZWZhdWx0IGZyb20gJy4uL3JlbmRlcmVycy9yZW5kZXJlckRlZmF1bHQnO1xuaW1wb3J0IFJlbmRlcmVySG9tZSBmcm9tICcuLi9yZW5kZXJlcnMvcmVuZGVyZXJIb21lJztcbmltcG9ydCBSZW5kZXJlckFib3V0IGZyb20gJy4uL3JlbmRlcmVycy9yZW5kZXJlckFib3V0JztcbmltcG9ydCBSZW5kZXJlclBoaWxvc29waHkgZnJvbSAnLi4vcmVuZGVyZXJzL3JlbmRlcmVyUGhpbG9zb3BoeSc7XG5pbXBvcnQgUmVuZGVyZXJQcm9tb3Rpb25zIGZyb20gJy4uL3JlbmRlcmVycy9yZW5kZXJlclByb21vdGlvbnMnO1xuaW1wb3J0IFJlbmRlcmVyUHJvbW90aW9uc1NpbmdsZSBmcm9tICcuLi9yZW5kZXJlcnMvcmVuZGVyZXJQcm9tb3Rpb25zU2luZ2xlJztcbmltcG9ydCBSZW5kZXJlck1hc3RlcndvcmtzIGZyb20gJy4uL3JlbmRlcmVycy9yZW5kZXJlck1hc3RlcndvcmtzJztcbmltcG9ydCBSZW5kZXJlckJsb2cgZnJvbSAnLi4vcmVuZGVyZXJzL3JlbmRlcmVyQmxvZyc7XG5pbXBvcnQgUmVuZGVyZXJCbG9nU2luZ2xlIGZyb20gJy4uL3JlbmRlcmVycy9yZW5kZXJlckJsb2dTaW5nbGUnO1xuaW1wb3J0IFJlbmRlcmVyQ29udGFjdCBmcm9tICcuLi9yZW5kZXJlcnMvUmVuZGVyZXJDb250YWN0JzsgLy8gSW1wb3J0IFRyYW5zaXRpb25zXG5cbmltcG9ydCBUcmFuc2l0aW9uRmFkZSBmcm9tICcuLi90cmFuc2l0aW9ucy90cmFuc2l0aW9uRmFkZSc7XG5pbXBvcnQgVHJhbnNpdGlvbk1hc2sgZnJvbSAnLi4vdHJhbnNpdGlvbnMvdHJhbnNpdGlvbk1hc2snO1xuaW1wb3J0IGdzYXBDb3JlIGZyb20gJ2dzYXAvZ3NhcC1jb3JlJztcbnZhciBfc2luZ2xldG9uID0gbnVsbDtcblxudmFyIGFwcENvcmUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBhcHBDb3JlKGRhdGEpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgYXBwQ29yZSk7XG5cbiAgICBpZiAoIV9zaW5nbGV0b24pIHtcbiAgICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gICAgICBfc2luZ2xldG9uID0gdGhpcztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIF9zaW5nbGV0b247XG4gICAgfSAvLyBjb25zb2xlLmxvZygnQ29uc3RydWN0b3IgZGUgYXBwQ29yZScpO1xuICAgIC8vIHN0b3JlXG5cblxuICAgIHRoaXMuYXBwU3RvcmUgPSBhcHBTdG9yZTsgLy8gYXBwIHJlZmVyZW5jZXNcblxuICAgIHRoaXMuYXBwVWkgPSBuZXcgYXBwVWkoKTsgLy8gRXZlbnRzXG5cbiAgICB0aGlzLmRvbUV2ZW50cyA9IG5ldyBkb21FdmVudHMoKTsgLy8gSGlnaHdheSBjb3JlXG5cbiAgICB0aGlzLmhpZ2h3YXkgPSBudWxsO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKGFwcENvcmUsIFt7XG4gICAga2V5OiBcImluaXRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgIC8vIENhbGwgSGlnaHdheS5Db3JlIG9uY2UuXG4gICAgICB0aGlzLmhpZ2h3YXkgPSBuZXcgSGlnaHdheS5Db3JlKHtcbiAgICAgICAgcmVuZGVyZXJzOiB7XG4gICAgICAgICAgaG9tZTogUmVuZGVyZXJIb21lLFxuICAgICAgICAgIHByb21vdGlvbnM6IFJlbmRlcmVyUHJvbW90aW9ucyxcbiAgICAgICAgICBwcm9tb3Rpb25zc2luZ2xlOiBSZW5kZXJlclByb21vdGlvbnNTaW5nbGUsXG4gICAgICAgICAgYWJvdXQ6IFJlbmRlcmVyQWJvdXQsXG4gICAgICAgICAgcGhpbG9zb3BoeTogUmVuZGVyZXJQaGlsb3NvcGh5LFxuICAgICAgICAgIG1hc3RlcndvcmtzOiBSZW5kZXJlck1hc3RlcndvcmtzLFxuICAgICAgICAgIGJsb2c6IFJlbmRlcmVyQmxvZyxcbiAgICAgICAgICBibG9nc2luZ2xlOiBSZW5kZXJlckJsb2dTaW5nbGUsXG4gICAgICAgICAgY29udGFjdDogUmVuZGVyZXJDb250YWN0LFxuICAgICAgICAgIFwiZGVmYXVsdFwiOiBSZW5kZXJlckRlZmF1bHRcbiAgICAgICAgfSxcbiAgICAgICAgdHJhbnNpdGlvbnM6IHtcbiAgICAgICAgICBcImRlZmF1bHRcIjogdGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3AgPyBUcmFuc2l0aW9uTWFzayA6IFRyYW5zaXRpb25GYWRlXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgdGhpcy5oaWdod2F5Lm9uKCdOQVZJR0FURV9PVVQnLCBmdW5jdGlvbiAoX3JlZikge1xuICAgICAgICB2YXIgZnJvbSA9IF9yZWYuZnJvbSxcbiAgICAgICAgICAgIHRyaWdnZXIgPSBfcmVmLnRyaWdnZXIsXG4gICAgICAgICAgICBsb2NhdGlvbiA9IF9yZWYubG9jYXRpb247XG5cbiAgICAgICAgX3RoaXMubmF2aWdhdGVPdXQoZnJvbSwgdHJpZ2dlciwgbG9jYXRpb24pO1xuICAgICAgfSk7XG4gICAgICB0aGlzLmhpZ2h3YXkub24oJ05BVklHQVRFX0lOJywgZnVuY3Rpb24gKF9yZWYyKSB7XG4gICAgICAgIHZhciB0byA9IF9yZWYyLnRvLFxuICAgICAgICAgICAgdHJpZ2dlciA9IF9yZWYyLnRyaWdnZXIsXG4gICAgICAgICAgICBsb2NhdGlvbiA9IF9yZWYyLmxvY2F0aW9uO1xuXG4gICAgICAgIF90aGlzLm5hdmlnYXRlSW4odG8sIHRyaWdnZXIsIGxvY2F0aW9uKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5oaWdod2F5Lm9uKCdOQVZJR0FURV9FTkQnLCBmdW5jdGlvbiAoX3JlZjMpIHtcbiAgICAgICAgdmFyIHRvID0gX3JlZjMudG8sXG4gICAgICAgICAgICBmcm9tID0gX3JlZjMuZnJvbSxcbiAgICAgICAgICAgIHRyaWdnZXIgPSBfcmVmMy50cmlnZ2VyLFxuICAgICAgICAgICAgbG9jYXRpb24gPSBfcmVmMy5sb2NhdGlvbjtcblxuICAgICAgICBfdGhpcy5uYXZpZ2F0ZUVuZCh0bywgZnJvbSwgdHJpZ2dlciwgbG9jYXRpb24pO1xuICAgICAgfSk7IC8vIENvb2tpZSBsaW5rc1xuXG4gICAgICB2YXIgY29va2llTGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjb29raWUtbGF3LWluZm8tYmFyIC5jb29raWVfYWN0aW9uX2Nsb3NlX2hlYWRlcicpO1xuXG4gICAgICBpZiAoY29va2llTGluaykge1xuICAgICAgICBjb29raWVMaW5rLmhyZWYgPSAnamF2YXNjcmlwdDp2b2lkKDApOyc7XG4gICAgICAgIGNvb2tpZUxpbmsuc2V0QXR0cmlidXRlKCdkYXRhLXJvdXRlci1kaXNhYmxlZCcsICcnKTsgLy90aGlzLmhpZ2h3YXkuZGV0YWNoKGNvb2tpZUxpbmspO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJuYXZpZ2F0ZVN0YXJ0XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIG5hdmlnYXRlU3RhcnQoKSB7XG4gICAgICAvLyBTdGFydCBuYXZpZ2F0aW9uIG9uIDBcbiAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCAwKTtcbiAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgPSAwO1xuICAgICAgaWYgKGhpc3Rvcnkuc2Nyb2xsUmVzdG9yYXRpb24pIGhpc3Rvcnkuc2Nyb2xsUmVzdG9yYXRpb24gPSAnbWFudWFsJzsgLy8gU2hvdyBzdWJtZW51IG9uIGhvbWVwYWdlXG5cbiAgICAgIGlmICh0aGlzLmFwcFN0b3JlLmN1cnJlbnQgPT09ICdob21lJyAmJiB0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCkgdGhpcy5hcHBVaS50cmlnZ2VyU3VibWVudSh0cnVlKTsgLy8gUG9zaXRpb24gdGhlIG1lbnUgb24gcHJvbW90aW9uU2luZ2xlXG5cbiAgICAgIGlmICh0aGlzLmFwcFN0b3JlLmN1cnJlbnQgPT09ICdwcm9tb3Rpb25zc2luZ2xlJyAmJiB0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCkgZ3NhcC5zZXQoW3RoaXMuYXBwVWkuJGhlYWRlcl0sIHtcbiAgICAgICAgeTogJy0yLjV2dydcbiAgICAgIH0pO2Vsc2UgZ3NhcC5zZXQoW3RoaXMuYXBwVWkuJGhlYWRlcl0sIHtcbiAgICAgICAgeTogJzB2dydcbiAgICAgIH0pOyAvLyBRdWVyeSBhZG1pbiBiYXIgbGlua3MsIGFuZCBuZXcgcGFnZSdzIGFkbWluIGJhciBsaW5rc1xuXG4gICAgICB2YXIgbGFuZ3VhZ2VMaW5rcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNoZWFkZXIgLm1lbnUtaXRlbS1vYmplY3QtbGFuZ3VhZ2Vfc3dpdGNoZXIgYScpO1xuXG4gICAgICBpZiAobGFuZ3VhZ2VMaW5rcykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxhbmd1YWdlTGlua3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBsYW5ndWFnZUxpbmtzW2ldLnNldEF0dHJpYnV0ZSgnZGF0YS1yb3V0ZXItZGlzYWJsZWQnLCAnJyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmhpZ2h3YXkuZGV0YWNoKGxhbmd1YWdlTGlua3MpO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJuYXZpZ2F0ZU91dFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBuYXZpZ2F0ZU91dChmcm9tLCB0cmlnZ2VyLCBsb2NhdGlvbikge1xuICAgICAgdGhpcy5hcHBTdG9yZS5mcm9tID0gZnJvbS52aWV3LmRhdGFzZXQucm91dGVyVmlldzsgLy8gU2hvdyBzdWJtZW51IG9uIGhvbWVwYWdlXG5cbiAgICAgIGlmICh0aGlzLmFwcFN0b3JlLmZyb20gPT09ICdob21lJyAmJiB0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCkgdGhpcy5hcHBVaS50cmlnZ2VyU3VibWVudShmYWxzZSk7XG4gICAgICBpZiAodGhpcy5hcHBVaS5oZWFkZXIuaXNPcGVuKSB0aGlzLmFwcFVpLnRyaWdnZXJNZW51KCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIm5hdmlnYXRlSW5cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gbmF2aWdhdGVJbih0bywgdHJpZ2dlciwgbG9jYXRpb24pIHtcbiAgICAgIHRoaXMuYXBwU3RvcmUudG8gPSB0by52aWV3LmRhdGFzZXQucm91dGVyVmlldzsgLy8gU2hvdyBzdWJtZW51IG9uIGhvbWVwYWdlXG5cbiAgICAgIGlmICh0aGlzLmFwcFN0b3JlLnRvID09PSAnaG9tZScgJiYgdGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHRoaXMuYXBwVWkudHJpZ2dlclN1Ym1lbnUodHJ1ZSk7IC8vIFBvc2l0aW9uIHRoZSBtZW51IG9uIHByb21vdGlvblNpbmdsZVxuXG4gICAgICBpZiAodGhpcy5hcHBTdG9yZS50byA9PT0gJ3Byb21vdGlvbnNzaW5nbGUnICYmIHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wKSBnc2FwLnRvKHRoaXMuYXBwVWkuJGhlYWRlciwge1xuICAgICAgICB5OiAnLTIuNXZ3JyxcbiAgICAgICAgZHVyYXRpb246IDEsXG4gICAgICAgIGVhc2U6ICdleHBvLm91dCdcbiAgICAgIH0pO2Vsc2UgZ3NhcC50byh0aGlzLmFwcFVpLiRoZWFkZXIsIHtcbiAgICAgICAgeTogJzB2dycsXG4gICAgICAgIGR1cmF0aW9uOiAxLFxuICAgICAgICBlYXNlOiAnZXhwby5vdXQnXG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwibmF2aWdhdGVFbmRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gbmF2aWdhdGVFbmQodG8sIGZyb20sIHRyaWdnZXIsIGxvY2F0aW9uKSB7XG4gICAgICB0aGlzLmFwcFN0b3JlLnRvID0gdG8udmlldy5kYXRhc2V0LnJvdXRlclZpZXc7IC8vIFJlbW92ZSBhY3RpdmUgaXRlbVxuXG4gICAgICBpZiAodGhpcy5hcHBVaS4kaGVhZGVyLnF1ZXJ5U2VsZWN0b3IoJy5hY3RpdmUnKSkgdGhpcy5hcHBVaS4kaGVhZGVyLnF1ZXJ5U2VsZWN0b3IoJy5hY3RpdmUnKS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsgLy8gQWRkIGFjdGl2ZSBpdGVtXG5cbiAgICAgIGlmICh0aGlzLmFwcFVpLiRoZWFkZXIucXVlcnlTZWxlY3RvcignLm1lbnUtaXRlbS0tJyArIHRoaXMuYXBwU3RvcmUudG8pKSB0aGlzLmFwcFVpLiRoZWFkZXIucXVlcnlTZWxlY3RvcignLm1lbnUtaXRlbS0tJyArIHRoaXMuYXBwU3RvcmUudG8pLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOyAvLyBTZXQgY2xhc3Nlc1xuXG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jykuc2V0QXR0cmlidXRlKCdjbGFzcycsIHRvLnBhZ2UuYm9keS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykpOyAvLyAvLyBRdWVyeSBhZG1pbiBiYXIgbGlua3MsIGFuZCBuZXcgcGFnZSdzIGFkbWluIGJhciBsaW5rc1xuICAgICAgLy8gY29uc3Qgb2xkTGFuZ3VhZ2VMaW5rcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNoZWFkZXIgYScpO1xuICAgICAgLy8gY29uc3QgbmV3TGFuZ3VhZ2VMaW5rcyA9IHRvLnBhZ2UuYm9keS5xdWVyeVNlbGVjdG9yQWxsKCcjaGVhZGVyIGEnKTtcbiAgICAgIC8vIC8vIFJlcGxhY2UgZXZlcnkgYWRtaW4gYmFyIGxpbmsncyBocmVmIHZhbHVlIHdpdGggbmV3IHZhbHVlXG4gICAgICAvLyBpZihvbGRMYW5ndWFnZUxpbmtzKVxuICAgICAgLy8ge1xuICAgICAgLy8gICAgIGZvcihsZXQgaSA9IDA7IGkgPCBuZXdMYW5ndWFnZUxpbmtzLmxlbmd0aDsgaSsrKVxuICAgICAgLy8gICAgIHtcbiAgICAgIC8vICAgICAgICAgb2xkTGFuZ3VhZ2VMaW5rc1tpXS5wYXJlbnROb2RlLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCBuZXdMYW5ndWFnZUxpbmtzW2ldLnBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKCdjbGFzcycpKTtcbiAgICAgIC8vICAgICAgICAgb2xkTGFuZ3VhZ2VMaW5rc1tpXS5ocmVmID0gbmV3TGFuZ3VhZ2VMaW5rc1tpXS5ocmVmO1xuICAgICAgLy8gICAgIH1cbiAgICAgIC8vICAgICAvLyBEZXRhY2ggYWRtaW4gYmFyIGxpbmtzIGZyb20gSGlnaHdheSB0cmFuc2l0aW9uc1xuICAgICAgLy8gICAgIHRoaXMuaGlnaHdheS5kZXRhY2gob2xkTGFuZ3VhZ2VMaW5rcyk7XG4gICAgICAvLyB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInNlbGVjdG9yc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzZWxlY3RvcnMoKSB7Ly8gR2V0IGFsbCBtZW51IG1lbnVMaW5rc1xuICAgICAgLy8gdGhpcy4kbWVudUxpbmtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI21lbnUgdWwgYScpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJldmVudHNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZXZlbnRzKCkgey8vIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy4kbWVudUxpbmtzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAvLyAgICAgdGhpcy5kb21FdmVudHMuYWRkKHRoaXMuJG1lbnVMaW5rc1tpXSwgJ21vdXNlZW50ZXInLCAoZSwgYSwgZWwpID0+IHsgdGhpcy5hcHBVaS5tZW51RW50ZXIoZSwgYSwgZWwpOyB9LCB0aGlzKTtcbiAgICAgIC8vICAgICB0aGlzLmRvbUV2ZW50cy5hZGQodGhpcy4kbWVudUxpbmtzW2ldLCAnbW91c2VsZWF2ZScsIChlLCBhLCBlbCkgPT4geyB0aGlzLmFwcFVpLm1lbnVMZWF2ZShlLCBhLCBlbCk7IH0sIHRoaXMpO1xuICAgICAgLy8gfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJyZXNpemVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVzaXplKHdpZHRoLCBoZWlnaHQpIHsvLyBjb25zb2xlLmxvZygnUmVzaXplIGFwcENvcmU6Jywgd2lkdGgsIGhlaWdodCk7XG4gICAgICAvLyAgdGhpcy5oaWdod2F5LkhlbHBlcnMucmVuZGVyZXJzW3RoaXMuaGlnaHdheS5wcm9wZXJ0aWVzLnNsdWddLnByb3RvdHlwZS5yZXNpemUoKTtcbiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuaGlnaHdheS5IZWxwZXJzLnJlbmRlcmVycy5sb2NhbGVzLnByb3RvdHlwZSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInJlc2l6ZU9yaWVudGF0aW9uXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2l6ZU9yaWVudGF0aW9uKCkgey8vIGdzYXAudG8oZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCB7IG9wYWNpdHk6IDAuMDAwMSwgZHVyYXRpb246IDAuNiwgZWFzZTogJ3Bvd2VyMi5vdXQnLCBvbkNvbXBsZXRlOiAoKSA9PiB7XG4gICAgICAvLyAgICAgZ3NhcC50byhkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsIHsgb3BhY2l0eTogMSwgZHVyYXRpb246IDAuNiwgZWFzZTogJ3Bvd2VyMi5vdXQnIH0pO1xuICAgICAgLy8gfX0pO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBhcHBDb3JlO1xufSgpO1xuXG5leHBvcnQgZGVmYXVsdCBhcHBDb3JlOyIsIi8vQ29weXJpZ2h0IDIwMTggVmljZW50ZSBMdWNlbmRvIC0gdmljZW5Admx1Y2VuZG8uY29tXG4vL3NpbXBsZSBkZWJvdW5jZSB3aXRoIGNhbGxiYWNrXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiAoY2FsbGJhY2ssIGRlbGF5KSB7XG4gIHZhciB0aW1lb3V0O1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICB0aW1lb3V0ID0gc2V0VGltZW91dChjYWxsYmFjaywgZGVsYXkpO1xuICB9O1xufVxuOyIsImZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuLy8gY3NzXG5pbXBvcnQgY3NzIGZyb20gJy4uLy4uL2Nzcy9zdHlsZXMuY3NzJzsgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuLy8gYXBwXG5cbmltcG9ydCBhcHBTdG9yZSBmcm9tICcuL2FwcFN0b3JlJztcbmltcG9ydCBhcHBDb3JlIGZyb20gJy4vYXBwQ29yZSc7XG5pbXBvcnQgYXBwVWkgZnJvbSAnLi9hcHBVaSc7IC8vIGNsYXNzZXNcblxuaW1wb3J0IGRvbUV2ZW50cyBmcm9tICcuLi9jbGFzc2VzL2RvbUV2ZW50cyc7IC8vIGdzYXBcblxuaW1wb3J0IGdzYXAgZnJvbSAnZ3NhcCc7IC8vIHV0aWxzXG5cbmltcG9ydCBEZWJvdW5jZSBmcm9tICcuLi91dGlscy9kZWJvdW5jZSc7XG5pbXBvcnQgQm93c2VyIGZyb20gJ2Jvd3Nlcic7XG5cbnZhciBBcHBsaWNhdGlvbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEFwcGxpY2F0aW9uKG9wdGlvbnMpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQXBwbGljYXRpb24pO1xuXG4gICAgLy8gY29uc29sZS5sb2coJ0NvbnN0cnVjdG9yIGRlIGFwcCcpO1xuICAgIC8vIHN0b3JlXG4gICAgdGhpcy5hcHBTdG9yZSA9IGFwcFN0b3JlOyAvLyBhcHAgcmVmZXJlbmNlc1xuXG4gICAgdGhpcy5hcHBDb3JlID0gbmV3IGFwcENvcmUoKTtcbiAgICB0aGlzLmFwcFVpID0gbmV3IGFwcFVpKCk7IC8vIEV2ZW50c1xuXG4gICAgdGhpcy5kb21FdmVudHMgPSBuZXcgZG9tRXZlbnRzKCk7IC8vIGdldCBjdXJyZW50IHVybFxuXG4gICAgdGhpcy5hcHBTdG9yZS5yb290VXJsID0gd2luZG93LmxvY2F0aW9uLnByb3RvY29sICsgJy8vICcgKyB3aW5kb3cubG9jYXRpb24uaG9zdDsgLy8gZ2V0IGNsaWVudCBpbmZvXG5cbiAgICB2YXIgY2xpZW50SW5mbyA9IEJvd3Nlci5nZXRQYXJzZXIod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpLnBhcnNlZFJlc3VsdDtcbiAgICB0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCA9ICEod2luZG93LmlubmVyV2lkdGggPCAxMDIzIHx8IHdpbmRvdy5pbm5lcldpZHRoIDwgd2luZG93LmlubmVySGVpZ2h0KTtcbiAgICB0aGlzLnNldE9TKGNsaWVudEluZm8pO1xuICAgIHRoaXMuc2V0RGV2aWNlKGNsaWVudEluZm8pO1xuICAgIHRoaXMuc2V0T3JpZW50YXRpb24oKTtcbiAgICB0aGlzLmFkZENsYXNzZXMoKTtcbiAgICB0aGlzLnNheUhlbGxvKCk7XG4gICAgdGhpcy5jaGVja0VsZW1lbnRzKCk7XG4gICAgdGhpcy5zZWxlY3RvcnMoKTtcbiAgICB0aGlzLmV2ZW50cygpO1xuICAgIHRoaXMuaW5pdCgpO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKEFwcGxpY2F0aW9uLCBbe1xuICAgIGtleTogXCJzZXRPU1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRPUyhjbGllbnRJbmZvKSB7XG4gICAgICB2YXIgb3MgPSBjbGllbnRJbmZvLm9zLm5hbWUudG9Mb3dlckNhc2UoKTsgLy8gZGV0ZWN0IG1hYyBhbmQgaW9zLCBkZWZhdWx0IHdpbmRvd3NcblxuICAgICAgc3dpdGNoIChvcykge1xuICAgICAgICBjYXNlICdtYWNvcyc6XG4gICAgICAgICAgdGhpcy5hcHBTdG9yZS5jbGllbnQub3MgPSAnbWFjJztcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdpb3MnOlxuICAgICAgICAgIHRoaXMuYXBwU3RvcmUuY2xpZW50Lm9zID0gJ2lvcyc7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICB0aGlzLmFwcFN0b3JlLmNsaWVudC5vcyA9ICd3aW5kb3dzJztcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwic2V0RGV2aWNlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNldERldmljZShjbGllbnRJbmZvKSB7XG4gICAgICAvLyBnZXQgZGV2aWNlXG4gICAgICB0aGlzLmFwcFN0b3JlLmNsaWVudC5kZXZpY2UgPSBjbGllbnRJbmZvLnBsYXRmb3JtLnR5cGUgPT09ICdkZXNrdG9wJyA/ICdkZXNrdG9wJyA6ICdtb2JpbGUnOyAvLyBkZXRlY3QgYnJvd3NlciAob25seSB0aGUgbWFqb3Igb25lcywgZGVmYXVsdCBpcyBjaHJvbWUpXG5cbiAgICAgIHN3aXRjaCAoY2xpZW50SW5mby5icm93c2VyLm5hbWUpIHtcbiAgICAgICAgY2FzZSAnSW50ZXJuZXQgRXhwbG9yZXInOlxuICAgICAgICAgIHRoaXMuYXBwU3RvcmUuY2xpZW50LmJyb3dzZXIgPSAnZXhwbG9yZXInO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ01pY3Jvc29mdCBFZGdlJzpcbiAgICAgICAgICB0aGlzLmFwcFN0b3JlLmNsaWVudC5icm93c2VyID0gJ2VkZ2UnO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ0ZpcmVmb3gnOlxuICAgICAgICAgIHRoaXMuYXBwU3RvcmUuY2xpZW50LmJyb3dzZXIgPSAnZmlyZWZveCc7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnU2FmYXJpJzpcbiAgICAgICAgICB0aGlzLmFwcFN0b3JlLmNsaWVudC5icm93c2VyID0gJ3NhZmFyaSc7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICB0aGlzLmFwcFN0b3JlLmNsaWVudC5icm93c2VyID0gJ2Nocm9tZSc7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInNldE9yaWVudGF0aW9uXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNldE9yaWVudGF0aW9uKCkge1xuICAgICAgdGhpcy5hcHBTdG9yZS5jbGllbnQub3JpZW50YXRpb24gPSB0aGlzLmFwcFN0b3JlLmNsaWVudC5zaXplcy53aWR0aCA+IHRoaXMuYXBwU3RvcmUuY2xpZW50LnNpemVzLmhlaWdodCA/ICdob3Jpem9udGFsJyA6ICd2ZXJ0aWNhbCc7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImFkZENsYXNzZXNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkQ2xhc3NlcygpIHtcbiAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuYXBwU3RvcmUuY2xpZW50LmRldmljZSk7XG4gICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLmFwcFN0b3JlLmNsaWVudC5vcyk7XG4gICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLmFwcFN0b3JlLmNsaWVudC5icm93c2VyKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwic2F5SGVsbG9cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2F5SGVsbG8oKSB7XG4gICAgICBpZiAodGhpcy5hcHBTdG9yZS5jbGllbnQuYnJvd3NlciA9PT0gJ2Nocm9tZScgfHwgdGhpcy5hcHBTdG9yZS5jbGllbnQuYnJvd3NlciA9PT0gJ2ZpcmVmb3gnKSB7XG4gICAgICAgIHZhciBhcmdzID0gWydcXG4lYyBEZXZlbG9wZWQgd2l0aCDimaUgYnkgRGdyZWVzwq4gLSBodHRwczovLyBkZ3JlZXMuc3R1ZGlvICVjXFxuJywgJ2Rpc3BsYXk6IGJsb2NrOyBwYWRkaW5nOiA1cHggMTBweDsgYmFja2dyb3VuZDogIzAwMDAyMjsgbGluZS1oZWlnaHQ6IDQwcHg7IGNvbG9yOiAjZmZmZmZmOycsICdiYWNrZ3JvdW5kOiAjZmZmOyddO1xuICAgICAgICB3aW5kb3cuY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgYXJncyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coJ0RldmVsb3BlZCBieSBEZ3JlZXPCricpO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJjaGVja0VsZW1lbnRzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNoZWNrRWxlbWVudHMoKSB7XG4gICAgICBpZiAodGhpcy5hcHBTdG9yZS5pc0Rlc2t0b3ApIHtcbiAgICAgICAgdGhpcy4kZWxlbWVudHNNb2JpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1tb2JpbGVdJyk7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLiRlbGVtZW50c01vYmlsZS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHRoaXMuJGVsZW1lbnRzTW9iaWxlW2ldLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLiRlbGVtZW50c0Rlc2t0b3AgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1kZXNrdG9wXScpO1xuXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCB0aGlzLiRlbGVtZW50c0Rlc2t0b3AubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgdGhpcy4kZWxlbWVudHNEZXNrdG9wW19pXS5yZW1vdmUoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzZWxlY3RvcnNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2VsZWN0b3JzKCkge1xuICAgICAgdGhpcy5hcHBDb3JlLnNlbGVjdG9ycygpO1xuICAgICAgdGhpcy5hcHBVaS5zZWxlY3RvcnMoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiZXZlbnRzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGV2ZW50cygpIHtcbiAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgIC8vIGJpbmQgZGVib3VuY2VkIHJlc2l6ZVxuICAgICAgdGhpcy5kb21FdmVudHMuYWRkKHdpbmRvdywgJ3Jlc2l6ZScsIERlYm91bmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3RoaXMucmVzaXplKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xuICAgICAgfSwgMTUwKSk7XG4gICAgICB2YXIgb3JpZW50YXRpb25FdmVudCA9ICdvbm9yaWVudGF0aW9uY2hhbmdlJyBpbiB3aW5kb3cgPyAnb3JpZW50YXRpb25jaGFuZ2UnIDogJ3Jlc2l6ZSc7XG4gICAgICB0aGlzLmRvbUV2ZW50cy5hZGQod2luZG93LCBvcmllbnRhdGlvbkV2ZW50LCBEZWJvdW5jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aGlzLnJlc2l6ZU9yaWVudGF0aW9uKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xuICAgICAgfSwgMTUwKSk7XG4gICAgICB0aGlzLmFwcENvcmUuZXZlbnRzKCk7XG4gICAgICB0aGlzLmFwcFVpLmV2ZW50cygpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJpbml0XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICB0aGlzLmFwcENvcmUuaW5pdCgpO1xuICAgICAgdGhpcy5hcHBVaS5pbml0KCk7XG4gICAgICB2YXIgdmggPSB3aW5kb3cuaW5uZXJIZWlnaHQgKiAwLjAxO1xuICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KCctLXZoJywgXCJcIi5jb25jYXQodmgsIFwicHhcIikpO1xuICAgICAgdGhpcy5yZXNpemUod2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInJlc2l6ZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZXNpemUod2lkdGgsIGhlaWdodCkge1xuICAgICAgLy8gRmlyc3Qgd2UgZ2V0IHRoZSB2aWV3cG9ydCBoZWlnaHQgYW5kIHdlIG11bHRpcGxlIGl0IGJ5IDElIHRvIGdldCBhIHZhbHVlIGZvciBhIHZoIHVuaXRcbiAgICAgIGlmICh0aGlzLmFwcFN0b3JlLmlzRGVza3RvcCkge1xuICAgICAgICB2YXIgdmggPSB3aW5kb3cuaW5uZXJIZWlnaHQgKiAwLjAxO1xuICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJy0tdmgnLCBcIlwiLmNvbmNhdCh2aCwgXCJweFwiKSk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuYXBwU3RvcmUuaXNEZXNrdG9wID0gISh3aW5kb3cuaW5uZXJXaWR0aCA8IDEwMjMgfHwgd2luZG93LmlubmVyV2lkdGggPCB3aW5kb3cuaW5uZXJIZWlnaHQpOyAvLyBzZXQgc2l6ZSB2YXJzXG5cbiAgICAgIHRoaXMuYXBwU3RvcmUuY2xpZW50LnNpemVzLndpZHRoID0gd2lkdGg7XG4gICAgICB0aGlzLmFwcFN0b3JlLmNsaWVudC5zaXplcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICB0aGlzLmFwcENvcmUucmVzaXplKHdpZHRoLCBoZWlnaHQpO1xuICAgICAgdGhpcy5hcHBVaS5yZXNpemUod2lkdGgsIGhlaWdodCk7XG4gICAgICBpZiAodGhpcy5hcHBTdG9yZS5jdXJyZW50U2VjdGlvbiAhPT0gbnVsbCkgdGhpcy5hcHBTdG9yZS5jdXJyZW50U2VjdGlvbi5yZXNpemUod2lkdGgsIGhlaWdodCk7IC8vIC8vIENoZWNrIG9yaWVudGF0aW9uXG4gICAgICAvLyBjb25zdCBuZXdPcmllbnRhdGlvbiA9IHRoaXMuYXBwU3RvcmUuY2xpZW50LnNpemVzLndpZHRoID4gdGhpcy5hcHBTdG9yZS5jbGllbnQuc2l6ZXMuaGVpZ2h0ID8gJ2hvcml6b250YWwnIDogJ3ZlcnRpY2FsJztcbiAgICAgIC8vIGlmKG5ld09yaWVudGF0aW9uICE9PSB0aGlzLmFwcFN0b3JlLmNsaWVudC5vcmllbnRhdGlvbilcbiAgICAgIC8vICAgICB0aGlzLnJlc2l6ZU9yaWVudGF0aW9uKHdpZHRoLCBoZWlnaHQsIG5ld09yaWVudGF0aW9uKTtcbiAgICAgIC8vIHRoaXMuYXBwU3RvcmUuY2xpZW50Lm9yaWVudGF0aW9uID0gbmV3T3JpZW50YXRpb247XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInJlc2l6ZU9yaWVudGF0aW9uXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2l6ZU9yaWVudGF0aW9uKHdpZHRoLCBoZWlnaHQsIG9yaWVudGF0aW9uKSB7XG4gICAgICB2YXIgdmggPSB3aW5kb3cuaW5uZXJIZWlnaHQgKiAwLjAxO1xuICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KCctLXZoJywgXCJcIi5jb25jYXQodmgsIFwicHhcIikpOyAvLyBDaGVjayBvcmllbnRhdGlvblxuXG4gICAgICB2YXIgbmV3T3JpZW50YXRpb24gPSB0aGlzLmFwcFN0b3JlLmNsaWVudC5zaXplcy53aWR0aCA+IHRoaXMuYXBwU3RvcmUuY2xpZW50LnNpemVzLmhlaWdodCA/ICdob3Jpem9udGFsJyA6ICd2ZXJ0aWNhbCc7XG4gICAgICB0aGlzLmFwcFN0b3JlLmNsaWVudC5vcmllbnRhdGlvbiA9IG5ld09yaWVudGF0aW9uO1xuICAgICAgdGhpcy5hcHBDb3JlLnJlc2l6ZU9yaWVudGF0aW9uKHdpZHRoLCBoZWlnaHQsIG9yaWVudGF0aW9uKTtcbiAgICAgIHRoaXMuYXBwVWkucmVzaXplT3JpZW50YXRpb24od2lkdGgsIGhlaWdodCwgb3JpZW50YXRpb24pO1xuICAgICAgaWYgKHRoaXMuYXBwU3RvcmUuY3VycmVudFNlY3Rpb24gIT09IG51bGwpIHRoaXMuYXBwU3RvcmUuY3VycmVudFNlY3Rpb24ucmVzaXplT3JpZW50YXRpb24od2lkdGgsIGhlaWdodCwgb3JpZW50YXRpb24pO1xuICAgIH1cbiAgICAvKiBfY2hlY2tPcmllbnRhdGlvbigpXG4gICAge1xuICAgICAgICAvLyBpZiBpdCdzIG5vdCBhZmZlY3RlZCBieSBvcmllbnRhdGlvbiBwYXNzIHRoZSBjdXJyZW50IG9uZSAoMDogaG9yaXpvbnRhbCwgMTogdmVydGljYWwpXG4gICAgICAgIGlmKHRoaXMub3JpZW50YXRpb24gPT09IG9yaWVudGF0aW9ucy5OT05FKVxuICAgICAgICAgICAgdGhpcy4vLyAodGhpcy5hcHBTdG9yZS5jbGllbnQuc2l6ZXMud2lkdGggPiB0aGlzLmFwcFN0b3JlLmNsaWVudC5zaXplcy5oZWlnaHQgPyAwIDogMSk7XG4gICAgICAgICBpZih0aGlzLm9yaWVudGF0aW9uID09PSBvcmllbnRhdGlvbnMuVkVSVElDQUwpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGlmIHdpZHRoIGlzIGJpZ2dlciB0aGFuIGhlaWdodFxuICAgICAgICAgICAgaWYodGhpcy5hcHBTdG9yZS5jbGllbnQuc2l6ZXMud2lkdGggPiB0aGlzLmFwcFN0b3JlLmNsaWVudC5zaXplcy5oZWlnaHQpXG4gICAgICAgICAgICAgICAgdGhpcy5yb3RhdGVEZXZpY2UodHJ1ZSk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgdGhpcy5yb3RhdGVEZXZpY2UoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYodGhpcy5vcmllbnRhdGlvbiA9PT0gb3JpZW50YXRpb25zLkhPUklaT05UQUwpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGlmIGhlaWdodCBpcyBiaWdnZXIgdGhhbiB3aWR0aFxuICAgICAgICAgICAgaWYodGhpcy5hcHBTdG9yZS5jbGllbnQuc2l6ZXMuaGVpZ2h0ID4gdGhpcy5hcHBTdG9yZS5jbGllbnQuc2l6ZXMud2lkdGgpXG4gICAgICAgICAgICAgICAgdGhpcy5yb3RhdGVEZXZpY2UodHJ1ZSk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgdGhpcy5yb3RhdGVEZXZpY2UoZmFsc2UpO1xuICAgICAgICB9XG4gICAgfSAqL1xuICAgIC8vIHJvdGF0ZURldmljZShhY3Rpb24pe30gLy8gZXNsaW50LWRpc2FibGUtbGluZVxuXG4gIH1dKTtcblxuICByZXR1cm4gQXBwbGljYXRpb247XG59KCk7XG5cbmV4cG9ydCBkZWZhdWx0IEFwcGxpY2F0aW9uOyIsIi8vYXBwc1xuaW1wb3J0IEFwcGxpY2F0aW9uIGZyb20gJy4vYXBwL2FwcCc7IC8vb24gZG9jdW1lbnQgcmVhZHkgY3JlYXRlIGxvYWRlclxuXG5pZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSAhPT0gJ2xvYWRpbmcnKSB7XG4gIHZhciBhcHAgPSBuZXcgQXBwbGljYXRpb24oKTtcbn0gZWxzZSB7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGFwcCA9IG5ldyBBcHBsaWNhdGlvbigpO1xuICB9LCBmYWxzZSk7IC8vZXNsaW50LWRpc2FibGUtbGluZVxufSJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///815\n")}},__webpack_module_cache__={},deferred;function __webpack_require__(g){var I=__webpack_module_cache__[g];if(void 0!==I)return I.exports;var n=__webpack_module_cache__[g]={exports:{}};return __webpack_modules__[g].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.m=__webpack_modules__,deferred=[],__webpack_require__.O=(g,I,n,t)=>{if(!I){var e=1/0;for(i=0;i<deferred.length;i++){for(var[I,n,t]=deferred[i],l=!0,C=0;C<I.length;C++)(!1&t||e>=t)&&Object.keys(__webpack_require__.O).every((g=>__webpack_require__.O[g](I[C])))?I.splice(C--,1):(l=!1,t<e&&(e=t));if(l){deferred.splice(i--,1);var c=n();void 0!==c&&(g=c)}}return g}t=t||0;for(var i=deferred.length;i>0&&deferred[i-1][2]>t;i--)deferred[i]=deferred[i-1];deferred[i]=[I,n,t]},__webpack_require__.n=g=>{var I=g&&g.__esModule?()=>g.default:()=>g;return __webpack_require__.d(I,{a:I}),I},__webpack_require__.d=(g,I)=>{for(var n in I)__webpack_require__.o(I,n)&&!__webpack_require__.o(g,n)&&Object.defineProperty(g,n,{enumerable:!0,get:I[n]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(g){if("object"==typeof window)return window}}(),__webpack_require__.o=(g,I)=>Object.prototype.hasOwnProperty.call(g,I),(()=>{var g={143:0};__webpack_require__.O.j=I=>0===g[I];var I=(I,n)=>{var t,e,[l,C,c]=n,i=0;if(l.some((I=>0!==g[I]))){for(t in C)__webpack_require__.o(C,t)&&(__webpack_require__.m[t]=C[t]);if(c)var A=c(__webpack_require__)}for(I&&I(n);i<l.length;i++)e=l[i],__webpack_require__.o(g,e)&&g[e]&&g[e][0](),g[l[i]]=0;return __webpack_require__.O(A)},n=self.webpackChunkcaledonian=self.webpackChunkcaledonian||[];n.forEach(I.bind(null,0)),n.push=I.bind(null,n.push.bind(n))})();var __webpack_exports__=__webpack_require__.O(void 0,[736],(()=>__webpack_require__(815)));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();